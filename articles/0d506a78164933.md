---
title: "PowerShellã§2ã¤ã®PSCustomObjectã‚’æ¯”è¼ƒã—åŒã˜è¦ç´ ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹Function"
emoji: "ğŸ™Œ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

articles\c1aeace31dbf48.mdã‚’å‚è€ƒ

```powershell:
# articles\75ad4960355f7d.md
function Test-IsPSCustomObject {
    param(
        [Parameter(Mandatory=$true)]
        [System.Object[]]$Argument
    )

    foreach ($arg in $Argument) {
        if (-not ($arg -is [System.Management.Automation.PSCustomObject])) {
            return $false
        }
    }
    return $true
}
Function Test-PSCustomObjectEquality {
    param (
        [Parameter(Mandatory=$true)][System.Object[]]$Object1,
        [Parameter(Mandatory=$true)][System.Object[]]$Object2
    )

    # ãƒ‡ãƒ¼ã‚¿å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    if (($Object1.Count -eq 0) -or ($Object2.Count -eq 0)) {
        Write-Warning "ã„ãšã‚Œã‹ã®å¼•æ•°ã®ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚[$($Object11.Count)]"â˜…
        return $false
    }

    # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†…ãŒPSCustomObjectã§ã‚ã‚‹ã‹åˆ¤å®š
    if (-not (Test-IsPSCustomObject $Object1)) {
        Write-Warning 'å¼•æ•°ã®ã€ŒObject1ã€ãŒPSCustomObjectã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚'
        return $false
    }
    elseif (-not (Test-IsPSCustomObject $Object2)) {
        Write-Warning 'å¼•æ•°ã®ã€ŒObject2ã€ãŒPSCustomObjectã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚'
        return $false
    }

    # è¦ç´ æ•°ã‚’æ¯”è¼ƒ
    if (-not)

    # PSCustomObjectã®é …ç›®åï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±ï¼‰ã‚’æ¯”è¼ƒ
    $resultArrayType = (Get-ArrayType $Array2)
    if ($resultArrayType -ne 1) {
        Write-Warning "å¼•æ•°ã®ã€ŒArray2ã€ãŒã‚¸ãƒ£ã‚°é…åˆ—ï¼ˆå¤šæ¬¡å…ƒé…åˆ—ï¼‰ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚[é…åˆ—ã®åˆ¤å®šçµæœ: $($resultArrayType)]"
        return
    }

    # é…åˆ—ã®æ¬¡å…ƒæ•°ã‚’æ¯”è¼ƒ
    $levelArray1 = $Array1.Length
    $levelArray2 = $Array2.Length

    Write-Debug "`$levelArray1: [$($levelArray1)], `$levelArray2: [$($levelArray2)]"
    if ($levelArray1 -ne $levelArray2) {
        return $false
    }

    # å„æ¬¡å…ƒæ¯ã®è¦ç´ æ•°ã‚’ãƒã‚§ãƒƒã‚¯
    for ($i = 0; $i -lt $Array1.Length; $i++) {
        Write-Debug "`$Array1[$($i)].Length: [$($Array1[$i].Length)], `$Array2[$($i)].Length: [$($Array2[$i].Length)]"
        if ($Array1[$i].Length -ne $Array2[$i].Length) {
            return $false
        }
        for ($j = 0; $j -lt $Array1[$i].Length; $j++) {
            Write-Debug "`$Array1[$($i)][$($j)]: [$($Array1[$i][$j])], `$Array2[$($i)][$($j)]: [$($Array2[$i][$j])]"
            if ($Array1[$i][$j] -ne $Array2[$i][$j]) {
                return $false
            }
        }
    }

    # è¦ç´ æ•°ãŒä¸€è‡´
    return $true
}
```
