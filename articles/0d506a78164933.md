---
title: "PowerShellã§2ã¤ã®PSCustomObjectã‚’æ¯”è¼ƒã—åŒã˜è¦ç´ ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹Function"
emoji: "ğŸ™Œ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

articles\c1aeace31dbf48.mdã‚’å‚è€ƒ

```powershell:
# articles\75ad4960355f7d.md
function Test-IsPSCustomObject {
    param(
        [Parameter(Mandatory=$true)]
        [System.Object[]]$Argument
    )

    foreach ($arg in $Argument) {
        if (-not ($arg -is [System.Management.Automation.PSCustomObject])) {
            return $false
        }
    }
    return $true
}
Function Test-PSCustomObjectEquality {
    param (
        [Parameter(Mandatory=$true)][System.Object[]]$Object1,
        [Parameter(Mandatory=$true)][System.Object[]]$Object2
    )

    # ãƒ‡ãƒ¼ã‚¿å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    if (($Object1.Count -eq 0) -or ($Object2.Count -eq 0)) {
        Write-Warning "ã„ãšã‚Œã‹å¼•æ•°ã®ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚[å¼•æ•°1ã®ä»¶æ•°: $($Object1.Count), å¼•æ•°2ã®ä»¶æ•°: $($Object2.Count)]"
        return $false
    }

    # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†…ãŒPSCustomObjectã§ã‚ã‚‹ã‹åˆ¤å®š
    if (-not (Test-IsPSCustomObject $Object1)) {
        Write-Warning 'å¼•æ•°ã®ã€ŒObject1ã€ãŒPSCustomObjectã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚'
        return $false
    }
    elseif (-not (Test-IsPSCustomObject $Object2)) {
        Write-Warning 'å¼•æ•°ã®ã€ŒObject2ã€ãŒPSCustomObjectã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚'
        return $false
    }

    # é …ç›®åã‚’æ¯”è¼ƒ
    $object1ColumnData = $Object1[0].psobject.properties | ForEach-Object { $_.Name }
    $object2ColumnData = $Object2[0].psobject.properties | ForEach-Object { $_.Name }
    $compareResult = (Compare-Object $object1ColumnData $object2ColumnData -SyncWindow 0)
    if (($null -ne $compareResult) -and ($compareResult.Count -ne 0)) {
        Write-Warning "ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒå£«ã®é …ç›®åãŒä¸€è‡´ã—ã¦ã„ã¾ã›ã‚“ã€‚"
        return $false
    }

    # ãƒ‡ãƒ¼ã‚¿ä»¶æ•°ã‚’æ¯”è¼ƒï¼ˆãƒã‚§ãƒƒã‚¯ã™ã‚‹å ´åˆã¯ã€ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆè§£é™¤ï¼‰
    # if ($Object1.Count -ne $Object2.Count) {
    #     Write-Warning "ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†…ã®ãƒ‡ãƒ¼ã‚¿ä»¶æ•°ãŒä¸€è‡´ã—ã¾ã›ã‚“ã€‚[å¼•æ•°1ã®ä»¶æ•°: $($Object1.Count), å¼•æ•°2ã®ä»¶æ•°: $($Object2.Count)]"
    #     return $false
    # }

    # æ¯”è¼ƒã—ãŸçµæœ2ã¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒä¸€è‡´
    return $true
}
```

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
https://zenn.dev/haretokidoki/articles/fb6830f9155de5
