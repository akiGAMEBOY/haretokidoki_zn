---
title: "[PowerShell]æŒ‡å®šãƒ‰ãƒ©ã‚¤ãƒ–å†…ã®å¤§ãã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ©ãƒ³ã‚­ãƒ³ã‚°å½¢å¼ã§è¡¨ç¤ºã™ã‚‹Function"
emoji: "ğŸ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["windows", "powershell"]
published: true
---

[éå»ã®è¨˜äº‹](./49dacc3516c441#èª¿æŸ»æ–¹æ³•)ã§ã‚‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã„ãƒ‡ãƒ¼ã‚¿ã‚’èª¿ã¹ã€ãã®æ–¹æ³•ã‚’è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚ä»Šå›ã¯é–¢æ•°åŒ–ï¼ˆFunctionï¼‰ã—ã¦ã¿ãŸã®ã§è¨˜äº‹ã«ã¾ã¨ã‚ã¾ã—ãŸã€‚

ãªãŠã€ã€Œ[PowerShell + ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º + å¤§ãã„](https://www.google.com/search?q=PowerShell+ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º+å¤§ãã„)ã€ãªã©ã§æ¤œç´¢ã™ã‚‹ã¨ã€ã™ã§ã«æ•°å¤šãã®è¨˜äº‹ãŒæŠ•ç¨¿ã•ã‚Œã¦ã„ã¦æ–°ãŸã«è¨˜äº‹ã‚’ä½œæˆã™ã‚‹ä¾¡å€¤ãŒè–„ã„ã‚ˆã†ã«æ„Ÿã˜ã¦ã„ã¾ã—ãŸãŒã€
ä»–ã®æ–¹ãŒå¯¾å¿œã—ã¦ã„ãªã„ä¸‹è¨˜2ç‚¹ã‚’è¡Œã£ã¦ã¿ãŸã®ã§æŠ•ç¨¿ã—ã¾ã™ã€‚

- ä¸€ç•ªå·¦å´ã«é †ä½ï¼ˆ`Rank`ï¼‰ã‚’è¡¨ç¤º
- **CmdletBinding()** ã‚’æŒ‡å®šã—ã¦ã„ã‚‹äº‹ã«ã‚ˆã‚‹æ‹¡å¼µæ€§
    ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ¸¡ã—ã§ **ã‚°ãƒªãƒƒãƒ‰ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º** ã¾ãŸã¯ **CSVå‡ºåŠ›** ãªã©ãŒå¯èƒ½ã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- Windows ãƒ¦ãƒ¼ã‚¶ãƒ¼ ã‹ã¤ PowerShellãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- ãƒ‰ãƒ©ã‚¤ãƒ–å†…ã®å¤§å®¹é‡ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸Šä½ã‚’èª¿ã¹ãŸã„æ–¹
- Functionã®çµæœã‚’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§æ¸¡ã—CSVå‡ºåŠ›ã—ãŸã„æ–¹

## ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã„ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹æ–¹æ³•

### Cãƒ‰ãƒ©ã‚¤ãƒ–ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã„ä¸Šä½10ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‡ºåŠ›ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰

```powershell:ã‚³ãƒ”ãƒ¼ç”¨
Get-ChildItem -Path "C:\" -Recurse -File -ErrorAction SilentlyContinue |
Sort-Object -Property Length -Descending |
Select-Object -First 10 -Property FullName, Length, LastWriteTime
```

```powershell:å®Ÿéš›ã«å®Ÿè¡Œã—ãŸçµæœ
PS C:\Users\Administrator> Get-ChildItem -Path "C:\" -Recurse -File -ErrorAction SilentlyContinue |
>> Sort-Object -Property Length -Descending |
>> Select-Object -First 10 -Property FullName, Length, LastWriteTime

FullName                                                                                                   Length LastWriteTime
--------                                                                                                   ------ -------------
C:\ESD\Windows\sources\install.esd                                                                     4117938608 2024/03/13 8:46:18
C:\Program Files (x86)\Adobe\Acrobat 11.0\Setup Files\{AC76BA86-1033-FFFF-7760-000000000006}\Data1.cab  638279605 2012/09/24 13:02:32
C:\ESD\Windows\sources\boot.wim                                                                         495620879 2024/03/13 8:46:08
C:\Program Files\Google\Chrome\Application\135.0.7049.115\Installer\chrome.7z                           407743101 2025/04/25 8:32:04
C:\Program Files\WSL\system.vhd                                                                         407298560 2024/08/15 0:07:58
C:\Program Files (x86)\Microsoft\EdgeCore\135.0.3179.98\msedge.dll                                      285697064 2025/04/24 16:06:26
C:\Program Files (x86)\Microsoft\EdgeWebView\Application\135.0.3179.98\msedge.dll                       285697064 2025/04/24 16:06:26
C:\Program Files (x86)\Microsoft\Edge\Application\135.0.3179.98\msedge.dll                              285697064 2025/04/24 16:06:26
C:\Program Files (x86)\Microsoft\EdgeCore\135.0.3179.85\msedge.dll                                      285679672 2025/04/17 15:59:53
C:\Program Files (x86)\Microsoft\Edge\Application\135.0.3179.85\msedge.dll                              285679672 2025/04/17 15:59:53


PS C:\Users\Administrator>
```

### æŒ‡å®šã—ãŸãƒ‰ãƒ©ã‚¤ãƒ–ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã„ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ©ãƒ³ã‚­ãƒ³ã‚°å½¢å¼ã§è¡¨ç¤ºã™ã‚‹Function

```powershell:Get-LargeFiles
function Get-LargeFiles {
    [CmdletBinding()]
    param(
        # æ¤œç´¢å¯¾è±¡ã®ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ¬ã‚¿ãƒ¼ã‚’æŒ‡å®šï¼ˆä¾‹ï¼šC, D ãªã©ä¸€æ–‡å­—ï¼‰
        [Parameter(Mandatory = $true)]
        [ValidatePattern('^[A-Za-z]$')]
        [string]$DriveLetter,

        # ä¸Šä½ä½•ä½ã¾ã§æŠ½å‡ºã™ã‚‹ã‹æŒ‡å®šï¼ˆä¾‹ï¼š50ï¼‰
        [ValidateRange(1, [int]::MaxValue)]
        [int]$TopCount = 10
    )

    $path = "${DriveLetter}:\"

    try {
        # ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒªã‚¹ãƒˆã‚’å–å¾—
        $files = Get-ChildItem -Path $path -Recurse -File -ErrorAction SilentlyContinue

        if (-not $files) {
            Write-Warning "æŒ‡å®šã—ãŸãƒ‰ãƒ©ã‚¤ãƒ– ($($path)) å†…ã«ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚"
            return
        }

        # ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã„é †ã«ä¸¦ã³æ›¿ãˆã€æŒ‡å®šé †ä½åˆ†ã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’ç”Ÿæˆ
        $result = $files |
            Sort-Object -Property Length -Descending |
            Select-Object -First $TopCount |
            ForEach-Object -Begin { $i = 1 } -Process {
                [pscustomobject]@{
                    Rank          = $i++
                    FullName      = $_.FullName
                    Size          = $_.Length
                    LastWriteTime = $_.LastWriteTime
                }
            }

        return $result
        # é †ä½ãŒä¸è¦ã§ã‚ã‚Œã°ã‚³ãƒƒãƒ
        #$result = $files |
        #    Sort-Object -Property Length -Descending |
        #    Select-Object -First $TopCount -Property FullName, Length, LastWriteTime
        #
        #return $result
    }
    catch {
         Write-Error "ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ: $($_.Exception.GetType().Name) - $($_.Exception.Message)"
    }
}
```

ãŠãã‚‰ãWindows PowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’åˆæœŸçŠ¶æ…‹ã§ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨çµ¶å¯¾ãƒ‘ã‚¹ãŒé•·ã„ãƒ‡ãƒ¼ã‚¿ãŒãƒ’ãƒƒãƒˆã—ã€
ä¸‹è¨˜ã®ã‚ˆã†ã«å³å´ã®é …ç›®ã€Œãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã€ã‚„ã€Œæœ€çµ‚æ›´æ–°æ—¥æ™‚ã€ãŒè¦‹åˆ‡ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/e9908d2f70f2-20250501.png)

ã“ã®ã‚ˆã†ãªå ´åˆã¯ã€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚ºã‚’ **æ¨ªæ–¹å‘ã«åºƒã’ã¦** Functionã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ã™ã¹ã¦è¡¨ç¤ºå¯èƒ½ã€‚

![](https://storage.googleapis.com/zenn-user-upload/6d2c4c22784b-20250501.png)

å‚è€ƒã¾ã§ã«ã‚ãŸã—ã®ç’°å¢ƒã§å®Ÿéš›ã«å®Ÿè¡Œã—ãŸçµæœã‚‚è¨˜è¼‰ã—ã¦ãŠãã¾ã™ã€‚

```powershell:å®Ÿéš›ã«å®Ÿè¡Œã—ãŸçµæœ
PS C:\Users\Administrator> Get-LargeFiles -DriveLetter C

Rank FullName                                                                                                     Size LastWriteTime
---- --------                                                                                                     ---- -------------
   1 C:\ESD\Windows\sources\install.esd                                                                     4117938608 2024/03/13 8:46:18
   2 C:\Program Files (x86)\Adobe\Acrobat 11.0\Setup Files\{AC76BA86-1033-FFFF-7760-000000000006}\Data1.cab  638279605 2012/09/24 13:02:32
   3 C:\ESD\Windows\sources\boot.wim                                                                         495620879 2024/03/13 8:46:08
   4 C:\Program Files\Google\Chrome\Application\135.0.7049.115\Installer\chrome.7z                           407743101 2025/04/25 8:32:04
   5 C:\Program Files\WSL\system.vhd                                                                         407298560 2024/08/15 0:07:58
   6 C:\Program Files (x86)\Microsoft\Edge\Application\135.0.3179.98\msedge.dll                              285697064 2025/04/24 16:06:26
   7 C:\Program Files (x86)\Microsoft\EdgeCore\135.0.3179.98\msedge.dll                                      285697064 2025/04/24 16:06:26
   8 C:\Program Files (x86)\Microsoft\EdgeWebView\Application\135.0.3179.98\msedge.dll                       285697064 2025/04/24 16:06:26
   9 C:\Program Files (x86)\Microsoft\Edge\Application\135.0.3179.85\msedge.dll                              285679672 2025/04/17 15:59:53
  10 C:\Program Files (x86)\Microsoft\EdgeWebView\Application\135.0.3179.85\msedge.dll                       285679672 2025/04/17 15:59:53


PS C:\Users\Administrator>
```

### ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§æ¸¡ã—ã¦ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆæ–¹æ³•ã‚’å¤‰æ›´

ã“ã“ã‹ã‚‰ã¯å‰è¿°ã—ãŸã€Œ**CmdletBinding()** ã‚’æŒ‡å®šã—ã¦ã„ã‚‹äº‹ã«ã‚ˆã‚‹æ‹¡å¼µæ€§ã€ã«é–¢ã™ã‚‹å†…å®¹ã§ã™ã€‚
å‚è€ƒã¾ã§ã« ã‚°ãƒªãƒƒãƒ‰ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º ã¨ CSVå‡ºåŠ› ã—ãŸå ´åˆã®çµæœã‚’ç´¹ä»‹ã€‚

#### ã‚°ãƒªãƒƒãƒ‰ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºï¼ˆOut-GridViewï¼‰ã™ã‚‹å ´åˆ

ä»Šå›ä½œæˆã—ãŸ `Get-LargeFiles` ã®çµæœã‚’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ `Out-GridView` ã«æ¸¡ã™ã¨

```powershell:ã‚°ãƒªãƒƒãƒ‰ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºã™ã‚‹å ´åˆ
PS C:\Users\XXXX> Get-LargeFiles -DriveLetter C -TopCount 20 | Out-GridView
```

![](https://storage.googleapis.com/zenn-user-upload/d3b78c4b9be6-20250501.png)

#### CSVå‡ºåŠ›ï¼ˆExport-Csvï¼‰ã™ã‚‹å ´åˆ

ã“ã¡ã‚‰ã¯ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ `Export-Csv` ã«æ¸¡ã—ãŸçµæœã€‚

```powershell:CSVå‡ºåŠ›ã™ã‚‹å ´åˆ
PS C:\Users\XXXX> Get-LargeFiles -DriveLetter C -TopCount 50 | Export-Csv D:\Downloads\get-largefiles.csv -NoTypeInformation
PS C:\Users\XXXX>
```

â€» `Export-Csv` ã§æŒ‡å®šã—ã¦ã„ã‚‹ `-NoTypeInformation` ã¯ã€CSVãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­ã«è¨˜éŒ²ã•ã‚Œã‚‹ `#TYPE Selected.System.IO.FileInfo` ã‚’æ¶ˆã™ãŸã‚ã€‚

```csv:å‡ºåŠ›ã—ãŸã€Œget-largefiles.csvã€ã®ä¸­èº«
"Rank","FullName","Size","LastWriteTime"
"1","C:\ESD\Windows\sources\install.esd","4117938608","2024/03/13 8:46:18"
"2","C:\Program Files (x86)\Adobe\Acrobat 11.0\Setup Files\{AC76BA86-1033-FFFF-7760-000000000006}\Data1.cab","638279605","2012/09/24 13:02:32"
"3","C:\ESD\Windows\sources\boot.wim","495620879","2024/03/13 8:46:08"
"4","C:\Program Files\Google\Chrome\Application\135.0.7049.115\Installer\chrome.7z","407743101","2025/04/25 8:32:04"
"5","C:\Program Files\WSL\system.vhd","407298560","2024/08/15 0:07:58"
"6","C:\Program Files (x86)\Microsoft\Edge\Application\135.0.3179.98\msedge.dll","285697064","2025/04/24 16:06:26"
"7","C:\Program Files (x86)\Microsoft\EdgeCore\135.0.3179.98\msedge.dll","285697064","2025/04/24 16:06:26"
"8","C:\Program Files (x86)\Microsoft\EdgeWebView\Application\135.0.3179.98\msedge.dll","285697064","2025/04/24 16:06:26"
"9","C:\Program Files (x86)\Microsoft\Edge\Application\135.0.3179.85\msedge.dll","285679672","2025/04/17 15:59:53"
"10","C:\Program Files (x86)\Microsoft\EdgeWebView\Application\135.0.3179.85\msedge.dll","285679672","2025/04/17 15:59:53"
"11","C:\Program Files (x86)\Microsoft\EdgeCore\135.0.3179.85\msedge.dll","285679672","2025/04/17 15:59:53"
"12","C:\Program Files\Google\Chrome\Application\135.0.7049.115\chrome.dll","248386656","2025/04/22 11:12:24"
"13","C:\Windows\System32\MRT.exe","209365816","2025/03/01 8:52:30"
"14","C:\Program Files (x86)\Common Files\Adobe\AdobeGCClient\libcef.dll","165081056","2023/11/07 14:47:12"
"15","C:\Apps\334CH\SupportAssistx64.msp","149450752","2019/04/02 5:11:06"
"16","C:\Program Files\ESET\ESET Endpoint Antivirus\em002_64\65295\em002_64.dll.raw","134173552","2025/05/01 8:20:14"
"17","C:\Program Files\ESET\ESET Endpoint Antivirus\em002_64\65295\em002_64.dll","134173552","2025/05/01 8:20:16"
"18","C:\Program Files\ESET\ESET Endpoint Antivirus\em002_64\65237\em002_64.dll.raw","133995888","2025/04/25 14:56:09"
"19","C:\Program Files\ESET\ESET Endpoint Antivirus\em002_64\65237\em002_64.dll","133995888","2025/04/25 14:56:13"
"20","C:\Program Files (x86)\Adobe\Acrobat Reader DC\Reader\acrocef_1\libcef.dll","122600160","2021/09/09 14:16:48"
"21","C:\Windows\WinSxS\amd64_microsoft-windows-edgechromium_31bf3856ad364e35_10.0.19041.3636_none_7437336f112dbb3d\Edge.wim","115133979","2023/12/04 11:39:37"
"22","C:\Windows\servicing\LCU\Package_for_RollupFix~31bf3856ad364e35~amd64~~19041.5737.1.12\amd64_microsoft-windows-edgechromium_31bf3856ad364e35_10.0.19041.3636_none_7437336f112dbb3d\edge.wim","115133979","2025/04/07 6:45:10"
"23","C:\Windows\System32\wbem\WMIObjectsMigration.bin","84118589","2024/03/13 9:53:16"
"24","C:\Windows\assembly\NativeImages_v4.0.30319_64\Microsoft.C8fd77a78#\30e39924b985261e364337ddad1afdd2\Microsoft.CodeAnalysis.Workspaces.ni.dll","84044288","2025/04/25 12:59:23"
"25","C:\Windows\System32\DriverStore\FileRepository\iigd_dch.inf_amd64_959d3d8d8ef6604f\opencl-clang64.dll","83604792","2024/09/27 2:36:08"
"26","C:\Windows\assembly\NativeImages_v4.0.30319_64\FSharp.Comp0c9a8de5#\3d86807f32d99e4b2e610b5a8a3816dd\FSharp.Compiler.Service.ni.dll","82005504","2025/04/25 13:05:45"
"27","C:\Windows\assembly\NativeImages_v4.0.30319_64\FSharp.Comp0c9a8de5#\875eb45dfec9d49b5ca2c7b7db499e1b\FSharp.Compiler.Service.ni.dll","82004992","2025/04/25 13:06:48"
"28","C:\Program Files\ESET\ESET Endpoint Antivirus\em023_64\40431\em023_64.dll.raw","81957232","2025/05/01 8:20:18"
"29","C:\Program Files\ESET\ESET Endpoint Antivirus\em023_64\40431\em023_64.dll","81957232","2025/05/01 8:20:20"
"30","C:\Program Files\ESET\ESET Endpoint Antivirus\em023_64\40371\em023_64.dll.raw","81669488","2025/04/25 14:56:03"
"31","C:\Program Files\ESET\ESET Endpoint Antivirus\em023_64\40371\em023_64.dll","81669488","2025/04/25 14:56:05"
"32","C:\Windows\System32\DriverStore\FileRepository\iigd_dch.inf_amd64_959d3d8d8ef6604f\libopencl-clang.so.9","81366600","2024/09/27 2:35:58"
"33","C:\Program Files\PowerToys\WinUI3Apps\CmdPal\Microsoft.CmdPal.UI_0.1.0.0_x64.msix","79740524","2025/03/27 3:15:42"
"34","C:\Windows\assembly\NativeImages_v4.0.30319_64\Microsoft.Cdce0ec49#\7404a8bbd673f8e478b246e72d3fa430\Microsoft.CodeAnalysis.Features.ni.dll","79571968","2025/04/25 12:57:57"
"35","C:\Windows\SoftwareDistribution\Download\bfad7b9721d1bada366b79508f32b67e\Windows10.0-KB5056578-x64-NDP481.cab","79095105","2025/04/23 8:32:36"
"36","C:\Windows\assembly\NativeImages_v4.0.30319_64\Microsoft.C1d3c2215#\8b043eb53c9858bdb51bf1619831f8d7\Microsoft.CodeAnalysis.CSharp.ni.dll","78353408","2025/04/25 12:55:39"
"37","C:\Windows\assembly\NativeImages_v4.0.30319_64\Microsoft.C1d3c2215#\aba8a4adaddf0ded283e45d6adae06af\Microsoft.CodeAnalysis.CSharp.ni.dll","78353408","2025/04/30 12:45:56"
"38","C:\Program Files\Microsoft Office\root\vfs\ProgramFilesX64\Microsoft Analysis Services\AS OLEDB\140\msmdlocal.dll","74061776","2023/07/28 14:06:34"
"39","C:\Program Files\Microsoft Office\root\vfs\ProgramFilesCommonX64\Microsoft Shared\OFFICE16\MSORES.DLL","73690184","2025/04/16 12:05:36"
"40","C:\Program Files\Microsoft Office\root\vfs\ProgramFilesCommonX86\Microsoft Shared\OFFICE16\MSORES.DLL","73689680","2025/04/16 12:06:43"
"41","C:\ESD\Windows\sources\sxs\microsoft-windows-netfx3-ondemand-package~31bf3856ad364e35~amd64~~.cab","72783629","2023/12/04 12:51:20"
"42","C:\Program Files\Intel\Intel(R) Arc Software & Drivers\Uninstaller.exe","72715808","2024/08/13 5:56:28"
"43","C:\Windows\System32\catroot2\{F750E6C3-38EE-11D1-85E5-00C04FC295EE}\catdb","72351744","2025/04/30 15:30:25"
"44","C:\Program Files\Microsoft Office\root\Office16\ADDINS\Microsoft Power Query for Excel Integrated\bin\Microsoft.Mashup.Client.Excel.Themes.dll","71823392","2024/04/17 9:55:41"
"45","C:\Windows\assembly\NativeImages_v4.0.30319_64\Microsoft.Cbf18da00#\76cc1fed8bd2fac9165c0b0992c77a4f\Microsoft.CodeAnalysis.ni.dll","69023744","2025/04/30 12:47:08"
"46","C:\Windows\assembly\NativeImages_v4.0.30319_64\Microsoft.Cbf18da00#\942228027bbe2a539842339ee090b1ed\Microsoft.CodeAnalysis.ni.dll","69023744","2025/04/25 13:04:27"
"47","C:\Windows\assembly\NativeImages_v4.0.30319_64\Microsoft.Cbf18da00#\87786509dcecfb469d3bd05d66e8d27b\Microsoft.CodeAnalysis.ni.dll","69023744","2025/04/25 12:56:48"
"48","C:\Windows\Logs\CBS\CbsPersist_20250430062551.log","66949104","2025/04/30 15:22:09"
"49","C:\Windows\assembly\NativeImages_v4.0.30319_32\Microsoft.C8fd77a78#\39c67bf843b77d3606e70f8e5e4fdb75\Microsoft.CodeAnalysis.Workspaces.ni.dll","65908224","2025/04/25 12:49:07"
"50","C:\Windows\assembly\NativeImages_v4.0.30319_32\FSharp.Comp0c9a8de5#\6fbd82fe6a5885f6d662d1ee4b48f254\FSharp.Compiler.Service.ni.dll","65680384","2025/04/25 12:51:49"

```

`Export-Csv` ã¯ã€ä»–ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã®æŒ‡å®šãªã©ã‚‚å¯èƒ½ã€‚è©³ç´°ã¯[ã“ã¡ã‚‰](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/export-csv)ã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã”ç¢ºèªãã ã•ã„ã€‚

## ã¾ã¨ã‚

- Windowsã§å¤§å®¹é‡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª¿ã¹ã‚‹æ–¹æ³•
    1. `Get-ChildItem` ã§ãƒ‰ãƒ©ã‚¤ãƒ–å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢
    1. `Sort-Object` ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’å¤§ãã„é †ï¼ˆé™é †ï¼‰ã§ã‚½ãƒ¼ãƒˆ
    1. `Select-Object -First "æ•°å€¤"` ã§ä¸Šä½ä»¶æ•°ã®ã¿è¡¨ç¤º
- ä»Šå›ä½œæˆã—ãŸFunctionã€Œ`Get-LargeFiles`ã€ã§ã¯ä¸‹è¨˜2ç‚¹ã®æ©Ÿèƒ½ã‚’å®Ÿè£…
    - ä¸€ç•ªå·¦å´ã®é …ç›®ã«é †ä½ï¼ˆ`Rank`ï¼‰ã‚’è¿½åŠ 
    - `[CmdletBinding()]` ã«ã‚ˆã‚Šãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ¸¡ã—ã§å¤–éƒ¨æ©Ÿèƒ½ã«é€£æºå¯èƒ½
        ã‚°ãƒªãƒƒãƒ‰ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºï¼ˆ`Out-GridView`ï¼‰ã‚„ CSVå‡ºåŠ›ï¼ˆ`Export-Csv`ï¼‰ãŒå¯èƒ½ã€‚

ã‚„ã¯ã‚Šã€**CmdletBinding()** ã¯ä¾¿åˆ©ã§ã™ã­ã€‚

## é–¢é€£è¨˜äº‹

https://zenn.dev/haretokidoki/articles/49dacc3516c441
https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
https://zenn.dev/haretokidoki/articles/fb6830f9155de5
