---
title: "Microsoft Storeをコマンドでアップデートする方法"
emoji: "🗂"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---
## 概要

Windows UpdateやMicrosoft Storeの両方で自動更新可能だが自動アップデートを設定してしまうと、
仮にトラブルが発生した場合に何を契機に発生したのか切り分けが難しくなってしまう。

その為、手動でアップデートを実施しているが、Windows Update（設定画面内） と Microsoft Store の2つをアップデートする必要があり面倒。

自動化して一括で2つともアップデートできると作業効率化が図れる為、調べた。

## 前提知識

### Windows Updateとは

<https://ja.wikipedia.org/wiki/Microsoft_Update>

#### Microsoft Defender

https://www.vwnet.jp/windows/PowerShell/FullAutoWU.htm
これによるとMicrosoft Defenderのアップデートは手動実行する必要があるとの事。

### MSI と MSIX

https://atmarkit.itmedia.co.jp/ait/articles/2206/14/news008.html

### インストーラー形式・exeファイル形式

インストーラー版とは、ファイルの拡張子が「*.msi」でウィザード形式で処理を進めてインストールする形式。
exeファイル版とは、exeファイルを所定の場所に配置しその実行ファイルを直接起動し動作する形式。

アップデートの有無は、そのソフトウェアの仕様により異なる。
アップデート機能があるソフトウェアの例としては、起動直後にダイアログで“最新版がある旨の通知”があり、
操作すると最新のインストーラー、または実行ファイルをダウンロードする形式のソフトウェアがある。

### ストアアプリ形式（UWPアプリ）とは

[Microsoft Store](https://ja.wikipedia.org/wiki/Microsoft_Store)で配信されるソフトウェア。

[ユニバーサルWindowsプラットフォーム](https://ja.wikipedia.org/wiki/ユニバーサルWindowsプラットフォーム)のアプリ（ソフトウェア）が配信されている環境。

統合されたプラットフォームで開発されたアプリが配信されている為、使用するデバイスなど環境依存で発生する問題が回避しやすいというメリットがある。
デメリットとしては今まで提供されていたソフトウェアをUWPアプリのプラットフォームで再開発（リプラットフォーム）する場合にコストがかかってしまう点がある。

https://learn.microsoft.com/ja-jp/windows/package-manager/winget/upgrade
https://atmarkit.itmedia.co.jp/ait/articles/2106/11/news021.html

## 自動化

### Windows Update

#### 公開されている自動化スクリプト

https://www.vwnet.jp/windows/PowerShell/FullAutoWU.htm
https://github.com/MuraAtVwnet/WindowsUpdate

#### C:\Windows\system32\UsoClient.exe

PowerShellとコマンドプロンプトで実行してみたが、正常に機能しなかった。
「UsoClient /?」などなく「UsoClient StartScan」を実行しても何も返ってこない状態。
→ 機能しているのかもしれない。ネット記事だと実行結果の返りがなさそう。
　 <https://jp.minitool.com/backup-tips/windows-update-command-line.html#コマンドプロンプトからWindows%20Updateを実行>

#### 公開モジュール「PSWindowsUpdate」を導入する方法

https://note.com/mahalo_/n/n9df78a3a2afc
https://qiita.com/NoTASK/items/8ba63aea7f037599b4f5
https://boonx4m312s.hatenablog.com/entry/2023/02/02/180000

#### 廃止済みのモジュール「WindowsUpdateProvider」

https://4thsight.xyz/3865

## Windows パッケージ マネージャー - upgrade コマンド（winget）

<https://answers.microsoft.com/ja-jp/windows/forum/all/akamsにつきまし/cc2b5536-8cac-4346-ab8d-658a669b8872>

アップデート対象となるソフトウェア側で制御がない場合、サポート対象外となったデバイスに対しても
ソフトウェアの更新がかかる事がある。

:::details 互換性がないのにアップデートが実行された「Dell Display Managerアプリケーション」

「Dell E2218HN」だったがアップデートが1.xから2.xになり使用できなくなった。

> ✅ 公式サイトから互換性のあるシステムを抜粋
> 
> Alienware 25 Gaming Monitor AW2521HF
> Alienware 25 Gaming Monitor AW2521HFA
> Alienware 25 Gaming Monitor AW2521HFL
> Alienware 25 Gaming Monitor AW2521HFLA
> Alienware 25 Gaming Monitor AW2523HF
> Alienware 27 Gaming Monitor AW2720HF
> Alienware 27 Gaming Monitor AW2720HFA
> Alienware 27 Gaming Monitor AW2723DF
> Alienware 27 Gaming Monitor AW2724DM
> Alienware 27 Gaming Monitor AW2724HF
> Alienware 34 Curved QD OLED Gaming Monitor AW3423DWF
> Alienware 500Hz Gaming Monitor AW2524HF
> Alienware 55 OLED Monitor AW5520QF
> Dell 24 Curved Gaming Monitor S2422HG
> Dell 24 Gaming Monitor G2422HS
> Dell 24 Video Conferencing Monitor I C2422HE
> Dell 25 Gaming Monitor G2524H
> Dell 25 Gaming Monitor S2522HG
> Dell 27 Curved Gaming Monitor S2722DGM
> Dell 27 Gaming Monitor G2722HS
> Dell 27 Gaming Monitor G2723H
> Dell 27 Gaming Monitor G2723HN
> Dell 27 Gaming Monitor G2724D
> Dell 27 Gaming Monitor S2721DGF
> Dell 27 Video Conferencing Monitor I C2722DE
> Dell 32 4K UHD Gaming Monitor G3223Q
> Dell 32 Curved Gaming Monitor S3222DGM
> Dell 32 Curved Gaming Monitor S3222HG
> Dell 32 Gaming Monitor G3223D
> Dell 34 Curved Gaming Monitor S3422DWG
> Dell 34 Video Conferencing Curved Monitor I C3422WE
> Dell C2423H
> Dell C2723H Monitor
> Dell C5519Q
> Dell C5519QA
> Dell C5522QT
> Dell C6522QT
> Dell C7520QT
> Dell C8621QT
> Dell Display and Peripheral Manager
> Dell Display Manager 2.x
> Dell E1715S
> Dell E1916HV
> Dell E1920H
> Dell E2016HV
> Dell E2020H
> Dell E2219HN
> Dell E2220H
> Dell E2221HN
> Dell E2222H
> Dell E2222HS
> Dell E2223HN
> Dell E2223HV
> Dell E2420H
> Dell E2420HS
> Dell E2421HN
> Dell E2422H
> Dell E2422HN
> Dell E2422HS
> Dell E2423H
> Dell E2423HN
> Dell E2424HS
> Dell E2720H
> Dell E2720HS
> Dell E2722H
> Dell E2722HS
> Dell E2723H
> Dell E2723HN
> Dell E2724HS
> Dell Gaming S2421HGF
> Dell Gaming S2721HGF
> Dell Gaming S2721HGFA
> Dell P1424H
> Dell P1917S
> Dell P2219H
> Dell P2219HC
> Dell P2222H
> Dell P2223HC
> Dell P2319H
> Dell P2418HT
> Dell P2419H
> Dell P2419HC
> Dell P2421
> Dell P2421D
> Dell P2421DC
> Dell P2422H
> Dell P2422HA
> Dell P2422HE
> Dell P2423
> Dell P2423D
> Dell P2423DE
> Dell P2424HEB
> Dell P2424HT
> Dell P2719H
> Dell P2719HC
> Dell P2720D
> Dell P2720DC
> Dell P2721Q
> Dell P2722H
> Dell P2722HE
> Dell P2723D
> Dell P2723DE
> Dell P2723QE
> Dell P2724DEB
> Dell P3221D
> Dell P3222QE
> Dell P3223DE
> Dell P3223QE
> Dell P3421W
> Dell P3424WE
> Dell P3424WEB
> Dell P5524Q
> Dell P5524QT
> Dell P6524QT
> Dell P7524QT
> Dell P8624QT
> Dell S2319H
> Dell S2319HN
> Dell S2319HS
> Dell S2319NX
> Dell S2419H
> Dell S2419HGF
> Dell S2419HM
> Dell S2419HN
> Dell S2419NX
> Dell S2421H
> Dell S2421HN
> Dell S2421HS
> Dell S2421HSX
> Dell S2421NX
> Dell S2422HZ
> Dell S2719DC
> Dell S2719DGF
> Dell S2719DM
> Dell S2719H
> Dell S2719HN
> Dell S2719HS
> Dell S2719NX
> Dell S2721D
> Dell S2721DGFA
> Dell S2721DS
> Dell S2721H
> Dell S2721HN
> Dell S2721HS
> Dell S2721HSX
> Dell S2721NX
> Dell S2721Q
> Dell S2721QS
> Dell S2721QSA
> Dell S2722DC
> Dell S2722DZ
> Dell S2722QC
> Dell S2723HC
> Dell S3219D
> Dell S3220DGF
> Dell S3221QS
> Dell S3221QSA
> Dell S3222HN
> Dell S3222HS
> Dell S3422DW
> Dell S3423DWC
> Dell SE2219H/SE2219HX
> Dell SE2222H
> Dell SE2222HV
> Dell SE2419H/SE2419HX
> Dell SE2419HR
> Dell SE2422H
> DELL SE2422HM
> Dell SE2422HR
> Dell SE2422HX
> Dell SE2423DS
> Dell SE2719H
> Dell SE2719HR
> Dell SE2722H
> Dell SE2722HR
> Dell SE2722HX
> Dell SE2723DS
> Dell SE3223Q
> Dell U2419H
> Dell U2419HC
> Dell U2419HS
> Dell U2421E
> Dell U2421HE
> Dell U2422H
> Dell U2422HE
> Dell U2422HX
> Dell U2424H
> Dell U2424HE
> Dell U2520D
> Dell U2520DR
> Dell U2719D
> Dell U2719DC
> Dell U2719DS
> Dell U2720Q
> Dell U2720QM
> Dell U2721DE
> Dell U2722D
> Dell U2722DE
> Dell U2722DX
> Dell U2723QE
> Dell U2723QX
> Dell U2724D
> Dell U2724DE
> Dell U3023E
> Dell U3219Q
> Dell U3223QE
> Dell U3223QZ
> Dell U3224KB
> Dell U3224KBA
> Dell U3419W
> Dell U3421WE
> Dell U3423WE
> Dell U3821DW
> Dell U3824DW
> Dell U4021QW
> Dell U4320Q
> Dell U4323QE
> Dell U4919DW
> Dell U4924DW
> Dell UP2720Q
> Dell UP2720QA
> Dell UP3218K
> Dell UP3218KA
> Dell UP3221Q
> 
> 引用元：[Dell Display Managerアプリケーション → 詳細情報 → 互換性のあるシステム](https://www.dell.com/support/home/ja-jp/drivers/driversdetails?driverid=yc3cv&oscode=wt64a&productcode=dell-display-manager-2.0)

:::
