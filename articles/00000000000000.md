---
title: "Scrap Memo"
emoji: "📝"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["memo"]
published: false
---
PowerShellで環境変数を確認／設定する方法
	https://zaki-hmkc.hatenablog.com/entry/2020/04/13/124930

Dockerで発生した問題・調べたこと
## 発生した問題
### ▼Dockerのデータファイル「ext4.vhdx」の肥大化でCドライブ枯渇
https://zenn.dev/haretokidoki/articles/49dacc3516c441
## 調べたこと
### ▼Dockerのデータファイル「ext4.vhdx」の最適化
- Win10 Pro/Enterprise
    https://www.curict.com/item/f4/f46da60.html
    https://qiita.com/sarisia/items/5c53c078ab30eb26bc3b
- Win10 Home
    https://qiita.com/siruku6/items/c91a40d460095013540d
### ▼Dockerのデータファイル「ext4.vhdx」の格納先（保存先）変更
https://qiita.com/__fu__/items/7c533911fc64006f64a0
https://zenn.dev/ijiwarunahello/articles/498acbe0d28f8b
### ▼Docker Desktop for Windowsのクリーンインストール
1. スタートメニュー -> 設定 -> アプリで、Docker Desktopを選択しアンインストール。
2. 残存しているデータを手動で削除（ただ再インストールしたい場合は不要）
    - C:\Users\XXXX\AppData\Local\Docker
        フォルダ内にデータあり。私の環境では約131MB
	- C:\Users\XXXX\AppData\Local\Temp\DockerDesktop
        フォルダ内にデータなし。空フォルダ
	- C:\ProgramData\DockerDesktop
        フォルダ内にデータあり。私の環境では約5KB
	- C:\Users\XXXX\.docker
        フォルダ内にデータあり。私の環境では約11.6MB
	- C:\Users\XXXX\AppData\Roaming\Docker
        フォルダ内にデータあり。私の環境では約11KB
	- C:\Users\XXXX\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\docker-desktop-data
        フォルダ内にデータなし。空フォルダ
3. Docker Desktop for Windowsのインストール
    - 公式：Install Docker Desktop on Windows
        https://docs.docker.com/desktop/install/windows-install/
    - 公式：ダウンロードリンク
	    https://desktop.docker.com/win/main/amd64/Docker%20Desktop%20Installer.exe
	
### ▼Docker Desktop + WSL2 メモリ使用率を制限する方法
#### 対応方法
    1. コンフィグファイルの作成
        C:\Users\`ユーザ名`の配下に`.wslconfig`を作成する。
        （ネットの記事だと`C:\Users\`ユーザ名\.wslconfig`にファイルがある前提で記載があったが、
        　私の環境では`.wslconfig`が存在しなかった為、手動で作成）
    2. コンフィグファイルに追記
        ```:`.wslconfig`ファイル
        [wsl2]
        memory=6GB # Limits VM memory in WSL 2 to 6 GB
        processors=2 # Makes the WSL 2 VM use two virtual processors
        swap=0
        ```
#### 参考記事
https://zenn.dev/takajun/articles/4f15d115548899
https://dojo.docker.jp/t/topic/52/2

OS関連のコマンド
### ▼サイズの大きいファイルを調べるコマンド
https://orebibou.com/ja/home/201501/20150113_001/
### ▼プロパティを表示のショートカット
ファイルもしくはフォルダを選択中にAlt + Enterを入力するとプロパティが表示
### ▼名前を指定して実行 で利用できるコマンド一覧
https://www.projectgroup.info/tips/Windows/comm_0006.html
### ▼回避方法：ExcelのハイパーリンクでアクセスするとCAPTCHA認証が表示される場合
とあるECサイトのリンクをExcelのセルにメモしていたが、
Excelのハイパーリンクからサイトにアクセスすると人間かの認証「CAPTCHA認証（hCaptcha）」が表示されてしまう。
認証を回避方法を見つけた。
#### Google検索ページのリンクをExcelに貼り付ける回避方法
直接、ECサイトのリンクを貼ってアクセスするとCAPTCHA認証が表示されてしまう為、
Google検索のフィルタ機能で対象ECサイト内でキーワード検索し、そのリンクをExcelに貼り付ける。
Excelからリンクにアクセスし到達するまで、Excel -> Google検索ページ -> 該当ページと
段階を踏む必要があるが、簡単に回避できる方法。
- Google検索ページのリンク
    https://www.google.com/search?q=site%3Ahttps%3A%2F%2Faxel.as-1.co.jp+NCGK072948
    https://www.google.com/search?q=site%3Ahttps%3A%2F%2Famazon.co.jp+hobby
#### VBAで独自関数を作成しサイトにアクセスする回避方法
独自関数の中身は、コマンドプロンプトのSTARTコマンドを実行している。
- Excelでの使用方法
    ```vbnet:Excelシート上での関数を使用する方法
    =SubJumpUrl(`対象のURLを記載`)
    ```
	```vbnet:独自関数の中身
	Sub SubJumpUrl(strUrl As String)
	    Dim lngResult As Long
	    Dim strCommand As String
	    Dim objWsh As Object
	    
	    ' 実行するコマンドを指定
	    strCommand = "start " & strUrl
	    
	    ' コマンドプロンプトで指定コマンドを実行
	    Set objWsh = CreateObject("WScript.Shell")
	    lngResult = objWsh.Run(Command:="%ComSpec% /c " & strCommand, WindowStyle:=0, WaitOnReturn:=True)
	    
	    ' DEBUG用
	    If lngResult = 0 Then
	        Debug.Print ("Success")
	    Else
	        Debug.Print ("Failure")
	    End If
	End Sub
	```
##### 参考記事
https://excel-vba.work/2020/10/30/【vba】windowsのコマンドを実行する/