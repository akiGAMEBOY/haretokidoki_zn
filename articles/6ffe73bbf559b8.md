---
title: "[PowerShell]PSCustomObjectを自身で作成し宣言する方法"
emoji: "🌟"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["powershell"]
published: false
---

PowerShellで`PSCustomObject`を自身で作成し、宣言する方法は、ハッシュテーブルを使用して行います。以下にその基本的な手順を示します。

まず、プロパティと値を持つハッシュテーブルを作成します。

```powershell
$properties = @{
    Name = 'John Doe'
    Age = 30
    Job = 'Engineer'
}
```

次に、このハッシュテーブルを`PSCustomObject`にキャストして、カスタムオブジェクトを作成します。

```powershell
$customObject = [PSCustomObject]$properties
```

これで、`$customObject`は`PSCustomObject`型のオブジェクトになり、指定したプロパティにアクセスできるようになります。

```powershell
$customObject.Name  # John Doe
$customObject.Age   # 30
$customObject.Job   # Engineer
```

この方法は、PowerShell 3.0以降で利用可能です。プロパティの順序を維持したい場合は、`[ordered]`を使用して順序付きハッシュテーブルを作成することが推奨されます。

また、`Add-Member`コマンドレットを使用して、既存の`PSCustomObject`に新しいプロパティを動的に追加することもできます。

```powershell
$customObject | Add-Member -MemberType NoteProperty -Name 'Department' -Value 'Research and Development'
```

これにより、`Department`という新しいプロパティが`$customObject`に追加されます¹。この方法を使用すると、オブジェクトを作成した後でもプロパティを柔軟に追加できるため、動的なデータ構造を扱う際に便利です。さらに詳しい情報や高度な使用方法については、Microsoftの公式ドキュメントを参照してください。
