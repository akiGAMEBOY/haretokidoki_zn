---
title: "[PowerShell]PSCustomObjectã‚’è‡ªèº«ã§ä½œæˆã—å®£è¨€ã™ã‚‹æ–¹æ³•"
emoji: "ðŸŒŸ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

PowerShellã§`PSCustomObject`ã‚’è‡ªèº«ã§ä½œæˆã—ã€å®£è¨€ã™ã‚‹æ–¹æ³•ã¯ã€ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½¿ç”¨ã—ã¦è¡Œã„ã¾ã™ã€‚ä»¥ä¸‹ã«ãã®åŸºæœ¬çš„ãªæ‰‹é †ã‚’ç¤ºã—ã¾ã™ã€‚

ã¾ãšã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨å€¤ã‚’æŒã¤ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

```powershell
$properties = @{
    Name = 'John Doe'
    Age = 30
    Job = 'Engineer'
}
```

æ¬¡ã«ã€ã“ã®ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’`PSCustomObject`ã«ã‚­ãƒ£ã‚¹ãƒˆã—ã¦ã€ã‚«ã‚¹ã‚¿ãƒ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

```powershell
$customObject = [PSCustomObject]$properties
```

ã“ã‚Œã§ã€`$customObject`ã¯`PSCustomObject`åž‹ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ãªã‚Šã€æŒ‡å®šã—ãŸãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```powershell
$customObject.Name  # John Doe
$customObject.Age   # 30
$customObject.Job   # Engineer
```

ã“ã®æ–¹æ³•ã¯ã€PowerShell 3.0ä»¥é™ã§åˆ©ç”¨å¯èƒ½ã§ã™ã€‚ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®é †åºã‚’ç¶­æŒã—ãŸã„å ´åˆã¯ã€`[ordered]`ã‚’ä½¿ç”¨ã—ã¦é †åºä»˜ããƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒæŽ¨å¥¨ã•ã‚Œã¾ã™ã€‚

ã¾ãŸã€`Add-Member`ã‚³ãƒžãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ã€æ—¢å­˜ã®`PSCustomObject`ã«æ–°ã—ã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å‹•çš„ã«è¿½åŠ ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

```powershell
$customObject | Add-Member -MemberType NoteProperty -Name 'Department' -Value 'Research and Development'
```

ã“ã‚Œã«ã‚ˆã‚Šã€`Department`ã¨ã„ã†æ–°ã—ã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒ`$customObject`ã«è¿½åŠ ã•ã‚Œã¾ã™Â¹ã€‚ã“ã®æ–¹æ³•ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ãŸå¾Œã§ã‚‚ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŸ”è»Ÿã«è¿½åŠ ã§ãã‚‹ãŸã‚ã€å‹•çš„ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’æ‰±ã†éš›ã«ä¾¿åˆ©ã§ã™ã€‚ã•ã‚‰ã«è©³ã—ã„æƒ…å ±ã‚„é«˜åº¦ãªä½¿ç”¨æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€Microsoftã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

PowerShellã§`PSCustomObject`ã‚’ä½œæˆã™ã‚‹æ–¹æ³•ã¨ãã®è©³ç´°ãªå‰ææ¡ä»¶ã‚’å«ã‚ãŸä¸€è¦§è¡¨ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚ã™ã¹ã¦ã®èª¬æ˜Žã‚’ç®‡æ¡æ›¸ãã«ã—ã¾ã—ãŸã€‚

- **ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ç›´æŽ¥**
  - `$myObject = [PSCustomObject]@{ Name = 'Kevin'; Language = 'PowerShell'; State = 'Texas' }`
  - å‰ææ¡ä»¶:
    - ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ãŒäº‹å‰ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
    - PowerShell v3.0ä»¥é™ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™Â¹ã€‚

- **ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å¤‰æ›**
  - `$myHashtable = @{ Name = 'Kevin'; Language = 'PowerShell'; State = 'Texas' }; $myObject = [pscustomobject]$myHashtable`
  - å‰ææ¡ä»¶:
    - ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ãŒäº‹å‰ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
    - PowerShell v3.0ä»¥é™ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™Â¹ã€‚

- **`New-Object` ã‚³ãƒžãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆ**
  - `$myHashtable = @{ Name = 'Kevin'; Language = 'PowerShell'; State = 'Texas' }; $myObject = New-Object -TypeName PSObject -Property $myHashtable`
  - å‰ææ¡ä»¶:
    - `New-Object` ã‚³ãƒžãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆãŒåˆ©ç”¨å¯èƒ½ã§ã‚ã‚‹ã“ã¨ã€‚
    - PowerShellã®åˆæœŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ä½¿ç”¨ã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ãŒã€v3.0ä»¥é™ã§ã¯ä»–ã®æ–¹æ³•ãŒæŽ¨å¥¨ã•ã‚Œã¾ã™Â¹ã€‚

- **JSONãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆ**
  - `$myObject = Get-Content -Path $Path | ConvertFrom-Json`
  - å‰ææ¡ä»¶:
    - PowerShell v3.0ä»¥é™ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™Â¹ã€‚
    - JSONãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ã„å½¢å¼ã§ã‚ã‚‹ã“ã¨ã€‚
    - `Get-Content` ã‚³ãƒžãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’èª­ã¿è¾¼ã‚€å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
    - `ConvertFrom-Json` ã‚³ãƒžãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦JSONæ–‡å­—åˆ—ã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã—ã¾ã™Â¹ã€‚

- **é †åºä»˜ããƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«**
  - `$myObject = [pscustomobject][ordered]@{ Name = 'Kevin'; Language = 'PowerShell'; State = 'Texas' }`
  - å‰ææ¡ä»¶:
    - PowerShell v3.0ä»¥é™ãŒå¿…è¦ã§ã™ã€‚
    - ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®é †åºã‚’ç¶­æŒã—ãŸã„å ´åˆã«ä½¿ç”¨ã—ã¾ã™Â¹ã€‚

- **ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®æ“ä½œ**
  - `$myObject | Add-Member -MemberType NoteProperty -Name 'ID' -Value 'KevinMarquette'`
  - å‰ææ¡ä»¶:
    - `Add-Member` ã‚³ãƒžãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆãŒåˆ©ç”¨å¯èƒ½ã§ã‚ã‚‹ã“ã¨ã€‚
    - `$myObject`ãŒäº‹å‰ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã€‚
    - æ–°ã—ã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã™ã‚‹éš›ã«ä½¿ç”¨ã—ã¾ã™Â¹ã€‚

- **ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å‰Šé™¤**
  - `$myObject.psobject.properties.remove('ID')`
  - å‰ææ¡ä»¶:
    - `$myObject`ã«å‰Šé™¤ã—ãŸã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒå­˜åœ¨ã—ã¦ã„ã‚‹ã“ã¨ã€‚
    - `.psobject` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ç”¨ã—ã¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™Â¹ã€‚

- **ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã®åˆ—æŒ™**
  - `$myObject | Get-Member -MemberType NoteProperty | Select -ExpandProperty Name`
  - å‰ææ¡ä»¶:
    - `$myObject`ãŒäº‹å‰ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã€‚
    - ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã™ã¹ã¦ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã‚’å–å¾—ã™ã‚‹éš›ã«ä½¿ç”¨ã—ã¾ã™Â¹ã€‚

- **ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¸ã®å‹•çš„ãªã‚¢ã‚¯ã‚»ã‚¹**
  - `$property = 'Name'; $myObject.$property`
  - å‰ææ¡ä»¶:
    - `$myObject`ãŒäº‹å‰ã«å®šç¾©ã•ã‚Œã¦ãŠã‚Šã€ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒå­˜åœ¨ã—ã¦ã„ã‚‹ã“ã¨ã€‚
    - ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã‚’å¤‰æ•°ã¨ã—ã¦ä½¿ç”¨ã™ã‚‹éš›ã«ä½¿ç”¨ã—ã¾ã™Â¹ã€‚

ã“ã‚Œã§ã€å„æ–¹æ³•ã®å‰ææ¡ä»¶ãŒã‚ˆã‚Šè©³ç´°ã«ãªã‚Šã¾ã—ãŸã€‚ä»–ã«ã”è³ªå•ãŒã‚ã‚Œã°ã€ãŠæ°—è»½ã«ã©ã†ãžã€‚ã€‚

ã‚½ãƒ¼ã‚¹: Copilot ã¨ã®ä¼šè©±ã€ 2024/6/28
(1) PSCustomObject ã«ã¤ã„ã¦çŸ¥ã‚ŠãŸã‹ã£ãŸã“ã¨ã®ã™ã¹ã¦ - PowerShell. https://learn.microsoft.com/ja-jp/powershell/scripting/learn/deep-dives/everything-about-pscustomobject?view=powershell-7.4.
(2) PSCustomObject ã«ã¤ã„ã¦ - PowerShell | Microsoft Learn. https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/about/about_pscustomobject?view=powershell-7.4.
(3) Powershellï¼šåŸºç¡€:è‡ªå®šä¹‰å¯¹è±¡1ï¼šä½¿ç”¨PSCustomObject | Tim .... https://blog.solex-inc.com/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/ps_how_to_new_ps_object.html.
(4) PowerShellã§ã‚«ã‚¹ã‚¿ãƒ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¦ã¿ã‚‹ -1- åŸºæœ¬ç·¨ - JBS .... https://blog.jbs.co.jp/entry/2022/09/29/182509.

---

ã‚‚ã¡ã‚ã‚“ã§ã™ã€‚`Add-Member` ã‚³ãƒžãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ã€æ—¢å­˜ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«æ–°ã—ã„ãƒ¡ãƒ³ãƒãƒ¼ï¼ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚„ãƒ¡ã‚½ãƒƒãƒ‰ãªã©ï¼‰ã‚’å‹•çš„ã«è¿½åŠ ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ä»¥ä¸‹ã«ã€`Add-Member`ã‚’ä½¿ç”¨ã—ã¦`PSCustomObject`ã«æ–°ã—ã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã™ã‚‹å…·ä½“çš„ãªã‚³ãƒ¼ãƒ‰ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚

ã¾ãšã€`PSCustomObject`ã‚’ä½œæˆã—ã¾ã™:

```powershell
$person = [PSCustomObject]@{
  FirstName = 'Taro'
  LastName = 'Yamada'
}
```

æ¬¡ã«ã€`Add-Member`ã‚’ä½¿ç”¨ã—ã¦æ–°ã—ã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€`FullName`ã¨ã„ã†æ–°ã—ã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã—ã€`FirstName`ã¨`LastName`ã‚’çµåˆã—ãŸå€¤ã‚’è¨­å®šã—ã¾ã™:

```powershell
$person | Add-Member -MemberType NoteProperty -Name 'FullName' -Value ($person.FirstName + ' ' + $person.LastName)
```

ã“ã‚Œã§ã€`$person`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«`FullName`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒè¿½åŠ ã•ã‚Œã€`Taro Yamada`ã¨ã„ã†å€¤ãŒè¨­å®šã•ã‚Œã¾ã™ã€‚`FullName`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å€¤ã‚’ç¢ºèªã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¾ã™:

```powershell
$person.FullName
```

ã“ã®æ–¹æ³•ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€æ—¢å­˜ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«æŸ”è»Ÿã«æ–°ã—ã„æƒ…å ±ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ç‰¹ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œä¸­ã«å‹•çš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ§‹ç¯‰ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã«ä¾¿åˆ©ã§ã™Â¹Â²ã€‚

ã‚½ãƒ¼ã‚¹: Copilot ã¨ã®ä¼šè©±ã€ 2024/6/28
(1) Add-Member ã‚’æ¥µã‚ã‚‹ - é·²ãƒŽå·£. https://tech.blog.aerie.jp/entry/2013/12/23/173004.
(2) Add-Member (Microsoft.PowerShell.Utility) - PowerShell. https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/add-member?view=powershell-7.4.
(3) Add-Member (Microsoft.PowerShell.Utility) - PowerShell. https://bing.com/search?q=PowerShell+Add-Member+%e3%82%b3%e3%83%bc%e3%83%89%e4%be%8b.
(4) Add-Member - Forsenergy. https://www.forsenergy.com/ja-jp/windowspowershellhelp/html/568588f6-4fed-47e5-819f-2cd326b71ed4.htm.
(5) PowerShellã§CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’åŠ¹çŽ‡çš„ã«æ“ä½œï¼Import-Csvã‚³ãƒžãƒ³ãƒ‰ã¨ .... https://automationse.net/powershell-efficiently-manipulate-csv-files-import-csv-command-and-options-complete-explanation/.
(6) PowerShellã®Add-Memberã®è€ƒãˆæ–¹ã«ã¤ã„ã¦ - teratailã€ãƒ†ãƒ© .... https://teratail.com/questions/48287.

---

PowerShellã§`PSCustomObject`ã‚’ä½œæˆã™ã‚‹éš›ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã¨ã—ã¦ã€ä»¥ä¸‹ã®æ–¹æ³•ãŒæŽ¨å¥¨ã•ã‚Œã¾ã™:

1. **ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ç›´æŽ¥**:
   - `$myObject = [PSCustomObject]@{ Name = 'Kevin'; Language = 'PowerShell'; State = 'Texas' }`
   - ã“ã®æ–¹æ³•ã¯ã€ç°¡æ½”ã§èª­ã¿ã‚„ã™ãã€PowerShell v3.0ä»¥é™ã§åˆ©ç”¨å¯èƒ½ã§ã™ã€‚ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ç›´æŽ¥`PSCustomObject`ã«ã‚­ãƒ£ã‚¹ãƒˆã™ã‚‹ã“ã¨ã§ã€è¿…é€Ÿã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã§ãã¾ã™Â¹ã€‚

2. **é †åºä»˜ããƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«**:
   - `$myObject = [pscustomobject][ordered]@{ Name = 'Kevin'; Language = 'PowerShell'; State = 'Texas' }`
   - ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®é †åºã‚’ç¶­æŒã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã«ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€ç‰¹ã«å‡ºåŠ›ã‚’æ•´å½¢ã™ã‚‹éš›ã‚„ã€é †åºã«ä¾å­˜ã™ã‚‹å‡¦ç†ã‚’è¡Œã†éš›ã«é‡è¦ã§ã™Â¹ã€‚

3. **JSONãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆ**:
   - `$myObject = Get-Content -Path $Path | ConvertFrom-Json`
   - JSONå½¢å¼ã§ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã€å¾Œã§å†åˆ©ç”¨ã™ã‚‹å ´åˆã«é©ã—ã¦ã„ã¾ã™ã€‚`ConvertFrom-Json`ã‚³ãƒžãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€JSONæ–‡å­—åˆ—ã‚’`PSCustomObject`ã«å¤‰æ›ã§ãã¾ã™Â¹ã€‚

ã“ã‚Œã‚‰ã®æ–¹æ³•ã¯ã€ä»¥ä¸‹ã®åŸºæº–ã«åŸºã¥ã„ã¦ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã¨åˆ¤æ–­ã•ã‚Œã¦ã„ã¾ã™:
- **ç°¡æ½”ã•**: ã‚³ãƒ¼ãƒ‰ãŒçŸ­ãã€æ„å›³ãŒæ˜Žç¢ºã§ã‚ã‚‹ã“ã¨ã€‚
- **å¯èª­æ€§**: ä»–ã®äººãŒã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚“ã§ç†è§£ã—ã‚„ã™ã„ã“ã¨ã€‚
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹**: å‡¦ç†é€Ÿåº¦ãŒé€Ÿãã€ãƒªã‚½ãƒ¼ã‚¹ã‚’ç¯€ç´„ã§ãã‚‹ã“ã¨ã€‚
- **äº’æ›æ€§**: æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PowerShellã§åºƒãã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ã€‚
- **å†åˆ©ç”¨æ€§**: ä½œæˆã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç°¡å˜ã«ä¿å­˜ã—ã€å†åˆ©ç”¨ã§ãã‚‹ã“ã¨ã€‚

ã“ã‚Œã‚‰ã®æ–¹æ³•ã¯ã€ä¸€èˆ¬çš„ãªã‚·ãƒŠãƒªã‚ªã§ã®ä½¿ç”¨ã‚’æƒ³å®šã—ã¦ãŠã‚Šã€ç‰¹å®šã®çŠ¶æ³ã‚„è¦ä»¶ã«å¿œã˜ã¦æœ€é©ãªæ–¹æ³•ã‚’é¸æŠžã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚ã‚‚ã—ä»–ã«ã”è³ªå•ãŒã‚ã‚Œã°ã€ãŠæ°—è»½ã«ã©ã†ãžã€‚ã€‚

ã‚½ãƒ¼ã‚¹: Copilot ã¨ã®ä¼šè©±ã€ 2024/6/28
(1) PSCustomObject ã«ã¤ã„ã¦çŸ¥ã‚ŠãŸã‹ã£ãŸã“ã¨ã®ã™ã¹ã¦ - PowerShell. https://learn.microsoft.com/ja-jp/powershell/scripting/learn/deep-dives/everything-about-pscustomobject?view=powershell-7.4.
(2) PSCustomObject ã«ã¤ã„ã¦ - PowerShell | Microsoft Learn. https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/about/about_pscustomobject?view=powershell-7.4.
(3) PowerShellã§ã‚«ã‚¹ã‚¿ãƒ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¦ã¿ã‚‹ -1- åŸºæœ¬ç·¨ - JBS .... https://blog.jbs.co.jp/entry/2022/09/29/182509.
(4) New-Object PSObject -Property ã¨ New-Object PSObject - Qiita. https://qiita.com/shiso_no_ha/items/30596fa032b15a24d0e5.

ã“ã‚Œã‚‰ã®çµæžœã‚’ç¢ºèªãƒ»æ¤œè¨¼ã—ã¾ã¨ã‚ã‚‹ã€‚
ã¾ãŸã€æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã§ã‚‚èª¿æŸ»ã—ã€ä»–ã®æ‰‹æ³•ãŒç„¡ã„ã‹ã‚‚èª¿ã¹ã¦ã¾ã¨ã‚ã¦æŽ²è¼‰ã™ã‚‹ã€‚

---

è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ä»¶æ•°ãŒã‚ã‚‹PSCustomObjectã‚’ä¸€åº¦ã«å®šç¾©ã™ã‚‹æ–¹æ³•

```powershell
$objectArray = @(
    [PSCustomObject]@{
        Name     = 'Taro'
        Language = 'Japanese'
        City     = 'Tokyo'
    },
    [PSCustomObject]@{
        Name     = 'Hanako'
        Language = 'English'
        City     = 'Kyoto'
    }
)
```

```powershell:
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $objectArray[0].Name
Taro
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

ä¸Šè¨˜ã ã¨åˆ—åã‚’å–å¾—ã™ã‚‹ãŒã€ä¸‹è¨˜ã®æ–¹æ³•ã ã¨åˆ—åã®æƒ…å ±ã‚’é…åˆ—ã«å…¥ã‚Œã€ãã®é…åˆ—ã‚’åˆ—æŒ‡å®šã§ä½¿ã†ã“ã¨ã§ã€
åˆ—ç•ªå·ã§æŒ‡å®šã™ã‚‹æ„Ÿã˜ã«ã§ãã‚‹ã€‚

```powershell:
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $propNames = $objectArray | Get-Member -MemberType NoteProperty | Select-Object -ExpandProperty Name
>>
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $propNames
City
Language
Name
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $objectArray[0]."$($propNames[1])"
Japanese
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```
