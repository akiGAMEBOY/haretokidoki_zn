---
title: "PowerShell 5.1で独自のイベントログを出力する方法"
emoji: "🔥"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["powershell"]
published: false
---

こんにちは、Copilotです。Powershellで独自のイベントログを出力する方法についてお答えします。😊

まず、`New-EventLog`コマンドレットを使って、出力したいイベントログの名前とソースを指定して、新しいイベントログを作成します。例えば、以下のコマンドは、`MyLog`という名前のイベントログを作成し、`MySource`というソースを登録します。

```powershell
New-EventLog -LogName MyLog -Source MySource
```

次に、`Write-EventLog`コマンドレットを使って、作成したイベントログにイベントを書き込みます。イベントには、エントリタイプ（エラー、警告、情報など）、イベントID、メッセージなどの情報を指定します。例えば、以下のコマンドは、`MyLog`にエラーのイベントを書き込みます。

```powershell
Write-EventLog -LogName MyLog -Source MySource -EntryType Error -EventId 100 -Message "This is an error event"
```

最後に、`Get-EventLog`コマンドレットを使って、出力したイベントログを確認します。例えば、以下のコマンドは、`MyLog`の最新の5件のイベントを表示します。

```powershell
Get-EventLog -LogName MyLog -Newest 5
```

以上が、Powershellで独自のイベントログを出力する方法です。詳しくは、[こちら](^1^)や[こちら](^2^)を参照してください。¹²

Copilotとの会話を楽しんでいただけたら嬉しいです。😊

ソース: Bing との会話 2024/3/6
(1) Get-Eventlogの使い方から覚えていくPowershellの基本的な使い .... https://qiita.com/Anubis_369/items/d0566143a1356a2f8ec5.
(2) Get-EventLog (Microsoft.PowerShell.Management) - PowerShell. https://learn.microsoft.com/ja-jp/powershell/module/Microsoft.PowerShell.Management/Get-EventLog?view=powershell-5.1.
(3) Get-Eventlogの使い方から覚えていくPowershellの基本的な使い .... https://qiita.com/Anubis_369/items/d0566143a1356a2f8ec5.
(4) Get-EventLog (Microsoft.PowerShell.Management) - PowerShell. https://learn.microsoft.com/ja-jp/powershell/module/Microsoft.PowerShell.Management/Get-EventLog?view=powershell-5.1.
(5) PowerShellを使って特定のWindowsイベントログをエクスポート .... https://ittrip.xyz/soft/windows/powershell-export-specific-windows-eventlog.
(6) 【PowerShell】イベントログをCSVファイルとして出力する - Qiita. https://qiita.com/hara_power/items/073fa6079e633f084412.