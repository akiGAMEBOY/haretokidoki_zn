---
title: "[PowerShell]PDFãƒ•ã‚¡ã‚¤ãƒ«å†…ã®æ–‡å­—åˆ—ã‚’æ¤œç´¢ã—å­˜å¦ã‚’åˆ¤å®šã™ã‚‹ãƒ„ãƒ¼ãƒ«"
emoji: "ğŸ¦¾"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell", "pdf", "itextsharp", "ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ "]
published: true
---
:::message
**æ³¨æ„äº‹é …**

ã“ã®è¨˜äº‹ã§ã¯ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã«è§¦ã‚Œã¦ã„ã¾ã™ãŒã€ç§ã¯ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®å°‚é–€å®¶ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

ä»¥é™ã€ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®å†…å®¹ã«é–¢ã—ã¦æ­£ç¢ºãªæƒ…å ±ã‚’æ²è¼‰ã—ã‚ˆã†ã¨å¯èƒ½ãªé™ã‚ŠåŠªåŠ›ã—ã¦ã„ã¾ã™ãŒã€
å€‹äººã®èª¿æŸ»ã«ã‚ˆã‚‹çµæœã§ã‚ã‚‹ç‚ºã€èª¤ã£ãŸæƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

**ãƒ©ã‚¤ã‚»ãƒ³ã‚¹é–¢é€£ã¯ã€ã‚ãã¾ã§ã‚‚å‚è€ƒæƒ…å ±**ã¨ã—ã€ã”è‡ªèº«ã§ã‚‚èª¿ã¹ã¦é ‚ã„ãŸä¸Šã§ã€
ã”æ´»ç”¨ã„ãŸã ã‘ã‚Œã°ã¨æ€ã„ã¾ã™ã€‚

ã‚‚ã—ã€æœ‰è­˜è€…ã®æ–¹ã§å†…å®¹ã«èª¤ã‚Šã‚’è¦‹ã¤ã‘ã¦é ‚ã„ãŸå ´åˆã€ã‚³ãƒ¡ãƒ³ãƒˆç­‰ã§ã‚„ã•ã—ãã€
ã”æŒ‡æ‘˜ã„ãŸã ã‘ã‚‹ã¨åŠ©ã‹ã‚Šã¾ã™ã€‚
:::
:::message alert
**ãƒ©ã‚¤ã‚»ãƒ³ã‚¹é–¢é€£ã§å–ã‚Šæ‰±ã„æ³¨æ„**

ã“ã®è¨˜äº‹ã§ç´¹ä»‹ã—ã¦ã„ã‚‹å†…å®¹ã¯ã€AGPLv3[^1]ã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®[iTextSharp](https://github.com/itext/itextsharp)ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚
ãã‚Œã«ã¨ã‚‚ãªã„ä»Šå›ã€ä½œæˆã—ãŸã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚‚**AGPLv3ã§è¨­å®š**ã—ã¦ã„ã¾ã™ã€‚

ã“ã®è¨˜äº‹ã§ç´¹ä»‹ã™ã‚‹ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å«ã‚ã€
ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’**å•†ç”¨åˆ©ç”¨ã™ã‚‹å ´åˆ**ã€[iText](https://itextpdf.com/)ã¨**æœ‰å„Ÿå¥‘ç´„ãŒå¿…è¦**ã«ãªã‚Šã¾ã™ã€‚
ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®è©³ç´°ã¯[ã“ã¡ã‚‰](https://github.com/itext/itextsharp/blob/develop/LICENSE.md)ã‚’ã”å‚ç…§ãã ã•ã„ã€‚
:::
[^1]: GNU Affero General Public License v3.0ã®ç•¥ã€‚

## æ¦‚è¦

[ã“ã¡ã‚‰ã®è¨˜äº‹](https://haretokidoki-blog.com/pasocon_powershell-startup/)ã§æ–‡å­—ã ã‘ã‚’è¡¨ç¤ºã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ã„ã€
PowerShellã®ã¯ã˜ã‚æ–¹ã‚’ç´¹ä»‹ã—ã¾ã—ãŸãŒã€ã‚ˆã‚Šå®Ÿè·µã«è¿‘ã„ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ï¼ˆã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼‰ã‚’ä½œæˆã—ã¾ã—ãŸã€‚

ä»Šå›ä½œæˆã—ãŸPowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯**ãƒ†ã‚­ã‚¹ãƒˆãŒåŸ‹ã‚è¾¼ã¾ã‚Œã¦ã„ã‚‹PDFãƒ•ã‚¡ã‚¤ãƒ«**[^2]ã‚’èª­ã¿è¾¼ã¿ã€ã‚ã‚‰ã‹ã˜ã‚è¨­å®šã—ãŸæ¤œç´¢æ–‡å­—åˆ—ã«ã‚ˆã‚Šå‡¦ç†çµæœã®æ­£å¸¸ï¼ç•°å¸¸ã‚’åˆ¤å®šã™ã‚‹ã¨ã„ã†å†…å®¹ã§ã™ã€‚
[^2]: ãƒ†ã‚­ã‚¹ãƒˆãŒåŸ‹ã‚è¾¼ã¾ã‚Œã¦ã„ãªã„ç”»åƒãƒ‡ãƒ¼ã‚¿ã®ã¿ã®PDFãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚ã‚‹å ´åˆã€ä¸­èº«ã¯èª­ã¿å–ã‚Œãšæ©Ÿèƒ½ã—ã¾ã›ã‚“ã€‚

PowerShellã®å§‹ã‚æ–¹ï¼ˆã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ï¼‰ã¨ã—ã¦ã‚‚ã€ã”å‚è€ƒé ‚ã‘ã‚Œã°ã¨æ€ã„ã¾ã™ã€‚
https://haretokidoki-blog.com/pasocon_powershell-startup/

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- PowerShellãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- PowerShellã§PDFãƒ•ã‚¡ã‚¤ãƒ«å†…ã®æ–‡å­—åˆ—ã‚’æ¤œç´¢ã—åˆ¤å®šã—ãŸã„æ–¹
- åˆå¿ƒè€…ã§PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆã®å‚è€ƒã«ã—ãŸã„æ–¹

## ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ç´¹ä»‹

ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã‚·ãƒŠãƒªã‚ªã¯ã€ã¨ã‚ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã•ã‚ŒãŸPDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¯¾è±¡ã«æ–‡å­—åˆ—ã‚’æ¤œç´¢ã€
æ–‡å­—åˆ—ã®æœ‰ç„¡ã«ã‚ˆã‚Šå‡¦ç†çµæœãŒæ­£å¸¸çµ‚äº†ã—ãŸã‹ï¼ç•°å¸¸çµ‚äº†ã—ãŸã‹ã‚’åˆ¤å®šã™ã‚‹ã¨ã„ã†ã€ã‚·ãƒŠãƒªã‚ªã‚’æƒ³å®šã—ãŸãƒ„ãƒ¼ãƒ«ã€‚

### ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ 

https://github.com/akiGAMEBOY/PowerShell_SearchForPdffileStrings

### ä»•æ§˜

ãƒ—ãƒ­ã‚°ãƒ©ãƒ èµ·å‹•ç”¨ï¼šbatãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®æœ¬ä½“ï¼šps1ãƒ•ã‚¡ã‚¤ãƒ«ã€å€‹åˆ¥ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼šsetup.iniãƒ•ã‚¡ã‚¤ãƒ«ã€
ã®3ã¤ã§æ§‹æˆã•ã‚ŒãŸãƒ—ãƒ­ã‚°ãƒ©ãƒ ã€‚

ãªãŠã€å¯¾è±¡ã®PDFãƒ•ã‚¡ã‚¤ãƒ«åã‚„æ¤œç´¢æ–‡å­—åˆ—ã«ã¤ã„ã¦ã¯ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã‚Šå¤‰æ›´å¯èƒ½ã¨ã™ã‚‹ã€‚

#### ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ

##### å‡¦ç†å…¨ä½“

##### ãƒ—ãƒ­ã‚°ãƒ©ãƒ æœ¬ä½“

ãƒ•ã‚¡ã‚¤ãƒ«åï¼šMain.ps1

```mermaid
flowchart TB
    A(["é–‹å§‹"]) --- B["åˆæœŸè¨­å®š"]
    B --- C["å¯¾è±¡PDFãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯"]
    C --- D{"å®Ÿè¡Œæœ‰ç„¡ã®ç¢ºèª"}
    D --> |"Yesï¼šå®Ÿè¡Œã™ã‚‹"| E["PDFãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿"]
    D --> |"No ï¼šå®Ÿè¡Œã—ãªã„"| X[["å‡¦ç†ä¸­æ–­"]]
    subgraph "PDFãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œç´¢å‡¦ç†"
    E --- F["æŒ‡å®šæ–‡å­—åˆ—ã®æ¤œç´¢"]
    end
    F --> |"æ–‡å­—åˆ—ã‚ã‚Šï¼šæ­£å¸¸çµ‚äº†ã¨åˆ¤æ–­"| G[/"å‡¦ç†çµæœã‚’è¡¨ç¤º"/]
    F --> |"æ–‡å­—åˆ—ãªã—ï¼šç•°å¸¸çµ‚äº†ã¨åˆ¤æ–­"| G    
    X --> G
    G --- H(["çµ‚äº†"])
```

#### ç”»é¢ä»•æ§˜

ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆbatãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚’ä½¿ã„PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã€‚
ã“ã®PowerShellã§ã¯[.NET Frameworkã®ãƒ•ã‚©ãƒ¼ãƒ ](https://learn.microsoft.com/ja-jp/powershell/scripting/samples/creating-a-custom-input-box?view=powershell-7.3)ï¼ˆä»¥ä¸‹ã€dotNETãƒ•ã‚©ãƒ¼ãƒ ã¨ç§°ã™ã‚‹ï¼‰ã‚’å‘¼ã³å‡ºã—ã¦ä½¿ç”¨ã—ã¦ãŠã‚Šã€
dotNETãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½¿ã£ãŸãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§æ“ä½œã™ã‚‹ã€‚
ä»–ã«ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ã¯ç¢ºèªç”»é¢ã§ä¸€æ™‚åœæ­¢ã—ã¦ã„ã‚‹å‡¦ç†ã‚’ã€ŒEnterã‚­ãƒ¼ã€ã§ç¶šè¡Œã™ã‚‹æ“ä½œæ–¹æ³•ãŒã‚ã‚‹ã€‚
https://learn.microsoft.com/ja-jp/powershell/scripting/samples/creating-a-custom-input-box?view=powershell-7.3

#### æ©Ÿèƒ½ä»•æ§˜

1. åˆæœŸè¨­å®š
    - è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
        - å¯¾è±¡PDFãƒ•ã‚¡ã‚¤ãƒ«å
        - å¯¾è±¡æ¤œç´¢æ–‡å­—åˆ—
1. å¯¾è±¡PDFãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚ˆã‚Šå–å¾—ã—ãŸå¯¾è±¡ã®PDFãƒ•ã‚¡ã‚¤ãƒ«åãŒãƒãƒƒãƒã®èµ·å‹•å ´æ‰€ã¨åŒã˜éšå±¤ã«ã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã€‚
    ãªã„å ´åˆã¯ã€å‡¦ç†ä¸­æ–­ã€‚
1. æŒ‡å®šæ–‡å­—åˆ—ã®æ¤œç´¢
    è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚ˆã‚Šå–å¾—ã—ãŸå¯¾è±¡æ¤œç´¢æ–‡å­—åˆ—ã®æœ‰ç„¡ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã€‚
    ãªã„å ´åˆã¯ã€ç•°å¸¸çµ‚äº†ã¨åˆ¤æ–­ã€‚

#### å…¥å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«

##### å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«

- iniãƒ•ã‚¡ã‚¤ãƒ«

https://github.com/akiGAMEBOY/PowerShell_SearchForPdffileStrings/blob/master/source/powershell/setup.ini#L7-L8

##### å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«

ãªã—

### GitHub Repository

https://github.com/akiGAMEBOY/PowerShell_SearchForPdffileStrings

#### ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼æ§‹æˆ

```
PowerShell_SearchForPdffileStrings
â”‚  LICENSE
â”‚  README.md
â”‚  SearchForPdffileStrings.bat          ãƒ»ãƒ»ãƒ»èµ·å‹•ç”¨ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«
â”‚  ProcessingResult.pdf                 ãƒ»ãƒ»ãƒ»å¯¾è±¡PDFãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆSuccessï¼‰
â”‚
â”œâ”€sample-data                           ãƒ»ãƒ»ãƒ»ãƒ†ã‚¹ãƒˆç”¨ã®PDFã‚µãƒ³ãƒ—ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«
â”‚      ProcessingResult_Failure.docx
â”‚      ProcessingResult_Failure.pdf
â”‚      ProcessingResult_Success.docx
â”‚      ProcessingResult_Success.pdf
â”‚
â””â”€source
    â”œâ”€icon                              ãƒ»ãƒ»ãƒ»ã‚¢ã‚¤ã‚³ãƒ³ãƒ‡ãƒ¼ã‚¿
    â”‚      shell32-296.ico
    â”‚
    â”œâ”€lib                               ãƒ»ãƒ»ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆiTextSharp 5.5.13ã®DLLï¼‰
    â”‚      itextsharp.dll
    â”‚
    â”œâ”€powershell
    â”‚      Main.ps1                     ãƒ»ãƒ»ãƒ»ãƒ—ãƒ­ã‚°ãƒ©ãƒ æœ¬ä½“
    â”‚      setup.ini                    ãƒ»ãƒ»ãƒ»è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
    â”‚
    â””â”€tmp                               ãƒ»ãƒ»ãƒ»PDFãƒ•ã‚¡ã‚¤ãƒ«å†…ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ä¸€æ™‚æ›¸ãå‡ºã—ç”¨
            pdf_textdata.txt
```

### å‚è€ƒè¨˜äº‹

#### å„iTestSharpã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§å‹•ä½œç¢ºèªã—ãŸçµæœ

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å‹•ä½œæœ‰ç„¡ | å‚™è€ƒ |
| ---- | ---- | ---- |
| 5.5.10 | â—‹ |  |
| 5.5.11 | â—‹ |  |
| 5.5.12 | â—‹ |  |
| 5.5.13 | â—‹ | ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ä½¿ç”¨ |
| 5.5.13.1 | â—‹ |  |
| 5.5.13.2 | Ã— | åŸå› ä¸æ˜ã ãŒå‹•ä½œã—ãªã‹ã£ãŸã€‚ä¸å…·åˆï¼Ÿ |
| 5.5.13.3 | Ã— | åŸå› ä¸æ˜ã ãŒå‹•ä½œã—ãªã‹ã£ãŸã€‚ä¸å…·åˆï¼Ÿ |

#### æµç”¨ã—ãŸã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ 

https://zenn.dev/haretokidoki/articles/a77765dd56f202

#### ãƒ—ãƒ­ã‚°ãƒ©ãƒ ä½œæˆæ™‚ã«å‚è€ƒã«ã—ãŸè¨˜äº‹

- iTextSharp 5.5.13ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
    https://www.nuget.org/packages/iTextSharp/5.5.13
- nupkgãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šå‡ºã™æ–¹æ³•
    https://zenn.dev/haretokidoki/articles/d3ca9fe55ab0c5
- ãƒ†ã‚­ã‚¹ãƒˆåŸ‹ã‚è¾¼ã¿ã®ã‚ã‚‹PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§å‡ºåŠ›ã™ã‚‹æ–¹æ³•
    http://35huyu.seesaa.net/article/446050464.html

- iTextSharpã®æƒ…å ±ãŒã¾ã¨ã¾ã£ã¦ã„ã‚‹ã‚µã‚¤ãƒˆ
    https://codezine.jp/article/detail/462
    https://qiita.com/AWtnb/items/215f77d97b7ea069a06a

- iTextSharpã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹é–¢é€£ã®è¨˜äº‹
    https://nokoshitamono.blogspot.com/2015/09/gplagpl.html
    https://caddiary.com/?p=4426
    https://qiita.com/toshi71/items/bc05d6e15edd645c8f46

- OSSãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã«é–¢ã™ã‚‹è¨˜äº‹
    https://www.tohoho-web.com/ex/license.html
    https://future-architect.github.io/articles/20200821/
    https://coliss.com/articles/build-websites/operation/work/choose-a-license-by-github.html

- GitHubã§ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’è¿½åŠ ã™ã‚‹æ–¹æ³•
    - ãƒªãƒã‚¸ãƒˆãƒªä½œæˆæ™‚ã«ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’è¿½åŠ ã™ã‚‹æ–¹æ³•
        https://qiita.com/shibukk/items/67ad0a5eda5a94e5c032
    - ãƒªãƒã‚¸ãƒˆãƒªä½œæˆå¾Œã«ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’è¿½åŠ ã™ã‚‹æ–¹æ³•
        https://docs.github.com/ja/communities/setting-up-your-project-for-healthy-contributions/adding-a-license-to-a-repository
        https://qiita.com/medi-y-sato/items/c3d5c357ab020290dccc

- iTextSharpä»¥å¤–ã®PDFãŒç·¨é›†å¯èƒ½ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€Œpdfsharpã€ï¼ˆæœªæ¤œè¨¼ï¼‰
    https://plaza.rakuten.co.jp/satocchia/diary/202110220000/?scid=we_blg_pc_lastctgy_3_title
    https://zenn.dev/awtnb/articles/e54718efcd1b5b#pdfsharp

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
