---
title: "PowerShellのCountメソッドとLengthメソッドの使用用途をまとめてみた"
emoji: "🦔"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["powershell"]
published: false
---

はい、PowerShellにおいて配列の長さ（要素数）を取得する際には、`Length`メソッドも使用できます。`Length`プロパティは配列の全ての要素数を返します。例えば、`$myArray.Length`は配列`$myArray`の要素数を返します¹。

表を更新して、配列における`Length`メソッドの使用可能性を示します。

| 使用シチュエーション | Count 利用可能 | Length 利用可能 | コード例 |
| --- | :---: | :---: | --- |
| 配列やコレクション | ✔️ | ✔️ | `Count`: `(Get-ChildItem).Count`<br>`Length`: `$myArray.Length` |
| 文字列の長さ | ❌ | ✔️ | `Length`: `"Hello".Length` |
| スカラー値（PowerShell 3.0以降） | ✔️ | ❌ | `Count`: `(123).Count` |
| 文字列のバイト数 | ❌ | ✔️ | `Length`: `$bytes = [System.Text.Encoding]::UTF8.GetBytes("文字列"); $bytes.Length` |

このように、配列やコレクションに対しては`Count`と`Length`の両方のメソッドが利用可能です。`Count`は主にオブジェクトのコレクションに対して使われ、`Length`は配列の要素数を取得するのに使われます。ご質問ありがとうございます。正確な情報を提供できるよう努めます。

ソース: Copilot との会話、 2024/6/28
(1) 【PowerShell】変数・配列の使用方法 | Ninth Code. https://ninthcode.net/240326-powershell-array/.
(2) 配列について - PowerShell | Microsoft Learn. https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/about/about_arrays?view=powershell-7.4.
(3) 【PowerShell】配列(Array)についてまとめてみる - SEブログ. https://soma-engineering.com/coding/powershell/what-is-array/2018/05/29/.
(4) “多次元配列”と“ジャグ配列”の要素数を取得する方法” - Zenn. https://zenn.dev/haretokidoki/articles/f79a5bb769973f.
