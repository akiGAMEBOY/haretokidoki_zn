---
title: "[PowerShell]HTTPSãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ä¸Šã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’å–å¾—ã™ã‚‹Function"
emoji: "ğŸ‰"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---
```powershell:
PS D:\Downloads> $response = Invoke-WebRequest -Uri "https://repo.almalinux.org/almalinux/9.4/isos/x86_64/AlmaLinux-9.4-x86_64-minimal.iso" -Method Head
PS D:\Downloads>
PS D:\Downloads> $response


StatusCode        : 200
StatusDescription : OK
Content           : {}
RawContent        : HTTP/1.1 200 OK
                    Connection: keep-alive
                    Accept-Ranges: bytes
                    Content-Length: 2060451840
                    Content-Type: application/octet-stream
                    Date: Tue, 04 Jun 2024 01:43:51 GMT
                    ETag: "6635645c-7ad00000"
                    Last-...
Headers           : {[Connection, keep-alive], [Accept-Ranges, bytes], [Content-Length, 2060451840], [Content-Type, app
                    lication/octet-stream]...}
RawContentLength  : 0



PS D:\Downloads>
PS D:\Downloads> $fileSize = $response.Headers."Content-Length"
>>
PS D:\Downloads>
PS D:\Downloads> Write-Host "ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º: $fileSize ãƒã‚¤ãƒˆ"
ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º: 2060451840 ãƒã‚¤ãƒˆ
PS D:\Downloads>

```

```powershell:
function Write-HttpHeaderFilesize {
    param (
        [Parameter(Mandatory=$true)][System.String]$getUrl
    )

    $getFilesize = (Invoke-WebRequest -Uri $getUrl -Method Head).Headers."Content-Length"

    if ($null -ne $getFilesize) {
        Write-Host "å–å¾—ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºï¼š$($getFilesize) ãƒã‚¤ãƒˆ"
    }
    else {
        Write-Host 'æŒ‡å®šã®URLã‹ã‚‰ãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚'
    }
}
```
