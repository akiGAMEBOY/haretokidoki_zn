---
title: "[Code Runner]UTF-8 BOMä»˜ãã®PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹è¨­å®š"
emoji: "ğŸƒâ€â™€ï¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["windows", "vscode", "coderunner"]
published: false
---

## æ¦‚è¦

Markdownãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ã‚³ãƒ¼ãƒ‰å†…å®¹ã ã‘ã§æ­£å¸¸å‹•ä½œã™ã‚‹ã‹æ¤œè¨¼ã—ãŸãã€VS Codeã«æ‹¡å¼µæ©Ÿèƒ½ã®[Code Runner](https://marketplace.visualstudio.com/items?itemName=formulahendry.code-runner)ã‚’å°å…¥ã—ã¾ã—ãŸã€‚

å®Ÿéš›ã«è¤‡æ•°è¡Œã®PowerShellã‚³ãƒ¼ãƒ‰ã‚’ç¯„å›²é¸æŠã—ã¦å‹•ã‹ã—ã¦ã¿ã‚‹ã¨ã€æ–‡å­—åŒ–ã‘ã—ã¦ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã—ã¾ã„ã¾ã—ãŸã€‚
ä»Šå›ã€ã“ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹æ–¹æ³•ãŒè¦‹ã¤ã‹ã£ãŸã®ã§ç´¹ä»‹ã—ã¾ã™ã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- VS Codeãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- Code Runnerã«ã¤ã„ã¦çŸ¥ã‚ŠãŸã„æ–¹
- Code Runnerã§PowerShellå®Ÿè¡Œæ™‚ã«æ–‡å­—åŒ–ã‘ã—ã¦ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹å•é¡Œã‚’è§£æ±ºã—ãŸã„æ–¹

## ç’°å¢ƒ

### Windows & PowerShell

[PowerShell Core](https://github.com/PowerShell/PowerShell/releases)ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã€‚

```powershell:Windows 10 & PowerShell 7.3.8
PS C:\Users\XXXX> $PSVersionTable

Name                           Value
----                           -----
PSVersion                      7.3.8
PSEdition                      Core
GitCommitId                    7.3.8
OS                             Microsoft Windows 10.0.19045
Platform                       Win32NT
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0â€¦}
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1
WSManStackVersion              3.0

PS C:\Users\XXXX>
```

- PowerShell OSåˆ¥ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ãƒ»ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•ã®ãƒªã‚¹ãƒˆ
    <https://github.com/PowerShell/PowerShell#get-powershell>

### VS Code

```powershell:ã‚³ãƒ”ãƒ¼ç”¨
code -v
```

```powershell:VS Code 1.83.1
PS C:\Users\XXXX> code -v
1.83.1
f1b07bd25dfad64b0167beb15359ae573aecd2cc
x64
PS C:\Users\XXXX>
```

### Code Runner

```powershell:ã‚³ãƒ”ãƒ¼ç”¨
code --list-extensions --show-versions
```

```powershell:Code Runner 0.12.1
PS C:\Users\XXXX> code --list-extensions --show-versions
formulahendry.code-runner@0.12.1

 ï½ çœç•¥ ï½
 
PS C:\Users\XXXX>
```

## ãªãœCode Runnerã‚’å°å…¥ã—ãŸã®ã‹

å†’é ­ã§ã‚‚è¨˜è¼‰ã—ã¦ã„ã¾ã™ãŒã€Markdownå†…ã§æ›¸ã„ãŸã‚³ãƒ¼ãƒ‰ã®å‹•ä½œæ¤œè¨¼ã‚’ç°¡ç•¥åŒ–ã—ãŸããªã‚Šå°å…¥ã—ã¾ã—ãŸã€‚

ã“ã®è¨˜äº‹ã‚’æŠ•ç¨¿ã—ã¦ã„ã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ Zenn.devã§ã¯Markdownè¨˜æ³•ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚
Markdownãƒ•ã‚¡ã‚¤ãƒ«å†…ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ãŸå¾Œã€ãã®ã‚³ãƒ¼ãƒ‰ãŒæ­£å¸¸ã«å‹•ãã‹æ¤œè¨¼ã™ã‚‹ç‚ºã€
å¯¾å¿œã™ã‚‹è¨€èªãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆãŸã¨ãˆã°PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å ´åˆã€`*.ps1`ï¼‰ã‚’å€‹åˆ¥ã«æ›¸ãå‡ºã—ãŸå¾Œã€å®Ÿè¡Œã—ã¦ã„ã¾ã—ãŸã€‚

ä¸€åº¦ã§å‹•ä½œæ¤œè¨¼ãŒçµ‚ã‚ã‚Œã°è‰¯ã„ã§ã™ãŒè©¦è¡ŒéŒ¯èª¤ã™ã‚‹ã¨ã€ã©ã†ã—ã¦ã‚‚ä½•åº¦ã‚‚ç¹°ã‚Šè¿”ã—ã¦ä½œæ¥­ã™ã‚‹äº‹ã«ãªã‚Šã€
å€‹åˆ¥ã«æ›¸ãå‡ºã—ã¦å®Ÿè¡Œã™ã‚‹äº‹ãŒé¢å€’ã«æ„Ÿã˜ã¦ã„ã¾ã—ãŸã€‚

ãƒãƒƒãƒˆã§æ¢ã—ã¦ã¿ã‚‹ã¨ã€VS Codeã®æ‹¡å¼µæ©Ÿèƒ½ã§ã‚ã‚‹[Code Runner](https://marketplace.visualstudio.com/items?itemName=formulahendry.code-runner)ã‚’ä½¿ç”¨ã™ã‚‹äº‹ã§ã€
ãƒã‚¦ã‚¹ãƒ»ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã§ç¯„å›²é¸æŠã—ãŸã‚³ãƒ¼ãƒ‰ã ã‘ã®å®Ÿè¡Œã™ã‚‹äº‹ãŒã§ãã‚‹ã¨ã®äº‹ã§å°å…¥ã—ã¾ã—ãŸã€‚

- Code Runner
    [Code Runner | Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=formulahendry.code-runner)
    VS Code æ‹¡å¼µæ©Ÿèƒ½ - è­˜åˆ¥å­ï¼š`formulahendry.code-runner`

## å®Ÿéš›ã«å‹•ã‹ã—ã¦ã¿ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ

Code Runnerã‚’ä½¿ã„å‹•ã‹ã—ã¦ã¿ãŸçµæœã€ç¯„å›²é¸æŠã—ãŸã‚³ãƒ¼ãƒ‰ã®å®Ÿè¡Œã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚
ã‚¨ãƒ©ãƒ¼å†…å®¹ã‚’ã¿ã‚‹ã¨æ–‡å­—åŒ–ã‘ã—ã¦ã„ã‚‹äº‹ãŒã‚ã‹ã‚Šã¾ã™ã€‚

![Code Runnerã®ç¯„å›²é¸æŠã—ãŸã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ãŸãŒå‡ºåŠ›æƒ…å ±ã§ã‚¨ãƒ©ãƒ¼ã€‚ã‚¨ãƒ©ãƒ¼å†…å®¹ãŒæ–‡å­—åŒ–ã‘ã—ã¦ã„ã‚‹ã€‚](https://storage.googleapis.com/zenn-user-upload/7dda566aaf68-20231031.png)
*ç”»åƒï¼šç¯„å›²é¸æŠã—ãŸã‚³ãƒ¼ãƒ‰ã®å®Ÿè¡Œã§ã‚¨ãƒ©ãƒ¼*

```powershell:Code Runnerã®é¸æŠç¯„å›²ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã‚‚ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿï¼ˆå‡ºåŠ›ã«ã¦ã‚¨ãƒ©ãƒ¼ï¼‰
[Running] powershell -ExecutionPolicy ByPass -File "C:\Users\ADMINI~1\AppData\Local\Temp\tempCodeRunnerFile.ps1"
ï¿½ï¿½ï¿½ï¿½ï¿½êŠ C:\Users\Administrator\AppData\Local\Temp\tempCodeRunnerFile.ps1:21 ï¿½ï¿½ï¿½ï¿½:39
+     [System.String]$prompt_message = 'å‚ï¿½Eã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ï¿½EåŠ›ã—ã¦ãã ã•ã„ã€E
+                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ï¿½ï¿½ï¿½Ü‚ï¿½ï¿½ÍƒXï¿½eï¿½[ï¿½gï¿½ï¿½ï¿½ï¿½ï¿½gï¿½Ìƒgï¿½[ï¿½Nï¿½ï¿½ 'å‚ï¿½Eã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ï¿½EåŠ›ã—ã¦ãã ã•ã„ã€E' ï¿½ï¿½ï¿½gï¿½pï¿½Å‚ï¿½ï¿½Ü‚ï¿½ï¿½ï¿½B
    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : UnexpectedToken
 

[Done] exited with code=1 in 3.738 seconds
```

- ç¯„å›²é¸æŠã—ãŸã‚³ãƒ¼ãƒ‰å®Ÿè¡Œï¼ˆSelect Language To Runï¼‰
    ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼ [`Ctrl + Alt + J`]
    ã€€
    å®Ÿè¡Œã—ãŸã„éƒ¨åˆ†ã‚’ç¯„å›²é¸æŠã—ã¦ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼ã‚’å…¥åŠ›ã€‚è¡¨ç¤ºã•ã‚ŒãŸè¨€èªã®ãƒªã‚¹ãƒˆã®ä¸­ã‹ã‚‰â€œpowershellâ€ã‚’é¸æŠã™ã‚‹ã¨å®Ÿè¡Œã§ããŸã€‚

    ![Code Runnerã§ç¯„å›²é¸æŠã—ãŸã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨è¡¨ç¤ºã•ã‚Œã‚‹è¨€èªãƒªã‚¹ãƒˆã€‚Markdownãƒ•ã‚¡ã‚¤ãƒ«ä¸Šã«ã‚ã‚‹PowerShellã®ã‚³ãƒ¼ãƒ‰ã‚’ç¯„å›²é¸æŠã—ã¦ã„ã‚‹ç‚ºã€ã€Œpowershellã€ã‚’é¸æŠ](https://storage.googleapis.com/zenn-user-upload/bcdeb1aae972-20231031.png)
    *ç”»åƒï¼šCode Runnerã®ç¯„å›²é¸æŠã—ãŸã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ãƒ¢ãƒ¼ãƒ‰ã§è¡¨ç¤ºã•ã‚Œã‚‹è¨€èªãƒªã‚¹ãƒˆ*

:::details è©³ç´°æƒ…å ±ï¼šç¯„å›²é¸æŠã§å®Ÿè¡Œã—ãŸã‚³ãƒ¼ãƒ‰ <ã‚¯ãƒªãƒƒã‚¯ã§æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ã>

```powershell:Markdownãƒ•ã‚¡ã‚¤ãƒ«å†…ã«ã‚ã£ãŸPowerShellã®ã‚³ãƒ¼ãƒ‰
#################################################################################
# å‡¦ç†åã€€ï½œInputForm
# æ©Ÿèƒ½ã€€ã€€ï½œå¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æŒ‡å®šã™ã‚‹å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ 
#--------------------------------------------------------------------------------
# æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue: OKãƒœã‚¿ãƒ³ã€False: OKãƒœã‚¿ãƒ³ä»¥å¤–ï¼‰
# å¼•æ•°ã€€ã€€ï½œtarget_folder: å¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼
#################################################################################
Function InputForm {
    param (
        [System.String]$target_folder
    )

    # ã‚¢ã‚»ãƒ³ãƒ–ãƒªèª­ã¿è¾¼ã¿ï¼ˆãƒ•ã‚©ãƒ¼ãƒ ç”¨ï¼‰
    Add-Type -AssemblyName System.Windows.Forms
    Add-Type -AssemblyName System.Drawing

    [System.String[]]$input_parameters = @()

    # ãƒ•ã‚©ãƒ¼ãƒ ã®ä½œæˆ
    [System.String]$prompt_title = 'ã‚¿ã‚¤ãƒˆãƒ«ï¼šå¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å…¥åŠ›'
    [System.String]$prompt_message = 'å‚ç…§ã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚'
    [System.Windows.Forms.Form]$form = New-Object System.Windows.Forms.Form
    $form.Text = $prompt_title
    [System.UInt32[]]$form_size = @(550, 300)
    $form.Size = New-Object System.Drawing.Size($form_size[0],$form_size[1])
    $form.StartPosition = 'CenterScreen'
    $form.MaximizeBox = $false
    $form.MinimizeBox = $false

    [System.String]$font_family = 'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'
    [System.Int32]$font_size = 12

    # ãƒ©ãƒ™ãƒ«ä½œæˆ
    [System.Windows.Forms.Label]$label = New-Object System.Windows.Forms.Label
    $label.Location = New-Object System.Drawing.Point(20, 20)
    $label.Size = New-Object System.Drawing.Size(350, 50)
    $label.Text = $prompt_message
    [System.Drawing.Font]$font = New-Object System.Drawing.Font($font_family, $font_size)
    $label.Font = New-Object System.Drawing.Font($font_family, $font_size)

    # ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ä½œæˆ
    [System.Windows.Forms.TextBox]$textbox = New-Object System.Windows.Forms.TextBox
    $textbox.Location = New-Object System.Drawing.Point(40, 80)

    # 100ã®å ´åˆ
    $textbox.Size = New-Object System.Drawing.Size(350, 100)

    $textbox.Text = $target_folder
    $textbox.Font = New-Object System.Drawing.Font($font_family, $font_size)

    # å‚ç…§ãƒœã‚¿ãƒ³ã®ä½œæˆ
    [System.Windows.Forms.Button]$btnRefer = New-Object System.Windows.Forms.Button
    $btnRefer.Location = New-Object System.Drawing.Point(420, 80)
    $btnRefer.Size = New-Object System.Drawing.Size(75,25)
    $btnRefer.Text = 'å‚ç…§'

    # OKãƒœã‚¿ãƒ³ã®ä½œæˆ
    [System.Windows.Forms.Button]$btnOkay = New-Object System.Windows.Forms.Button
    $btnOkay.Location = New-Object System.Drawing.Point(355, 210)
    $btnOkay.Size = New-Object System.Drawing.Size(75,30)
    $btnOkay.Text = 'OK'
    $btnOkay.DialogResult = [System.Windows.Forms.DialogResult]::OK

    # Cancelãƒœã‚¿ãƒ³ã®ä½œæˆ
    [System.Windows.Forms.Button]$btnCancel = New-Object System.Windows.Forms.Button
    $btnCancel.Location = New-Object System.Drawing.Point(440,210)
    $btnCancel.Size = New-Object System.Drawing.Size(75,30)
    $btnCancel.Text = 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«'
    $btnCancel.DialogResult = [System.Windows.Forms.DialogResult]::Cancel

    # ãƒœã‚¿ãƒ³ã®ç´ã¥ã‘
    $form.AcceptButton = $btnOkay
    $form.CancelButton = $btnCancel

    # ãƒ•ã‚©ãƒ¼ãƒ ã«ç´ã¥ã‘
    $form.Controls.Add($label)
    $form.Controls.Add($textbox)
    $form.Controls.Add($btnRefer)
    $form.Controls.Add($btnOkay)
    $form.Controls.Add($btnCancel)

    # ãƒ•ã‚©ãƒ¼ãƒ è¡¨ç¤º
    [System.Boolean]$is_Selected = ($form.ShowDialog() -eq [System.Windows.Forms.DialogResult]::OK)
    $form = $null

    return $is_Selected
}
# å®Ÿè¡Œ
InputForm 'D:\Downloads'
```

https://zenn.dev/haretokidoki/articles/a95255bdb31ad3
:::

ã¡ãªã¿ã«Code Runnerã§ã¯ç¯„å›²é¸æŠã—ãŸã‚³ãƒ¼ãƒ‰ã®å®Ÿè¡Œã ã‘ã§ãªãã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œã§ãã‚‹ãƒ¢ãƒ¼ãƒ‰ã‚‚ã‚ã‚Šã¾ã™ã€‚
è©¦ã—ã«å®Ÿè¡Œã—ã¦ã„ã¿ã‚‹ã¨ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«ãŒMarkdownãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆæ‹¡å¼µå­ã¯`*.md`ï¼‰ã ã£ãŸç‚ºã€ã€`Code language not supported or defined.`ã¨ã„ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºã¾ã—ãŸã€‚
Markdownãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œç”¨ã®å½¢å¼ã§ã¯ãªã„ã®ã§æƒ³å®šé€šã‚Šå®Ÿè¡Œã§ãã¾ã›ã‚“ã§ã—ãŸã€‚

- ã‚³ãƒ¼ãƒ‰ã®å®Ÿè¡Œï¼ˆRun Codeï¼‰
    ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼ [`Ctrl + Alt + N`]

- å®Ÿè¡Œçµæœ
    ![ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«ãŒMarkdownãƒ•ã‚¡ã‚¤ãƒ«ã ã¨å®Ÿè¡Œã§ããšãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤º](https://storage.googleapis.com/zenn-user-upload/eb121b3a50bb-20231031.png)
    *ç”»åƒï¼šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸â€œCode language not supported or defined.â€*

Code Runnerã§ã¯åˆæœŸè¨­å®šã•ã‚Œã¦ã„ã‚‹ä¸»æµã®è¨€èªä»¥å¤–ã«ã‚‚å€‹åˆ¥ã«è¿½åŠ ã™ã‚‹äº‹ãŒå¯èƒ½ã§ã™ã€‚

- Code Runnerã§å‹•ä½œã•ã›ã‚‹è¨€èªã‚’å€‹åˆ¥ã«è¿½åŠ ã™ã‚‹æ–¹æ³•
    <https://qiita.com/take_me/items/6a1d2d417889837219d1#ç§ã®è¨€èªãŒå¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ãŒ>

## æ–‡å­—åŒ–ã‘è¡¨ç¤ºã¨ã‚¨ãƒ©ãƒ¼ã®å¯¾å¿œ

### Code Runnerã®å‡ºåŠ›å…ˆã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«è¨­å®šï¼ˆå¿…é ˆä½œæ¥­ï¼‰

èª¿ã¹ãŸçµæœã€[ã“ã¡ã‚‰](https://beiyan-tool.info/?p=962)ã§ç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹Code Runnerã®å‡ºåŠ›å…ˆã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«å¤‰æ›´ã™ã‚‹äº‹ã§ã€
æ–‡å­—åŒ–ã‘ãŒè§£æ¶ˆã•ã‚ŒãŸã¨ã„ã†è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸã€‚

ä»¥ä¸‹ãŒè©³ã—ã„è¨­å®šæ–¹æ³•ã§ã™ã€‚

1. VS Codeã®è¨­å®šç”»é¢ã‚’é–‹ã
    ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼æ“ä½œ  ï¼š`Ctrl + ,ï¼ˆã‚«ãƒ³ãƒï¼‰`
    ç”»é¢æ“ä½œ                ï¼š`ãƒ•ã‚¡ã‚¤ãƒ«(F)` â†’ `ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®š(P)` â†’ `è¨­å®š(S)`ã‚’é¸æŠ
1. è¨­å®šã§æ¤œç´¢æ¬„ã§`code-runner run in terminal`ã¨å…¥åŠ›
1. è¨­å®šé …ç›®ã€Œ`Code-runner: Run In Terminal`ã€ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹
    ![Code Runnerã®è¨­å®šã§ã€ŒCode-runner: Run In Terminalã€ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã‚‹äº‹ã§å®Ÿè¡Œçµæœã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«å‡ºåŠ›ã™ã‚‹ã‚ˆã†å¤‰æ›´](https://storage.googleapis.com/zenn-user-upload/3fbf3459bb6f-20231031.png)
    *ç”»åƒï¼šCode Runnerã®è¨­å®šã§ã€ŒCode-runner: Run In Terminalã€ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚ŒãŸçŠ¶æ…‹*

è¨­å®šå¤‰æ›´å¾Œã€æ–‡å­—åŒ–ã‘ã®åº¦åˆã„ã¯å°‘ãªããªã£ãŸã‚ˆã†ã«è¦‹ãˆã‚‹ãŒã€çŠ¶æ³ã¯å¤‰ã‚ã‚‰ãšæ–‡å­—åŒ–ã‘ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚
![Code Runnerã®è¨­å®šã§ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«å‡ºåŠ›ã™ã‚‹ã‚ˆã†åˆ‡ã‚Šæ›¿ãˆã‚‹ã‚‚ã€çŠ¶æ³ã¯å¤‰ã‚ã‚‰ãšæ–‡å­—åŒ–ã‘ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹](https://storage.googleapis.com/zenn-user-upload/3562fabfee92-20231031.png)
*ç”»åƒï¼šå‡ºåŠ›ã‹ã‚‰ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«å¤‰æ›´ã—ã¦é¸æŠç¯„å›²ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã‚‚æ–‡å­—åŒ–ã‘ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ*

```powershell:Code Runnerã®é¸æŠç¯„å›²ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã‚‚ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿï¼ˆã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ã‚¨ãƒ©ãƒ¼ï¼‰
PS C:\Users\Administrator> powershell -ExecutionPolicy ByPass -File "c:\Users\Administrator\Downloads\tempCodeRunnerFile.ps1"
ç™ºç”Ÿå ´æ‰€ C:\Users\Administrator\Downloads\tempCodeRunnerFile.ps1:21 æ–‡å­—:39
+     [System.String]$prompt_message = 'èœ¿ã‚‰ãƒ»ç¸ºå¶ï½‹ç¹è¼”ã‹ç¹ï½«ç¹ç¹ï½¼ç¹§è²ãƒ»èœ‰å¸™ï¼ ç¸ºï½¦ç¸ºä¸Šâ–¡ç¸ºè¼”ï¼ç¸²ãƒ»
+                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
å¼ã¾ãŸã¯ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã®ãƒˆãƒ¼ã‚¯ãƒ³ 'èœ¿ã‚‰ãƒ»ç¸ºå¶ï½‹ç¹è¼”ã‹ç¹ï½«ç¹ç¹ï½¼ç¹§è²ãƒ»èœ‰å¸™ï¼ ç¸ºï½¦ç¸ºä¸Šâ–¡ç¸ºè¼”ï¼ç¸²ãƒ»' ã‚’ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚
    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : UnexpectedToken
 
PS C:\Users\Administrator> 
```

- å‚è€ƒæƒ…å ±ï¼šCode Runnerã®å‡ºåŠ›å…ˆã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«è¨­å®šã™ã‚‹æ–¹æ³•
    <https://beiyan-tool.info/?p=962>

å¤‰ã‚ã‚‰ãšæ–‡å­—åŒ–ã‘ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸãŒæœ€çµ‚çš„ãªçµæœã€ã“ã“ã§ã®ã€Œ **å‡ºåŠ›å…ˆã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«è¨­å®š** ã€ ã¨ å¾Œè¿°ã™ã‚‹ã€Œ **Code Runnerã§PowerShellã®å€‹åˆ¥è¨­å®šã‚’è¿½åŠ ** ã€ ã®2ä»¶ã‚ã‚ã›ã¦å¯¾å¿œã—ãŸäº‹ã«ã‚ˆã‚Šè§£æ±ºã—ã¾ã—ãŸã€‚

ãã®ç‚ºã€ã“ã“ã§å¯¾å¿œã—ãŸã€Œ **å‡ºåŠ›å…ˆã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«è¨­å®š** ã€ã¯ãã®ã¾ã¾ã®çŠ¶æ…‹ã§å¼•ãç¶šãä½œæ¥­ã—ã¦ãã ã•ã„ã€‚

### èª¿æŸ»æ–¹æ³•ï¼ˆç§ã®ç’°å¢ƒã§é€šå¸¸ã¨ã¯ç•°ãªã‚‹ç‚¹ã‚’æ´—ã„å‡ºã—ï¼‰

ãƒãƒƒãƒˆã®æƒ…å ±ã‚’å…ƒã«ä¸€èˆ¬çš„ãªç’°å¢ƒã¨ç§ã®ç’°å¢ƒã§ç•°ãªã‚‹éƒ¨åˆ†ã‚’ã‚ã‚‰ãŸã‚ã¦æ´—ã„å‡ºã—ãŸçµæœã€
ä¸€èˆ¬çš„ãªç’°å¢ƒã¨é•ã†ç‚¹ã¯ã€PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’**UTF-8 BOMä»˜ãã§ä¿å­˜**ã—ã¦ã„ã‚‹ã¨ã„ã†ç‚¹ã§ã—ãŸã€‚

- ä¸€èˆ¬çš„ãªç’°å¢ƒ
    é€šå¸¸PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒUTF-8ã®ç’°å¢ƒã§å‹•ä½œã™ã‚‹
- ç§ã®ç’°å¢ƒã®å ´åˆ
    ãƒãƒ«ãƒãƒã‚¤ãƒˆï¼ˆæ—¥æœ¬èªï¼‰ã‚’å«ã‚€æ–‡å­—åˆ—ã‚’å–ã‚Šæ‰±ã†ç‚ºã€PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ*.ps1ï¼‰ã‚’**UTF-8 BOMä»˜ãã§ä¿å­˜**ã—ã¦ã„ã‚‹ã€‚
    :::details è£œè¶³æƒ…å ±ï¼šãªãœUTF-8 BOMã§ä¿å­˜ã—ãŸæ–¹ãŒã‚ˆã„ã®ã‹ <ã‚¯ãƒªãƒƒã‚¯ã§æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ã>
    ä»Šå›ã€ä½œæˆã—ãŸPowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€[ASCIIæ–‡å­—](https://e-words.jp/w/ASCII.html)ä»¥å¤–ï¼ˆã¤ã¾ã‚Šæ—¥æœ¬èªï¼‰ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã€‚
    PowerShellã§ã¯ã€ASCIIæ–‡å­—ä»¥å¤–ã®æ–‡å­—åˆ—ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã¨è‡ªå‹•çš„ã«[ANSI](http://office-qa.com/win/win309.htm)ï¼ˆæ—¥æœ¬èªç‰ˆWindows OSã§ã‚ã‚Œã°ã€Shift-JISã®äº‹ã‚’æŒ‡ã™ï¼‰ã¨ã—ã¦å‡¦ç†ã•ã‚Œæ–‡å­—åŒ–ã‘ã™ã‚‹ã€‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹ã®æ–‡å­—åŒ–ã‘ãã‚‰ã„ã§ã‚ã‚Œã°å‹•ä½œã«å•é¡Œã¯ãªã„ãŒã€æ–‡å­—åŒ–ã‘ã®åº¦åˆã„ã«ã‚ˆã£ã¦ã¯å‹•ä½œã—ãªã„å ´åˆã‚‚ã‚ã‚‹ã€‚
    ä¸Šè¨˜ã®å›é¿ç­–ã¨ã—ã¦æ—¥æœ¬èªã‚’å«ã‚€PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’â€œUTF-8 BOMä»˜ãâ€ã§ä¿å­˜ã™ã‚‹äº‹ã«ã‚ˆã‚Šã€
    æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®ãƒ‡ãƒ¼ã‚¿ãŒãƒ•ã‚¡ã‚¤ãƒ«ã«ä»˜ä¸ã•ã‚Œæ–‡å­—åŒ–ã‘ã‚„ã‚¨ãƒ©ãƒ¼ãŒãªãå‹•ä½œã™ã‚‹ã€‚

    - å‚è€ƒæƒ…å ±ï¼šãªãœUTF-8 BOMã§ä¿å­˜ã—ãŸæ–¹ãŒã‚ˆã„ã®ã‹
        - Visual Studio Codeã§PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒæ–‡å­—åŒ–ã‘ã™ã‚‹æ™‚ã®å¯¾å‡¦æ³•
            https://ygkb.jp/17519
        - Microsoftå…¬å¼ï¼šãƒã‚¤ãƒˆã‚ªãƒ¼ãƒ€ãƒ¼ãƒãƒ¼ã‚¯ BOM ã«ã¤ã„ã¦ï¼ˆæ—¥æœ¬èªï¼‰
            https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/about/about_character_encoding?view=powershell-7.3#the-byte-order-mark
        - Microsoftå…¬å¼ï¼šãƒã‚¤ãƒˆã‚ªãƒ¼ãƒ€ãƒ¼ãƒãƒ¼ã‚¯ BOM ã«ã¤ã„ã¦ï¼ˆè‹±èªï¼‰
            https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_character_encoding?view=powershell-7.3#the-byte-order-mark
    :::

ã•ã‚‰ã«Code Runnerã§å®Ÿè¡Œã•ã‚Œã‚‹ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã€Œ`tempCodeRunnerFile.ps1`ã€ã‚’ç¢ºèªã™ã‚‹ã¨æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒã€Œ**UTF-8**ã€ã§ã‚ã‚‹äº‹ãŒåˆ¤æ˜ã€‚

### åŸå› 

æ—¥æœ¬èªã‚’å«ã‚€ãƒãƒ«ãƒãƒã‚¤ãƒˆã‚’å«ã¾ãªã„PowerShellã¯UTF-8ã§å‹•ä½œã™ã‚‹ãŒã€ä»Šå›ã®ã‚³ãƒ¼ãƒ‰ã§ã¯æ—¥æœ¬èªãŒã‚³ãƒ¡ãƒ³ãƒˆè¡Œã‚„ãƒ•ã‚©ãƒ¼ãƒ ã®è¨­å®šå€¤ãªã©ã«ã‚ã‚Šã€
BOMæƒ…å ±ãŒãƒ•ã‚¡ã‚¤ãƒ«ã«ãªãæ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒåˆ¤åˆ¥ã§ããªã„ç‚ºã€PowerShellãŒè‡ªå‹•çš„ã«Shift-JISã«å¤‰æ›ã—å®Ÿè¡Œã—ã¦ã„ãŸäº‹ãŒåˆ¤æ˜ã€‚

è¦ç´„ã™ã‚‹ã¨ä¸‹è¨˜ã®æµã‚Œã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã‚‹äº‹ãŒã‚ã‹ã£ãŸã€‚

1. Markdownãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ã‚³ãƒ¼ãƒ‰ã‚’ç¯„å›²é¸æŠã—ã¦Code Runnerã§å®Ÿè¡Œ
    ç¯„å›²é¸æŠã—ãŸã‚³ãƒ¼ãƒ‰ã«ã¯ã€æ—¥æœ¬èªãŒå«ã¾ã‚ŒãŸçŠ¶æ…‹
1. ï¼ˆCode Runnerã§è‡ªå‹•ï¼‰ã§ç¯„å›²é¸æŠéƒ¨åˆ†ã‚’æŠœãå‡ºã— **UTF-8 ã®ps1ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆ**
1. ï¼ˆCode Runnerã§è‡ªå‹•ï¼‰ç”Ÿæˆã—ãŸps1ãƒ•ã‚¡ã‚¤ãƒ«ã‚’PowerShellã§å®Ÿè¡Œ
1. ï¼ˆPowerShellã§è‡ªå‹•ï¼‰æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒåˆ¤åˆ¥ã§ããªã„æ—¥æœ¬èªã‚’å«ã‚€ps1ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãªã‚‹ç‚º **Shift-JIS** ã§å®Ÿè¡Œ
1. **<< ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ >>**
    æ–‡å­—ã‚³ãƒ¼ãƒ‰ **UTF-8ã®ps1ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Shift-JISã¨ã—ã¦å®Ÿè¡Œã—ã¦ã—ã¾ã£ãŸç‚º** ã€æ—¥æœ¬èªãŒæ–‡å­—åŒ–ã‘ã—ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ

### Code Runnerã§PowerShellã®å€‹åˆ¥è¨­å®šã‚’è¿½åŠ ï¼ˆå¿…é ˆä½œæ¥­ï¼‰

Code Runnerã®è¨­å®šã§PowerShellã‚’å®Ÿè¡Œã™ã‚‹éš›ã«å€‹åˆ¥ã®å‡¦ç†ã‚’è¿½åŠ ã™ã‚‹ã€‚
å…·ä½“çš„ã«è¿½åŠ ã™ã‚‹å†…å®¹ã¯ä¸‹è¨˜ã®é€šã‚Šã€‚

1. Code Runnerå®Ÿè¡Œæ™‚ã«ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å‹•ä½œã™ã‚‹ã‚ˆã†å¤‰æ›´ï¼ˆå‰è¿°ã«è¨˜è¼‰ã—ãŸå†…å®¹ï¼‰
1. å®Ÿè¡Œæ™‚ã€ä¸€æ™‚çš„ã«ä½œæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’UTF-8 BOMä»˜ãã«å¤‰æ›
    ä¸€æ™‚çš„ã«ä½œæˆã•ã‚Œã‚‹UTF-8ã®ãƒ•ã‚¡ã‚¤ãƒ«ã€Œ`tempCodeRunnerFile.ps1`ã€
    ä¸Šè¨˜ã‚’UTF8 BOMã«å¤‰æ›ã—ãŸãƒ•ã‚¡ã‚¤ãƒ« ã€Œ`tempCodeRunnerFile_utf8bom.ps1`ã€
    ãªãŠã€å¤‰æ›ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜å…ˆã¯ä¸€æ™‚ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã€Œ`$Env:TEMP`ï¼ˆ`C:\Users\ãƒ¦ãƒ¼ã‚¶ãƒ¼å\AppData\Local\Temp`ï¼‰ ã€ã«ä¿å­˜ã™ã‚‹ã€‚
1. å¤‰æ›å¾Œã€Code Runnerã§ä¸€æ™‚çš„ã«ä½œæˆã•ã‚ŒãŸUTF-8ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤
1. UTF-8 BOMã«å¤‰æ›ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’PowerShellã§å®Ÿè¡Œ

#### settings.jsonã®è¨­å®šå†…å®¹

1. VS Codeã®è¨­å®šç”»é¢ã‚’é–‹ã
    ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼æ“ä½œ  ï¼š`Ctrl + ,ï¼ˆã‚«ãƒ³ãƒï¼‰`
    ç”»é¢æ“ä½œ                ï¼š`ãƒ•ã‚¡ã‚¤ãƒ«(F)` â†’ `ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®š` â†’ `è¨­å®š    Ctrl + ,`ã‚’é¸æŠ
1. è¨­å®šã§æ¤œç´¢æ¬„ã§`code-runner executor map`ã¨å…¥åŠ›
1. è¨­å®šé …ç›® `Code-runner: Executor Map` ã«ã‚ã‚‹ãƒªãƒ³ã‚¯ã€Œ `settings.jsonã§ç·¨é›†` ã€ã‚’ã‚¯ãƒªãƒƒã‚¯

    :::details Code-runner: Executor Map ã®ã€Œ settings.jsonã§ç·¨é›† ã€ã«ã‚ˆã‚‹å¤‰åŒ–ç‚¹ <ã‚¯ãƒªãƒƒã‚¯ã§æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ã>

    ```diff json:Code-runner: Executor Map ã®ã€Œ settings.jsonã§ç·¨é›† ã€ã§è¿½åŠ ã•ã‚Œã‚‹è¨­å®š
    {
        "python.linting.flake8Enabled": true,
        "editor.fontFamily": "'BIZ UDã‚´ã‚·ãƒƒã‚¯', Consolas, 'Courier New', monospace",
        "extensions.ignoreRecommendations": true,
        "[python]": {
            "editor.formatOnType": true
        },
        "code-runner.runInTerminal": true
    +    "code-runner.executorMap": {
    +        
    +        "javascript": "node",
    +        "java": "cd $dir && javac $fileName && java $fileNameWithoutExt",
    +        "c": "cd $dir && gcc $fileName -o $fileNameWithoutExt && $dir$fileNameWithoutExt",
    +        "zig": "zig run",
    +        "cpp": "cd $dir && g++ $fileName -o $fileNameWithoutExt && $dir$fileNameWithoutExt",
    +        "objective-c": "cd $dir && gcc -framework Cocoa $fileName -o $fileNameWithoutExt && $dir$fileNameWithoutExt",
    +        "php": "php",
    +        "python": "python -u",
    +        "perl": "perl",
    +        "perl6": "perl6",
    +        "ruby": "ruby",
    +        "go": "go run",
    +        "lua": "lua",
    +        "groovy": "groovy",
    +        "powershell": "powershell -ExecutionPolicy ByPass -File",
    +        "bat": "cmd /c",
    +        "shellscript": "bash",
    +        "fsharp": "fsi",
    +        "csharp": "scriptcs",
    +        "vbscript": "cscript //Nologo",
    +        "typescript": "ts-node",
    +        "coffeescript": "coffee",
    +        "scala": "scala",
    +        "swift": "swift",
    +        "julia": "julia",
    +        "crystal": "crystal",
    +        "ocaml": "ocaml",
    +        "r": "Rscript",
    +        "applescript": "osascript",
    +        "clojure": "lein exec",
    +        "haxe": "haxe --cwd $dirWithoutTrailingSlash --run $fileNameWithoutExt",
    +        "rust": "cd $dir && rustc $fileName && $dir$fileNameWithoutExt",
    +        "racket": "racket",
    +        "scheme": "csi -script",
    +        "ahk": "autohotkey",
    +        "autoit": "autoit3",
    +        "dart": "dart",
    +        "pascal": "cd $dir && fpc $fileName && $dir$fileNameWithoutExt",
    +        "d": "cd $dir && dmd $fileName && $dir$fileNameWithoutExt",
    +        "haskell": "runghc",
    +        "nim": "nim compile --verbosity:0 --hints:off --run",
    +        "lisp": "sbcl --script",
    +        "kit": "kitc --run",
    +        "v": "v run",
    +        "sass": "sass --style expanded",
    +        "scss": "scss --style expanded",
    +        "less": "cd $dir && lessc $fileName $fileNameWithoutExt.css",
    +        "FortranFreeForm": "cd $dir && gfortran $fileName -o $fileNameWithoutExt && $dir$fileNameWithoutExt",
    +        "fortran-modern": "cd $dir && gfortran $fileName -o $fileNameWithoutExt && $dir$fileNameWithoutExt",
    +        "fortran_fixed-form": "cd $dir && gfortran $fileName -o $fileNameWithoutExt && $dir$fileNameWithoutExt",
    +        "fortran": "cd $dir && gfortran $fileName -o $fileNameWithoutExt && $dir$fileNameWithoutExt",
    +        "sml": "cd $dir && sml $fileName",
    +        "mojo": "mojo run"
    +    }
    }
    ```

    :::

1. settings.jsonã§powershellã®æ¬„ã‚’å€‹åˆ¥ã«å¤‰æ›´ã™ã‚‹

    ```diff json:UTF-8 BOMã®å¤‰æ›å‡¦ç†ã‚’è¿½åŠ ã—ãŸsettings.json
    {
        // ï½ çœç•¥ ï½ //
        
        "code-runner.runInTerminal": true,
        "code-runner.executorMap": {

            "javascript": "node",
            "java": "cd $dir && javac $fileName && java $fileNameWithoutExt",
            "c": "cd $dir && gcc $fileName -o $fileNameWithoutExt && $dir$fileNameWithoutExt",
            "zig": "zig run",
            "cpp": "cd $dir && g++ $fileName -o $fileNameWithoutExt && $dir$fileNameWithoutExt",
            "objective-c": "cd $dir && gcc -framework Cocoa $fileName -o $fileNameWithoutExt && $dir$fileNameWithoutExt",
            "php": "php",
            "python": "python -u",
            "perl": "perl",
            "perl6": "perl6",
            "ruby": "ruby",
            "go": "go run",
            "lua": "lua",
            "groovy": "groovy",
    -         "powershell": "powershell -ExecutionPolicy ByPass -File",
            // Windowsæ¨™æº–ã®PowerShell 5.1.x ã®å ´åˆ
    +         "powershell": "cd $dir && Get-Content -Encoding utf8BOM .\\$fileName | Out-File -Encoding utf8BOM $Env:TEMP\\tempCodeRunnerFile_utf88BOM.ps1 && Remove-Item .\\$fileName -Force && powershell -ExecutionPolicy ByPass -File $Env:TEMP\\tempCodeRunnerFile_utf88BOM.ps1",
            // PowerShell Core ã®å ´åˆï¼ˆç§ã®å ´åˆã€7.3.8ï¼‰
    +         "powershell": "cd $dir && Get-Content -Encoding utf8BOM .\\$fileName | Out-File -Encoding utf8BOM $Env:TEMP\\tempCodeRunnerFile_utf88BOM.ps1 && Remove-Item .\\$fileName -Force && pwsh -ExecutionPolicy ByPass -File $Env:TEMP\\tempCodeRunnerFile_utf88BOM.ps1",
            "bat": "cmd /c",
            "shellscript": "bash",
            "fsharp": "fsi",
            "csharp": "scriptcs",
            "vbscript": "cscript //Nologo",
            "typescript": "ts-node",
            "coffeescript": "coffee",
            "scala": "scala",
            "swift": "swift",
            "julia": "julia",
            "crystal": "crystal",
            "ocaml": "ocaml",
            "r": "Rscript",
            "applescript": "osascript",
            "clojure": "lein exec",
            "haxe": "haxe --cwd $dirWithoutTrailingSlash --run $fileNameWithoutExt",
            "rust": "cd $dir && rustc $fileName && $dir$fileNameWithoutExt",
            "racket": "racket",
            "scheme": "csi -script",
            "ahk": "autohotkey",
            "autoit": "autoit3",
            "dart": "dart",
            "pascal": "cd $dir && fpc $fileName && $dir$fileNameWithoutExt",
            "d": "cd $dir && dmd $fileName && $dir$fileNameWithoutExt",
            "haskell": "runghc",
            "nim": "nim compile --verbosity:0 --hints:off --run",
            "lisp": "sbcl --script",
            "kit": "kitc --run",
            "v": "v run",
            "sass": "sass --style expanded",
            "scss": "scss --style expanded",
            "less": "cd $dir && lessc $fileName $fileNameWithoutExt.css",
            "FortranFreeForm": "cd $dir && gfortran $fileName -o $fileNameWithoutExt && $dir$fileNameWithoutExt",
            "fortran-modern": "cd $dir && gfortran $fileName -o $fileNameWithoutExt && $dir$fileNameWithoutExt",
            "fortran_fixed-form": "cd $dir && gfortran $fileName -o $fileNameWithoutExt && $dir$fileNameWithoutExt",
            "fortran": "cd $dir && gfortran $fileName -o $fileNameWithoutExt && $dir$fileNameWithoutExt",
            "sml": "cd $dir && sml $fileName",
            "mojo": "mojo run"
        }

        // ï½ çœç•¥ ï½ //
    }
    ```

### è¨­å®šå¤‰æ›´å¾Œã«ç¯„å›²é¸æŠã§å®Ÿè¡Œã—ãŸçµæœ

ã€Œ **å‡ºåŠ›å…ˆã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«è¨­å®š** ã€ã¨ ã€Œ **Code Runnerã§PowerShellã®å€‹åˆ¥è¨­å®šã‚’è¿½åŠ ** ã€
![ã€Œå‡ºåŠ›å…ˆã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«è¨­å®šã€ã¨ã€ŒCode Runnerã§PowerShellã®å€‹åˆ¥è¨­å®šã‚’è¿½åŠ ã€ã«ã‚ˆã‚ŠCode Runnerã®å€‹åˆ¥å®Ÿè¡ŒãŒæ­£å¸¸å‹•ä½œã—ã¦Windowsãƒ•ã‚©ãƒ¼ãƒ ãŒè¡¨ç¤ºã•ã‚ŒãŸ](https://storage.googleapis.com/zenn-user-upload/4514cdef87cb-20231031.png)
*ç”»åƒï¼šCode Runnerã®å€‹åˆ¥å®Ÿè¡ŒãŒæ­£å¸¸å‹•ä½œã—ã¦Windowsãƒ•ã‚©ãƒ¼ãƒ ãŒè¡¨ç¤º*

## å‚è€ƒæƒ…å ±

- Code Runner å…¨ä½“çš„ãªèª¬æ˜
    <https://qiita.com/take_me/items/6a1d2d417889837219d1>
- Code Runner å®Ÿè¡Œã™ã‚‹ã¨æ–‡å­—åŒ–ã‘ã—ã¦ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆ
    <https://beiyan-tool.info/?p=962>
- Code Runner æ‹¡å¼µå­ã”ã¨ã®å€‹åˆ¥è¨­å®šã§å‚è€ƒ
    <https://dianxnao.com/visual-studio-codeã§cè¨€èªãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’å§‹ã‚ã‚‹ï¼ˆwindowsç·¨ï¼‰/#toc8>
- PowerShell Get-Contentã‚³ãƒãƒ³ãƒ‰ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰
    <https://www.ipentec.com/document/powershell-get-content-specify-encoding>
- PowerShell Out-Fileã‚³ãƒãƒ³ãƒ‰
    <https://hardsofttalk.seesaa.net/article/202106article_1.html>
- PowerShell ä¸€æ™‚ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®å ´æ‰€ã‚’å–å¾—
    <https://www.tekizai.net/entry/powershell_TemporaryFile>

## ã¾ã¨ã‚

- Code Runner ã‚’å°å…¥ã™ã‚‹äº‹ã§é¸æŠç¯„å›²ã®ã‚³ãƒ¼ãƒ‰ã®ã¿å®Ÿè¡Œã™ã‚‹äº‹ãŒå¯èƒ½
- Code Runner ã§ã¯æ‹¡å¼µå­ï¼ˆè¨€èªï¼‰æ¯ã«å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹äº‹ãŒå¯èƒ½
- ä»Šå›æ¤œè¨¼ã—ãŸPowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã¯æ—¥æœ¬èªãŒå«ã¾ã‚Œã¦ã„ãŸäº‹ã«ã‚ˆã‚ŠPowerShellã§è‡ªå‹•çš„ã«Shift-JISã¨ã—ã¦å‡¦ç†ã•ã‚Œæ–‡å­—åŒ–ã‘ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ãŸ
- Code Runner ã§å®Ÿè¡Œæ™‚ã«ç”Ÿæˆã•ã‚Œã‚‹ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’UTF-8 BOMã«å¤‰æ›ã™ã‚‹äº‹ã§æ­£å¸¸å‹•ä½œã—ãŸ

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
