---
title: "[PowerShell]Markdownã®ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã§å„åˆ—ã®å¹…ã‚’æƒãˆã‚‹Function"
emoji: "ğŸ“˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---
## æ¦‚è¦

åˆ—ã®å¹…ãŒãƒãƒ©ãƒãƒ©ã«ãªã£ã¦ã„ã‚‹Markdownã®ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã®é–‹å§‹ä½ç½®ã‚’åŠè§’ã‚¹ãƒšãƒ¼ã‚¹ã§æ•´é “ã™ã‚‹Funcitonã‚’ä½œæˆã€‚

```powershell:
Function Format-MarkdownTableColumnWidth {
    param (
        [System.String]$FilePath
    )

    # ãƒãƒ«ãƒãƒã‚¤ãƒˆæ–‡å­—ã‚’è€ƒæ…®ã—ã¦æ–‡å­—åˆ—ã®ãƒã‚¤ãƒˆæ•°ã‚’è¨ˆç®—ã™ã‚‹é–¢æ•°
    function Get-ByteLength {
        param (
            [string]$InputString
        )
        $length = 0
        foreach ($char in $InputString.ToCharArray()) {
            if ([System.Text.Encoding]::UTF8.GetByteCount($char) -gt 1) {
                $length += 2
            } else {
                $length += 1
            }
        }
        return $length
    }

    # ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å…¥åŠ›ã‚’èª­ã¿è¾¼ã‚€
    $MarkdownTable = (Get-Content -Path $FilePath -Raw)

    # å…¥åŠ›ã‚’è¡Œã”ã¨ã«åˆ†å‰²
    $lines = $MarkdownTable -split "`n"

    # å„åˆ—ã®æœ€å¤§å¹…ã‚’è¨ˆç®—
    $maxWidths = @{}
    foreach ($line in $lines) {
        if ($line.Trim() -eq "") { continue } # ç©ºè¡Œã‚’ç„¡è¦–
        $columns = $line -split '\|'
        for ($i = 1; $i -lt $columns.Length - 1; $i++) {
            $column = $columns[$i].Trim()
            $byteLength = Get-ByteLength $column
            if (-not $maxWidths.ContainsKey($i)) {
                $maxWidths[$i] = $byteLength
            } else {
                if ($byteLength -gt $maxWidths[$i]) {
                    $maxWidths[$i] = $byteLength
                }
            }
        }
    }

    # åˆ—ã®å¹…ã‚’æƒãˆã¦å†æ§‹ç¯‰
    $alignedTable = @()
    foreach ($line in $lines) {
        if ($line.Trim() -eq "") { continue } # ç©ºè¡Œã‚’ç„¡è¦–
        $columns = $line -split '\|'
        $newLine = "|"
        for ($i = 1; $i -lt $columns.Length - 1; $i++) {
            $column = $columns[$i].Trim()
            $padding = " " * ($maxWidths[$i] - (Get-ByteLength $column))
            $newLine += " " + $column + $padding + " |"
        }
        $alignedTable += $newLine
    }

    # ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚ŒãŸ$è¨˜å·ã‚’å…ƒã«æˆ»ã™
    $alignedTable = $alignedTable -join "`r`n" -replace '\\\$', '\$'
    
    return $alignedTable
}

# å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®š
$inputFilePath = "D:\Downloads\input_markdowntable.md"
$outputFilePath = "D:\Downloads\output_markdowntable.md"

# é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦çµæœã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›
Format-MarkdownTableColumnWidth $inputFilePath > $outputFilePath
```

```markdown:å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã€Œinput_markdowntable.mdã€
| ãƒ©ãƒ³ã‚­ãƒ³ã‚° | ãƒ‰ãƒ¡ã‚¤ãƒ³å       | ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ‘ãƒ¯ãƒ¼ | ã‚µã‚¤ãƒˆèª¬æ˜ | é‹å–¶ä¼šç¤¾       | æœ¬ç¤¾æ‰€åœ¨åœ° | æ ªä¾¡ (2024å¹´7æœˆ22æ—¥) |
|------------|------------------|----------------|------------|----------------|------------|----------------------|
| 1          | [google.com](https://www.google.com)              | 100            | æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã€åºƒå‘Šã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ | [Alphabet Inc.](https://ja.wikipedia.org/wiki/Alphabet)  | ã‚¢ãƒ¡ãƒªã‚«   | \$181.67             |
| 2          | [youtube.com](https://www.youtube.com)            | 99             | å‹•ç”»å…±æœ‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  | [Alphabet Inc.](https://ja.wikipedia.org/wiki/Alphabet)  | ã‚¢ãƒ¡ãƒªã‚«   | \$181.67             |
| 3          | [facebook.com](https://www.facebook.com)          | 98             | ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹ | [Meta Platforms, Inc.](https://ja.wikipedia.org/wiki/Meta_%28ä¼æ¥­%29) | ã‚¢ãƒ¡ãƒªã‚«   | \$487.40             |
| 4          | [twitter.com](https://www.twitter.com)            | 97             | ãƒã‚¤ã‚¯ãƒ­ãƒ–ãƒ­ã‚°ã‚µãƒ¼ãƒ“ã‚¹ | [X Corp.](https://ja.wikipedia.org/wiki/X_%282023å¹´å‰µæ¥­ã®ä¼æ¥­%29)        | ã‚¢ãƒ¡ãƒªã‚«   | éå…¬é–‹               |
| 5          | [instagram.com](https://www.instagram.com)        | 96             | å†™çœŸãƒ»å‹•ç”»å…±æœ‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  | [Meta Platforms, Inc.](https://ja.wikipedia.org/wiki/Meta_(ä¼æ¥­)) | ã‚¢ãƒ¡ãƒªã‚«   | \$487.40             |

```

```markdown:å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã€Œoutput_markdowntable.mdã€
| ãƒ©ãƒ³ã‚­ãƒ³ã‚°   | ãƒ‰ãƒ¡ã‚¤ãƒ³å                                         | ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ‘ãƒ¯ãƒ¼   | ã‚µã‚¤ãƒˆèª¬æ˜                                   | é‹å–¶ä¼šç¤¾                                                                              | æœ¬ç¤¾æ‰€åœ¨åœ°   | æ ªä¾¡ (2024å¹´7æœˆ22æ—¥)   |
| ------------ | ------------------                                 | ---------------- | ------------                                 | ----------------                                                                      | ------------ | ---------------------- |
| 1            | [google.com](https://www.google.com)               | 100              | æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã€åºƒå‘Šã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹         | [Alphabet Inc.](https://ja.wikipedia.org/wiki/Alphabet)                               | ã‚¢ãƒ¡ãƒªã‚«     | \$181.67               |
| 2            | [youtube.com](https://www.youtube.com)             | 99               | å‹•ç”»å…±æœ‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ                      | [Alphabet Inc.](https://ja.wikipedia.org/wiki/Alphabet)                               | ã‚¢ãƒ¡ãƒªã‚«     | \$181.67               |
| 3            | [facebook.com](https://www.facebook.com)           | 98               | ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹           | [Meta Platforms, Inc.](https://ja.wikipedia.org/wiki/Meta_%28ä¼æ¥­%29)                 | ã‚¢ãƒ¡ãƒªã‚«     | \$487.40               |
| 4            | [twitter.com](https://www.twitter.com)             | 97               | ãƒã‚¤ã‚¯ãƒ­ãƒ–ãƒ­ã‚°ã‚µãƒ¼ãƒ“ã‚¹                       | [X Corp.](https://ja.wikipedia.org/wiki/X_%282023å¹´å‰µæ¥­ã®ä¼æ¥­%29)                     | ã‚¢ãƒ¡ãƒªã‚«     | éå…¬é–‹                 |
| 5            | [instagram.com](https://www.instagram.com)         | 96               | å†™çœŸãƒ»å‹•ç”»å…±æœ‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ                | [Meta Platforms, Inc.](https://ja.wikipedia.org/wiki/Meta_(ä¼æ¥­))                     | ã‚¢ãƒ¡ãƒªã‚«     | \$487.40               |

```
