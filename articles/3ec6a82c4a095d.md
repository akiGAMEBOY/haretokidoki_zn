---
title: "[PowerShell]Markdownã®ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã§å„åˆ—ã®å¹…ã‚’æƒãˆã‚‹Function"
emoji: "ðŸ“˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---
## æ¦‚è¦

åˆ—ã®å¹…ãŒãƒãƒ©ãƒãƒ©ã«ãªã£ã¦ã„ã‚‹Markdownã®ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã®é–‹å§‹ä½ç½®ã‚’åŠè§’ã‚¹ãƒšãƒ¼ã‚¹ã§æ•´é “ã™ã‚‹Funcitonã‚’ä½œæˆã€‚

```powershell:
Function Format-MarkdownTableColumnWidth {
    param (
        [System.String]$MarkdownTable
    )
    # å…¥åŠ›ã‚’è¡Œã”ã¨ã«åˆ†å‰²
    $lines = $MarkdownTable -split "`n"

    # å„åˆ—ã®æœ€å¤§å¹…ã‚’è¨ˆç®—
    $maxWidths = @{}
    foreach ($line in $lines) {
        $columns = $line -split '\|'
        for ($i = 1; $i -lt $columns.Length - 1; $i++) {
            $column = $columns[$i].Trim()
            if (-not $maxWidths.ContainsKey($i)) {
                $maxWidths[$i] = $column.Length
            } else {
                if ($column.Length -gt $maxWidths[$i]) {
                    $maxWidths[$i] = $column.Length
                }
            }
        }
    }

    # åˆ—ã®å¹…ã‚’æƒãˆã¦å†æ§‹ç¯‰
    $alignedTable = @()
    foreach ($line in $lines) {
        $columns = $line -split '\|'
        $newLine = "|"
        for ($i = 1; $i -lt $columns.Length - 1; $i++) {
            $column = $columns[$i].Trim()
            $newLine += " " + $column.PadRight($maxWidths[$i]) + " |"
        }
        $alignedTable += $newLine
    }
    
    return $alignedTable -join "`n"
}

$markdownTable = @"
| ãƒ©ãƒ³ã‚­ãƒ³ã‚° | ãƒ‰ãƒ¡ã‚¤ãƒ³å       | ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ‘ãƒ¯ãƒ¼ | ã‚µã‚¤ãƒˆèª¬æ˜Ž | é‹å–¶ä¼šç¤¾       | æœ¬ç¤¾æ‰€åœ¨åœ° | æ ªä¾¡ (2024å¹´7æœˆ22æ—¥) |
|------------|------------------|----------------|------------|----------------|------------|----------------------|
| 1          | [google.com](https://www.google.com)              | 100            | æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã€åºƒå‘Šã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ | [Alphabet Inc.](https://ja.wikipedia.org/wiki/Alphabet)  | ã‚¢ãƒ¡ãƒªã‚«   | \$181.67             |
| 2          | [youtube.com](https://www.youtube.com)            | 99             | å‹•ç”»å…±æœ‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  | [Alphabet Inc.](https://ja.wikipedia.org/wiki/Alphabet)  | ã‚¢ãƒ¡ãƒªã‚«   | \$181.67             |
| 3          | [facebook.com](https://www.facebook.com)          | 98             | ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹ | [Meta Platforms, Inc.](https://ja.wikipedia.org/wiki/Meta_%28ä¼æ¥­%29) | ã‚¢ãƒ¡ãƒªã‚«   | \$487.40             |
| 4          | [twitter.com](https://www.twitter.com)            | 97             | ãƒžã‚¤ã‚¯ãƒ­ãƒ–ãƒ­ã‚°ã‚µãƒ¼ãƒ“ã‚¹ | [X Corp.](https://ja.wikipedia.org/wiki/X_%282023å¹´å‰µæ¥­ã®ä¼æ¥­%29)        | ã‚¢ãƒ¡ãƒªã‚«   | éžå…¬é–‹               |
| 5          | [instagram.com](https://www.instagram.com)        | 96             | å†™çœŸãƒ»å‹•ç”»å…±æœ‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  | [Meta Platforms, Inc.](https://ja.wikipedia.org/wiki/Meta_(ä¼æ¥­)) | ã‚¢ãƒ¡ãƒªã‚«   | \$487.40             |
| 6          | [wikipedia.org](https://www.wikipedia.org)        | 95             | ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ç™¾ç§‘äº‹å…¸ | [Wikimedia](https://ja.wikipedia.org/wiki/ã‚¦ã‚£ã‚­ãƒ¡ãƒ‡ã‚£ã‚¢è²¡å›£)      | ã‚¢ãƒ¡ãƒªã‚«   | éžå–¶åˆ©               |
| 7          | [amazon.com](https://www.amazon.com)              | 94             | é›»å­å•†å–å¼•ã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° | [Amazon.com, Inc.](https://ja.wikipedia.org/wiki/Amazon.com)| ã‚¢ãƒ¡ãƒªã‚«   | \$182.55             |
"@

Format-MarkdownTableColumnWidth $markdownTable > D:\Downloads\format_markdowntable.txt
```