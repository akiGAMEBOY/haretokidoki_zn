---
title: "ã„ã¾ã•ã‚‰PowerShellå…¬å¼ã®é–‹ç™ºã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’èª­ã‚“ã§ã¿ãŸ"
emoji: "ğŸ’¨"
type: "idea" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---
## æ¦‚è¦

æœ€è¿‘ã€PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚„Functionã‚’è‡ªä½œã—ãŸã‚Šã™ã‚‹ã†ãˆã§ã€å‘½åè¦å‰‡ã‚’ã©ã®ã‚ˆã†ã«è¨­å®šã™ã¹ãã‹ã€
ãã®éƒ½åº¦ã€è¿·ã„ãªãŒã‚‰å¯¾å¿œ

PowerShellã®è¨˜è¿°

## ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆé–‹ç™ºã«å¿…è¦ãªã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®åå‰ã¯ã€Œ "å‹•è©"`-`"åè©" ã€ãŒåŸºæœ¬ã«ãªã‚‹ã“ã¨ã€‚

### å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®å‹•è©ä¸€è¦§

ãƒã‚¤ãƒ•ãƒ³ã®å‰ã§æŒ‡å®šã™ã‚‹ "å‹•è©" ã¯åŸºæœ¬çš„ã«å…¬å¼ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ä¸‹è¨˜ã®ä¸­ã‹ã‚‰é¸æŠã—ãŸæ–¹ãŒã‚ˆã•ãã†ã€‚

|å®šç¾©ã•ã‚Œã¦ã„ã‚‹å ´æ‰€|å‹•è©|æ—¥æœ¬èªè¨³|
|---|---|---|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Add|è¿½åŠ ã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Clear|ã‚¯ãƒªã‚¢ã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Close|é–‰ã˜ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Copy|ã‚³ãƒ”ãƒ¼ã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Enter|å…¥åŠ›ã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Exit|çµ‚äº†ã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Find|è¦‹ã¤ã‘ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Format|ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Get|å–å¾—ã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Hide|éš ã™|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Join|å‚åŠ ã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Lock|ãƒ­ãƒƒã‚¯ã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Move|ç§»å‹•ã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|New|æ–°è¦|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Open|é–‹ã|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Optimize|æœ€é©åŒ–ã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Pop|ãƒãƒƒãƒ—|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Push|ãƒ—ãƒƒã‚·ãƒ¥|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Redo|ã‚„ã‚Šç›´ã™|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Remove|å‰Šé™¤ã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Rename|åå‰ã‚’å¤‰æ›´ã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Reset|ãƒªã‚»ãƒƒãƒˆã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Resize|ã‚µã‚¤ã‚ºã‚’å¤‰æ›´ã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Search|æ¤œç´¢ã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Select|é¸æŠã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Set|è¨­å®šã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Show|è¡¨ç¤ºã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Skip|ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Split|åˆ†å‰²ã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Step|ã‚¹ãƒ†ãƒƒãƒ—|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Switch|åˆ‡ã‚Šæ›¿ãˆã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Undo|å…ƒã«æˆ»ã™|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Unlock|ã‚¢ãƒ³ãƒ­ãƒƒã‚¯ã™ã‚‹|
|[VerbsCommon](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbscommon)|Watch|è¦‹ã‚‹|
|[VerbsCommunications](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsCommunications)|Connect|æ¥ç¶šã™ã‚‹|
|[VerbsCommunications](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsCommunications)|Disconnect|åˆ‡æ–­ã™ã‚‹|
|[VerbsCommunications](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsCommunications)|Read|èª­ã‚€|
|[VerbsCommunications](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsCommunications)|Receive|å—ã‘å–ã‚‹|
|[VerbsCommunications](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsCommunications)|Send|é€ã‚‹|
|[VerbsCommunications](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsCommunications)|Write|æ›¸ã|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Checkpoint|ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Compare|æ¯”è¼ƒã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Compress|åœ§ç¸®ã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Convert|å¤‰æ›ã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|ConvertFrom|ã‹ã‚‰å¤‰æ›ã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|ConvertTo|ã«å¤‰æ›ã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Dismount|å–ã‚Šå¤–ã™|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Edit|ç·¨é›†ã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Expand|æ‹¡å¤§ã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Export|ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Group|ã‚°ãƒ«ãƒ¼ãƒ—|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Import|ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Initialize|åˆæœŸåŒ–ã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Limit|åˆ¶é™ã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Merge|çµ±åˆã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Mount|ãƒã‚¦ãƒ³ãƒˆã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Out|ã‚¢ã‚¦ãƒˆ|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Publish|å…¬é–‹ã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Restore|å¾©å…ƒã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Save|ä¿å­˜ã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Sync|åŒæœŸã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Unpublish|éå…¬é–‹ã«ã™ã‚‹|
|[VerbsData](https://learn.microsoft.com/ja-jp/dotnet/api/system.management.automation.verbsdata)|Update|æ›´æ–°ã™ã‚‹|
|[VerbsDiagnostic](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsDiagnostic)|Debug|ãƒ‡ãƒãƒƒã‚°ã™ã‚‹|
|[VerbsDiagnostic](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsDiagnostic)|Measure|æ¸¬å®šã™ã‚‹|
|[VerbsDiagnostic](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsDiagnostic)|Ping|ç–é€šã™ã‚‹|
|[VerbsDiagnostic](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsDiagnostic)|Repair|ä¿®ç†ã™ã‚‹|
|[VerbsDiagnostic](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsDiagnostic)|Resolve|è§£æ±ºã™ã‚‹|
|[VerbsDiagnostic](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsDiagnostic)|Test|ãƒ†ã‚¹ãƒˆã™ã‚‹|
|[VerbsDiagnostic](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsDiagnostic)|Trace|ãƒˆãƒ¬ãƒ¼ã‚¹ã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Approve|æ‰¿èªã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Assert|ä¸»å¼µã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Build|æ§‹ç¯‰ã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Complete|å®Œäº†ã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Confirm|ç¢ºèªã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Deny|å¦å®šã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Deploy|å±•é–‹ã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Disable|ç„¡åŠ¹ã«ã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Enable|æœ‰åŠ¹ã«ã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Install|ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Invoke|å‘¼ã³å‡ºã™|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Register|ç™»éŒ²ã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Request|è¦æ±‚ã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Restart|å†èµ·å‹•ã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Resume|å†é–‹ã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Start|é–‹å§‹ã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Stop|åœæ­¢ã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Submit|æå‡ºã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Suspend|ä¸€æ™‚åœæ­¢ã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Uninstall|ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Unregister|ç™»éŒ²è§£é™¤ã™ã‚‹|
|[VerbsLifeCycle](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsLifeCycle)|Wait|å¾…ã¤|
|[VerbsSecurity](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsSecurity)|Block|ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹|
|[VerbsSecurity](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsSecurity)|Grant|ä»˜ä¸ã™ã‚‹|
|[VerbsSecurity](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsSecurity)|Protect|ä¿è­·ã™ã‚‹|
|[VerbsSecurity](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsSecurity)|Revoke|å–ã‚Šæ¶ˆã™|
|[VerbsSecurity](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsSecurity)|Unblock|ãƒ–ãƒ­ãƒƒã‚¯ã‚’è§£é™¤ã™ã‚‹|
|[VerbsSecurity](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsSecurity)|Unprotect|ä¿è­·ã‚’è§£é™¤ã™ã‚‹|
|[VerbsOther](https://learn.microsoft.com/ja-jp/dotnet/api/System.Management.Automation.VerbsOther)|Use|ä½¿ç”¨ã™ã‚‹|

### ã‚·ã‚¹ãƒ†ãƒ ã‚’å¤‰æ›´ã™ã‚‹æ“ä½œãŒç™ºç”Ÿã™ã‚‹å‰ã«ç¢ºèªã‚’æ±‚ã‚ã‚‹

ç‰¹å®šã®ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆ`System.Management.Automation.Cmdlet.ShouldProcess`ï¼‰ã¤ã¾ã‚Šã¯ã€ä¸‹è¨˜ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã®ã“ã¨ã‚’æŒ‡ã™ã€‚

```powershell:

```

ä¸Šè¨˜ã®çŠ¶æ³ã‚’ç®¡ç†è€…æ¨©é™ãŒãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§å®Ÿè¡Œã—ãŸã‚Šã€ã‚³ãƒãƒ³ãƒ‰ã®å¼•æ•°ã§ã€Œ-Confirmã€ã‚’ä»˜ä¸ã™ã‚‹ã¨ã€
ä»¥ä¸‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºåŠ›ã•ã‚Œã‚‹ã€‚

```
```

:::details ConfirmImpactã®ãƒ¬ãƒ™ãƒ«ã«ã¤ã„ã¦
PowerShellã®`ConfirmImpact`å±æ€§ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå€¤ã‚’è¨­å®šã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ï¼š

- **None**: ã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹éš›ã«ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèªã‚’æ±‚ã‚ã¾ã›ã‚“ã€‚
- **Low**: ä½ã„å½±éŸ¿ã‚’æŒã¤ã‚³ãƒãƒ³ãƒ‰ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèªã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
- **Medium**: ä¸­ç¨‹åº¦ã®å½±éŸ¿ã‚’æŒã¤ã‚³ãƒãƒ³ãƒ‰ã§ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®`$ConfirmPreference`è¨­å®šã§ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèªã‚’æ±‚ã‚ã¾ã™ã€‚
- **High**: é«˜ã„å½±éŸ¿ã‚’æŒã¤ã‚³ãƒãƒ³ãƒ‰ã§ã€ã»ã¨ã‚“ã©ã®å ´åˆã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèªã‚’æ±‚ã‚ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ã“ã‚Œã‚‰ã®å€¤ã¯ã€ã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹å‰ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèªã‚’æ±‚ã‚ã‚‹ã‹ã©ã†ã‹ã€ãŠã‚ˆã³ãã®ç¢ºèªã‚’æ±‚ã‚ã‚‹é–¾å€¤ã‚’æ±ºå®šã—ã¾ã™ã€‚`$ConfirmPreference`å¤‰æ•°ã®è¨­å®šå€¤ãŒ`ConfirmImpact`ã®å€¤ã‚ˆã‚Šã‚‚ä½ã„ã‹ç­‰ã—ã„å ´åˆã€PowerShellã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèªã‚’æ±‚ã‚ã¾ã™ã€‚ä¾‹ãˆã°ã€`$ConfirmPreference`ãŒ`Medium`ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€`ConfirmImpact`ãŒ`Medium`ã¾ãŸã¯`High`ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€PowerShellã¯å®Ÿè¡Œå‰ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèªã‚’æ±‚ã‚ã¾ã™Â¹Â³â´ã€‚

å…·ä½“çš„ãªå¤‰åŒ–ç‚¹ã«ã¤ã„ã¦ã¯ã€`ConfirmImpact`ã®å€¤ã«ã‚ˆã£ã¦ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚„é–¢æ•°ãŒå®Ÿè¡Œã•ã‚Œã‚‹å‰ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèªã‚’æ±‚ã‚ã‚‹ã‹ã©ã†ã‹ãŒå¤‰ã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€`High`ã«è¨­å®šã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ã¯ã€é‡è¦ãªã‚·ã‚¹ãƒ†ãƒ å¤‰æ›´ã‚„ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤ãªã©ã€å¤§ããªå½±éŸ¿ã‚’åŠã¼ã™å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€ã»ã¨ã‚“ã©ã®å ´åˆã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèªã‚’æ±‚ã‚ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ä¸€æ–¹ã§ã€`Low`ã«è¨­å®šã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ã¯ã€æ¯”è¼ƒçš„å½±éŸ¿ãŒå°‘ãªã„ãŸã‚ã€ç¢ºèªã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹ã“ã¨ã¯å°‘ãªããªã‚Šã¾ã™Â¹Â³â´ã€‚

ã“ã®æ©Ÿèƒ½ã‚’é©åˆ‡ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒäºˆæœŸã›ã¬å½±éŸ¿ã‚’åŠã¼ã™ã“ã¨ã‚’é˜²ãã“ã¨ãŒã§ãã¾ã™ã€‚è©³ç´°ãªè¨­å®šæ–¹æ³•ã‚„ä½¿ç”¨ä¾‹ã«ã¤ã„ã¦ã¯ã€Microsoftã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚„PowerShellã®ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ•ã‚©ãƒ¼ãƒ©ãƒ ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚ã“ã‚Œã‚‰ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’é€šã˜ã¦ã€`ConfirmImpact`å±æ€§ã®é©åˆ‡ãªä½¿ç”¨æ–¹æ³•ã‚’å­¦ã¶ã“ã¨ãŒã§ãã¾ã™ã€‚

ã‚½ãƒ¼ã‚¹: Copilot ã¨ã®ä¼šè©±ã€ 2024/6/21
(1) Confirm, $ConfirmPreference, and ConfirmImpact in PowerShell. https://4sysops.com/archives/confirm-confirmpreference-and-confirmimpact-in-powershell/.
(2) Investigating ConfirmImpact (Part 1: User Perspective). https://blog.idera.com/database-tools/powershell/powertips/investigating-confirmimpact-part-1-user-perspective/.
(3) Proper use of ConfirmImpact and a Force parameter. https://forums.powershell.org/t/proper-use-of-confirmimpact-and-a-force-parameter/9982.
(4) Powershell Cmdlet with 'dynamic' ConfirmImpact attribute setting. https://stackoverflow.com/questions/37488778/powershell-cmdlet-with-dynamic-confirmimpact-attribute-setting.
:::

---

åŸºæœ¬çš„ã«ã¯ã€é ­æ–‡å­—ã‚’å¤§æ–‡å­—åŒ–ï¼ˆã‚­ãƒ£ãƒ”ã‚¿ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã‹

Functionã®å‘½åè¦å‰‡ã¯ã€"å‹•è©"-"åè©"ãŒåŸºæœ¬ã€‚
æ—¢å­˜ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®å‹•è©ã‚’ç¢ºèªã—ã¦ã€å®Ÿç¾ã—ãŸã„äº‹ã¨åˆã†å‹•è©ãŒã‚ã‚Œã°ã€æ—¢å­˜ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®å‹•è©ã«åˆã‚ã›ã¦å‘½åã—ãŸæ–¹ãŒã‚ˆã„ã€‚
ï¼ˆãŸã¨ãˆã°ã€ãƒã‚§ãƒƒã‚¯ã—ãŸçµæœã€Boolå‹ãŒæˆ»ã‚Šå€¤ã®Funcitonã®å ´åˆã¯ã€Test-XXXXãªã©ï¼‰

function ã‚„ param -or -and -not ãªã©ã®æœ€åˆã¯å°æ–‡å­—ã¨ã™ã‚‹ã€‚ãŸã ã—ã€-notã‚’å®šç¾©ã™ã‚‹å ´åˆã®ã¿-Notã¨ã™ã‚‹ã€‚
ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’è¨˜è¿°ã™ã‚‹å ´åˆã€å‰å¾Œã«ã‚¹ãƒšãƒ¼ã‚¹ã‚’è¨­ã‘ãŸæ–¹ãŒå¯èª­æ€§ãŒã‚ˆã„ã€‚
ãŸã ã—ã€ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ãŒå…ˆé ­ã‚„æ–‡æœ«ã®å ´åˆã¯ã€å…ˆé ­ä½ç½®ã¨æœ€çµ‚ä½ç½®ã«ã¯ã‚¹ãƒšãƒ¼ã‚¹ã‚’å…¥ã‚Œãªã„ã€‚

å¼•æ•°ã®å¤‰æ•°åã¯æœ€åˆã‚’å¤§æ–‡å­—ã¨ã™ã‚‹ã€‚

é–¢æ•°å†…ã§ã®å¤‰æ•°åã¯å¤§æ–‡å­—ã‹å°æ–‡å­—ã‹

å®šæ•°ã‚„é…åˆ—ã€ãƒªã‚¹ãƒˆã€ãã®ä»–ç‰¹æ®Šã‚±ãƒ¼ã‚¹ã®å®šç¾©æ–¹æ³•ã€‚

è‡ªå‹•å¤‰æ•°ã®éš›ã¯ã€æœ€åˆã¯å¤§æ–‡å­—

## å‚è€ƒæƒ…å ±

https://learn.microsoft.com/ja-jp/powershell/scripting/developer/cmdlet/required-development-guidelines
https://learn.microsoft.com/ja-jp/powershell/scripting/developer/cmdlet/advisory-development-guidelines
https://learn.microsoft.com/ja-jp/powershell/scripting/developer/cmdlet/strongly-encouraged-development-guidelines

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
https://zenn.dev/haretokidoki/articles/fb6830f9155de5
