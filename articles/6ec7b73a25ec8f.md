---
title: "Windows PowerShell 6.0.0ä»¥é™ã‚’ã‚³ãƒžãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•"
emoji: "ðŸ”®"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["windows", "powershell"]
published: false
---

Windowsã§ã¯ã€æ¨™æº–ã®PowerShell 5.1ã‚ˆã‚Šã‚‚æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’æŽ¨å¥¨ã—ã¦ã„ã¾ã™ã€‚
å®Ÿéš›ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ç‰ˆã®PowerShellã‚’ä½¿ã£ã¦ã¿ã¿ã‚‹ã¨ã€å‡¦ç†æ™‚é–“ãŒçŸ­ç¸®ã—ãŸã‚Šæ©Ÿèƒ½ãŒå¼·åŒ–ã•ã‚ŒãŸã‚Šã¨ã€
ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã®ãƒ¡ãƒªãƒƒãƒˆã‚’å®Ÿæ„Ÿã—ã‚„ã™ã„ã§ã™ã€‚

é€šå¸¸ã¯Microsoft Store ã‚¢ãƒ—ãƒªã«å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã€Œ[PowerShellã‚¢ãƒ—ãƒª](https://apps.microsoft.com/detail/9MZ1SNWT0N5D)ã€ ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•ãŒåºƒãçŸ¥ã‚‰ã‚Œã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ãŒã€
ä»Šå›žã¯ã‚³ãƒžãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•ã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚

ã‚³ãƒžãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãƒ¡ãƒªãƒƒãƒˆã¨ã—ã¦ã¯ã€å‡¦ç†æ™‚é–“ã®é«˜é€ŸåŒ–ã‚„æŒ‡å®šã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãªã©ãŒä¸Šã’ã‚‰ã‚Œã¾ã™ã€‚
ã¾ãŸã€åˆ‡ã‚Šæˆ»ã—ã¨ã—ã¦ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚‚ã‚³ãƒžãƒ³ãƒ‰ã§è¡Œãˆã‚‹ã®ã§ã‚ã‚ã›ã¦ç´¹ä»‹ã—ã¾ã™ã€‚

ä»Šå›žã¯ ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’Windowsã«æ¨™æº–ã§å…¥ã£ã¦ã„ã‚‹ Windows PowerShellï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ 5.1.0ï¼‰PowerShell Coreï¼ˆ6.0.0 ï½ž 6.2.6ï¼‰ã‚‚ã—ãã¯PowerShellï¼ˆ7.0.0ä»¥é™ï¼‰ã‚’ã‚³ãƒžãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- Windows PowerShell 5.1ã‚ˆã‚Šã‚‚å¤§ãã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆ6.0.0ä»¥é™ï¼‰ã‚’å°Žå…¥ã—ãŸã„æ–¹
    - ãƒãƒ¼ã‚¸ãƒ§ãƒ³6.0.0 ï½ž 6.2.6ï¼šPowerShell Core
    - ãƒãƒ¼ã‚¸ãƒ§ãƒ³7.0.0ä»¥é™     ï¼šPowerShell
- å°Žå…¥æ–¹æ³•ã‚’CLIï¼ˆã‚³ãƒžãƒ³ãƒ‰ãƒ»ã‚³ãƒžãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆï¼‰ã§è¡Œã„ãŸã„æ–¹

## å¯¾å¿œæ–¹æ³•

### äº‹å‰è¨­å®šï¼šãƒ•ã‚©ãƒ³ãƒˆã¨æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´

ã‚³ãƒžãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•ã¯å¤šå²ã«æ¸¡ã‚Šã¾ã™ãŒã€ä»Šå›žã¯`winget`ã¨ã„ã†ã‚³ãƒžãƒ³ãƒ‰ã‚’ä½¿ã£ã¦ä½œæ¥­ã‚’è¡Œã„ã¾ã™ã€‚
`winget`ã‚³ãƒžãƒ³ãƒ‰ã«ã¯ä¸‹è¨˜2ç‚¹ã®æ³¨æ„ç‚¹ãŒã‚ã‚Šã¾ã™ã€‚

- `winget`ã‚³ãƒžãƒ³ãƒ‰çµæžœã¯ã€æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒã€ŒUTF-8ã€ã§å‡ºåŠ›ã•ã‚Œã‚‹ã“ã¨
- Windows PowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ãƒ•ã‚©ãƒ³ãƒˆã¯æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒ`UTF-8`ã§å‡ºåŠ›ã•ã‚Œã‚‹ãŸã‚ã€æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¨ãƒ•ã‚©ãƒ³ãƒˆã®è¨­å®šã‚’å¤‰æ›´

åˆæœŸå€¤ã§ã¯æ—¥æœ¬èªžã®UTF-8ã«å¯¾å¿œãŠã‚‰ãšã€ãã®ã¾ã¾`winget`ã‚³ãƒžãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã—ã¾ã†ã¨æ–‡å­—åŒ–ã‘ãŒç™ºç”Ÿã—ã¦ã—ã¾ã†ã®ã§ã€
ã‚ã‚‰ã‹ã˜ã‚è¨­å®šå¤‰æ›´ã—ã¾ã™ã€‚

#### ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã®å¤‰æ›´

![Windows PowerShell ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼](https://storage.googleapis.com/zenn-user-upload/4e8b4aa47a7c-20250317.png)

1. ã‚¹ã‚¿ãƒ¼ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ "Windows PowerShell" ã‚’é¸æŠžã—èµ·å‹•
1. Windows PowerShell ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ ã®ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼ã‚’å³ã‚¯ãƒªãƒƒã‚¯
1. ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆã¾ãŸã¯ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼‰ã‚ˆã‚Šã€Œãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã€ã‚’é¸æŠž
   å…ƒã®ã‚µã‚¤ã‚ºã«æˆ»ã™(R)
ã€€ ç§»å‹•(M)
ã€€ ã‚µã‚¤ã‚ºå¤‰æ›´(S)
ã€€ æœ€å°åŒ–(N)
ã€€ æœ€å¤§åŒ–(X)
ã€€ é–‰ã˜ã‚‹(C)
ã€€ ç·¨é›†(E)
ã€€ è¦å®šå€¤(D)
ã€€ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£(P) ðŸ‘ˆ ã“ã‚Œã‚’é¸æŠž
1. "ãƒ•ã‚©ãƒ³ãƒˆã‚¿ãƒ–" ã«ã‚ã‚‹ `ãƒ•ã‚©ãƒ³ãƒˆ(F)` ã§ ã€Œ`ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯`ã€orã€Œ`BIZ UDã‚´ã‚·ãƒƒã‚¯`ã€ã‚’è¨­å®š

1. OKãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

:::details ä¸Šè¨˜ã®GUIæ“ä½œã‚’ã™ã¹ã¦ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼ã§å¯¾å¿œã™ã‚‹æ–¹æ³•

1. ã€ŒâŠžWinã‚­ãƒ¼ ï¼‹ Rã€ã§"ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æŒ‡å®šã—ã¦å®Ÿè¡Œ"ã‚’èµ·å‹•
1. "ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æŒ‡å®šã—ã¦å®Ÿè¡Œ"ã®`åå‰(O)`æ¬„ã«ã€Œpowershellã€ã‚’å…¥åŠ›ã—Enterã‚­ãƒ¼
1. ï¼ˆWindows PowerShell ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ ãŒèµ·å‹•ã—ãŸã“ã¨ã‚’ç¢ºèªï¼‰
1. ã€ŒAlt + ã‚¹ãƒšãƒ¼ã‚¹ã€ã§Windows PowerShell ã®ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã
    ï¼ˆPowerToysã‚’å°Žå…¥ã—ã¦ã„ã‚‹å ´åˆã¯ã€[PowerToys Run](https://learn.microsoft.com/ja-jp/windows/powertoys/run)ãŒèµ·å‹•ã—ã¦ã—ã¾ã†ã®ã§ç„¡åŠ¹åŒ–ãŒå¿…è¦ï¼‰

1. ã€ŒPã€ã‚’å…¥åŠ›ã—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¡¨ç¤º

1. ã€ŒAlt ï¼‹ Fã€ã§ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«

1. æŒ‡å®šã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é¸æŠž

1. Enterã‚­ãƒ¼ã§è¨­å®šãŒåæ˜ 

:::

#### æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´


    

Windows 

## ã‚³ãƒžãƒ³ãƒ‰ã§PowerShellã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•

### Windows PowerShellã®ãƒ•ã‚©ãƒ³ãƒˆã‚’å¤‰æ›´

æ—¥æœ¬èªžã§ã®wingetã‚³ãƒžãƒ³ãƒ‰ã¯æ–‡å­—ã‚³ãƒ¼ãƒ‰UTF-8ã®æ—¥æœ¬èªžã‚’å‡ºåŠ›ã—ã¾ã™ã€‚
ãã®ãŸã‚ã€ä¸‹è¨˜ã®ä½œæ¥­ã‚’å®Ÿæ–½ã—ãªã„ã¨å‡ºåŠ›ã•ã‚Œã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ–‡å­—åŒ–ã‘ã—ã¦ã—ã¾ã†ã®ã§æ³¨æ„ï¼

:::details ä¸Šè¨˜ã‚’ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œã§å¯¾å¿œã™ã‚‹æ–¹æ³•

1. ã€ŒWinã‚­ãƒ¼ ï¼‹ Rã€ã§ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æŒ‡å®šã—ã¦å®Ÿè¡Œã‚’èµ·å‹•

1. åå‰(O)æ¬„ã«ã€Œpowershellã€ã¨å…¥åŠ›ã—Enterã‚­ãƒ¼

1. ï¼ˆWindows PowerShell ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒèµ·å‹•ã—ãŸã“ã¨ã‚’ç¢ºèªï¼‰

1. Alt + ã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼ ã§ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã
   ï¼ˆPowerToysã‚’å°Žå…¥ã—ã¦ã„ã‚‹å ´åˆã¯ã€PowerToysRunãŒèµ·å‹•ã—ã¦ã—ã¾ã†ã€‚ï¼‰

1. ã€ŒPã€ã‚’å…¥åŠ›ã—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¡¨ç¤º

1. ã€ŒAlt ï¼‹ Fã€ã§ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«

1. æŒ‡å®šã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é¸æŠž

1. Enterã‚­ãƒ¼ã§è¨­å®šãŒåæ˜ 

:::


```powershell
# ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’UTF-8ã«è¨­å®š
[Console]::OutputEncoding = [System.Text.Encoding]::UTF8
```

### ä½•ã‚‚æŒ‡å®šã›ãšã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

:::message
**æ–‡å­—åŒ–ã‘ã™ã‚‹å ´åˆ**

å‰è¿°ã—ã¦ã„ã‚‹[ãƒ•ã‚©ãƒ³ãƒˆã¨æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´](#äº‹å‰è¨­å®šï¼šãƒ•ã‚©ãƒ³ãƒˆã¨æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´)ã‚’å‚ç…§ã—ã€wingetã‚³ãƒžãƒ³ãƒ‰ãŒæ­£å¸¸ã«è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚
:::

```powershell
# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã‚³ãƒžãƒ³ãƒ‰
winget install --id Microsoft.PowerShell
```

**å®Ÿéš›ã«å®Ÿè¡Œã—ãŸçµæžœ**

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¶å¾¡ãŒè¡¨ç¤ºã•ã‚ŒãŸå ´åˆã¯ã€Œã¯ã„ã€

```powershell
```

ã¯ã˜ã‚ã¦wingetã‚³ãƒžãƒ³ãƒ‰ã§PowerShellã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸå ´åˆã¯ã€ä¸‹è¨˜2ç‚¹ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚
- Windows Package Manager Source (winget) V2
- PowerShell 7-x64

**ã™ã§ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å ´åˆ**

```powershell
PS C:\Users\XXXX> winget install --id Microsoft.PowerShell
æ—¢å­˜ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒæ—¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸...ã‚’ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™
åˆ©ç”¨å¯èƒ½ãªã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
æ§‹æˆã•ã‚ŒãŸã‚½ãƒ¼ã‚¹ã‹ã‚‰å…¥æ‰‹ã§ãã‚‹æ–°ã—ã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
PS C:\Users\XXXX>
```

wingetã‚’ä½¿ç”¨ã™ã‚‹ç‚ºã«ã¯ã€Microsoft Store ã‚¢ãƒ—ãƒªã®ã€Œã‚¢ãƒ—ãƒª ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã€ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ã€‚
æ‰‹å‹•ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãªãã¦ã‚‚è‡ªå‹•ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹ã¯ãšã€‚

### ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®æŒ‡å®šã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```powershell
winget install --id Microsoft.PowerShell --version "æŒ‡å®šã™ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³"
```

:::details ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä¸€è¦§è¡¨ç¤ºã™ã‚‹æ–¹æ³•

```powershell:ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸€è¦§ã‚’å–å¾—ã™ã‚‹ã‚³ãƒžãƒ³ãƒ‰
winget show --id Microsoft.PowerShell --versions
```

```powershell:wingetã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¡¨ç¤ºï¼ˆï¼‰
PS C:\Users\XXXX> winget show --id Microsoft.PowerShell --versions
ã‚½ãƒ¼ã‚¹ã‚’æ›´æ–°ã§ãã¾ã›ã‚“ã§ã—ãŸ: winget
ã‚½ãƒ¼ã‚¹ã®æ¤œç´¢ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ;çµæžœã¯å«ã¾ã‚Œã¾ã›ã‚“: msstore
è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ PowerShell [Microsoft.PowerShell]
ãƒãƒ¼ã‚¸ãƒ§ãƒ³
----------
7.5.0.0
7.4.7.0
7.4.6.0
7.4.5.0
7.4.4.0
7.4.3.0
7.4.2.0
7.4.1.0
7.4.0.0
7.3.11.0
7.3.10.0
7.3.9.0
7.3.8.0
7.3.7.0
7.3.6.0
7.3.5.0
7.3.4.0
7.3.3.0
7.3.2.0
7.3.1.0
7.3.0.0
7.2.24.0
7.2.23.0
7.2.22.0
7.2.21.0
7.2.18.0
7.2.17.0
7.2.16.0
7.2.14.0
7.2.13.0
7.2.12.0
7.2.10.0
7.2.9.0
7.2.8.0
7.2.7.0
7.2.6.0
7.2.5.0
7.2.4.0
7.2.3.0
7.2.2.0
7.2.1.0
7.2.0.0
7.1.5.0
7.1.4.0
7.1.3.0
7.1.2.0
7.1.1.0
7.1.0.0
7.0.13.0
7.0.8.0
7.0.6.0
7.0.5.0
7.0.4.0
7.0.3.0
7.0.2.0
7.0.1.0
7.0.0.0
6.2.6.0
6.2.5.0
6.2.4.0
6.2.3.0
6.2.2.0
6.2.1.0
6.2.0.0
6.1.6.0
6.1.5.0
6.1.4.0
6.1.3.0
6.1.2.0
6.1.1.0
6.1.0.0
6.0.5.0
6.0.4.0
6.0.3.0
6.0.2.0
6.0.1.0
6.0.0.0
PS C:\Users\XXXX>
```

:::

### Functionã§å®Ÿè¡Œ

```powershell:Function
Function Install-PowerShell {
    param (
        [Parameter(Mandatory = $false)]
        [string]$Id = "Microsoft.PowerShell"
    )

    $statusCode = 0

    # ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’UTF-8ã«è¨­å®š
    [Console]::OutputEncoding = [System.Text.Encoding]::UTF8

    Write-Host "åˆ©ç”¨å¯èƒ½ãª PowerShell ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªä¸­..." -ForegroundColor Cyan
    $wingetOutput = (winget show --id $Id --versions | Out-String)

    if (-Not $wingetOutput) {
        Write-Error "winget ã‚³ãƒžãƒ³ãƒ‰ãŒå®Ÿè¡Œã§ããªã„ã‹ã€PowerShell ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚"
        $statusCode = -11
        return $statusCode
    }

    # ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸€è¦§ã®ã¿æŠœç²‹
    $lines = ($wingetOutput -split "`r?`n")
    $availableVersions = ($lines -replace "\s+", "" | Where-Object { $_ -ne "" -and $_ -match "^\d" } | Sort-Object)
    # `$lines -replace "\s+", ""`                       â€¦ ä½™åˆ†ãªç©ºç™½æ–‡å­—ã‚’æ¶ˆã™
    # `Where-Object { $_ -ne "" -and $_ -match "^\d" }` â€¦ ç©ºè¡Œã‚’å‰Šé™¤ã—ã€æ•°å­—ã§å§‹ã¾ã‚‹è¡Œã®ã¿ã‚’æŠœç²‹
    # `Sort-Object`                                     â€¦ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã‚’æ˜‡é †ã«ä¸¦ã³æ›¿ãˆ
    
    if (-Not $availableVersions) {
        Write-Error "åˆ©ç”¨å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚"
        $statusCode = -21
        return $statusCode
    }

    Write-Host "ä»¥ä¸‹ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒé¸æŠžå¯èƒ½ã§ã™:" -ForegroundColor Green
    $availableVersions | ForEach-Object { Write-Host $_ }

    # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å…¥åŠ›ã•ã›ã‚‹ï¼ˆç©ºã®å ´åˆã¯æœ€æ–°ç‰ˆã‚’ä½¿ç”¨ï¼‰
    $selectedVersion = Read-Host "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆç©ºã®å ´åˆã¯æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’é¸æŠžï¼‰"

    if (-Not $selectedVersion) {
        # æœ€æ–°ç‰ˆã‚’è‡ªå‹•é¸æŠž
        $selectedVersion = $availableVersions[-1]
        Write-Host "æœ€æ–°ç‰ˆ '$selectedVersion' ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚" -ForegroundColor Yellow
    } elseif (-Not ($availableVersions -contains $selectedVersion)) {
        Write-Error "æŒ‡å®šã•ã‚ŒãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ '$selectedVersion' ã¯åˆ©ç”¨å¯èƒ½ãªãƒªã‚¹ãƒˆã«ãªãé¸æŠžã§ãã¾ã›ã‚“ã€‚"
        $statusCode = -31
        return $statusCode
    }

    Write-Host "PowerShell ãƒãƒ¼ã‚¸ãƒ§ãƒ³ $selectedVersion ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™..." -ForegroundColor Cyan
    (winget install --id $Id --version $selectedVersion --silent | Out-String)

    if ($LASTEXITCODE -eq 0) {
        Write-Host "PowerShell ãƒãƒ¼ã‚¸ãƒ§ãƒ³ $selectedVersion ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå®Œäº†ã—ã¾ã—ãŸã€‚" -ForegroundColor Green
    } else {
        Write-Error "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚"
        $statusCode = -41
        return $statusCode
    }

    return $statusCode
}

# å®Ÿè¡Œä¾‹
$statusCode = Install-PowerShell
Write-Output "çµ‚äº†ã‚³ãƒ¼ãƒ‰: $statusCode"
Write-Output "Enterã‚­ãƒ¼ã§çµ‚äº†ã—ã¾ã™ã€‚"
Read-Host > $null
```

## ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```
winget list --id Microsoft.PowerShell

```

```powershell:ã‚ã‚‹å ´åˆ
PS C:\Users\XXXX> winget list --id Microsoft.PowerShell
å…¥åŠ›æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
PS C:\Users\XXXX>
```

```powershell:ãªã„å ´åˆ
PS C:\Users\XXXX> winget list --id Microsoft.PowerShell
å…¥åŠ›æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
PS C:\Users\XXXX>
PS C:\Users\XXXX> $LASTEXITCODE
-1978335212
PS C:\Users\XXXX>
```

```
winget uninstall --id Microsoft.PowerShell

```
