---
title: "Windows PowerShell 6.0.0ä»¥é™ã‚’ã‚³ãƒžãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•"
emoji: "ðŸ¦”"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["windows", "powershell"]
published: false
---

Windowsã§ã¯ã€PowerShell 5.1ã‚ˆã‚Šã‚‚æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’æŽ¨å¥¨ã—ã¦ã„ã¾ã™ã€‚
å®Ÿéš›ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ç‰ˆã®PowerShellã‚’ä½¿ã£ã¦ã¿ã‚‹ã¨ã€å‡¦ç†æ™‚é–“ãŒçŸ­ç¸®ã—ãŸã‚Šæ©Ÿèƒ½ãŒå¼·åŒ–ã•ã‚ŒãŸã‚Šãªã©ã€
æ©Ÿèƒ½å¼·åŒ–ã‚’å®Ÿæ„Ÿã§ãã‚‹ã§ã—ã‚‡ã†ã€‚

PowerShellã®6.0.0ä»¥é™ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å ´åˆã¯ã€ä»¥å‰ã¯æ™‚é–“ãŒã‹ã‹ã£ã¦ã„ãŸå‡¦ç†ã‚‚ã¿ãŸæ„Ÿè§¦ã‚‚æ©Ÿèƒ½ãŒå¼·åŒ–ã•ã‚ŒãŸã‚Šã€macOSã‚„Linuxç’°å¢ƒã§ã‚‚å‹•ä½œã™ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚

ä»Šå›žã¯ ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’Windowsã«æ¨™æº–ã§å…¥ã£ã¦ã„ã‚‹ Windows PowerShellï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ 5.1.0ï¼‰PowerShell Coreï¼ˆ6.0.0 ï½ž 6.2.6ï¼‰ã‚‚ã—ãã¯PowerShellï¼ˆ7.0.0ä»¥é™ï¼‰ã‚’ã‚³ãƒžãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•

## ã‚³ãƒžãƒ³ãƒ‰ã§PowerShellã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•

### Windows PowerShellã®ãƒ•ã‚©ãƒ³ãƒˆã‚’å¤‰æ›´

æ—¥æœ¬èªžã§ã®wingetã‚³ãƒžãƒ³ãƒ‰ã¯æ–‡å­—ã‚³ãƒ¼ãƒ‰UTF-8ã®æ—¥æœ¬èªžã‚’å‡ºåŠ›ã—ã¾ã™ã€‚
ãã®ãŸã‚ã€ä¸‹è¨˜ã®ä½œæ¥­ã‚’å®Ÿæ–½ã—ãªã„ã¨å‡ºåŠ›ã•ã‚Œã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ–‡å­—åŒ–ã‘ã—ã¦ã—ã¾ã†ã®ã§æ³¨æ„ï¼

Windows PowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼ã‚’å³ã‚¯ãƒªãƒƒã‚¯
â†’ å…ƒã®ã‚µã‚¤ã‚ºã«æˆ»ã™(R)
ã€€ ç§»å‹•(M)
ã€€ ã‚µã‚¤ã‚ºå¤‰æ›´(S)
ã€€ æœ€å°åŒ–(N)
ã€€ æœ€å¤§åŒ–(X)
ã€€ é–‰ã˜ã‚‹(C)
ã€€ ç·¨é›†(E)
ã€€ è¦å®šå€¤(D)
ã€€ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£(P) ðŸ‘ˆ é¸æŠž

ãƒ•ã‚©ãƒ³ãƒˆã‚¿ãƒ– â†’ ãƒ•ã‚©ãƒ³ãƒˆã€Œï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯ã€orã€ŒBIZ UDã‚´ã‚·ãƒƒã‚¯ã€

:::details ä¸Šè¨˜ã‚’ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œã§å¯¾å¿œã™ã‚‹æ–¹æ³•

1. ã€ŒWinã‚­ãƒ¼ ï¼‹ Rã€ã§ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æŒ‡å®šã—ã¦å®Ÿè¡Œã‚’èµ·å‹•

1. åå‰(O)æ¬„ã«ã€Œpowershellã€ã¨å…¥åŠ›ã—Enterã‚­ãƒ¼

1. ï¼ˆWindows PowerShell ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒèµ·å‹•ã—ãŸã“ã¨ã‚’ç¢ºèªï¼‰

1. Alt + ã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼ ã§ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã
   ï¼ˆPowerToysã‚’å°Žå…¥ã—ã¦ã„ã‚‹å ´åˆã¯ã€PowerToysRunãŒèµ·å‹•ã—ã¦ã—ã¾ã†ã€‚ï¼‰

1. ã€ŒPã€ã‚’å…¥åŠ›ã—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¡¨ç¤º

1. ã€ŒAlt ï¼‹ Fã€ã§ãƒ•ã‚©ãƒ³ãƒˆè¨­å®šã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«

1. æŒ‡å®šã®ãƒ•ã‚©ãƒ³ãƒˆã‚’é¸æŠž

1. Enterã‚­ãƒ¼ã§è¨­å®šãŒåæ˜ 

:::


```powershell
# ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’UTF-8ã«è¨­å®š
[Console]::OutputEncoding = [System.Text.Encoding]::UTF8
```

### ä½•ã‚‚æŒ‡å®šã›ãšã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```powershell
# ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’UTF-8ã«è¨­å®š
[Console]::OutputEncoding = [System.Text.Encoding]::UTF8
# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã‚³ãƒžãƒ³ãƒ‰
winget install --id Microsoft.PowerShell
```

**å®Ÿéš›ã«å®Ÿè¡Œã—ãŸçµæžœ**

```powershell
```

**ã™ã§ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å ´åˆ**

```powershell
PS C:\Users\XXXX> winget install --id Microsoft.PowerShell
æ—¢å­˜ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒæ—¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸...ã‚’ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™
åˆ©ç”¨å¯èƒ½ãªã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
æ§‹æˆã•ã‚ŒãŸã‚½ãƒ¼ã‚¹ã‹ã‚‰å…¥æ‰‹ã§ãã‚‹æ–°ã—ã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
PS C:\Users\XXXX>
```

wingetã‚’ä½¿ç”¨ã™ã‚‹ç‚ºã«ã¯ã€Microsoft Store ã‚¢ãƒ—ãƒªã®ã€Œã‚¢ãƒ—ãƒª ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã€ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ã€‚
æ‰‹å‹•ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãªãã¦ã‚‚è‡ªå‹•ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹ã¯ãšã€‚

### ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®æŒ‡å®šã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```powershell
winget install --id Microsoft.PowerShell --version "æŒ‡å®šã™ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³"
```

:::details ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä¸€è¦§è¡¨ç¤ºã™ã‚‹æ–¹æ³•

```powershell:ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸€è¦§ã‚’å–å¾—ã™ã‚‹ã‚³ãƒžãƒ³ãƒ‰
winget show --id Microsoft.PowerShell --versions
```

```powershell:wingetã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¡¨ç¤ºï¼ˆï¼‰
PS C:\Users\XXXX> winget show --id Microsoft.PowerShell --versions
ã‚½ãƒ¼ã‚¹ã‚’æ›´æ–°ã§ãã¾ã›ã‚“ã§ã—ãŸ: winget
ã‚½ãƒ¼ã‚¹ã®æ¤œç´¢ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ;çµæžœã¯å«ã¾ã‚Œã¾ã›ã‚“: msstore
è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ PowerShell [Microsoft.PowerShell]
ãƒãƒ¼ã‚¸ãƒ§ãƒ³
----------
7.5.0.0
7.4.7.0
7.4.6.0
7.4.5.0
7.4.4.0
7.4.3.0
7.4.2.0
7.4.1.0
7.4.0.0
7.3.11.0
7.3.10.0
7.3.9.0
7.3.8.0
7.3.7.0
7.3.6.0
7.3.5.0
7.3.4.0
7.3.3.0
7.3.2.0
7.3.1.0
7.3.0.0
7.2.24.0
7.2.23.0
7.2.22.0
7.2.21.0
7.2.18.0
7.2.17.0
7.2.16.0
7.2.14.0
7.2.13.0
7.2.12.0
7.2.10.0
7.2.9.0
7.2.8.0
7.2.7.0
7.2.6.0
7.2.5.0
7.2.4.0
7.2.3.0
7.2.2.0
7.2.1.0
7.2.0.0
7.1.5.0
7.1.4.0
7.1.3.0
7.1.2.0
7.1.1.0
7.1.0.0
7.0.13.0
7.0.8.0
7.0.6.0
7.0.5.0
7.0.4.0
7.0.3.0
7.0.2.0
7.0.1.0
7.0.0.0
6.2.6.0
6.2.5.0
6.2.4.0
6.2.3.0
6.2.2.0
6.2.1.0
6.2.0.0
6.1.6.0
6.1.5.0
6.1.4.0
6.1.3.0
6.1.2.0
6.1.1.0
6.1.0.0
6.0.5.0
6.0.4.0
6.0.3.0
6.0.2.0
6.0.1.0
6.0.0.0
PS C:\Users\XXXX>
```

:::

## ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```
winget list --id Microsoft.PowerShell

```

```powershell:ã‚ã‚‹å ´åˆ
PS C:\Users\XXXX> winget list --id Microsoft.PowerShell
å…¥åŠ›æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
PS C:\Users\XXXX>
```

```powershell:ãªã„å ´åˆ
PS C:\Users\XXXX> winget list --id Microsoft.PowerShell
å…¥åŠ›æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
PS C:\Users\XXXX>
PS C:\Users\XXXX> $LASTEXITCODE
-1978335212
PS C:\Users\XXXX>
```

```
winget uninstall --id Microsoft.PowerShell

```

$statusCode = 0

# ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’UTF-8ã«è¨­å®š
[Console]::OutputEncoding = [System.Text.Encoding]::UTF8

# åˆ©ç”¨å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ã—ã¦å‡¦ç†ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
Write-Host "åˆ©ç”¨å¯èƒ½ãª PowerShell ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªä¸­..." -ForegroundColor Cyan

# winget ã®çµæžœã‚’UTF-8ã§æ˜Žç¤ºçš„ã«èª­ã¿å–ã‚‹
$wingetOutput = winget show --id Microsoft.PowerShell --versions | Out-String

if (-Not $wingetOutput) {
    Write-Error "winget ã‚³ãƒžãƒ³ãƒ‰ãŒå®Ÿè¡Œã§ããªã„ã‹ã€PowerShell ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚"
    $statusCode = -11
}

if ($statusCode -eq 0) {
	# å‡ºåŠ›ã‚’æ”¹è¡Œã§åˆ†å‰²ã—ã€å…ˆé ­ã®ä¸è¦éƒ¨åˆ†ã‚’é™¤åŽ»
	$lines = $wingetOutput -split "`r?`n"
	$availableVersions = $lines[2..($lines.Length - 1)] -replace "\s+", "" | Where-Object { $_ -ne "" }

	if (-Not $availableVersions) {
	    Write-Error "åˆ©ç”¨å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚"
	    $statusCode = -21
	}
}

if ($statusCode -eq 0) {
	# åˆ©ç”¨å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸€è¦§ã‚’è¡¨ç¤º
	Write-Host "ä»¥ä¸‹ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒåˆ©ç”¨å¯èƒ½ã§ã™:" -ForegroundColor Green
	$availableVersions | ForEach-Object { Write-Host $_ }

	# ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’é¸æŠžã•ã›ã‚‹
	Write-Host "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹: 7.5.0.0ï¼‰"
	$selectedVersion = Read-Host > $null

	# å…¥åŠ›å€¤ãŒæœ‰åŠ¹ã‹ç¢ºèª
	if (-Not ($availableVersions -contains $selectedVersion)) {
	    Write-Error "æŒ‡å®šã•ã‚ŒãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ '$selectedVersion' ã¯åˆ©ç”¨å¯èƒ½ãªãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚"
	    $statusCode = -31
	}
}

if ($statusCode -eq 0) {
	# é¸æŠžã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
	Write-Host "PowerShell ãƒãƒ¼ã‚¸ãƒ§ãƒ³ $selectedVersion ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™..." -ForegroundColor Cyan
	winget install --id Microsoft.PowerShell --version $selectedVersion --silent

	# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
	if ($LASTEXITCODE -eq 0) {
	    Write-Host "PowerShell ãƒãƒ¼ã‚¸ãƒ§ãƒ³ $selectedVersion ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå®Œäº†ã—ã¾ã—ãŸã€‚" -ForegroundColor Green
	} else {
	    Write-Error "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚"
	}
}

Write-Output "Enterã‚­ãƒ¼ã§çµ‚äº†ã—ã¾ã™ã€‚"
Read-Host > $null

exit $statusCode


```powershell:Function
Function Install-PowerShell {
    # PowerShell Coreï¼ˆ6.0.0 ï½ž 6.2.6ï¼‰ã‚‚ã—ãã¯ PowerShellï¼ˆ7.0.0ä»¥é™ï¼‰ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹é–¢æ•°

    param (
        [Parameter(Mandatory = $false)]
        [string]$Id = "Microsoft.PowerShell" # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ID
    )

    $statusCode = 0

    # ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’UTF-8ã«è¨­å®š
    [Console]::OutputEncoding = [System.Text.Encoding]::UTF8

    Write-Host "åˆ©ç”¨å¯èƒ½ãª PowerShell ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªä¸­..." -ForegroundColor Cyan

    # winget ã®çµæžœã‚’UTF-8ã§æ˜Žç¤ºçš„ã«èª­ã¿å–ã‚‹
    $wingetOutput = winget show --id $Id --versions | Out-String

    if (-Not $wingetOutput) {
        Write-Error "winget ã‚³ãƒžãƒ³ãƒ‰ãŒå®Ÿè¡Œã§ããªã„ã‹ã€PowerShell ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚"
        return -11
    }

    # å‡ºåŠ›ã‚’æ”¹è¡Œã§åˆ†å‰²ã—ã€ä¸è¦ãªéƒ¨åˆ†ã‚’é™¤åŽ»
    $lines = $wingetOutput -split "`r?`n"
    $availableVersions = $lines[2..($lines.Length - 1)] -replace "\s+", "" | Where-Object { $_ -ne "" }

    if (-Not $availableVersions) {
        Write-Error "åˆ©ç”¨å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚"
        return -21
    }

    # åˆ©ç”¨å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸€è¦§ã‚’è¡¨ç¤º
    Write-Host "ä»¥ä¸‹ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒåˆ©ç”¨å¯èƒ½ã§ã™:" -ForegroundColor Green
    $availableVersions | ForEach-Object { Write-Host $_ }

    # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’é¸æŠžã•ã›ã‚‹
    $selectedVersion = Read-Host "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹: 7.5.0.0ï¼‰"

    # å…¥åŠ›å€¤ãŒæœ‰åŠ¹ã‹ç¢ºèª
    if (-Not ($availableVersions -contains $selectedVersion)) {
        Write-Error "æŒ‡å®šã•ã‚ŒãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ '$selectedVersion' ã¯åˆ©ç”¨å¯èƒ½ãªãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚"
        return -31
    }

    # é¸æŠžã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
    Write-Host "PowerShell ãƒãƒ¼ã‚¸ãƒ§ãƒ³ $selectedVersion ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™..." -ForegroundColor Cyan
    winget install --id $Id --version $selectedVersion --silent

    # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    if ($LASTEXITCODE -eq 0) {
        Write-Host "PowerShell ãƒãƒ¼ã‚¸ãƒ§ãƒ³ $selectedVersion ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå®Œäº†ã—ã¾ã—ãŸã€‚" -ForegroundColor Green
    } else {
        Write-Error "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚"
        return -41
    }

    # æ­£å¸¸çµ‚äº†ã‚³ãƒ¼ãƒ‰ã‚’è¿”ã™
    return 0
}

# å®Ÿè¡Œä¾‹
$statusCode = Install-PowerShell
Write-Output "çµ‚äº†ã‚³ãƒ¼ãƒ‰: $statusCode"
Write-Output "Enterã‚­ãƒ¼ã§çµ‚äº†ã—ã¾ã™ã€‚"
Read-Host > $null
```
