---
title: "[PowerShell]ワンライナーでコマンド存在チェックし"
emoji: "📝"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---

> # PowerShell
> 
> ### ワンライナー
> `&&`や`||`に対応するものはたぶんない ?
> 
> ### 複数行
> 
> `Get-Command` (`gcm`) コマンドレットを使う.
> 
> ```powershell
> gcm perldoc -ea SilentlyContinue | Out-Null
> if ($? -eq $true) { # コマンドが存在すれば
>     Write-Output 'Success!'
>     perldoc perldoc
> } else {            # コマンドが存在しなければ
>     Write-Error 'Error!'
>     exit 1
> }
> ```
> 
> 簡潔に書くと:
> 
> ```powershell
> if (gcm perldoc -ea SilentlyContinue) { # コマンドが存在すれば
>     Write-Output 'Success!'
>     perldoc perldoc
> } else {                                # コマンドが存在しなければ
>     Write-Error 'Error!'
>     exit 1
> }
> ```
> 
> 引用元：[コマンドが存在するかしないかを判定して, 条件分岐する構文のまとめ](https://qiita.com/skkzsh/items/d63861293fd6bde1b0d8#powershell)

コマンド有無を確認する方法
https://qiita.com/skkzsh/items/d63861293fd6bde1b0d8

PS C:\Users\XXXX> gcm perldoc -ea SilentlyContinue | Out-Null ; if ($?) {Write-Host 'Success'}
PS C:\Users\XXXX>
PS C:\Users\XXXX> gcm perldoc -ea SilentlyContinue | Out-Null ; if (-Not($?)) {Write-Host 'Success'}
Success
PS C:\Users\XXXX>
PS C:\Users\XXXX> gcm perldoc -ea SilentlyContinue | Out-Null ; if (-Not($?)) {Write-Host 'Error'}
Error
PS C:\Users\XXXX>
PS C:\Users\XXXX> gcm perldoc -ea SilentlyContinue | Out-Null ; if (($?)) {Write-Host 'Error'}
PS C:\Users\XXXX>
PS C:\Users\XXXX> gcm perldoc -ea SilentlyContinue | Out-Null ; if (-Not($?)) {Write-Host 'Error'}
Error
PS C:\Users\XXXX>
PS C:\Users\XXXX> gcm perldoc -ea SilentlyContinue | Out-Null | %{Write-Host 'Error'}
PS C:\Users\XXXX>
PS C:\Users\XXXX> gcm dir -ea SilentlyContinue | Out-Null | %{Write-Host 'Error'}
PS C:\Users\XXXX> gcm dir -ea SilentlyContinue | %{Write-Host 'Error'}
Error
PS C:\Users\XXXX>
PS C:\Users\XXXX> gcm perldoc -ea SilentlyContinue | %{Write-Host 'Error'}


PS C:\Users\XXXX> gcm get-command -ea SilentlyContinue | ?{Write-Host 'Error'}
Error
PS C:\Users\XXXX>
PS C:\Users\XXXX> gcm perldoc -ea SilentlyContinue | ?{Write-Host 'Error'}
PS C:\Users\XXXX>


PS C:\Users\XXXX> Get-Command gc -ea SilentlyContinue | ?{write-host 'success'}
success
PS C:\Users\XXXX>

http://www.math.kobe-u.ac.jp/HOME/kodama/tips-powershell-grammar.html
https://stackoverflow.com/questions/39103840/powershell-script-error-cannot-validate-argument-on-parameter-property-cannot


PS C:\Users\XXXX> Find-Command Get-Command -Repository PSGallery | ?{write-host "success"}
success
PS C:\Users\XXXX>
PS C:\Users\XXXX> Find-Command xxxx -Repository PSGallery | ?{write-host "success"}
PS C:\Users\XXXX>

https://learn.microsoft.com/ja-jp/powershell/module/powershellget/find-command


PS C:\Users\XXXX> (Get-Command -Name perldoc -ErrorAction SilentlyContinue) -and (Write-Host 'Success!') | Out-Null
PS C:\Users\XXXX>
PS C:\Users\XXXX> -Not(Get-Command -Name perldoc -ErrorAction SilentlyContinue) -and (Write-Host 'Error!') | Out-Null
Error!
PS C:\Users\XXXX>
PS C:\Users\XXXX>



find-command, get-command の違い