---
title: "[PowerShell]ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã§ã‚³ãƒãƒ³ãƒ‰ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã—æ¡ä»¶åˆ†å²ã•ã›ã‚‹æ–¹æ³•"
emoji: "ğŸŒ "
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell", "cli"]
published: true
---
## æ¦‚è¦

ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚„PowerShellã«ãŠã„ã¦ã‚³ãƒãƒ³ãƒ‰ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã—Trueãƒ»Falseã®çœŸå½ã§æ¡ä»¶åˆ†å²ã™ã‚‹æ–¹æ³•ã‚’[ã“ã¡ã‚‰](https://qiita.com/skkzsh/items/d63861293fd6bde1b0d8#powershell)ã®è¨˜äº‹ã§è¦‹ã¤ã‘ã¾ã—ãŸã€‚
PowerShellã®æ¬„ã‚’ã¿ã‚‹ã¨ã€Œ`&&`ã‚„`||`ã«å¯¾å¿œã™ã‚‹ã‚‚ã®ã¯ã€ãŠãã‚‰ããªã„ã ã‚ã†ã€ã¨ã„ã†è¶£æ—¨ã®è¨˜è¿°ãŒã‚ã‚Šã€
æ·±æ˜ã‚Šã—ã¦èª¿ã¹ã¦ã¿ãŸçµæœã€ã‚„ã‚Šæ–¹ãŒè¦‹ã¤ã‹ã£ãŸã®ã§ç´¹ä»‹ã—ã¾ã™ã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- PowerShellãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- PowerShellã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®å­˜åœ¨æœ‰ç„¡ã«ã‚ˆã‚ŠçœŸå½ï¼ˆTrueãƒ»Falseï¼‰ã§æ¡ä»¶åˆ†å²ã•ã›ãŸã„æ–¹

## ç’°å¢ƒ

```powershell:PowerShellã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³
PS C:\Users\XXXX> $PSVersionTable

Name                           Value
----                           -----
PSVersion                      7.3.8
PSEdition                      Core
GitCommitId                    7.3.8
OS                             Microsoft Windows 10.0.19045
Platform                       Win32NT
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0â€¦}
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1
WSManStackVersion              3.0

PS C:\Users\XXXX>
```

## è¦‹ã¤ã‹ã£ãŸè¨˜äº‹ã®å†…å®¹

å‰è¿°ã—ãŸé€šã‚Šã€[ã“ã¡ã‚‰](https://qiita.com/skkzsh/items/d63861293fd6bde1b0d8)ã§ShellScriptï¼ˆã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼‰ã‚„ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å§‹ã‚ã¨ã™ã‚‹ç’°å¢ƒã§ã€
ã‚³ãƒãƒ³ãƒ‰ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã‚’è¡Œã„å­˜åœ¨æœ‰ç„¡ã®çµæœã€Trueãƒ»Falseã®çœŸå½ã§å‡¦ç†ã‚’åˆ†å²ã•ã›ã‚‹æ–¹æ³•ãŒç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚

ãã®å†…ã€[PowerShellã®ç®‡æ‰€](https://qiita.com/skkzsh/items/d63861293fd6bde1b0d8#powershell)ã§ä»¥ä¸‹ã®ã‚ˆã†ã«ç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚

> \# PowerShell
> 
> \### ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼
> `&&`ã‚„`||`ã«å¯¾å¿œã™ã‚‹ã‚‚ã®ã¯ãŸã¶ã‚“ãªã„ ?
> 
> \### è¤‡æ•°è¡Œ
> 
> `Get-Command` (`gcm`) ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ã†.
> 
> ```powershell
> gcm perldoc -ea SilentlyContinue | Out-Null
> if ($? -eq $true) { # ã‚³ãƒãƒ³ãƒ‰ãŒå­˜åœ¨ã™ã‚Œã°
>     Write-Output 'Success!'
>     perldoc perldoc
> } else {            # ã‚³ãƒãƒ³ãƒ‰ãŒå­˜åœ¨ã—ãªã‘ã‚Œã°
>     Write-Error 'Error!'
>     exit 1
> }
> ```
> 
> ç°¡æ½”ã«æ›¸ãã¨:
> 
> ```powershell
> if (gcm perldoc -ea SilentlyContinue) { # ã‚³ãƒãƒ³ãƒ‰ãŒå­˜åœ¨ã™ã‚Œã°
>     Write-Output 'Success!'
>     perldoc perldoc
> } else {                                # ã‚³ãƒãƒ³ãƒ‰ãŒå­˜åœ¨ã—ãªã‘ã‚Œã°
>     Write-Error 'Error!'
>     exit 1
> }
> ```
> 
> å¼•ç”¨å…ƒï¼š[ã‚³ãƒãƒ³ãƒ‰ãŒå­˜åœ¨ã™ã‚‹ã‹ã—ãªã„ã‹ã‚’åˆ¤å®šã—ã¦, æ¡ä»¶åˆ†å²ã™ã‚‹æ§‹æ–‡ã®ã¾ã¨ã‚ - PowerShell](https://qiita.com/skkzsh/items/d63861293fd6bde1b0d8#powershell)

è¤‡æ•°è¡Œã§ã‚‚å®Ÿç¾ã§ãã‚‹ç‚ºã€ã‚ãˆã¦ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã§ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€
æœ¬å½“ã«ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã§å®Ÿç¾ã™ã‚‹æ–¹æ³•ãŒãªã„ã®ã‹æ°—ã«ãªã£ãŸã®ã§æ·±æ˜ã‚Šã—ã¦èª¿ã¹ã¦ã¿ã¾ã—ãŸã€‚
ï¼ˆå€‹äººçš„ã«ã¯ã€å¯èª­æ€§ã‚’è€ƒãˆã‚‹ã¨ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã‚ˆã‚Šã‚‚è¤‡æ•°è¡ŒãŒè‰¯ã„ã¨æ€ã£ã¦ã„ã¾ã™ã€‚ï¼‰

## å¯¾å¿œæ–¹æ³•

[ã“ã¡ã‚‰](https://www.vwnet.jp/windows/PowerShell/Ope/OpeListg.htm)ã®è¨˜äº‹ã«ã‚ã‚‹è¦‹å‡ºã—ã€Œè«–ç†æ¼”ç®—ã€ã®æ¬„ã§ã€Œ `&&` ã¯ `-and` ã€ã€Œ `||` ã¯ `-or` ã€ã¨ç´¹ä»‹ã•ã‚Œã¦ã„ãŸã®ã§ã€
ã€Œ `-and` ã€ã‚’ä½¿ã£ã¦ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½œã£ã¦ã¿ã¾ã—ãŸã€‚

:::: message
**æœ¬è¨˜äº‹ã«ãŠã‘ã‚‹ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ï¼ˆOne-linerï¼‰ã®å®šç¾©**

Wikipediaã®[ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ ãƒ—ãƒ­ã‚°ãƒ©ãƒ ](https://en.wikipedia.org/wiki/One-liner_program)ï¼ˆè‹±æ–‡ï¼‰ã‚’å‚è€ƒã«ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã®å®šç¾©ã‚’è€ƒãˆã¾ã—ãŸã€‚
ç¿»è¨³ã‚µã‚¤ãƒˆï¼ˆ[DeepLç¿»è¨³](https://www.deepl.com/ja/translator)ï¼‰ã§è¨˜äº‹ã‚’ç¿»è¨³ã—ã¦ã¿ã‚‹ã¨ã€

> ğŸ“Œ Wikipedia [ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ ãƒ—ãƒ­ã‚°ãƒ©ãƒ ](https://en.wikipedia.org/wiki/One-liner_program)ï¼ˆè‹±æ–‡ï¼‰ã‚’ç¿»è¨³ã—ä¸€éƒ¨ã‚’æŠœç²‹
> 
> ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã¨ã„ã†è¨€è‘‰ã®ä½¿ã„æ–¹ã¯ã€1è¡Œã§ä½•ã‹æœ‰ç”¨ãªã“ã¨ã‚’è¡Œã†ã‚ã‚‰ã‚†ã‚‹è¨€èªã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãƒ»ã‚½ãƒ¼ã‚¹ã‚‚å«ã‚€ã‚ˆã†ã«åºƒãŒã£ãŸã€‚

ã¨ã‚ã‚Šã¾ã—ãŸã€‚

å›½ã‚„ä¼æ¥­ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ãƒãƒ¼ãƒ ãªã©ã®å ´æ‰€ãƒ»ç’°å¢ƒã€ã¾ãŸã¯å€‹äººã«ã‚ˆã‚Šã•ã¾ã–ã¾ãªè€ƒãˆæ–¹ãŒã‚ã‚‹ã¨æ€ã„ã¾ã™ãŒã€
ã“ã“ã§ã®å®šç¾©ã¯ã€**1è¡Œã§ç›®çš„ã‚’å®Ÿç¾ã§ãã‚‹ã‚³ãƒãƒ³ãƒ‰ã®äº‹ã‚’ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã®ã‚³ãƒãƒ³ãƒ‰**ã¨å®šç¾©ã—ã¾ã™ã€‚

:::details å‚è€ƒæƒ…å ±ï¼šWikipediaã®ã€Œ One Liner program ã€ã®å†’é ­ã‚’DeepLç¿»è¨³ã—ã¦ã¿ãŸ
ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ãƒ»ãƒ—ãƒ­ã‚°ãƒ©ãƒ 
ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ãƒ»ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã«ãŠã„ã¦ã€ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ãƒ»ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨ã¯ã€ã‚‚ã¨ã‚‚ã¨ã¯ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ»ã‚·ã‚¹ãƒ†ãƒ ã®ã‚·ã‚§ãƒ«ã®ã‚³ãƒãƒ³ãƒ‰ãƒ»ãƒ©ã‚¤ãƒ³ã«å…¥åŠ›ã•ã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆã®ã“ã¨ã§ã€ãŸã£ãŸ1è¡Œã®å…¥åŠ›ã§ä½•ã‚‰ã‹ã®æ©Ÿèƒ½ã‚’å®Ÿè¡Œã™ã‚‹ã‚‚ã®ã ã£ãŸã€‚ç¾åœ¨ã§ã¯ã€ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã¯æ¬¡ã®ã‚ˆã†ãªã‚‚ã®ã«ãªã‚‹ã€‚

ã‚·ã‚§ãƒ«ã®è¨€èªã§æ›¸ã‹ã‚ŒãŸè¡¨ç¾ï¼›
ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ—ãƒªã‚¿ãƒ¼ã®èµ·å‹•ã¨ã€ãã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ—ãƒªã‚¿ãƒ¼ãŒå®Ÿè¡Œã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚½ãƒ¼ã‚¹ï¼›
ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’èµ·å‹•ã—ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã‚½ãƒ¼ã‚¹ã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚ŒãŸãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œã™ã‚‹å‘½ä»¤ã€‚
AWKã€sedã€Perlãªã©ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”¨å‹•çš„è¨€èªã¯ã€ä¼çµ±çš„ã«ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã®è¡¨ç¾ã«é•·ã‘ã¦ã„ã‚‹ã€‚Unixã‚·ã‚§ãƒ«ã‚„Windows PowerShellã®ã‚ˆã†ãªã‚·ã‚§ãƒ«ãƒ»ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ã§ã¯ã€å¼·åŠ›ãªãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã¨ã„ã†è¨€è‘‰ã®ä½¿ã„æ–¹ã¯ã€1è¡Œã§ä½•ã‹æœ‰ç”¨ãªã“ã¨ã‚’è¡Œã†ã‚ã‚‰ã‚†ã‚‹è¨€èªã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãƒ»ã‚½ãƒ¼ã‚¹ã‚‚å«ã‚€ã‚ˆã†ã«åºƒãŒã£ãŸã€‚

> ğŸ“œ åŸæ–‡ã®å†’é ­ã‚’æŠœç²‹ï¼ˆ<https://en.wikipedia.org/wiki/One-liner_program>ï¼‰
> 
> One-liner program
> In computer programming, a one-liner program originally was textual input to the command line of an operating system shell that performed some function in just one line of input. In the present day, a one-liner can be
> 
> an expression written in the language of the shell;
> the invocation of an interpreter together with program source for the interpreter to run;
> the invocation of a compiler together with source to compile and instructions for executing the compiled program.
> Certain dynamic languages for scripting, such as AWK, sed, and Perl, have traditionally been adept at expressing one-liners. Shell interpreters such as Unix shells or Windows PowerShell allow for the construction of powerful one-liners.
> 
> The use of the phrase one-liner has been widened to also include program-source for any language that does something useful in one line.

- å‚è€ƒæƒ…å ±
    <https://en.wikipedia.org/wiki/One-liner_program>
    <https://www.deepl.com/ja/translator>
:::
::::

### PowerShellã®ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã‚³ãƒãƒ³ãƒ‰

#### ã‚³ãƒ”ãƒ¼ç”¨ï¼ˆPowerShellã®ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã‚³ãƒãƒ³ãƒ‰ï¼‰

```powershell:ã‚³ãƒãƒ³ãƒ‰ãŒå­˜åœ¨ã™ã‚‹å ´åˆã«ã€Œ Success! ã€ã‚’è¡¨ç¤º
(Get-Command -Name "å¯¾è±¡ã‚³ãƒãƒ³ãƒ‰å" -ErrorAction SilentlyContinue) -and (Write-Output "å­˜åœ¨ã—ãŸå ´åˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸") | Out-Null
```

```powershell:ã‚³ãƒãƒ³ãƒ‰ãŒå­˜åœ¨ã—ãªã„å ´åˆã«ã€Œ Error! ã€ã‚’è¡¨ç¤º
-Not(Get-Command -Name "å¯¾è±¡ã‚³ãƒãƒ³ãƒ‰å" -ErrorAction SilentlyContinue) -and (Write-Error "å­˜åœ¨ã—ãªã„å ´åˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸") | Out-Null
```

ä¸Šè¨˜ã§å®Ÿç¾ã§ãã¾ã—ãŸãŒã€ä»–ã®è¨€èªã‚„ã‚¹ã‚¯ãƒªãƒ—ãƒˆãªã©ã¨æ¯”è¼ƒã™ã‚‹ã¨é•å’Œæ„Ÿã®ã‚ã‚‹ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã«ãªã£ã¦ã—ã¾ã„ã¾ã—ãŸã€‚

ä»¥ä¸‹ãŒã“ã‚Œã‚‰ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿéš›ã«å®Ÿè¡Œã—ãŸçµæœã§ã™ã€‚

#### å®Ÿéš›ã®å®Ÿè¡Œçµæœ

```powershell:å®Ÿéš›ã«å®Ÿè¡Œã—ãŸçµæœ
# Test-Path ãŒå­˜åœ¨ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã§ã‚ã‚‹ç‚ºã€ã€Œ Success! ã€ã¨è¡¨ç¤º
PS C:\Users\XXXX> (Get-Command -Name Test-Path -ErrorAction SilentlyContinue) -and (Write-Output 'Success!') | Out-Null
Success!
PS C:\Users\XXXX>
# perldoc ãŒå­˜åœ¨ã—ãªã„ã‚³ãƒãƒ³ãƒ‰ã§ã‚ã‚‹ç‚ºã€ã€Œ Error! ã€ã¨è¡¨ç¤º
PS C:\Users\XXXX> -Not(Get-Command -Name perldoc -ErrorAction SilentlyContinue) -and (Write-Error 'Error!') | Out-Null
Error!
PS C:\Users\XXXX>
```

ã¡ã¾ã¿ã«`Get-Command -Name "å¯¾è±¡ã‚³ãƒãƒ³ãƒ‰å" -ErrorAction SilentlyContinue`ã«ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼ˆ`|`ï¼‰ã‚’ã¤ã‘ãŸå¾Œã€[Where-Object](http://www.math.kobe-u.ac.jp/HOME/kodama/tips-powershell-grammar.html#pipe)ï¼ˆçœç•¥ã ã¨`?{}`ï¼‰ã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰æ§‹æˆã§ã©ã†ã«ã‹ã§ããªã„ã‹ã€
ã„ã‚ã„ã‚è©¦ã—ã¦ã¿ã¾ã—ãŸãŒã€ã†ã¾ãã„ãæ–¹æ³•ã‚’è¦‹ã¤ã‘ã‚‹äº‹ãŒã§ãã¾ã›ã‚“ã§ã—ãŸã€‚

ä»–ã«ã‚‚ã£ã¨è‰¯ã„ã‚„ã‚Šæ–¹ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

#### ã‚»ãƒŸã‚³ãƒ­ãƒ³ï¼ˆ`;`ï¼‰ã‚’ä½¿ã£ãŸæ–¹æ³•

ã‚ã¨ã€ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã®å®šç¾©ã§è¤‡æ•°ã‚³ãƒãƒ³ãƒ‰ï¼ˆè¤‡æ–‡ï¼Ÿï¼‰ã®æ§‹æˆãŒNGæ¡ä»¶ã ã¨ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã«å½“ãŸã‚Šã¾ã›ã‚“ãŒã€
ä¸‹è¨˜ã®ã‚„ã‚Šæ–¹ã§ã‚‚å‹•ä½œã—ã¾ã™ã€‚
ï¼ˆã‚»ãƒŸã‚³ãƒ­ãƒ³ `;` ã§ã‚³ãƒãƒ³ãƒ‰åŒå£«ã‚’åŒºåˆ‡ã‚‹äº‹ã§è¤‡æ•°è¡Œã®ã‚³ãƒãƒ³ãƒ‰ã‚’1è¡Œã§å®Ÿç¾å¯èƒ½ ï¼‰

```powershell:è¤‡æ•°ã‚³ãƒãƒ³ãƒ‰ã‚’1è¡Œã§æ§‹æˆã—ãŸãƒ‘ã‚¿ãƒ¼ãƒ³
# ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚„ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’çœç•¥
# ã€ŒGet-Command   â†’ gcmã€
# ã€Œ-ErrorAction  â†’ -eaã€
gcm Test-Path -ea SilentlyContinue | Out-Null ; if ($?) {Write-Output 'Success!'}
gcm perldoc -ea SilentlyContinue | Out-Null ; if (-Not($?)) {Write-Error 'Error!'}
```

##### ã‚³ãƒ”ãƒ¼ç”¨ï¼»ã‚»ãƒŸã‚³ãƒ­ãƒ³ï¼ˆ`;`ï¼‰ã‚’ä½¿ã£ãŸæ–¹æ³•ï¼½

```powershell:ã‚³ãƒãƒ³ãƒ‰ãŒå­˜åœ¨ã™ã‚‹å ´åˆã«ã€Œ Success! ã€ã‚’è¡¨ç¤º
gcm "å¯¾è±¡ã‚³ãƒãƒ³ãƒ‰å" -ea SilentlyContinue | Out-Null ; if ($?) {Write-Output "å­˜åœ¨ã—ãŸå ´åˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"}
```

```powershell:ã‚³ãƒãƒ³ãƒ‰ãŒå­˜åœ¨ã—ãªã„å ´åˆã«ã€Œ Error! ã€ã‚’è¡¨ç¤º
gcm "å¯¾è±¡ã‚³ãƒãƒ³ãƒ‰å" -ea SilentlyContinue | Out-Null ; if (-Not($?)) {Write-Error "å­˜åœ¨ã—ãªã„å ´åˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"}
```

æ­£ç›´ã€å‰è¿°ã—ãŸè«–ç†æ¼”ç®—ã® `-and` ã‚’ä½¿ã†æ–¹æ³•ã‚ˆã‚Šã€ã“ã¡ã‚‰ã®ã‚»ãƒŸã‚³ãƒ­ãƒ³`;`ã§åŒºåˆ‡ã‚‹æ–¹æ³•ã®æ–¹ãŒã‚ã‹ã‚Šã‚„ã™ã„ã¨æ„Ÿã˜ã¾ã™ã€‚

## è£œè¶³äº‹é …ï¼šGet-Command ã¨ Find-Command ã®é•ã„ã‚’Bing AIã«èã„ã¦ã¿ãŸ

è„±ç·šã—ã¾ã™ãŒã€PowerShellã®ã‚³ãƒãƒ³ãƒ‰ã‚’èª¿ã¹ã‚‹æ–¹æ³•ãŒ`Get-Command`ä»¥å¤–ã«ã‚‚`Find-Command`ã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚‚ã‚ã‚Šã¾ã—ãŸã€‚
å…¬å¼ã®ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‚’ç¢ºèªã—ã¾ã—ãŸãŒã€ã„ã¾ã„ã¡é•ã„ãŒã‚ã‹ã‚‰ãªã‹ã£ãŸã®ã§ã€[Bing AI](https://www.bing.com/search?q=Bing+AI&showconv=1)ï¼ˆMicrosoft Copilotãƒ»Bing ãƒãƒ£ãƒƒãƒˆï¼‰ã«èã„ã¦ã¿ã¾ã—ãŸã€‚

::::details Bing AIã®å›ç­”å†…ï¼ˆã‚¯ãƒªãƒƒã‚¯ãƒ»ã‚¿ãƒƒãƒ—ã§æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
>>>>>>> parent of d4b57db (docs: detailså‰å¾Œã«ç©ºè¡Œã‚’è¿½åŠ )
> â“ Bing AI ã¸ã®å‘½ä»¤å†…å®¹ï¼ˆ"ã‚ˆã‚Šå‰µé€ çš„ã«"ï¼‰
> 
> PowerShellã«ãŠã‘ã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€ŒGet-Commandã€ã¨ã€ŒFind-Commandã€ã®é•ã„ã‚’æ•™ãˆã¦
-----
> âœ… Bing AI ã‹ã‚‰ã®å›ç­”
> 
> ã“ã‚“ã«ã¡ã¯ã€ã“ã‚Œã¯Bingã§ã™ã€‚PowerShellã«é–¢ã™ã‚‹è³ªå•ã‚’ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ğŸ˜Š
> 
> ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€ŒGet-Commandã€ã¨ã€ŒFind-Commandã€ã®é•ã„ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚
> 
> - ã€ŒGet-Commandã€ã¯ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å–å¾—ã—ã¾ã™ã€‚ã‚³ãƒãƒ³ãƒ‰ã®ç¨®é¡ã‚„åå‰ã€å‹•è©ã€åè©ãªã©ã§çµã‚Šè¾¼ã‚€ã“ã¨ãŒã§ãã¾ã™Â¹ã€‚
> - ã€ŒFind-Commandã€ã¯ã€ç™»éŒ²æ¸ˆã¿ã®ãƒªãƒã‚¸ãƒˆãƒªå†…ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ¤œç´¢ã—ã€ãã®ä¸­ã«å«ã¾ã‚Œã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’å–å¾—ã—ã¾ã™ã€‚ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®åå‰ã‚„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€ã‚¿ã‚°ãªã©ã§çµã‚Šè¾¼ã‚€ã“ã¨ãŒã§ãã¾ã™Â²ã€‚
> 
> ãŸã¨ãˆã°ã€ã€ŒGet-Command -Verb Getã€ã¯ã€å‹•è©ãŒã€ŒGetã€ã§ã‚ã‚‹ã™ã¹ã¦ã®ã‚³ãƒãƒ³ãƒ‰ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚ä¸€æ–¹ã€ã€ŒFind-Command -Verb Getã€ã¯ã€ãƒªãƒã‚¸ãƒˆãƒªå†…ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å«ã¾ã‚Œã‚‹å‹•è©ãŒã€ŒGetã€ã§ã‚ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
> 
> ã€ŒGet-Commandã€ã¯ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è‡ªå‹•çš„ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ãŒã€ã€ŒFind-Commandã€ã¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã›ã‚“ã€‚ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã«ã¯ã€ã€ŒFind-Commandã€ã®çµæœã‚’ã€ŒInstall-Moduleã€ã«ãƒ‘ã‚¤ãƒ—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™Â²ã€‚
> 
> ä»¥ä¸ŠãŒã€ã€ŒGet-Commandã€ã¨ã€ŒFind-Commandã€ã®é•ã„ã«ã¤ã„ã¦ã®èª¬æ˜ã§ã™ã€‚å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚ğŸ‘
> 
> Â¹: [Get-Command (Microsoft.PowerShell.Core) - PowerShell](^2^)
> Â²: [Find-Command (PowerShellGet) - PowerShell | Microsoft Learn](^1^)
> 
> ã‚½ãƒ¼ã‚¹: Bing ã¨ã®ä¼šè©± 2023/10/26
> (1) Find-Command (PowerShellGet) - PowerShell | Microsoft Learn. <https://learn.microsoft.com/ja-jp/powershell/module/powershellget/find-command?view=powershellget-2.x>.
> (2) Get-Command (Microsoft.PowerShell.Core) - PowerShell. <https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/get-command?view=powershell-7.3>.
> (3) Get-Command (Microsoft.PowerShell.Core) - PowerShell. <https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/get-command?view=powershell-7.3>.
> (4) Find-Command (PowerShellGet) - PowerShell | Microsoft Learn. <https://learn.microsoft.com/ja-jp/powershell/module/powershellget/find-command?view=powershellget-2.x>.
> (5) Powershellã§åˆ†ã‹ã‚‰ãªã„ã‚³ãƒãƒ³ãƒ‰ã¯Powershellã§èª¿ã¹ã‚‹ - Qiita. <https://qiita.com/Anubis_369/items/9e265f479187c40cc626>.
> (6) ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®æ¦‚è¦ - PowerShell | Microsoft Learn. <https://learn.microsoft.com/ja-jp/powershell/scripting/developer/cmdlet/cmdlet-overview?view=powershell-7.2>.
> (7) ã€PowerShellã€‘ã‚³ãƒãƒ³ãƒ‰å…¥é–€ç·¨(Get-Command) - ãªã‚“ã ã‹ .... <https://nandakagoodvibes.hatenablog.com/entry/2021/07/18/164927>.
-----

Bing AIã®å›ç­”ã«ã‚ˆã‚‹ã¨ã€

- `Get-Command` ã¯
    ã™ã¹ã¦ã®ã‚³ãƒãƒ³ãƒ‰ãƒªã‚¹ãƒˆã‹ã‚‰å–å¾—ã§ãã‚‹ã‚³ãƒãƒ³ãƒ‰
- `Find-Command` ã¯
    **ç™»éŒ²æ¸ˆã¿ã®ãƒªãƒã‚¸ãƒˆãƒªå†…ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«**æ¤œç´¢ã§å–å¾—ã§ãã‚‹ã‚³ãƒãƒ³ãƒ‰

ã¨ã„ã†å†…å®¹ã§ã—ãŸã€‚

Find-Commandã®å…¬å¼ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‚’ã¿ã‚‹ã¨PowerShellã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ`2.x`ã¾ã§ã®æ–‡æ›¸ã—ã‹ãªã„ã‚ˆã†ã§ã™ã€‚
ã¨ãã«ã€ã“ã ã‚ã‚ŠãŒç„¡ã‘ã‚Œã°`Get-Command`ã®æ–¹ã‚’ä½¿ç”¨ã—ãŸæ–¹ãŒç„¡é›£ãã†ã¨ã„ã†äº‹ã¯ä½•ã¨ãªãã‚ã‹ã‚Šã¾ã—ãŸã€‚

:::details ã•ã‚‰ã«è£œè¶³æƒ…å ±ï¼šPowerShellã«ãŠã‘ã‚‹ç™»éŒ²æ¸ˆã¿ãƒªãƒã‚¸ãƒˆãƒªå†…ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ï¼ˆã‚¯ãƒªãƒƒã‚¯ãƒ»ã‚¿ãƒƒãƒ—ã§æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
> â“ Bing AI ã¸ã®å‘½ä»¤å†…å®¹ï¼ˆ"ã‚ˆã‚Šå‰µé€ çš„ã«"ï¼‰
> 
> PowerShellã«ãŠã‘ã‚‹ç™»éŒ²æ¸ˆã¿ãƒªãƒã‚¸ãƒˆãƒªå†…ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã¯
-----
> âœ… Bing AI ã‹ã‚‰ã®å›ç­”
> 
> PowerShellã«ãŠã‘ã‚‹ç™»éŒ²æ¸ˆã¿ãƒªãƒã‚¸ãƒˆãƒªå†…ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã¯ã€PowerShellGetã¨ã„ã†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã§åˆ©ç”¨ã§ãã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®é›†åˆã§ã™Â¹ã€‚ç™»éŒ²æ¸ˆã¿ãƒªãƒã‚¸ãƒˆãƒªã¨ã¯ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ¤œç´¢ã—ãŸã‚Šã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã‚Šã™ã‚‹ãŸã‚ã®ã‚½ãƒ¼ã‚¹ã®å ´æ‰€ã‚’æŒ‡å®šã—ãŸã‚‚ã®ã§ã™Â²ã€‚ç™»éŒ²æ¸ˆã¿ãƒªãƒã‚¸ãƒˆãƒªã¯ã€PowerShellã‚®ãƒ£ãƒ©ãƒªãƒ¼Â³ã‚„NuGetâ´ãªã©ã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã‚„ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚©ãƒ«ãƒ€ã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å…±æœ‰ãªã©ã®ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã‚½ãƒ¼ã‚¹ã«è¨­å®šã§ãã¾ã™Â²ã€‚ç™»éŒ²æ¸ˆã¿ãƒªãƒã‚¸ãƒˆãƒªã‚’ç®¡ç†ã™ã‚‹ã«ã¯ã€Set-PSRepositoryâµã‚„Find-PSRepositoryâ¶ãªã©ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¾ã™Â²ã€‚
> 
> ä»¥ä¸ŠãŒã€PowerShellã«ãŠã‘ã‚‹ç™»éŒ²æ¸ˆã¿ãƒªãƒã‚¸ãƒˆãƒªå†…ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã¤ã„ã¦ã®èª¬æ˜ã§ã™ã€‚å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚ğŸ‘
> 
> Â¹: [PowerShellGet ã¨ã¯ - PowerShell | Microsoft Learn](^1^)
> Â²: [Set-PSRepository (PowerShellGet) - PowerShell | Microsoft Learn](^2^)
> Â³: [PowerShell Gallery | Home]
> â´: [NuGet Gallery | Home]
> âµ: [Set-PSRepository (PowerShellGet) - PowerShell | Microsoft Learn]
> â¶: [Find-PSRepository (PowerShellGet) - PowerShell | Microsoft Learn]
> 
> ã‚½ãƒ¼ã‚¹: Bing ã¨ã®ä¼šè©± 2023/10/26
> (1) Set-PSRepository (PowerShellGet) - PowerShell | Microsoft Learn. <https://learn.microsoft.com/ja-jp/powershell/module/powershellget/set-psrepository?view=powershellget-2.x>.
> (2) PowerShellã«ãŠã‘ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å–æ‰±ã„æ–¹ #PowerShell - Qiita. <https://qiita.com/tomomoss/items/5f8c027f3bdc3b189791>v
> (3) ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ–¹æ³• - Forsenergy. <https://forsenergy.com/ja-jp/windowspowershellhelp/html/a21640bb-853f-4dc2-b43a-fb44d3a774b2.htm>.
> (4) undefined. <https://someNuGetUrl.com/api/v2>.
> (5) undefined. <https://someNuGetUrl.com/api/v2/packages>.
> (6) undefined. <https://someNuGetUrl.com/api/v2/Packages>.
> (7) Set-PSRepository (PowerShellGet) - PowerShell | Microsoft Learn. <https://learn.microsoft.com/ja-jp/powershell/module/powershellget/set-psrepository?view=powershellget-2.x>.
> (8) PowerShellã«ãŠã‘ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å–æ‰±ã„æ–¹ #PowerShell - Qiita. <https://qiita.com/tomomoss/items/5f8c027f3bdc3b189791>.
-----

å®Ÿéš›ã€ç§ã®ç’°å¢ƒã«ãŠã‘ã‚‹**ç™»éŒ²æ¸ˆã¿ãƒªãƒã‚¸ãƒˆãƒªå†…ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«**ã‚’`Get-PSRepository`ã‚³ãƒãƒ³ãƒ‰ã§èª¿ã¹ã¦ã¿ã¾ã—ãŸã€‚

```powershell:ç™»éŒ²æ¸ˆã¿ãƒªãƒã‚¸ãƒˆãƒªå†…ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’èª¿ã¹ãŸ
PS C:\Users\XXXX> Get-PSRepository

Name                      InstallationPolicy   SourceLocation
----                      ------------------   --------------
PSGallery                 Untrusted            https://www.powershellgallery.com/api/v2

PS C:\Users\XXXX>
```

ç§ã®ç’°å¢ƒä¸‹ã§**ç™»éŒ²æ¸ˆã¿ãƒªãƒã‚¸ãƒˆãƒªå†…ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«**ã¯ã€Œ `PSGallery` ã€ã®ã¿ã®ã‚ˆã†ã§ã™ã€‚
ã“ã‚Œã‚‰ã®ç’°å¢ƒã¯è§¦ã£ã¦ã„ãªã„ã®ã§ã€ãŠãã‚‰ãã“ã®ã‚³ãƒãƒ³ãƒ‰çµæœã¯ã€åˆæœŸè¨­å®šã®çŠ¶æ…‹ã ã¨æ€ã‚ã‚Œã¾ã™ã€‚

- å‚è€ƒæƒ…å ±ï¼šPSGalleryã‚’ã€Œ `Untrusted` ã‹ã‚‰ `Trusted` ã€ã«å¤‰æ›´ã™ã‚‹æ–¹æ³•
    "ä¿¡é ¼ã•ã‚Œã¦ã„ãªã„ï¼ˆ`Untrusted`ï¼‰" ã‹ã‚‰ "ä¿¡é ¼ã§ãã‚‹ï¼ˆ`Trusted`ï¼‰"ã«å¤‰æ›´ã€‚
    <https://tomoh1r.github.io/blog/2016/11201_how_to_make_psgallery_trusted_repository.html>
:::
::::

## å‚è€ƒæƒ…å ±

- ã‚³ãƒãƒ³ãƒ‰ãŒå­˜åœ¨ã™ã‚‹ã‹ã—ãªã„ã‹ã‚’åˆ¤å®šã—ã¦æ¡ä»¶åˆ†å²ã™ã‚‹æ§‹æ–‡ã®ã¾ã¨ã‚
    <https://qiita.com/skkzsh/items/d63861293fd6bde1b0d8>

## ã¾ã¨ã‚

- PowerShellã§ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã§ã‚³ãƒãƒ³ãƒ‰ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã—æ¡ä»¶åˆ†å²ã•ã›ã‚‹æ–¹æ³•
    - ç´”ç²‹ï¼ˆï¼Ÿï¼‰ãªãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã®æ–¹æ³•

        ```powershell:ã‚³ãƒãƒ³ãƒ‰ãŒå­˜åœ¨ã™ã‚‹å ´åˆ
        (Get-Command -Name "å¯¾è±¡ã‚³ãƒãƒ³ãƒ‰å" -ErrorAction SilentlyContinue) -and (Write-Output "å­˜åœ¨ã—ãŸå ´åˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸") | Out-Null`
        ```

        ```powershell:ã‚³ãƒãƒ³ãƒ‰ãŒå­˜åœ¨ã—ãªã„å ´åˆ
        -Not(Get-Command -Name "å¯¾è±¡ã‚³ãƒãƒ³ãƒ‰å" -ErrorAction SilentlyContinue) -and (Write-Error "å­˜åœ¨ã—ãªã„å ´åˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸") | Out-Null
        ```

    - è¤‡æ•°ã‚³ãƒãƒ³ãƒ‰ã§å®Ÿè¡Œã™ã‚‹æ–¹æ³•
        ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚„ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®è¨˜è¿°ã‚’ä»¥ä¸‹ã®é€šã‚Šçœç•¥ã€‚
        ã€ŒGet-Command   â†’ gcmã€
        ã€Œ-ErrorAction  â†’ -eaã€

        ```powershell:ã‚³ãƒãƒ³ãƒ‰ãŒå­˜åœ¨ã™ã‚‹å ´åˆ
        gcm "å¯¾è±¡ã‚³ãƒãƒ³ãƒ‰å" -ea SilentlyContinue | Out-Null ; if ($?) {Write-Output "å­˜åœ¨ã—ãŸå ´åˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"}
        ```

        ```powershell:ã‚³ãƒãƒ³ãƒ‰ãŒå­˜åœ¨ã—ãªã„å ´åˆ
        gcm "å¯¾è±¡ã‚³ãƒãƒ³ãƒ‰å" -ea SilentlyContinue | Out-Null ; if (-Not($?)) {Write-Error "å­˜åœ¨ã—ãªã„å ´åˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"}
        ```

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
