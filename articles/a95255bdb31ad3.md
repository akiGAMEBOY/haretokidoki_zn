---
title: "[PowerShell]Textboxã®ç¸¦ã‚µã‚¤ã‚ºï¼ˆé«˜ã•ï¼‰ã‚’å¤‰æ›´ã—ã¦ã‚‚å¤‰ã‚ã‚‰ãªã„å•é¡Œã‚’èª¿ã¹ãŸ"
emoji: "ğŸ¤–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---
## æ¦‚è¦
PowerShellã§C#ã®ã‚½ãƒ¼ã‚¹ã€Windowsãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆã—ã¦ã„ã¦ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ç¸¦ã‚µã‚¤ã‚ºï¼ˆé«˜ã•ï¼‰ã‚’æŒ‡å®šã—ã¦ã‚‚ã€
æœŸå¾…é€šã‚Šã®å¤§ãã•ã«ãªã‚‰ãªã„å•é¡ŒãŒã‚ã£ãŸã€‚

çµè«–ã€ã“ã‚Œã¯ä»•æ§˜ã®ã‚ˆã†ã§ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã«ç´ã¥ã„ã¦ç¸¦ã®ã‚µã‚¤ã‚ºãŒæ±ºå®šã—ã¦ã„ã‚‹ã‚‚ã‚ˆã†ã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
- PowerShellãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- PowerShell + C#ã®Windowsãƒ•ã‚©ãƒ¼ãƒ  ã«ãŠã„ã¦ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ç¸¦ã‚µã‚¤ã‚ºã‚’å¤‰æ›´ã—ãŸã„æ–¹

## å•é¡Œ
```powershell:ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ç¸¦ã‚µã‚¤ã‚ºãŒå¤‰æ›´ã§ããªã„
# ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ä½œæˆ
[System.Windows.Forms.TextBox]$textbox = New-Object System.Windows.Forms.TextBox
$textbox.Location = New-Object System.Drawing.Point(40, 80)

# ç¸¦ã®ã‚µã‚¤ã‚ºã‚’ã€Œ100ã€ã§è¨­å®š
$textbox.Size = New-Object System.Drawing.Size(350, 100)

$textbox.Text = $target_folder
$textbox.Font = New-Object System.Drawing.Font($font_family, $font_size)
```

![](https://storage.googleapis.com/zenn-user-upload/37788f8c8124-20231023.png)
*ç”»åƒï¼šç¸¦ã‚µã‚¤ã‚ºã‚’ã€Œ100ã€ã«è¨­å®šã—ã¦ã¿ãŸãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹*

ä¸Šè¨˜ã®é€šã‚Šã€`$textbox.Size = New-Object System.Drawing.Size(350, 100)`ã§ç¸¦ã®ã‚µã‚¤ã‚ºã‚’ã€Œ100ã€ã«è¨­å®šã™ã‚‹ã‚‚ã€
ã‚µã‚¤ã‚ºã‚’å¤‰æ›´ã—ãŸè©²å½“ç®‡æ‰€ã®ã‚µã‚¤ã‚ºã¯åºƒãŒã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚

:::details ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ï¼ˆFunctionå…¨ä½“ ã¨ å®Ÿè¡Œæ–¹æ³•ï¼‰
```powershell:Functionå…¨ä½“
#################################################################################
# å‡¦ç†åã€€ï½œInputForm
# æ©Ÿèƒ½ã€€ã€€ï½œå¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æŒ‡å®šã™ã‚‹å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ 
#--------------------------------------------------------------------------------
# æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue: OKãƒœã‚¿ãƒ³ã€False: OKãƒœã‚¿ãƒ³ä»¥å¤–ï¼‰
# å¼•æ•°ã€€ã€€ï½œtarget_folder: å¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼
#################################################################################
Function InputForm {
    param (
        [System.String]$target_folder
    )

    # ã‚¢ã‚»ãƒ³ãƒ–ãƒªèª­ã¿è¾¼ã¿ï¼ˆãƒ•ã‚©ãƒ¼ãƒ ç”¨ï¼‰
    Add-Type -AssemblyName System.Windows.Forms
    Add-Type -AssemblyName System.Drawing

    [System.String[]]$input_parameters = @()

    # ãƒ•ã‚©ãƒ¼ãƒ ã®ä½œæˆ
    [System.String]$prompt_title = 'ã‚¿ã‚¤ãƒˆãƒ«ï¼šå¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å…¥åŠ›'
    [System.String]$prompt_message = 'å‚ç…§ã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚'
    [System.Windows.Forms.Form]$form = New-Object System.Windows.Forms.Form
    $form.Text = $prompt_title
    [System.UInt32[]]$form_size = @(550, 300)
    $form.Size = New-Object System.Drawing.Size($form_size[0],$form_size[1])
    $form.StartPosition = 'CenterScreen'
    $form.MaximizeBox = $false
    $form.MinimizeBox = $false

    [System.String]$font_family = 'ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯'
    [System.Int32]$font_size = 12

    # ãƒ©ãƒ™ãƒ«ä½œæˆ
    [System.Windows.Forms.Label]$label = New-Object System.Windows.Forms.Label
    $label.Location = New-Object System.Drawing.Point(20, 20)
    $label.Size = New-Object System.Drawing.Size(350, 50)
    $label.Text = $prompt_message
    [System.Drawing.Font]$font = New-Object System.Drawing.Font($font_family, $font_size)
    $label.Font = New-Object System.Drawing.Font($font_family, $font_size)

    # ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ä½œæˆ â˜…ã“ã“ã‹ã‚‰â˜… --->
    [System.Windows.Forms.TextBox]$textbox = New-Object System.Windows.Forms.TextBox
    $textbox.Location = New-Object System.Drawing.Point(40, 80)

    # 100ã§ãƒãƒ«ãƒãƒ©ã‚¤ãƒ³ã‚’ã‚ªãƒ³ã®å ´åˆ
    $textbox.Size = New-Object System.Drawing.Size(350, 100)
    $textbox.Multiline = $true

    $textbox.Text = $target_folder
    $textbox.Font = New-Object System.Drawing.Font($font_family, $font_size)
    # <--- â˜…ã“ã“ã¾ã§â˜…

    # å‚ç…§ãƒœã‚¿ãƒ³ã®ä½œæˆ
    [System.Windows.Forms.Button]$btnRefer = New-Object System.Windows.Forms.Button
    $btnRefer.Location = New-Object System.Drawing.Point(420, 80)
    $btnRefer.Size = New-Object System.Drawing.Size(75,25)
    $btnRefer.Text = 'å‚ç…§'

    # OKãƒœã‚¿ãƒ³ã®ä½œæˆ
    [System.Windows.Forms.Button]$btnOkay = New-Object System.Windows.Forms.Button
    $btnOkay.Location = New-Object System.Drawing.Point(355, 210)
    $btnOkay.Size = New-Object System.Drawing.Size(75,30)
    $btnOkay.Text = 'OK'
    $btnOkay.DialogResult = [System.Windows.Forms.DialogResult]::OK

    # Cancelãƒœã‚¿ãƒ³ã®ä½œæˆ
    [System.Windows.Forms.Button]$btnCancel = New-Object System.Windows.Forms.Button
    $btnCancel.Location = New-Object System.Drawing.Point(440,210)
    $btnCancel.Size = New-Object System.Drawing.Size(75,30)
    $btnCancel.Text = 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«'
    $btnCancel.DialogResult = [System.Windows.Forms.DialogResult]::Cancel

    # ãƒœã‚¿ãƒ³ã®ç´ã¥ã‘
    $form.AcceptButton = $btnOkay
    $form.CancelButton = $btnCancel

    # ãƒ•ã‚©ãƒ¼ãƒ ã«ç´ã¥ã‘
    $form.Controls.Add($label)
    $form.Controls.Add($textbox)
    $form.Controls.Add($btnRefer)
    $form.Controls.Add($btnOkay)
    $form.Controls.Add($btnCancel)

    # ãƒ•ã‚©ãƒ¼ãƒ è¡¨ç¤º
    [System.Boolean]$is_Selected = ($form.ShowDialog() -eq [System.Windows.Forms.DialogResult]::OK)
    $form = $null

    return $is_Selected
}
```
```powershell:Functionã‚’å®Ÿè¡Œ
# å®Ÿè¡Œ
InputForm 'D:\Downloads'
```
:::

## èª¿æŸ»çµæœ
ã„ã‚ã„ã‚è¨­å®šã—ç›´ã—ã¦æ¤œè¨¼ï¼ˆãƒ†ã‚¹ãƒˆï¼‰ã—ã¦ã¿ãŸçµæœã€C#ã®ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã«ãŠã‘ã‚‹ç¸¦ã®ã‚µã‚¤ã‚ºï¼ˆé«˜ã•ï¼‰ã¯ã€
ã€Œ **ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã«ç´ã¥ã„ã¦å¤§ãã•ãŒæ±ºå®šã—ã¦ã„ã‚‹** ã€ã¨ã„ã†äº‹ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚

å…·ä½“çš„ã«ã¯ä¸‹è¨˜å†…å®¹ã®æ¤œè¨¼ã‚’è¡Œã„ã¾ã—ãŸã€‚

### ç¸¦ã‚µã‚¤ã‚ºã‚’ã€Œ100ã€ã«è¨­å®šã—ãŸãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹
å‰è¿°ã«ç´¹ä»‹ã—ãŸç”»åƒã¨åŒã˜ã‚‚ã®ã§ã™ã€‚
```powershell:ç¸¦ã‚µã‚¤ã‚ºã‚’ã€Œ100ã€ã§è¨­å®š
# ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ä½œæˆ
[System.Windows.Forms.TextBox]$textbox = New-Object System.Windows.Forms.TextBox
$textbox.Location = New-Object System.Drawing.Point(40, 80)

# 100ã®å ´åˆ
$textbox.Size = New-Object System.Drawing.Size(350, 100)

$textbox.Text = $target_folder
$textbox.Font = New-Object System.Drawing.Font($font_family, $font_size)
```

![](https://storage.googleapis.com/zenn-user-upload/37788f8c8124-20231023.png)
*ç”»åƒï¼šç¸¦ã‚µã‚¤ã‚ºã‚’ã€Œ100ã€ã«è¨­å®šã—ãŸãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹*

### ç¸¦ã‚µã‚¤ã‚ºã‚’ã€Œ0ã€ã«è¨­å®šã—ãŸãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹
ç¸¦ã‚µã‚¤ã‚ºã‚’ã€Œ0ã€ã«å¤‰æ›´ã—ã¾ã—ãŸãŒã€ãªã‚“ã¨ã€Œ100ã€ã®æ™‚ã¨**ã¾ã£ãŸãå¤‰ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚**
```powershell:ç¸¦ã‚µã‚¤ã‚ºã‚’ã€Œ0ã€ã«è¨­å®šã—ãŸãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹
# ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ä½œæˆ
[System.Windows.Forms.TextBox]$textbox = New-Object System.Windows.Forms.TextBox
$textbox.Location = New-Object System.Drawing.Point(40, 80)

# 0ã®å ´åˆ
$textbox.Size = New-Object System.Drawing.Size(350, 0)

$textbox.Text = $target_folder
$textbox.Font = New-Object System.Drawing.Font($font_family, $font_size)
```

![](https://storage.googleapis.com/zenn-user-upload/5ea39b23240e-20231023.png)
*ç”»åƒï¼šç¸¦ã‚µã‚¤ã‚ºã‚’ã€Œ0ã€ã«è¨­å®šã—ãŸãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹*

### ç¸¦ã‚µã‚¤ã‚ºã‚’ã€Œ0ã€ã§ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’å¤§ããã—ãŸãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹
ã“ã‚Œã«ã‚ˆã‚Šãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã¯ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã«ã‚ˆã‚Šç¸¦ã®ã‚µã‚¤ã‚ºãŒæ±ºã¾ã£ã¦ã„ã‚‹äº‹ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚
```powershell:ç¸¦ã‚µã‚¤ã‚ºã‚’ã€Œ0ã€ã§ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’å¤‰æ›´
# ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ä½œæˆ
[System.Windows.Forms.TextBox]$textbox = New-Object System.Windows.Forms.TextBox
$textbox.Location = New-Object System.Drawing.Point(40, 80)

# 0ã§ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã€Œ12 â†’ 20ã€ã®å ´åˆ
$textbox.Size = New-Object System.Drawing.Size(350, 0)
$font_size = 20

$textbox.Text = $target_folder
$textbox.Font = New-Object System.Drawing.Font($font_family, $font_size)
```

![](https://storage.googleapis.com/zenn-user-upload/25a5e855dae4-20231023.png)
*ç”»åƒï¼šç¸¦ã‚µã‚¤ã‚ºã‚’ã€Œ0ã€ã§ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’å¤§ããã—ãŸãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹*

### ç¸¦ã‚µã‚¤ã‚ºã‚’ã€Œ100ã€ã§ãƒãƒ«ãƒãƒ©ã‚¤ãƒ³ã‚’ã€Œã‚ªãƒ³ã€ã«ã—ãŸãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹
ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’å¤‰æ›´ã›ãšã¨ã‚‚ãƒãƒ«ãƒãƒ©ã‚¤ãƒ³ã‚’ã‚ªãƒ³ã«ã™ã‚‹ã¨ã‚µã‚¤ã‚ºãŒå¤§ãããªã‚Šã¾ã—ãŸã€‚
ãŸã ã—ã€OKãƒœã‚¿ãƒ³ãŒç´ã¥ã„ã¦ã„ãªã„Windowsãƒ•ã‚©ãƒ¼ãƒ ã§ã€ã‹ã¤ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹å†…ãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã®æ™‚ã«Enterã‚­ãƒ¼ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€
æ”¹è¡ŒãŒæŒ¿å…¥ã•ã‚Œã‚‹ã€‚
**ç”»é¢ã®ä»•æ§˜ã«ã‚ˆã£ã¦ã¯ã€ãƒãƒ«ãƒãƒ©ã‚¤ãƒ³ã‚’ã‚ªãƒ³ã«ã§ããªã„**ç‚ºã€æ³¨æ„ãŒå¿…è¦ã€‚
```powershell:ç¸¦ã‚µã‚¤ã‚ºã‚’ã€Œ100ã€ã§ãƒãƒ«ãƒãƒ©ã‚¤ãƒ³ã‚’ã€Œã‚ªãƒ³ã€ã§è¨­å®š
# ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ä½œæˆ
[System.Windows.Forms.TextBox]$textbox = New-Object System.Windows.Forms.TextBox
$textbox.Location = New-Object System.Drawing.Point(40, 80)

# 100ã§ãƒãƒ«ãƒãƒ©ã‚¤ãƒ³ã‚’ã‚ªãƒ³ã®å ´åˆ
$textbox.Size = New-Object System.Drawing.Size(350, 100)
$textbox.Multiline = $true

$textbox.Text = $target_folder
$textbox.Font = New-Object System.Drawing.Font($font_family, $font_size)
```

![](https://storage.googleapis.com/zenn-user-upload/10da496bf54c-20231023.png)
*ç”»åƒï¼šç¸¦ã‚µã‚¤ã‚ºã‚’ã€Œ100ã€ã§ãƒãƒ«ãƒãƒ©ã‚¤ãƒ³ã‚’ã€Œã‚ªãƒ³ã€ã«ã—ãŸãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹*

## ã¾ã¨ã‚
- ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ç¸¦ã‚µã‚¤ã‚ºã‚’å¤‰æ›´ã—ãŸã„å ´åˆã¯ã€ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’è¦‹ç›´ã™
- ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’å¤‰æ›´ã—ãŸããªã„å ´åˆã€ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ãƒãƒ«ãƒãƒ©ã‚¤ãƒ³ã‚’ã‚ªãƒ³ã«ã™ã‚‹
    ãŸã ã—ã€ç”»é¢ã®ä½œã‚Šã«ã‚ˆã£ã¦æ”¹è¡ŒãŒæŒ¿å…¥ã•ã‚Œã¦ã—ã¾ã†äº‹ãŒã‚ã‚‹ç‚ºã€æ³¨æ„ãŒå¿…è¦
