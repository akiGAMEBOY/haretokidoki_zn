---
title: "PowerShell Textbox ã‚µã‚¤ã‚ºã§ç¸¦ã‚µã‚¤ã‚ºï¼ˆé«˜ã•ï¼‰ã‚’å¤‰æ›´ã—ã¦ã‚‚å¤‰ã‚ã‚‰ãªã„å•é¡Œ"
emoji: "ğŸ¤–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---
â– PowerShell Textbox ã‚µã‚¤ã‚ºã§ç¸¦ã‚µã‚¤ã‚ºï¼ˆé«˜ã•ï¼‰ã‚’å¤‰æ›´ã—ã¦ã‚‚å¤‰ã‚ã‚‰ãªã„å•é¡Œ
ã€€1è¡Œã ã¨ãƒ•ã‚©ãƒ³ãƒˆã«ç´ã¥ã„ã¦ã„ã‚‹ã€‚è¤‡æ•°è¡Œã ã¨è‡ªç”±è‡ªåœ¨ã«å¤‰ãˆã‚‰ã‚Œã‚‹ãŒã€æ”¹è¡Œãƒ‡ãƒ¼ã‚¿ãŒè²¼ã£ã¦ã—ã¾ã†ã®ã§ã€
ã€€ç”¨é€”ã«ã‚ˆã‚Šä½¿ç”¨ã§ããªã„ã€‚
ã€€
	```
	# ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ä½œæˆ
	[System.Windows.Forms.TextBox]$textbox = New-Object System.Windows.Forms.TextBox
	$textbox.Location = New-Object System.Drawing.Point(($form_size[0] * 0.04), ($form_size[1] * 0.175))
	# $textbox.Size = New-Object System.Drawing.Size(($form_size[0] * 0.75), ($form_size[1] * 0.075))
	$textbox.Size = New-Object System.Drawing.Size(480, 100)
	$textbox.Text = $target_folder
	$font = New-Object System.Drawing.Font('ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯',12)
	$textbox.Font = $font
	# $textbox.Multiline = $true
	```
	
	![](https://storage.googleapis.com/zenn-user-upload/83afdee06999-20230914.png)

    ```
    # ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ä½œæˆ
    [System.Windows.Forms.TextBox]$textbox = New-Object System.Windows.Forms.TextBox
    $textbox.Location = New-Object System.Drawing.Point(($form_size[0] * 0.04), ($form_size[1] * 0.175))
    # $textbox.Size = New-Object System.Drawing.Size(($form_size[0] * 0.75), ($form_size[1] * 0.075))
    $textbox.Size = New-Object System.Drawing.Size(($form_size[0] * 0.75), 100)
    $textbox.Text = $target_folder
    $font = New-Object System.Drawing.Font('ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯',20)
    $textbox.Font = $font
    # $textbox.Multiline = $true
    ```

    ![](https://storage.googleapis.com/zenn-user-upload/bd3d9634b916-20230914.png)

    ```
    # ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ä½œæˆ
    [System.Windows.Forms.TextBox]$textbox = New-Object System.Windows.Forms.TextBox
    $textbox.Location = New-Object System.Drawing.Point(($form_size[0] * 0.04), ($form_size[1] * 0.175))
    # $textbox.Size = New-Object System.Drawing.Size(($form_size[0] * 0.75), ($form_size[1] * 0.075))
    $textbox.Size = New-Object System.Drawing.Size(($form_size[0] * 0.75), 100)
    $textbox.Text = $target_folder
    $font = New-Object System.Drawing.Font('ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯',20)
    $textbox.Font = $font
    $textbox.Multiline = $true
    ```

    ![](https://storage.googleapis.com/zenn-user-upload/6d91a9b63773-20230914.png)


```powershell:Functionå…¨ä½“
#################################################################################
# å‡¦ç†åã€€ï½œSettingInputfolder
# æ©Ÿèƒ½ã€€ã€€ï½œå…¥åŠ›ãƒ•ã‚©ãƒ«ãƒ€ã®è¨­å®šï¼ˆWindowsãƒ•ã‚©ãƒ¼ãƒ ï¼‰
#--------------------------------------------------------------------------------
# æˆ»ã‚Šå€¤ã€€ï½œStringï¼ˆæŒ‡å®šã®ã‚ã£ãŸå…¥åŠ›ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ‘ã‚¹ï¼‰
# å¼•æ•°ã€€ã€€ï½œtarget_folder: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®åˆæœŸå€¤ã‚’è¨­å®šã€root_dirï¼šãƒ„ãƒ¼ãƒ«ã®ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ«ãƒ€
#################################################################################
Function SettingInputfolder {
    param (
        [System.String]$target_folder,
        [System.String]$root_dir
    )
    [System.String]$return = ''

    # ãƒ•ã‚©ãƒ¼ãƒ ã®ä½œæˆ
    [System.String]$prompt_title = 'å…¥åŠ›ãƒ•ã‚©ãƒ«ãƒ€ã®è¨­å®š'
    [System.String]$prompt_message = 'å‚ç…§ã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚'

    [System.Windows.Forms.Form]$form = New-Object System.Windows.Forms.Form
    $form.Text = $prompt_title
    [System.UInt32[]]$form_size = AcquisitionFormsize(3)
    # $form.Size = New-Object System.Drawing.Size(460,210)
    $form.Size = New-Object System.Drawing.Size($form_size[0],$form_size[1])
    $form.StartPosition = 'CenterScreen'
    $form.Icon = [System.Drawing.Icon]::ExtractAssociatedIcon("${root_dir}\source\icon\shell32-296.ico")
    $form.MaximizeBox = $false
    $form.MinimizeBox = $false
    # ãƒ©ãƒ™ãƒ«ä½œæˆ
    [System.Windows.Forms.Label]$label = New-Object System.Windows.Forms.Label
    # $label.Location = New-Object System.Drawing.Point(85,30)
    $label.Location = New-Object System.Drawing.Point(($form_size[0] * 0.04),($form_size[1] * 0.07))
    # $label.Size = New-Object System.Drawing.Size(350,80)
    $label.Size = New-Object System.Drawing.Size(($form_size[0] * 0.75),($form_size[1] * 0.075))
    $label.Text = $prompt_message
    $font = New-Object System.Drawing.Font('ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯',12)
    $label.Font = $font
    # ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ä½œæˆ
    [System.Windows.Forms.TextBox]$textbox = New-Object System.Windows.Forms.TextBox
    $textbox.Location = New-Object System.Drawing.Point(($form_size[0] * 0.04), ($form_size[1] * 0.175))
    $textbox.Size = New-Object System.Drawing.Size(($form_size[0] * 0.75), 0)
    $textbox.Text = $target_folder
    $font = New-Object System.Drawing.Font('ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯',12)
    $textbox.Font = $font
    # å‚ç…§ãƒœã‚¿ãƒ³ã®ä½œæˆ
    [System.Windows.Forms.Button]$btnRefer = New-Object System.Windows.Forms.Button
    $btnRefer.Location = New-Object System.Drawing.Point(($form_size[0] * 0.820), ($form_size[1] * 0.175))
    $btnRefer.Size = New-Object System.Drawing.Size(75,25)
    $btnRefer.Text = 'å‚ç…§'
    # OKãƒœã‚¿ãƒ³ã®ä½œæˆ
    [System.Windows.Forms.Button]$btnOkay = New-Object System.Windows.Forms.Button
    # $btnOkay.Location = New-Object System.Drawing.Point(255,120)
    $btnOkay.Location = New-Object System.Drawing.Point(($form_size[0] - 205), ($form_size[1] - 90))
    $btnOkay.Size = New-Object System.Drawing.Size(75,30)
    $btnOkay.Text = 'æ¬¡ã¸'
    $btnOkay.DialogResult = [System.Windows.Forms.DialogResult]::OK
    # Cancelãƒœã‚¿ãƒ³ã®ä½œæˆ
    [System.Windows.Forms.Button]$btnCancel = New-Object System.Windows.Forms.Button
    # $btnCancel.Location = New-Object System.Drawing.Point(345,120)
    $btnCancel.Location = New-Object System.Drawing.Point(($form_size[0] - 115), ($form_size[1] - 90))
    $btnCancel.Size = New-Object System.Drawing.Size(75,30)
    $btnCancel.Text = 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«'
    $btnCancel.DialogResult = [System.Windows.Forms.DialogResult]::Cancel
    # ãƒœã‚¿ãƒ³ã®ç´ã¥ã‘
    $form.AcceptButton = $btnOkay
    $form.CancelButton = $btnCancel
    # ãƒ•ã‚©ãƒ¼ãƒ ã«ç´ã¥ã‘
    $form.Controls.Add($label)
    $form.Controls.Add($textbox)
    $form.Controls.Add($btnRefer)
    $form.Controls.Add($btnOkay)
    $form.Controls.Add($btnCancel)
    # ãƒ•ã‚©ãƒ¼ãƒ è¡¨ç¤º
    if ($form.ShowDialog() -eq [System.Windows.Forms.DialogResult]::OK) {
        $return = $true
    }
    else {
        $return = $false
    }
    $form = $null

    return $return
}
```