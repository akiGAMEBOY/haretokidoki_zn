---
title: "Coreç’°å¢ƒã‹ãƒã‚§ãƒƒã‚¯"
emoji: "ğŸŒŸ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

```powershell:
#################################################################################
# å‡¦ç†åã€€ | VerificationExecutionEnv
# æ©Ÿèƒ½ã€€ã€€ | PowerShellç’°å¢ƒãƒã‚§ãƒƒã‚¯
#--------------------------------------------------------------------------------
# æˆ»ã‚Šå€¤ã€€ | MESSAGECODEï¼ˆenumï¼‰
# å¼•æ•°ã€€ã€€ | ãªã—
#################################################################################
Function VerificationExecutionEnv {
    [MESSAGECODE]$messagecode = [MESSAGECODE]::Successful
    [System.String]$messagecode_messages = ''

    # ç’°å¢ƒæƒ…å ±ã‚’å–å¾—
    [System.Collections.Hashtable]$powershell_ver = $PSVersionTable

    # ç’°å¢ƒã®åˆ¤å®šï¼šCoreã§ã¯ãªã„å ´åˆ
    if ($powershell_ver.PSEdition -ne 'Core') {
        $messagecode = [MESSAGECODE]::Error_NotCore
        $messagecode_messages = RetrieveMessage $messagecode
        Write-Host $messagecode_messages -ForegroundColor Red
    }
    # ç’°å¢ƒã®åˆ¤å®šï¼šãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ7ã‚ˆã‚Šå°ã•ã„å ´åˆ
    elseif ($powershell_ver.PSVersion.Major -lt 7) {
        $messagecode = [MESSAGECODE]::Error_NotSupportedVersion
        $messagecode_messages = RetrieveMessage $messagecode
        Write-Host $messagecode_messages -ForegroundColor Red
    }
    # ç’°å¢ƒã®åˆ¤å®šï¼šWindows OSã§ã¯ãªã„å ´åˆ
    elseif (-Not($IsWindows)) {
        $messagecode = [MESSAGECODE]::Error_NotWindows
        $messagecode_messages = RetrieveMessage $messagecode
        Write-Host $messagecode_messages -ForegroundColor Red
    }

    ### DEBUG ###
    if ($DEBUG_ON) {
        [void](Write-Host '### DEBUG PRINT ###')
        [void](Write-Host '')

        [void](Write-Host "Function VerificationExecutionEnv: messagecode [${messagecode}]")

        [void](Write-Host '')
        [void](Write-Host '###################')
        [void](Write-Host '')
        [void](Write-Host '')
    }

    return $messagecode
}
```

```:ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
WHERE /Q pwsh
IF %ERRORLEVEL% == 0 (
    @REM PowerShell Core ã§å®Ÿè¡Œã™ã‚‹å ´åˆ
    pwsh -NoProfile -ExecutionPolicy Unrestricted -File "%~dp0\source\powershell\Main.ps1"
    @REM pwsh -NoProfile -ExecutionPolicy RemoteSigned -File "%~dp0\source\powershell\Main.ps1"
) ELSE (
    @REM PowerShell 5.1  ã§å®Ÿè¡Œã™ã‚‹å ´åˆ
    powershell -NoProfile -ExecutionPolicy Unrestricted -File "%~dp0\source\powershell\Main.ps1"
    @REM powershell -NoProfile -ExecutionPolicy RemoteSigned -File "%~dp0\source\powershell\Main.ps1"
)
```

```powershell:
# 'pwsh' ã‚³ãƒãƒ³ãƒ‰ã®ãƒ‘ã‚¹ã‚’æ¤œç´¢ã—ã€çµæœãŒã‚ã‚Œã°è¡¨ç¤ºã—ã¾ã™ã€‚
[System.String]$pwsh_path = (Get-Command 'pws' -ErrorAction SilentlyContinue)
[System.String]$pwsh_path = (Get-Command 'pwsh' -ErrorAction SilentlyContinue)Source
if ($commandPath) {
    Write-Host "ã‚³ãƒãƒ³ãƒ‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ: $commandPath"
} else {
    Write-Host "ã‚³ãƒãƒ³ãƒ‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚"
}

```

è‡ªå‹•å¤‰æ•°ã®ä¸€è¦§ã®è¨˜äº‹ã‚’ç´¹ä»‹ã€‚
