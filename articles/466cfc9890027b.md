---
title: "[PowerShell]Excelã®COMã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹æ”¾ã™ã‚‹Function"
emoji: "ğŸ¥"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell", "excel"]
published: false
---
## æ¦‚è¦

ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ä½¿ã£ãŸå¾Œã®è§£æ”¾å‡¦ç†ã‚’Functionã«

## å¯¾å¿œæ–¹æ³•

```powershell:
# Excelã®COMã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹æ”¾ã™ã‚‹å‡¦ç†
function Release-ExcelObjects {
    param (
        [Microsoft.Office.Interop.Excel.ApplicationClass]$ExcelObject,
        [System.__ComObject]$WorkbookObject
    )

    # ãƒ¯ãƒ¼ã‚¯ãƒ–ãƒƒã‚¯ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒã‚ã‚‹å ´åˆã¯é–‹æ”¾
    if ($null -ne $WorkbookObject) {
        [System.Runtime.InteropServices.Marshal]::ReleaseComObject($WorkbookObject)
    }
    # ã‚¨ã‚¯ã‚»ãƒ«ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒã‚ã‚‹å ´åˆã¯é–‹æ”¾
    if ($null -ne $ExcelObject) {
        [System.Runtime.InteropServices.Marshal]::ReleaseComObject($ExcelObject)
    }

    # ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’å¼·åˆ¶çš„ã«å®Ÿè¡Œ
    [System.GC]::Collect()
    [System.GC]::WaitForPendingFinalizers()
}
```
