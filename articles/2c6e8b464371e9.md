---
title: ""
emoji: "ğŸ™†"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: false
---

Alt + æ•°å­—4æ¡

C#

https://zenn.dev/midoliy/articles/9e3cff958ff89ba151de

:::details 

::: details Pythonã§ã‚‚ã†ã¾ãã„ã‹ãªã‹ã£ãŸ

```python
from ctypes.wintypes import HWND
from pynput import keyboard
import subprocess
import time
import win32gui
import win32con
import pyautogui
import ctypes
import platform

# æ¤œç´¢ã™ã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®åå‰ï¼ˆéƒ¨åˆ†ä¸€è‡´ï¼‰
# exefile = sys.argv[1]
# title = sys.argv[2]
# presskey = sys.argv[3]
exefile = "notepad.exe"
title = "ãƒ¡ãƒ¢å¸³"
keynum = 1

dict = {}
found_apps = []


# å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã®èµ·å‹•
process = subprocess.Popen(exefile)
time.sleep(0.1)


def get_window_titles():
    def set_windowdata(hwnd, ctx):
        if win32gui.IsWindowVisible(hwnd):
            dict[win32gui.GetWindowText(hwnd)] = hex(hwnd)
    win32gui.EnumWindows(set_windowdata, None)


get_window_titles()

for item in dict.keys():
    if title not in item:
        pass
    else:
        found_apps.append(item)

if len(found_apps) != 0:
    # æ¤œç´¢ã—ãŸã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‹ãã¾ã™
    hwnd: HWND = win32gui.FindWindow(None, found_apps[0])  # windowã®ãƒãƒ³ãƒ‰ãƒ«ã‚’å–å¾—

    # æœ€å°åŒ–ã—ã¦ã„ãŸå ´åˆã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’å¤‰ãˆã¾ã™
    if win32gui.IsIconic(hwnd):
        win32gui.ShowWindow(hwnd, 1)  # SW_SHOWNORMAL
    else:
        win32gui.SetWindowPos(hwnd, win32con.HWND_TOPMOST, 0, 0, 0, 0,
                              win32con.SWP_NOMOVE | win32con.SWP_NOSIZE)
    time.sleep(1)

    # ã“ã®ã¾ã¾ã˜ã‚ƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã¯è¡¨ç¤ºã•ã‚Œã‚‹ã‘ã©ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ãªã£ã¦ã„ãªã„ã®ã§ã€pysutoguiã§ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ã™ã‚‹ï¼ˆåŠ›æ¥­ï¼‰
    (left, top, right, bottom) = win32gui.GetWindowRect(hwnd)
    pyautogui.moveTo(left+60, top + 10)
    pyautogui.click()

    # è‡ªå‹•åŒ–å‡¦ç†ã€€ã”è‡ªç”±ã«ã©ã†ã
    # ä»Šå›ã¯ãƒ¡ãƒ¢å¸³ã«Hiã¨æ›¸ã„ã¦ã¿ã¾ã™
    # pyautogui.keyDown("alt")
    # time.sleep(0.1)
    # pyautogui.press("0")
    # pyautogui.press("1")
    # pyautogui.press("8")
    # pyautogui.press("2")
    # pyautogui.typewrite("0182")
    # pyautogui.keyDown("0")
    # pyautogui.keyUp("0")
    # pyautogui.keyDown("1")
    # pyautogui.keyUp("1")
    # pyautogui.keyDown("8")
    # pyautogui.keyUp("8")
    # pyautogui.keyDown("2")
    # pyautogui.keyUp("2")
    # pyautogui.hotkey("alt", "0", "1", "8", "2")
    # pyautogui.keyDown("alt", "0", "1", "8", "2")
    # pyautogui.keyUp("alt", "0", "1", "8", "2")
    # pyautogui.keyDown("0")
    # time.sleep(1)
    # pyautogui.keyUp("0")
    # time.sleep(0.1)
    # # pyautogui.keyUp("alt")
    # pyautogui.press("return")

    def ime_on(event):
        pf = platform.system()
        if pf == "Windows":
            user32 = ctypes.WinDLL(name="user32")
            imm32 = ctypes.WinDLL(name="imm32")
            h_wnd = user32.GetForegroundWindow()
            h_imc = imm32.ImmGetContext(h_wnd)
            imm32.ImmSetOpenStatus(h_imc, True)
            imm32.ImmReleaseContext(h_wnd, h_imc)

        elif pf == "Darwin":
            applescript = r'tell application "System Events" to keystroke (key code {104})'
            subprocess.run(["osascript", "-e", applescript])

        elif pf == "Linux":
            try:
                subprocess.run(["ibus", "engine", "mozc-jp"])  # ibusã®å ´åˆ
                subprocess.run(["fcitx-remote", "-o"])  # fcitxã®å ´åˆ
                subprocess.run(["echo", "1", ">", "$UIM_FEP_SETMODE"])  # uimã®å ´åˆ(åˆã£ã¦ã„ã‚‹ã®ã‹ä¸æ˜)
            except FileNotFoundError:
                pass

    def ime_off(event):
        pf = platform.system()
        if pf == "Windows":
            user32 = ctypes.WinDLL(name="user32")
            imm32 = ctypes.WinDLL(name="imm32")
            h_wnd = user32.GetForegroundWindow()
            h_imc = imm32.ImmGetContext(h_wnd)
            imm32.ImmSetOpenStatus(h_imc, False)
            imm32.ImmReleaseContext(h_wnd, h_imc)

        elif pf == "Darwin":
            applescript = r'tell application "System Events" to keystroke (key code {102})'
            subprocess.run(["osascript", "-e", applescript])

        elif pf == "Linux":
            try:
                subprocess.run(["ibus", "engine", "xkb:jp::jpn"])  # ibusã®å ´åˆ
                subprocess.run(["fcitx-remote", "-c"])  # fcitxã®å ´åˆ
                subprocess.run(["echo", "0", ">", "$UIM_FEP_SETMODE"])  # uimã®å ´åˆ(åˆã£ã¦ã„ã‚‹ã®ã‹ä¸æ˜)
            except FileNotFoundError:
                pass
            pass

    ime_off
    ime_on
    pyautogui.keyDown('alt')  # altã‚­ãƒ¼é•·æŠ¼ã—é–‹å§‹
    pyautogui.press('0')   # tabã‚­ãƒ¼1å›ç›®å…¥åŠ›
    pyautogui.press('1')   # tabã‚­ãƒ¼2å›ç›®å…¥åŠ›
    pyautogui.press('8')   # tabã‚­ãƒ¼3å›ç›®å…¥åŠ›
    pyautogui.press('2')   # tabã‚­ãƒ¼3å›ç›®å…¥åŠ›
    pyautogui.keyUp('alt')   # altã‚­ãƒ¼é•·æŠ¼ã—è§£é™¤
    pyautogui.press('return')   # altã‚­ãƒ¼é•·æŠ¼ã—è§£é™¤

    # ã“ã®ã¾ã¾ã ã¨ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒå‰é¢å›ºå®šã•ã‚Œã¦ã„ã‚‹ã®ã§ã€å‰é¢å›ºå®šã‚’è§£é™¤
    win32gui.SetWindowPos(hwnd, win32con.HWND_NOTOPMOST, 0, 0, 0, 0,
                          win32con.SWP_NOMOVE | win32con.SWP_NOSIZE)
else:
    print("è©²å½“ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãªã—")
```

> â“ Bing AIã¸ã®è³ªå•
> 
> win32gui ã‚’ä½¿ã„ã€Windowsã®å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’èµ·å‹•ã—ã€ãã®ãƒ—ãƒ­ã‚»ã‚¹ã«ã‚­ãƒ¼å…¥åŠ›ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ã€‚
> ãªãŠã€èµ·å‹•ã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã¨å…¥åŠ›ã™ã‚‹ã‚­ãƒ¼ã¯å¼•æ•°ã§æŒ‡å®šã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã€‚
ã€€
> âœ… Bing AIã®å›ç­”
> 
> ã“ã‚“ã«ã¡ã¯ã€ã“ã‚Œã¯Bingã§ã™ã€‚ğŸ˜Š
> win32guiã‚’ä½¿ã£ã¦Windowsã®å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’èµ·å‹•ã—ã€ãã®ãƒ—ãƒ­ã‚»ã‚¹ã«ã‚­ãƒ¼å…¥åŠ›ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹ã®ã¯ã€ã‹ãªã‚Šé›£ã—ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã—ã‹ã—ã€ç§ã¯æŒ‘æˆ¦ã—ã¦ã¿ã¾ã™ã€‚
> 
> ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã¯ã€ç§ãŒè€ƒãˆãŸä¸€ã¤ã®æ–¹æ³•ã§ã™ã€‚`subprocess`ã¨`win32gui`ã¨`win32con`ã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ã€Windowsã®å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’èµ·å‹•ã—ã¦ã€ç‰¹å®šã®ãƒ—ãƒ­ã‚»ã‚¹ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒãƒ³ãƒ‰ãƒ«ã‚’å–å¾—ã—ã¦ã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚¤ãƒ™ãƒ³ãƒˆã‚’é€ä¿¡ã™ã‚‹ã¨ã„ã†ã‚‚ã®ã§ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã€pipã‚³ãƒãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ã€‚Â¹Â²Â³
> 
> ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€å¼•æ•°ã§æŒ‡å®šã•ã‚ŒãŸå®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã¨ã‚­ãƒ¼ã‚’ä½¿ã£ã¦ã€ã‚­ãƒ¼å…¥åŠ›ã‚’è‡ªå‹•åŒ–ã—ã¾ã™ã€‚é•·æŠ¼ã—ã™ã‚‹æ™‚é–“ã¯ã€`press_time`å¤‰æ•°ã§æŒ‡å®šã§ãã¾ã™ã€‚â´
> 
> ```python
> # ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
> import subprocess
> import win32gui
> import win32con
> import time
> import sys
> 
> # å¼•æ•°ã‹ã‚‰å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã¨ã‚­ãƒ¼ã‚’å–å¾—
> exe_file = sys.argv[1]
> key = sys.argv[2]
> 
> # é•·æŠ¼ã—ã™ã‚‹æ™‚é–“ï¼ˆç§’ï¼‰
> press_time = 1
> 
> # å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’èµ·å‹•ã™ã‚‹
> subprocess.Popen(exe_file)
> 
> # èµ·å‹•ã—ãŸãƒ—ãƒ­ã‚»ã‚¹ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒãƒ³ãƒ‰ãƒ«ã‚’å–å¾—ã™ã‚‹é–¢æ•°
> def get_window_handle(process_name):
>     # ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒãƒ³ãƒ‰ãƒ«ã‚’æ ¼ç´ã™ã‚‹å¤‰æ•°
>     window_handle = 0
>     # ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¿ã‚¤ãƒˆãƒ«ã¨ã‚¯ãƒ©ã‚¹åã‚’å–å¾—ã™ã‚‹é–¢æ•°
>     def get_window_info(hwnd, param):
>         nonlocal window_handle # å¤–éƒ¨å¤‰æ•°ã‚’å‚ç…§ã™ã‚‹ãŸã‚ã«nonlocalå®£è¨€
>         title = win32gui.GetWindowText(hwnd) # ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å–å¾—
>         class_name = win32gui.GetClassName(hwnd) # ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¯ãƒ©ã‚¹åã‚’å–å¾—
>         # ã‚¿ã‚¤ãƒˆãƒ«ã¾ãŸã¯ã‚¯ãƒ©ã‚¹åãŒãƒ—ãƒ­ã‚»ã‚¹åã¨ä¸€è‡´ã—ãŸã‚‰ã€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒãƒ³ãƒ‰ãƒ«ã‚’ä¿å­˜
>         if title == process_name or class_name == process_name:
>             window_handle = hwnd
>     # ã™ã¹ã¦ã®ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«å¯¾ã—ã¦get_window_infoé–¢æ•°ã‚’å‘¼ã³å‡ºã™
>     win32gui.EnumWindows(get_window_info, None)
>     # ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒãƒ³ãƒ‰ãƒ«ã‚’è¿”ã™
>     return window_handle
> 
> # èµ·å‹•ã—ãŸãƒ—ãƒ­ã‚»ã‚¹ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒãƒ³ãƒ‰ãƒ«ã‚’å–å¾—ã™ã‚‹ï¼ˆæœ€å¤§10ç§’é–“è©¦è¡Œï¼‰
> for i in range(10):
>     window_handle = get_window_handle(exe_file)
>     if window_handle > 0: # ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒãƒ³ãƒ‰ãƒ«ãŒå–å¾—ã§ããŸã‚‰
>         break # ãƒ«ãƒ¼ãƒ—ã‚’æŠœã‘ã‚‹
>     else: # ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒãƒ³ãƒ‰ãƒ«ãŒå–å¾—ã§ããªã‹ã£ãŸã‚‰
>         time.sleep(1) # 1ç§’å¾…ã£ã¦å†è©¦è¡Œ
> 
> # ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒãƒ³ãƒ‰ãƒ«ãŒå–å¾—ã§ããŸã‹ã©ã†ã‹åˆ¤å®š
> if window_handle > 0: # å–å¾—ã§ããŸå ´åˆ
>     print(f"Window handle of {exe_file} is {window_handle}.")
>     # ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ã™ã‚‹
>     win32gui.SetForegroundWindow(window_handle)
>     # ã‚­ãƒ¼ã®æŠ¼ä¸‹ã‚¤ãƒ™ãƒ³ãƒˆã‚’é€ä¿¡
>     win32gui.PostMessage(window_handle, win32con.WM_KEYDOWN, ord(key), 0)
>     # é•·æŠ¼ã—ã™ã‚‹æ™‚é–“ã ã‘å¾…æ©Ÿ
>     time.sleep(press_time)
>     # ã‚­ãƒ¼ã®é›¢ä¸Šã‚¤ãƒ™ãƒ³ãƒˆã‚’é€ä¿¡
>     win32gui.PostMessage(window_handle, win32con.WM_KEYUP, ord(key), 0)
> else: # å–å¾—ã§ããªã‹ã£ãŸå ´åˆ
>     print(f"Window handle of {exe_file} is not found.")
> 
> ```
> 
> ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€ç§ã®æƒ³åƒåŠ›ã¨çŸ¥è­˜ã§ä½œæˆã—ãŸã‚‚ã®ã§ã™ã€‚å®Ÿéš›ã«å‹•ä½œã™ã‚‹ã‹ã©ã†ã‹ã¯ä¿è¨¼ã§ãã¾ã›ã‚“ã€‚ã‚‚ã£ã¨è‰¯ã„æ–¹æ³•ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚Pythonã‚„win32guiã«é–¢ã™ã‚‹è©³ç´°ãªæƒ…å ±ã¯ã€[ã“ã¡ã‚‰](^5^)ã‚„[ã“ã¡ã‚‰]ãªã©ã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
> 
> ç§ã¯Pythonã‚„win32guiã«ã¤ã„ã¦ã‚ã¾ã‚Šè©³ã—ãã‚ã‚Šã¾ã›ã‚“ãŒã€å°‘ã—ã§ã‚‚ãŠå½¹ã«ç«‹ã¦ã‚Œã°å¬‰ã—ã„ã§ã™ã€‚ğŸ˜Š
> 
> ã‚½ãƒ¼ã‚¹: Bing ã¨ã®ä¼šè©± 2023/11/2
> (1) Windowsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è‡ªå‹•åŒ–-Pythonç·¨â‘¡- #Python - Qiita. https://qiita.com/kurosworld/items/529b8447b0ab61ea0dcd.
> (2) ã€Pythonã€‘ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ã‚¢ãƒ—ãƒªåæŒ‡å®šã—ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åˆ‡ã‚Šæ›¿ãˆã™ã‚‹ .... https://pentan.net/python-windowactive/.
> (3) Python Windowsç’°å¢ƒä¸‹ã§ã®RPAã€Œpyautoguiã€ - Pythonã¨ .... https://hk29.hatenablog.jp/entry/2021/08/14/191947.
> (4) PyAutoGuiã§ç¹°ã‚Šè¿”ã—ä½œæ¥­ã‚’Pythonã«ã‚„ã‚‰ã›ã‚ˆã† #Python3 - Qiita. https://qiita.com/hirohiro77/items/78e26a59c2e45a0fe4e3.
> (5) Pythonã§ç‰¹å®šã®ã‚½ãƒ•ãƒˆã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ã™ã‚‹æ–¹æ³• #Python - Qiita. https://qiita.com/Romane/items/9f70dbd4313ca6bf9fff.

- å‚è€ƒæƒ…å ±
    https://qiita.com/Cmirai/items/ad39ffbf2642d7476980
    https://qiita.com/kawamasa/items/8f849d1cd99cb76b4aa2
    https://qiita.com/Romane/items/9f70dbd4313ca6bf9fff

:::

:::details å‚è€ƒæƒ…å ±ï¼šPowerShellã§å®Ÿç¾ã—ã‚ˆã†ã¨ã—ãŸéš›ã€ã‚­ãƒ¼ã®å˜ä½“æŠ¼ã—ã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ãŸ
ãƒ—ãƒ­ã‚»ã‚¹åã‚’æŒ‡å®šã—ã€ãã®ãƒ—ãƒ­ã‚»ã‚¹ã«åˆ‡ã‚Šæ›¿ãˆã¦æ–‡å­—å…¥åŠ›ãŒå¯èƒ½ã€‚ãŸã ã—ã€Altã‚­ãƒ¼ã®é•·æŠ¼ã—ã¯ã§ããªã‹ã£ãŸã€‚

```powershell
Add-Type -AssemblyName Microsoft.VisualBasic
Add-Type -AssemblyName System.Windows.Forms

<#
.Synopsis
   å®Ÿè¡Œä¸­ã®ä»»æ„ã®ãƒ—ãƒ­ã‚»ã‚¹ã«ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ã‚’é€ã‚‹æ“ä½œã‚’ã—ã¾ã™ã€‚
.DESCRIPTION
   ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ã€ãƒ—ãƒ­ã‚»ã‚¹åãŒãã‚Œãã‚ŒæœªæŒ‡å®šã®å ´åˆã€ä½•ã‚‚å®Ÿè¡Œã•ã‚Œã¾ã›ã‚“ã€‚
   ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ã®ã¿ãŒæŒ‡å®šã•ã‚ŒãŸå ´åˆã¯å®Ÿè¡Œæ™‚ã®ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã¸ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ã‚’é€ã‚Šã€
   ãƒ—ãƒ­ã‚»ã‚¹åã®ã¿ãŒæŒ‡å®šã•ã‚ŒãŸå ´åˆã¯ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã®ã¿ãŒæŒ‡å®šã•ã‚ŒãŸãƒ—ãƒ­ã‚»ã‚¹ã«å¤‰æ›´ã—ã¾ã™ã€‚
.EXAMPLE
   Send-Keys -KeyStroke "test.%~" -ProcessName "LINE"

   ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯æ—¢ã«èµ·å‹•ä¸­ã®LINEã‚¢ãƒ—ãƒªã«å¯¾ã—ã¦"test."ã¨å…¥åŠ›ã—ã€
   Altã‚­ãƒ¼ã‚’æŠ¼ã—ãªãŒã‚‰Enterã‚­ãƒ¼ã‚’æŠ¼ä¸‹ã™ã‚‹æ“ä½œã‚’ã—ã¦ã„ã¾ã™ã€‚
#>
function Send-Keys
{
    [CmdletBinding()]
    [Alias("sdky")]
    Param
    (
        # ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯
        # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«é€ã‚ŠãŸã„ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯å†…å®¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚
        # ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ã®è¨˜è¿°æ–¹æ³•ã¯ä¸‹è¨˜ã®Webãƒšãƒ¼ã‚¸ã‚’å‚ç…§ã€‚
        # https://msdn.microsoft.com/ja-jp/library/cc364423.aspx
        [Parameter(Mandatory=$false,
                   ValueFromPipelineByPropertyName=$true,
                   Position=0)]
        [string]
        $KeyStroke,

        # ãƒ—ãƒ­ã‚»ã‚¹å
        # ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ã‚’é€ã‚ŠãŸã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ—ãƒ­ã‚»ã‚¹åã‚’æŒ‡å®šã—ã¾ã™ã€‚
        # è¤‡æ•°ã‚ã‚‹å ´åˆã¯ã€PIDãŒä¸€ç•ªä½ã„ãƒ—ãƒ­ã‚»ã‚¹ã‚’å¯¾è±¡ã¨ã™ã‚‹ã€‚
        [Parameter(Mandatory=$false,
                   ValueFromPipelineByPropertyName=$true)]
        [string]
        $ProcessName,

        # å¾…æ©Ÿæ™‚é–“
        # ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹å‰ã®å¾…æ©Ÿæ™‚é–“ã‚’ãƒŸãƒªç§’å˜ä½ã§æŒ‡å®šã—ã¾ã™ã€‚
        [Parameter(Mandatory=$false,
                   ValueFromPipelineByPropertyName=$true)]
        [int]
        $Wait = 0
    )

    Process
    {
        $Process = ps | ? {$_.Name -eq $ProcessName} | sort -Property CPU -Descending | select -First 1
        Write-Verbose $Process", KeyStroke = "$KeyStroke", Wait = "$Wait" ms."
        sleep -Milliseconds $Wait
        if ($Process -ne $null)
        {
            [Microsoft.VisualBasic.Interaction]::AppActivate($Process.ID)
        }
        [System.Windows.Forms.SendKeys]::SendWait($KeyStroke)
    }
}
# å®Ÿè¡Œ
#   Ctrl + V ã§è²¼ã‚Šä»˜ã‘ã¨ã€ã€Œ TEST MESSAGE.ã€ã¨å…¥åŠ›ã•ã‚Œã‚‹ã€‚
Send-Keys "^(V) TEST MESSAGE." -ProcessName "notepad"
```

:::

https://pajoca.com/ms-ime-trouble-alt/

> â“ Bing AIã¸ã®è³ªå•
> 
> Microsoft IME ã§ä½¿ç”¨ã§ãã‚‹ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼ã€Altã‚’é•·æŠ¼ã—ã—ã¦4æ¡ã®æ•°å­—ã‚’å…¥ã‚Œã‚‹ã¨ã€
> ç‰¹æ®Šæ–‡å­—ãŒå…¥åŠ›ã§ãã‚‹æ©Ÿèƒ½ã«ä¸å…·åˆãŒç™ºç”Ÿã—ã¦ã„ã‚‹ç†ç”±ã‚’æ•™ãˆã¦ã€‚
ã€€
> âœ… Bing AIã®å›ç­”
> 
> Microsoft IMEã§ç‰¹æ®Šæ–‡å­—ã‚’å…¥åŠ›ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ãŠå°‹ã­ã§ã™ã­ã€‚ğŸ˜Š
> 
> ã‚¦ã‚§ãƒ–æ¤œç´¢ã®çµæœã«ã‚ˆã‚‹ã¨ã€ã“ã®æ©Ÿèƒ½ã¯Unicodeã®æ–‡å­—ã‚³ãƒ¼ãƒ‰å€¤ã‚’ä½¿ã£ã¦ç‰¹æ®Šæ–‡å­—ã‚’å…¥åŠ›ã™ã‚‹æ–¹æ³•ã§ã™â´ã€‚ã—ã‹ã—ã€ã“ã®æ–¹æ³•ã¯Windows 10ã®æ–°ã—ã„IMEã§ã¯æ­£å¸¸ã«å‹•ä½œã—ãªã„å ´åˆãŒã‚ã‚‹ã‚ˆã†ã§ã™âµã€‚ãã®ç†ç”±ã¯ã€æ–°ã—ã„IMEãŒä»¥å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨äº’æ›æ€§ãŒãªã„ãŸã‚ã ã¨è€ƒãˆã‚‰ã‚Œã¾ã™Â³ã€‚
> 
> ã“ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ã«ã¯ã€æ¬¡ã®äºŒã¤ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚
> 
> - ä¸€ã¤ç›®ã¯ã€æ–°ã—ã„IMEã‚’ç„¡åŠ¹ã«ã—ã¦ã€ä»¥å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®IMEã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™Â³ã€‚ã“ã®æ–¹æ³•ã§ã¯ã€ä»¥ä¸‹ã®æ‰‹é †ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
>     1. IMEã‚’å³ã‚¯ãƒªãƒƒã‚¯ã—ã¦[è¨­å®š]ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
>     2. [ä¸€èˆ¬]ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
>     3. [äº’æ›æ€§è¨­å®š]ã‚°ãƒ«ãƒ¼ãƒ—ã®[ä»¥å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®Microsoft IMEã‚’ä½¿ç”¨ã™ã‚‹]ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¾ã™ã€‚
>     4. OKã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
> 
> - äºŒã¤ç›®ã¯ã€ç‰¹æ®Šæ–‡å­—ã‚’å…¥åŠ›ã™ã‚‹ãŸã‚ã®åˆ¥ã®ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™â´ã€‚ã“ã®æ–¹æ³•ã§ã¯ã€ä»¥ä¸‹ã®æ‰‹é †ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
>     1. ç‰¹æ®Šæ–‡å­—ã‚’å…¥åŠ›ã—ãŸã„å ´æ‰€ã«ã‚«ãƒ¼ã‚½ãƒ«ã‚’åˆã‚ã›ã¾ã™ã€‚
>     2. Win + . (ãƒ”ãƒªã‚ªãƒ‰)ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ã€çµµæ–‡å­—ã‚„é¡”æ–‡å­—ã®å…¥åŠ›ãƒ‘ãƒãƒ«ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
>     3. [è¨˜å·ã¨ç‰¹æ®Šæ–‡å­—]ã‚¿ãƒ–ã‚’é¸æŠã—ã¾ã™ã€‚
>     4. å…¥åŠ›ã—ãŸã„ç‰¹æ®Šæ–‡å­—ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
> 
> ä»¥ä¸ŠãŒç§ãŒè¦‹ã¤ã‘ãŸæ–¹æ³•ã§ã™ã€‚ã©ã¡ã‚‰ã‹ãŠè©¦ã—ãã ã•ã„ã€‚ã‚‚ã£ã¨è©³ã—ãçŸ¥ã‚ŠãŸã„å ´åˆã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯Â²ã‹ã‚‰æ¤œç´¢çµæœã‚„å›ç­”ãªã©ã‚’ã”è¦§ã„ãŸã ã‘ã¾ã™ã€‚ã”å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚ğŸ˜Š
> 
> ã‚½ãƒ¼ã‚¹: Bing ã¨ã®ä¼šè©± 2023/11/1
> (1) Windows ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ç‰¹æ®Šæ–‡å­—ã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³• - Microsoft .... https://support.microsoft.com/ja-jp/topic/windows-%E3%81%AE%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88%E3%81%A7%E7%89%B9%E6%AE%8A%E6%96%87%E5%AD%97%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95-ec1a4e84-706e-67a5-e52b-e3ebab90313f.
> (2) IMEã«é–¢ã™ã‚‹ãƒã‚°ã€‚ä»®åã«åˆ‡ã‚Šæ›¿ãˆã‚ˆã†ã¨ã™ã‚‹æ™‚ .... https://answers.microsoft.com/ja-jp/windows/forum/all/ime%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E3%83%90/44cd2c70-38aa-4417-a12c-a85740c9282b.
> (3) Microsoft æ—¥æœ¬èª IME - Microsoft ã‚µãƒãƒ¼ãƒˆ. https://support.microsoft.com/ja-jp/windows/microsoft-%E6%97%A5%E6%9C%AC%E8%AA%9E-ime-da40471d-6b91-4042-ae8b-713a96476916.
> (4) æ–‡å­—å…¥åŠ›ä¸­ã«ä½¿ãˆã‚‹ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼ç´¹ä»‹ã€11ç¨®é¡ã€‘ | å…ƒ .... https://oozappase.com/windows/ime-shortcutkey/.
> (5) Windows 10 IME ã¨ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã®ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ ã‚­ãƒ¼ä¸€è¦§ - Tipsfound. https://www.tipsfound.com/windows10/12013-windows10.
ã€€
> â“ Bing AIã¸ã®è³ªå•
> 
> PowerShell ã§ Altã‚’é•·æŠ¼ã—ã—ãªãŒã‚‰æ•°å­—4æ¡ã‚’ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã§ãã‚‹Functionã‚’ä½œæˆã—ã¦
ã€€
> âœ… Bing AIã®å›ç­”
> 
> PowerShellã§Altã‚­ãƒ¼ã‚’é•·æŠ¼ã—ã—ãªãŒã‚‰æ•°å­—4æ¡ã‚’ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã§ãã‚‹é–¢æ•°ã‚’ä½œæˆã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ãŠå°‹ã­ã§ã™ã­ã€‚ğŸ˜Š
> 
> ç§ã¯ã‚¦ã‚§ãƒ–æ¤œç´¢ã®çµæœã‚’ã‚‚ã¨ã«ã€ã„ãã¤ã‹ã®æ–¹æ³•ã‚’è¦‹ã¤ã‘ã¾ã—ãŸã®ã§ã€ã”ç´¹ä»‹ã—ã¾ã™ã€‚
> 
> - ä¸€ã¤ç›®ã®æ–¹æ³•ã¯ã€SendKeysãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ã¦ã€Altã‚­ãƒ¼ã¨æ•°å­—ã‚­ãƒ¼ã®çµ„ã¿åˆã‚ã›ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã§ã™Â¹ã€‚ã“ã®æ–¹æ³•ã§ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã¾ã™ã€‚
> 
> ```powershell
> # SendKeysã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹
> Add-Type -AssemblyName System.Windows.Forms
> 
> # Altã‚­ãƒ¼ã¨æ•°å­—ã‚­ãƒ¼ã®çµ„ã¿åˆã‚ã›ã‚’é€ä¿¡ã™ã‚‹é–¢æ•°
> function Send-AltNum {
>     Param (
>         # 4æ¡ã®æ•°å­—
>         [Parameter(Mandatory=$true)]
>         [string]$Num
>     )
>     # Altã‚­ãƒ¼ã‚’æŠ¼ã™
>     [System.Windows.Forms.SendKeys]::SendWait("%")
>     # æ•°å­—ã‚­ãƒ¼ã‚’æŠ¼ã™
>     foreach ($digit in $Num.ToCharArray()) {
>         [System.Windows.Forms.SendKeys]::SendWait($digit)
>     }
>     # Altã‚­ãƒ¼ã‚’é›¢ã™
>     [System.Windows.Forms.SendKeys]::SendWait("%")
> }
> 
> # ä¾‹: Alt+0128ã§ãƒ¦ãƒ¼ãƒ­è¨˜å·ã‚’å…¥åŠ›ã™ã‚‹
> Send-AltNum "0128"
> ```
> 
> - äºŒã¤ç›®ã®æ–¹æ³•ã¯ã€[InputSimulator](^2^)ã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ã€Altã‚­ãƒ¼ã¨æ•°å­—ã‚­ãƒ¼ã®çµ„ã¿åˆã‚ã›ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã™ã‚‹ã“ã¨ã§ã™Â³ã€‚ã“ã®æ–¹æ³•ã§ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã¾ã™ã€‚
> 
> ```powershell
> # InputSimulatorãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹
> Install-Package InputSimulator
> 
> # InputSimulatorãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’èª­ã¿è¾¼ã‚€
> Add-Type -Path "$env:USERPROFILE\.nuget\packages\inputsimulator\1.0.4\lib\net40\InputSimulator.dll"
> 
> # InputSimulatorã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚‹
> $sim = New-Object WindowsInput.InputSimulator
> 
> # Altã‚­ãƒ¼ã¨æ•°å­—ã‚­ãƒ¼ã®çµ„ã¿åˆã‚ã›ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã™ã‚‹é–¢æ•°
> function Simulate-AltNum {
>     Param (
>         # 4æ¡ã®æ•°å­—
>         [Parameter(Mandatory=$true)]
>         [string]$Num
>     )
>     # Altã‚­ãƒ¼ã‚’æŠ¼ã™
>     $sim.Keyboard.KeyDown([WindowsInput.Native.VirtualKeyCode]::MENU)
>     # æ•°å­—ã‚­ãƒ¼ã‚’æŠ¼ã™
>     foreach ($digit in $Num.ToCharArray()) {
>         $sim.Keyboard.KeyPress([WindowsInput.Native.VirtualKeyCode]::$digit)
>     }
>     # Altã‚­ãƒ¼ã‚’é›¢ã™
>     $sim.Keyboard.KeyUp([WindowsInput.Native.VirtualKeyCode]::MENU)
> }
> 
> # ä¾‹: Alt+0128ã§ãƒ¦ãƒ¼ãƒ­è¨˜å·ã‚’å…¥åŠ›ã™ã‚‹
> Simulate-AltNum "0128"
> ```
> 
> ä»¥ä¸ŠãŒç§ãŒè¦‹ã¤ã‘ãŸæ–¹æ³•ã§ã™ã€‚ã©ã¡ã‚‰ã‹ãŠè©¦ã—ãã ã•ã„ã€‚ã‚‚ã£ã¨è©³ã—ãçŸ¥ã‚ŠãŸã„å ´åˆã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯Â²ã‹ã‚‰æ¤œç´¢çµæœã‚„å›ç­”ãªã©ã‚’ã”è¦§ã„ãŸã ã‘ã¾ã™ã€‚ã”å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚ğŸ˜Š
> 
> ã‚½ãƒ¼ã‚¹: Bing ã¨ã®ä¼šè©± 2023/11/1
> (1) PowerShellã§SendKeysã‚’ä½¿ã£ã¦ã¿ãŸ #PowerShell - Qiita. https://qiita.com/nimzo6689/items/488467dbe0c4e5645745.
> (2) PowerShellã§ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã‚’è‡ªå‹•åŒ–ã™ã‚‹æ–¹æ³• | æ°´æˆ¸ã‚¹ãƒ¤ã®SE .... https://mitosuya.net/automation-input-keyboard.
> (3) ã‚¹ã‚¿ãƒƒãƒ•ãƒ–ãƒ­ã‚° Â» Blog Archive Â» PowerShellã§ã‚­ãƒ¼å…¥åŠ›ã®è‡ªå‹•åŒ–. https://systemage.co.jp/blog/?p=1662.
> (4) PowerShellã§ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã‚’è‡ªå‹•åŒ–ã™ã‚‹æ–¹æ³• | æ°´æˆ¸ã‚¹ãƒ¤ã®SE .... https://mitosuya.net/automation-input-keyboard.
> (5) undefined. https://msdn.microsoft.com/ja-jp/library/cc364423.aspx.