---
title: "“Alt長押し→数字入力→Alt離す”で文字入力できるショートカットキーを調べた（Microsoft IME）"
emoji: "🙆"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["microsoft", "windows", "ime"]
published: true
---
## 概要

つい先日、特殊文字の入力方法として、Microsoft IMEのショートカットキーを使った入力方法を知りました。

Microsoft IMEのショートカットキーとは、Altを長押ししつつNum Lockキーで特定の数字を入力して、
Altを離すと文字が入力されるという独特な入力方法のショートカットキーです。

このショートカットキーは、IMEのバージョンによって結果が一部異なります。
各Num数字キーで入力した結果 と 新旧IMEでの結果の差異 をまとめてみました。

## この記事のターゲット

- Microsoft IME のショートカットキーについて知りたい方
- Microsoft IME のショートカットキーと入力できる文字の対応表を知りたい方
- 新旧IMEで結果が変わる部分をおさえておきたい方

## Microsoft IMEのショートカットキーとは

前述で記載している通り、“Alt長押し → 数字入力 → Alt長押しを離す”というショートカットキーで機能する文字入力方法です。

このショートカットキーで入力する数値は、Shift-JISの文字コードと紐づいており、
数値は2桁以上を入力するとShift JISの半角文字が入力されます。

- 参考情報：文字コード表 シフトJIS(Shift_JIS) - シフトJISの1バイトコード（半角文字）のエリアマップ
    http://charset.7jp.net/sjis.html

なお、テンキーありのフルキーボードの場合は、テンキーにある数値で入力する必要があります。
ノートパソコンなどでテンキーがない場合、Num Lockをオンしファンクションキー（Fn）などと組み合わせて、
数値を入力する必要あり。

:::details 補足情報：その他の特殊な入力方法

- ASCIIの文字コードで文字を入力する方法

    全角入力モード中に数字を4桁入力しスペースで表示される変換候補の中に“\[文字コード変換\]...”と表示されるので、
    選択すると対応するASCIIコード（16進）の文字が表示される。
    ![全角モード中に“0040”と入力して変換すると「\[文字コード変換\]...」と表示される](https://storage.googleapis.com/zenn-user-upload/3f1bca4b43fe-20231129.png)
    *画像：全角モード中に“0040”と入力して変換すると「\[文字コード変換\]...」と表示*

    そのまま `[文字コード変換]...` を選択すると対応する16進のASCIIコードである「@」が入力される。

    - ASCIIの文字コード表
        <http://www3.nit.ac.jp/~tamura/ex2/ascii.html>

- Unicodeの文字コードで文字を入力する方法
    - Microsoft Office 関連の特殊な入力方法
        ExcelやPowerPoint、Word、もしくはワードパッド（WordPad）では、「数値入力（2桁以上） → Alt + X」でUnicodeの文字が入力可能。
        https://support.microsoft.com/en-us/office/insert-ascii-or-unicode-latin-based-symbols-and-characters-d13f58d3-7bcb-44a7-a4d5-972ee12e50e0#ID0EDFBH
        https://ja.wikipedia.org/wiki/Unicode一覧_0000-0FFF

        - 参考情報：今後、ワードパッド（WordPad）は廃止予定
            <https://www.itmedia.co.jp/news/articles/2309/03/news037.html>

    - 文字コード表を使った入力方法
        ファイル名を指定して実行で「`charmap`」で表示される文字コード表でもUnicodeの文字を直接入力できる。
        https://support.microsoft.com/en-us/office/insert-ascii-or-unicode-latin-based-symbols-and-characters-d13f58d3-7bcb-44a7-a4d5-972ee12e50e0#ID0EDJBH

    - Microsoft IMEのショートカットキーでUnicode文字を入力する方法
        日本語版のWindows OSでは、Windows のキーボード設定が“日本語 - Microsoft IME”となっているが、
        “英語（米国） - US”に変更して
        「Alt長押し → 数値入力（数値2桁以上） → Alt長押しを離す」でもUnicodeの文字を入力可。
:::

## 環境

### OSのバージョン

Windows 10 Pro環境

```powershell:Get-WmiObjectコマンド
PS C:\Users\"ユーザー名"> Get-CimInstance CIM_OperatingSystem

SystemDirectory     Organization BuildNumber RegisteredUser SerialNumber            Version
---------------     ------------ ----------- -------------- ------------            -------
C:\WINDOWS\system32              19045       XXXXX          00000-00000-00000-AAAAA 10.0.19045
                                             ^^^^^          ^^^^^ ^^^^^ ^^^^^ ^^^^^
                                             ↑マスク       ↑マスク

PS C:\Users\"ユーザー名">
PS C:\Users\"ユーザー名">
```

- 参考記事：PowerShell Core ではGet-WmiObjectからGet-CimInstanceに変更
    https://www.vwnet.jp/windows/PowerShell/2021061301/PowerShellCore6xWMI.htm

- 参考記事：Win32_OperatingSystem クラスは CIM_OperatingSystem に変更
    https://learn.microsoft.com/ja-jp/windows/win32/cimwin32prov/cim-operatingsystem

### PowerShellのバージョン

```powershell:PowerShellのバージョン
PS C:\Users\"ユーザー名"> $PSVersionTable

Name                           Value
----                           -----
PSVersion                      7.3.9
PSEdition                      Core
GitCommitId                    7.3.9
OS                             Microsoft Windows 10.0.19045
Platform                       Win32NT
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0…}
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1
WSManStackVersion              3.0

PS C:\Users\"ユーザー名">
```

## Microsoft IMEのショートカットキーの一覧（新旧2つのIMEでの結果あり）

Windows 10 の規定値である **最新のIME** でショートカットキー、“Alt長押し→数字入力→Alt長押しを離す”を入力した結果と、
IMEの設定で切り替えできる **以前のIME** のバージョンに戻して入力した結果で差異があります。

これら新旧IMEのショートカットキーの結果に差異がある事がWindowsとして仕様なのか不具合なのかは不明です。

新旧それぞれのバージョンで確認した結果を1つの表にまとめました。

::::details 現在のIMEが新旧どちらか判定する方法・設定を切り替える方法

- 設定をみて判断する方法（また、設定を切り替える方法）
    1. 設定からIME設定を検索すうる方法
        1. 設定画面を開く
        1. 検索キーワードで「`IME`」
            ![Windowsの設定、検索欄で“IME”と入力し「日本語 IME 設定」が表示された画面](https://storage.googleapis.com/zenn-user-upload/e465c0ac8090-20231206.png)
            *画像：設定の検索欄で“IME”と入力した結果*
        1. “日本語 IME 設定”を選択

        :::details 他にMicrosoft IMEの設定を開く方法
        - 最新のIME限定：タスクトレイのAまたはあを右クリックして設定を開く方法
            1. タスクトレイにある“A（半角モード中）”または“あ（全角モード中）”を右クリックし「設定(S)」を選択
                ![タスクトレイにある“A（半角モード中）を右クリックしコンテキストメニュー（ショートカットメニュー）から設定を選択する”](https://storage.googleapis.com/zenn-user-upload/47042a4502d6-20231128.png)
                *画像：タスクトレイにあるIMEのアイコン“A（半角モード中）”を右クリックから設定を選択する*
        - 設定から1つずつ画面推移してIMEの設定を開く方法
            かなり深い場所にあり設定から「`IME`」と検索した方が手っ取り早いので、この方法は推奨しない。
            1. 設定を開く
            1. 時刻と言語
            1. 左側のメニューで「言語」を選択
            1. 優先する言語の“日本語”を選択後に表示される「オプション」ボタンをクリック
            1. 言語のオプション より キーボード欄 にある“Microsoft IME”を選択後に表示される「オプション」ボタンをクリック
        :::
    1. Microsoft IMEの設定画面より 全般 をクリック
    1. 互換性 にある “以前のバージョンの Microsoft IME を使う”のトグルボタンをチェック
        - オフの場合：最新のIMEで動作中
            ![“以前のバージョンの Microsoft IME を使う”のトグルボタンがオフの状態の為、最新のIMEで動作中。](https://storage.googleapis.com/zenn-user-upload/33e80a29c28b-20231124.png)
            *画像：“最新のIMEが有効となっている状態（トグルボタンがオフ）*
        - オンの場合：以前のIMEで動作中
            ![“以前のバージョンの Microsoft IME を使う”のトグルボタンがオフの状態の為、以前のIMEで動作中。](https://storage.googleapis.com/zenn-user-upload/ed206b737670-20231124.png)
            *画像：“以前のIMEの方が有効となっている状態（トグルボタンがオン）*
        　
        なお、**こちらのトグルボタンをオン／オフする事で新旧のIMEを切り替えできる**。
            [こちら](https://support.microsoft.com/ja-jp/windows/microsoft-日本語-ime-da40471d-6b91-4042-ae8b-713a96476916#ID0EDD)のMicrosoft 公式ページでも紹介されている「以前のバージョンの Microsoft IME を使用する」方法で新旧IMEを切り替える。
            - オフ から オン にした際のポップアップメッセージ
                ![“以前のバージョンの Microsoft IME を使う”のトグルボタンがオフからオンにする時のメッセージ](https://storage.googleapis.com/zenn-user-upload/795190649f31-20231124.png)
                *画像：“以前のバージョンの Microsoft IME を使う”のトグルボタンをオンにする時のメッセージ*
            - オン から オフ にした際のポップアップメッセージ
                ![“以前のバージョンの Microsoft IME を使う”のトグルボタンがオンからオフにする時のメッセージ](https://storage.googleapis.com/zenn-user-upload/e64f97f1b7c3-20231124.png)
                *画像：“以前のバージョンの Microsoft IME を使う”のトグルボタンをオフにする時のメッセージ*

- タスクトレイにあるIMEアイコン（Aまたはあ）のコンテキストメニューの見た目で判断する方法
    半角モード中では“A”、全角モード中では“あ”が表示されているタスクトレイを右クリックした際に表示されるコンテキストメニュー（ショートカットメニュー）の見た目で新旧を判断できる。
        ![半角モード中でタスクトレイのIMEのアイコンが“A”が表示されている状態](https://storage.googleapis.com/zenn-user-upload/b203d2cbc198-20231124.png)
        *画像：半角モード中で“A”が表示されている状態*
        ![全角モード中でタスクトレイのIMEのアイコンが“あ”が表示されている状態](https://storage.googleapis.com/zenn-user-upload/37aa93ac7903-20231124.png)
        *画像：全角モード中で“あ”が表示されている状態*
    - 最新のIME
        ![最新のIMEのアイコンで右クリックした際のコンテキストメニュー](https://storage.googleapis.com/zenn-user-upload/8f788a0e41b5-20231124.png)
        *画像：最新のIMEのコンテキストメニュー*
    - 以前のIME
        ![以前のIMEのアイコンで右クリックした際のコンテキストメニュー](https://storage.googleapis.com/zenn-user-upload/58eedc61745b-20231124.png)
        *画像：以前のIMEのコンテキストメニュー*
::::

### 新旧IMEでのショートカットキー実行結果の一覧・比較表

数値“033”であれば、「Alt長押し → Num数値キーで“033” → Alt長押しを離す」という、
方法で「`!`」の文字を入力できます。

なお、前述でも説明している通り数値入力は2桁以上であれば有効とされるので、

- “33”
- “00033”

などでも機能する。

| 数値 | 最新のIME | 以前のIME | 差異の有無<br>（差異あり:○、差異なし:－） |
| ---- | ---- | ---- | ---- |
| 001 | `` ※ 制御文字"SOH" | `(空文字)` | ○ |
| 002 | `` ※ 制御文字"STX" | `(空文字)` | ○ |
| 003 | `` ※ 制御文字"ETX" | `(空文字)` | ○ |
| 004 | `` ※ 制御文字"EOT" | `(空文字)` | ○ |
| 005 | `` ※ 制御文字"ENQ" | `(空文字)` | ○ |
| 006 | `` ※ 制御文字"ACK" | `(空文字)` | ○ |
| 007 | `` ※ 制御文字"BEL" | `(空文字)` | ○ |
| 008 | `` ※ 制御文字"BS" | `(空文字)` | ○ |
| 009 | `	（← タブあり）` ※ 制御文字"HT" | `	（← タブあり）` | － |
| 010 | `（← LF改行あり）` ※ 制御文字"LF" | `（← CRLF改行あり）` | ○ |
| 011 | `` ※ 制御文字"VT" | `(空文字)` | ○ |
| 012 | `` ※ 制御文字"FF" | `(空文字)` | ○ |
| 013 | `（← CR改行あり）` ※ 制御文字"CR" | `（← CRLF改行あり）` | ○ |
| 014 | `` ※ 制御文字"SO" | `(空文字)` | ○ |
| 015 | `` ※ 制御文字"SI" | `(空文字)` | ○ |
| 016 | `` ※ 制御文字"DLE" | `(空文字)` | ○ |
| 017 | `` ※ 制御文字"DC1" | `(空文字)` | ○ |
| 018 | `` ※ 制御文字"DC2" | `(空文字)` | ○ |
| 019 | `` ※ 制御文字"DC3" | `(空文字)` | ○ |
| 020 | `` ※ 制御文字"DC4" | `(空文字)` | ○ |
| 021 | `` ※ 制御文字"NAK" | `(空文字)` | ○ |
| 022 | `` ※ 制御文字"SYN" | `(空文字)` | ○ |
| 023 | `` ※ 制御文字"ETB" | `(空文字)` | ○ |
| 024 | `` ※ 制御文字"CAN" | `(空文字)` | ○ |
| 025 | `` ※ 制御文字"EM" | `(空文字)` | ○ |
| 026 | `` ※ 制御文字"SUB" | `(空文字)` | ○ |
| 027 | `` ※ 制御文字"ESC" | `(空文字)` | ○ |
| 028 | `` ※ 制御文字"FS" | `(空文字)` | ○ |
| 029 | `` ※ 制御文字"GS" | `(空文字)` | ○ |
| 030 | `` ※ 制御文字"RS" | `(空文字)` | ○ |
| 031 | `` ※ 制御文字"US" | `(空文字)` | ○ |
| 032 | ` ` | ` ` | － |
| 033 | `!` | `!` | － |
| 034 | `"` | `"` | － |
| 035 | `#` | `#` | － |
| 036 | `$` | `$` | － |
| 037 | `%` | `%` | － |
| 038 | `&` | `&` | － |
| 039 | `'` | `'` | － |
| 040 | `(` | `(` | － |
| 041 | `)` | `)` | － |
| 042 | `*` | `*` | － |
| 043 | `+` | `+` | － |
| 044 | `,` | `,` | － |
| 045 | `-` | `-` | － |
| 046 | `.` | `.` | － |
| 047 | `/` | `/` | － |
| 048 | `0` | `0` | － |
| 049 | `1` | `1` | － |
| 050 | `2` | `2` | － |
| 051 | `3` | `3` | － |
| 052 | `4` | `4` | － |
| 053 | `5` | `5` | － |
| 054 | `6` | `6` | － |
| 055 | `7` | `7` | － |
| 056 | `8` | `8` | － |
| 057 | `9` | `9` | － |
| 058 | `:` | `:` | － |
| 059 | `;` | `;` | － |
| 060 | `<` | `<` | － |
| 061 | `=` | `=` | － |
| 062 | `>` | `>` | － |
| 063 | `?` | `?` | － |
| 064 | `@` | `@` | － |
| 065 | `A` | `A` | － |
| 066 | `B` | `B` | － |
| 067 | `C` | `C` | － |
| 068 | `D` | `D` | － |
| 069 | `E` | `E` | － |
| 070 | `F` | `F` | － |
| 071 | `G` | `G` | － |
| 072 | `H` | `H` | － |
| 073 | `I` | `I` | － |
| 074 | `J` | `J` | － |
| 075 | `K` | `K` | － |
| 076 | `L` | `L` | － |
| 077 | `M` | `M` | － |
| 078 | `N` | `N` | － |
| 079 | `O` | `O` | － |
| 080 | `P` | `P` | － |
| 081 | `Q` | `Q` | － |
| 082 | `R` | `R` | － |
| 083 | `S` | `S` | － |
| 084 | `T` | `T` | － |
| 085 | `U` | `U` | － |
| 086 | `V` | `V` | － |
| 087 | `W` | `W` | － |
| 088 | `X` | `X` | － |
| 089 | `Y` | `Y` | － |
| 090 | `Z` | `Z` | － |
| 091 | `[` | `[` | － |
| 092 | `\` | `\` | － |
| 093 | `]` | `]` | － |
| 094 | `^` | `^` | － |
| 095 | `_` | `_` | － |
| 096 | `\`` | `\`` | － |
| 097 | `a` | `a` | － |
| 098 | `b` | `b` | － |
| 099 | `c` | `c` | － |
| 100 | `d` | `d` | － |
| 101 | `e` | `e` | － |
| 102 | `f` | `f` | － |
| 103 | `g` | `g` | － |
| 104 | `h` | `h` | － |
| 105 | `i` | `i` | － |
| 106 | `j` | `j` | － |
| 107 | `k` | `k` | － |
| 108 | `l` | `l` | － |
| 109 | `m` | `m` | － |
| 110 | `n` | `n` | － |
| 111 | `o` | `o` | － |
| 112 | `p` | `p` | － |
| 113 | `q` | `q` | － |
| 114 | `r` | `r` | － |
| 115 | `s` | `s` | － |
| 116 | `t` | `t` | － |
| 117 | `u` | `u` | － |
| 118 | `v` | `v` | － |
| 119 | `w` | `w` | － |
| 120 | `x` | `x` | － |
| 121 | `y` | `y` | － |
| 122 | `z` | `z` | － |
| 123 | `{` | `{` | － |
| 124 | `|` | `|` | － |
| 125 | `}` | `}` | － |
| 126 | `~` | `~` | － |
| 127 | `` ※ 制御文字"DEL" | `(空文字)` | ○ |
| 128 | `` | `€` | ○ |
| 129 | `・` | `` | ○ |
| 130 | `・` | `‚` | ○ |
| 131 | `・` | `ƒ` | ○ |
| 132 | `・` | `„` | ○ |
| 133 | `・` | `…` | ○ |
| 134 | `・` | `†` | ○ |
| 135 | `・` | `‡` | ○ |
| 136 | `・` | `ˆ` | ○ |
| 137 | `・` | `‰` | ○ |
| 138 | `・` | `Š` | ○ |
| 139 | `・` | `‹` | ○ |
| 140 | `・` | `Œ` | ○ |
| 141 | `・` | `` | ○ |
| 142 | `・` | `Ž` | ○ |
| 143 | `・` | `` | ○ |
| 144 | `・` | `` | ○ |
| 145 | `・` | `‘` | ○ |
| 146 | `・` | `’` | ○ |
| 147 | `・` | `“` | ○ |
| 148 | `・` | `”` | ○ |
| 149 | `・` | `•` | ○ |
| 150 | `・` | `–` | ○ |
| 151 | `・` | `—` | ○ |
| 152 | `・` | `˜` | ○ |
| 153 | `・` | `™` | ○ |
| 154 | `・` | `š` | ○ |
| 155 | `・` | `›` | ○ |
| 156 | `・` | `œ` | ○ |
| 157 | `・` | `` | ○ |
| 158 | `・` | `ž` | ○ |
| 159 | `・` | `Ÿ` | ○ |
| 160 | `` | ` ` | ○ |
| 161 | `｡` | `｡` | － |
| 162 | `｢` | `｢` | － |
| 163 | `｣` | `｣` | － |
| 164 | `､` | `､` | － |
| 165 | `･` | `･` | － |
| 166 | `ｦ` | `ｦ` | － |
| 167 | `ｧ` | `ｧ` | － |
| 168 | `ｨ` | `ｨ` | － |
| 169 | `ｩ` | `ｩ` | － |
| 170 | `ｪ` | `ｪ` | － |
| 171 | `ｫ` | `ｫ` | － |
| 172 | `ｬ` | `ｬ` | － |
| 173 | `ｭ` | `ｭ` | － |
| 174 | `ｮ` | `ｮ` | － |
| 175 | `ｯ` | `ｯ` | － |
| 176 | `ｰ` | `ｰ` | － |
| 177 | `ｱ` | `ｱ` | － |
| 178 | `ｲ` | `ｲ` | － |
| 179 | `ｳ` | `ｳ` | － |
| 180 | `ｴ` | `ｴ` | － |
| 181 | `ｵ` | `ｵ` | － |
| 182 | `ｶ` | `ｶ` | － |
| 183 | `ｷ` | `ｷ` | － |
| 184 | `ｸ` | `ｸ` | － |
| 185 | `ｹ` | `ｹ` | － |
| 186 | `ｺ` | `ｺ` | － |
| 187 | `ｻ` | `ｻ` | － |
| 188 | `ｼ` | `ｼ` | － |
| 189 | `ｽ` | `ｽ` | － |
| 190 | `ｾ` | `ｾ` | － |
| 191 | `ｿ` | `ｿ` | － |
| 192 | `ﾀ` | `ﾀ` | － |
| 193 | `ﾁ` | `ﾁ` | － |
| 194 | `ﾂ` | `ﾂ` | － |
| 195 | `ﾃ` | `ﾃ` | － |
| 196 | `ﾄ` | `ﾄ` | － |
| 197 | `ﾅ` | `ﾅ` | － |
| 198 | `ﾆ` | `ﾆ` | － |
| 199 | `ﾇ` | `ﾇ` | － |
| 200 | `ﾈ` | `ﾈ` | － |
| 201 | `ﾉ` | `ﾉ` | － |
| 202 | `ﾊ` | `ﾊ` | － |
| 203 | `ﾋ` | `ﾋ` | － |
| 204 | `ﾌ` | `ﾌ` | － |
| 205 | `ﾍ` | `ﾍ` | － |
| 206 | `ﾎ` | `ﾎ` | － |
| 207 | `ﾏ` | `ﾏ` | － |
| 208 | `ﾐ` | `ﾐ` | － |
| 209 | `ﾑ` | `ﾑ` | － |
| 210 | `ﾒ` | `ﾒ` | － |
| 211 | `ﾓ` | `ﾓ` | － |
| 212 | `ﾔ` | `ﾔ` | － |
| 213 | `ﾕ` | `ﾕ` | － |
| 214 | `ﾖ` | `ﾖ` | － |
| 215 | `ﾗ` | `ﾗ` | － |
| 216 | `ﾘ` | `ﾘ` | － |
| 217 | `ﾙ` | `ﾙ` | － |
| 218 | `ﾚ` | `ﾚ` | － |
| 219 | `ﾛ` | `ﾛ` | － |
| 220 | `ﾜ` | `ﾜ` | － |
| 221 | `ﾝ` | `ﾝ` | － |
| 222 | `ﾞ` | `ﾞ` | － |
| 223 | `ﾟ` | `ﾟ` | － |
| 224 | `・` | `à` | ○ |
| 225 | `・` | `á` | ○ |
| 226 | `・` | `â` | ○ |
| 227 | `・` | `ã` | ○ |
| 228 | `・` | `ä` | ○ |
| 229 | `・` | `å` | ○ |
| 230 | `・` | `æ` | ○ |
| 231 | `・` | `ç` | ○ |
| 232 | `・` | `è` | ○ |
| 233 | `・` | `é` | ○ |
| 234 | `・` | `ê` | ○ |
| 235 | `・` | `ë` | ○ |
| 236 | `・` | `ì` | ○ |
| 237 | `・` | `í` | ○ |
| 238 | `・` | `î` | ○ |
| 239 | `・` | `ï` | ○ |
| 240 | `・` | `ð` | ○ |
| 241 | `・` | `ñ` | ○ |
| 242 | `・` | `ò` | ○ |
| 243 | `・` | `ó` | ○ |
| 244 | `・` | `ô` | ○ |
| 245 | `・` | `õ` | ○ |
| 246 | `・` | `ö` | ○ |
| 247 | `・` | `÷` | ○ |
| 248 | `・` | `ø` | ○ |
| 249 | `・` | `ù` | ○ |
| 250 | `・` | `ú` | ○ |
| 251 | `・` | `û` | ○ |
| 252 | `・` | `ü` | ○ |
| 253 | `` | `ý` | ○ |
| 254 | `` | `þ` | ○ |
| 255 | `` | `ÿ` | ○ |

::::details 新旧IMEのショートカットキーで入力する数値の有効桁数について

ネットで調べる限り公式サイトでも公表されていない情報のようでした。
今回はAlt長押しという特殊な入力方法が機能した自動化ツール「[UWSC(Free版)](https://www.vector.co.jp/soft/winnt/util/se115105.html)」を使用して、
新旧IMEで入力した結果を確認しました。
（後述でUWSCについて紹介します。）

- 最新のMicrosoft IMEで確認した結果

    下記の通り有効桁数の境界位置を調べた結果、最新のIMEでは有効桁数が5桁である事がわかりました。
    なお、数値を5桁以上入力すると前方で入力した1桁目から数えた **上5桁が有効値** になるもよう。

    - 1桁目が数字1で連番した構成
        下記の通り、上桁が合う数字の構成にしてみた結果、**上5桁で判断**している事がわかる。

        ```
        1234          :ﾒ    👈 有効桁数は5桁。5桁以内の4桁
        12345         :9    👈 有効桁数の5桁
        123456        :9    👈 有効桁数は上5桁の為、「12345」と同様の結果
        1234567890    :9    👈 有効桁数は上5桁の為、「12345」と同様の結果
        ```

    - 先頭が大きい数値で1ずつ引いた構成
        下記の通り、下桁が合う数字の構成にしてみた結果、下桁では判定していない事がわかる。

        ```
        3210        :・     👈 有効桁数は上5桁以内の4桁
        43210       :ﾊ      👈 有効桁数は上5桁
        543210      :1      👈 有効桁数は上5桁の為、「43210」とは違う結果
        9876543210  :ﾍ      👈 有効桁数は上5桁の為、「43210」とは違う結果
        ```

    :::details 補足情報：最新のIME + 最大5桁で検証した結果

    ```:最新のIME + 最大5桁で検証した結果
    00001    : 
    00002    : 
    00003    : 
    00004    : 
    00005    : 
    00006    : 
    00007    : 
    00008    : 
    00009    : 	（タブ）
    00010    : （LF改行コード）
    00011    : 
    00012    : 
    00013    : （CR改行コード）
    00014    : 
    00015    : 
    00016    : 
    00017    : 
    00018    : 
    00019    : 
    00020    : 
    00021    : 
    00022    : 
    00023    : 
    00024    : 
    00025    : 
    00026    : 
    00027    : 
    00028    : 
    00029    : 
    00030    : 
    00031    : 
    00032    :  （半角の空白）
    00033    : !
    00034    : "
    00035    : #
    00036    : $
    00037    : %
    00038    : &
    00039    : '
    00040    : (
    00041    : )
    00042    : *
    00043    : +
    00044    : ,
    00045    : -
    00046    : .
    00047    : /
    00048    : 0
    00049    : 1
    00050    : 2
    00051    : 3
    00052    : 4
    00053    : 5
    00054    : 6
    00055    : 7
    00056    : 8
    00057    : 9
    00058    : :
    00059    : ;
    00060    : <
    00061    : =
    00062    : >
    00063    : ?
    00064    : @
    00065    : A
    00066    : B
    00067    : C
    00068    : D
    00069    : E
    00070    : F
    00071    : G
    00072    : H
    00073    : I
    00074    : J
    00075    : K
    00076    : L
    00077    : M
    00078    : N
    00079    : O
    00080    : P
    00081    : Q
    00082    : R
    00083    : S
    00084    : T
    00085    : U
    00086    : V
    00087    : W
    00088    : X
    00089    : Y
    00090    : Z
    00091    : [
    00092    : \
    00093    : ]
    00094    : ^
    00095    : _
    00096    : `
    00097    : a
    00098    : b
    00099    : c
    00100    : d
    00101    : e
    00102    : f
    00103    : g
    00104    : h
    00105    : i
    00106    : j
    00107    : k
    00108    : l
    00109    : m
    00110    : n
    00111    : o
    00112    : p
    00113    : q
    00114    : r
    00115    : s
    00116    : t
    00117    : u
    00118    : v
    00119    : w
    00120    : x
    00121    : y
    00122    : z
    00123    : {
    00124    : |
    00125    : }
    00126    : ~
    00127    : 
    00128    : 
    00129    : ・
    00130    : ・
    00131    : ・
    00132    : ・
    00133    : ・
    00134    : ・
    00135    : ・
    00136    : ・
    00137    : ・
    00138    : ・
    00139    : ・
    00140    : ・
    00141    : ・
    00142    : ・
    00143    : ・
    00144    : ・
    00145    : ・
    00146    : ・
    00147    : ・
    00148    : ・
    00149    : ・
    00150    : ・
    00151    : ・
    00152    : ・
    00153    : ・
    00154    : ・
    00155    : ・
    00156    : ・
    00157    : ・
    00158    : ・
    00159    : ・
    00160    : 
    00161    : ｡
    00162    : ｢
    00163    : ｣
    00164    : ､
    00165    : ･
    00166    : ｦ
    00167    : ｧ
    00168    : ｨ
    00169    : ｩ
    00170    : ｪ
    00171    : ｫ
    00172    : ｬ
    00173    : ｭ
    00174    : ｮ
    00175    : ｯ
    00176    : ｰ
    00177    : ｱ
    00178    : ｲ
    00179    : ｳ
    00180    : ｴ
    00181    : ｵ
    00182    : ｶ
    00183    : ｷ
    00184    : ｸ
    00185    : ｹ
    00186    : ｺ
    00187    : ｻ
    00188    : ｼ
    00189    : ｽ
    00190    : ｾ
    00191    : ｿ
    00192    : ﾀ
    00193    : ﾁ
    00194    : ﾂ
    00195    : ﾃ
    00196    : ﾄ
    00197    : ﾅ
    00198    : ﾆ
    00199    : ﾇ
    00200    : ﾈ
    00201    : ﾉ
    00202    : ﾊ
    00203    : ﾋ
    00204    : ﾌ
    00205    : ﾍ
    00206    : ﾎ
    00207    : ﾏ
    00208    : ﾐ
    00209    : ﾑ
    00210    : ﾒ
    00211    : ﾓ
    00212    : ﾔ
    00213    : ﾕ
    00214    : ﾖ
    00215    : ﾗ
    00216    : ﾘ
    00217    : ﾙ
    00218    : ﾚ
    00219    : ﾛ
    00220    : ﾜ
    00221    : ﾝ
    00222    : ﾞ
    00223    : ﾟ
    00224    : ・
    00225    : ・
    00226    : ・
    00227    : ・
    00228    : ・
    00229    : ・
    00230    : ・
    00231    : ・
    00232    : ・
    00233    : ・
    00234    : ・
    00235    : ・
    00236    : ・
    00237    : ・
    00238    : ・
    00239    : ・
    00240    : ・
    00241    : ・
    00242    : ・
    00243    : ・
    00244    : ・
    00245    : ・
    00246    : ・
    00247    : ・
    00248    : ・
    00249    : ・
    00250    : ・
    00251    : ・
    00252    : ・
    00253    : 
    00254    : 
    00255    : 
    00256    : Ā
    ※ 以降、あいだにある255個のショートカットキーの結果は、00001 - 00255 と同様。
    00512    : Ȁ
    00768    : ̀
    01024    : Ѐ
    01280    : Ԁ
    01536    : ؀
    01792    : ܀
    02048    : ࠀ
    02304    : ऀ
    02560    : ਀
    02816    : ଀
    03072    : ఀ
    03328    : ഀ
    03584    : ฀
    03840    : ༀ
    04096    : က
    04352    : ᄀ
    04608    : ሀ
    04864    : ጀ
    05120    : ᐀
    05376    : ᔀ
    05632    : ᘀ
    05888    : ᜀ
    06144    : ᠀
    06400    : ᤀ
    06656    : ᨀ
    06912    : ᬀ
    07168    : ᰀ
    07424    : ᴀ
    07680    : Ḁ
    07936    : ἀ
    08192    :  
    08448    : ℀
    08704    : ∀
    08960    : ⌀
    09216    : ␀
    09472    : ─
    09728    : ☀
    09984    : ✀
    10240    : ⠀
    10496    : ⤀
    10752    : ⨀
    11008    : ⬀
    11264    : Ⰰ
    11520    : ⴀ
    11776    : ⸀
    12032    : ⼀
    12288    : 　
    12544    : ㄀
    12800    : ㈀
    13056    : ㌀
    13312    : 㐀
    13568    : 㔀
    13824    : 㘀
    14080    : 㜀
    14336    : 㠀
    14592    : 㤀
    14848    : 㨀
    15104    : 㬀
    15360    : 㰀
    15616    : 㴀
    15872    : 㸀
    16128    : 㼀
    16384    : 䀀
    16640    : 䄀
    16896    : 䈀
    17152    : 䌀
    17408    : 䐀
    17664    : 䔀
    17920    : 䘀
    18176    : 䜀
    18432    : 䠀
    18688    : 䤀
    18944    : 䨀
    19200    : 䬀
    19456    : 䰀
    19712    : 䴀
    19968    : 一
    20224    : 伀
    20480    : 倀
    20736    : 儀
    20992    : 刀
    21248    : 匀
    21504    : 吀
    21760    : 唀
    22016    : 嘀
    22272    : 圀
    22528    : 堀
    22784    : 夀
    23040    : 娀
    23296    : 嬀
    23552    : 尀
    23808    : 崀
    24064    : 帀
    24320    : 开
    24576    : 怀
    24832    : 愀
    25088    : 戀
    25344    : 挀
    25600    : 搀
    25856    : 攀
    26112    : 昀
    26368    : 最
    26624    : 栀
    26880    : 椀
    27136    : 樀
    27392    : 欀
    27648    : 氀
    27904    : 洀
    28160    : 渀
    28416    : 漀
    28672    : 瀀
    28928    : 焀
    29184    : 爀
    29440    : 猀
    29696    : 琀
    29952    : 甀
    30208    : 瘀
    30464    : 眀
    30720    : 砀
    30976    : 礀
    31232    : 稀
    31488    : 笀
    31744    : 簀
    32000    : 紀
    32256    : 縀
    32512    : 缀
    32768    : 耀
    33024    : 脀
    33280    : 舀
    33536    : 茀
    33792    : 萀
    34048    : 蔀
    34304    : 蘀
    34560    : 蜀
    34816    : 蠀
    35072    : 褀
    35328    : 言
    35584    : 謀
    35840    : 谀
    36096    : 贀
    36352    : 踀
    36608    : 輀
    36864    : 退
    37120    : 鄀
    37376    : 鈀
    37632    : 錀
    37888    : 鐀
    38144    : 销
    38400    : 阀
    38656    : 需
    38912    : 頀
    39168    : 餀
    39424    : 騀
    39680    : 鬀
    39936    : 鰀
    40192    : 鴀
    40448    : 鸀
    40704    : 鼀
    40960    : ꀀ
    41216    : ꄀ
    41472    : ꈀ
    41728    : ꌀ
    41984    : ꐀ
    42240    : ꔀ
    42496    : ꘀ
    42752    : ꜀
    43008    : ꠀ
    43264    : ꤀
    43520    : ꨀ
    43776    : ꬀
    44032    : 가
    44288    : 관
    44544    : 글
    44800    : 꼀
    45056    : 뀀
    45312    : 넀
    45568    : 눀
    45824    : 대
    46080    : 됀
    46336    : 딀
    46592    : 똀
    46848    : 뜀
    47104    : 렀
    47360    : 뤀
    47616    : 먀
    47872    : 묀
    48128    : 밀
    48384    : 봀
    48640    : 븀
    48896    : 뼀
    49152    : 쀀
    49408    : 섀
    49664    : 숀
    49920    : 쌀
    50176    : 쐀
    50432    : 씀
    50688    : 였
    50944    : 윀
    51200    : 저
    51456    : 준
    51712    : 쨀
    51968    : 쬀
    52224    : 찀
    52480    : 촀
    52736    : 츀
    52992    : 케
    53248    : 퀀
    53504    : 턀
    53760    : 툀
    54016    : 팀
    54272    : 퐀
    54528    : 픀
    54784    : 혀
    55040    : 휀
    55296    : �
    55552    : �
    55808    : �
    56064    : �
    56320    : �
    56576    : �
    56832    : �
    57088    : �
    57344    : 
    57600    : 
    57856    : 
    58112    : 
    58368    : 
    58624    : 
    58880    : 
    59136    : 
    59392    : 
    59648    : 
    59904    : 
    60160    : 
    60416    : 
    60672    : 
    60928    : 
    61184    : 
    61440    : 
    61696    : 
    61952    : 
    62208    : 
    62464    : 
    62720    : 
    62976    : 
    63232    : 
    63488    : 
    63744    : 豈
    64000    : 切
    64256    : ﬀ
    64512    : ﰀ
    64768    : ﴀ
    65024    : ︀
    65280    : ＀
    65536    : 
    65792    : Ā
    66048    : Ȁ
    66304    : ̀
    66560    : Ѐ
    66816    : Ԁ
    67072    : ؀
    67328    : ܀
    67584    : ࠀ
    67840    : ऀ
    68096    : ਀
    68352    : ଀
    68608    : ఀ
    68864    : ഀ
    69120    : ฀
    69376    : ༀ
    69632    : က
    69888    : ᄀ
    70144    : ሀ
    70400    : ጀ
    70656    : ᐀
    70912    : ᔀ
    71168    : ᘀ
    71424    : ᜀ
    71680    : ᠀
    71936    : ᤀ
    72192    : ᨀ
    72448    : ᬀ
    72704    : ᰀ
    72960    : ᴀ
    73216    : Ḁ
    73472    : ἀ
    73728    :  
    73984    : ℀
    74240    : ∀
    74496    : ⌀
    74752    : ␀
    75008    : ─
    75264    : ☀
    75520    : ✀
    75776    : ⠀
    76032    : ⤀
    76288    : ⨀
    76544    : ⬀
    76800    : Ⰰ
    77056    : ⴀ
    77312    : ⸀
    77568    : ⼀
    77824    : 　
    78080    : ㄀
    78336    : ㈀
    78592    : ㌀
    78848    : 㐀
    79104    : 㔀
    79360    : 㘀
    79616    : 㜀
    79872    : 㠀
    80128    : 㤀
    80384    : 㨀
    80640    : 㬀
    80896    : 㰀
    81152    : 㴀
    81408    : 㸀
    81664    : 㼀
    81920    : 䀀
    82176    : 䄀
    82432    : 䈀
    82688    : 䌀
    82944    : 䐀
    83200    : 䔀
    83456    : 䘀
    83712    : 䜀
    83968    : 䠀
    84224    : 䤀
    84480    : 䨀
    84736    : 䬀
    84992    : 䰀
    85248    : 䴀
    85504    : 一
    85760    : 伀
    86016    : 倀
    86272    : 儀
    86528    : 刀
    86784    : 匀
    87040    : 吀
    87296    : 唀
    87552    : 嘀
    87808    : 圀
    88064    : 堀
    88320    : 夀
    88576    : 娀
    88832    : 嬀
    89088    : 尀
    89344    : 崀
    89600    : 帀
    89856    : 开
    90112    : 怀
    90368    : 愀
    90624    : 戀
    90880    : 挀
    91136    : 搀
    91392    : 攀
    91648    : 昀
    91904    : 最
    92160    : 栀
    92416    : 椀
    92672    : 樀
    92928    : 欀
    93184    : 氀
    93440    : 洀
    93696    : 渀
    93952    : 漀
    94208    : 瀀
    94464    : 焀
    94720    : 爀
    94976    : 猀
    95232    : 琀
    95488    : 甀
    95744    : 瘀
    96000    : 眀
    96256    : 砀
    96512    : 礀
    96768    : 稀
    97024    : 笀
    97280    : 簀
    97536    : 紀
    97792    : 縀
    98048    : 缀
    98304    : 耀
    98560    : 脀
    98816    : 舀
    99072    : 茀
    99328    : 萀
    99584    : 蔀
    99840    : 蘀

    ～～～ 以降は割愛（有効桁数の5桁を超える為） ～～～

    ```

    :::

- 以前のMicrosoft IMEで確認した結果

    下記の通り有効桁数の境界位置を調べた結果、以前のIMEでは有効桁数が16桁である事がわかりました。
    なお、数値を16桁以上入力すると後方で入力した最終桁の数字から **下16桁が有効値** になるもよう。

    - 1桁目が数字1で連番した構成
        下記の通り、上桁が合う数字の構成にしてみた結果、上桁では判定していない事がわかる。

        ```
        123456789012345     : ﾟ      👈 有効桁数は16桁。16桁以内の15桁
        1234567890123456    :ｺ       👈 有効桁数の16桁
        12345678901234567   :K       👈 有効桁数は下16桁の為、「2345678901234567」と同様の結果
        123456789012345678  :      👈 有効桁数は下16桁の為、「3456789012345678」と同様の結果
        1234567890123456789 :・      👈 有効桁数は下16桁の為、「4567890123456789」と同様の結果
        ```
    
    - 先頭が大きい数値で1ずつ引いた構成
        下記の通り、下桁が合う数字の構成にしてみた結果、**おそらく下16桁で判断**している事がわかる。
        |コメント|20桁|結果|下19桁|結果|下18桁|結果|下17桁|結果|下16桁|結果|下15桁|結果|下14桁|結果|
        |---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
        |16桁と15桁で違う|12345678901234567890|Empty|2345678901234567890|Empty|345678901234567890|Empty|45678901234567890|Empty|5678901234567890|Empty|678901234567890|還|78901234567890|Empty|
        |15桁と14桁で違う<br>\* 16桁と15桁の結果がたまたま一致していると思われる|23456789012345678901|l|3456789012345678901|l|456789012345678901|l|56789012345678901|l|6789012345678901|l|789012345678901|l|89012345678901|ｬ|
        |16桁と15桁で違う|34567890123456789012|:|4567890123456789012|:|567890123456789012|:|67890123456789012|:|7890123456789012|:|890123456789012|ｺ|90123456789012|ｺ|
        |15桁と14桁で違う<br>\* 16桁と15桁の結果がたまたま一致していると思われる|45678901234567890123|D|5678901234567890123|D|678901234567890123|D|78901234567890123|D|8901234567890123|D|901234567890123|D|01234567890123|Empty|
        |16桁と15桁で違う|56789012345678901234|ｯ|6789012345678901234|ｯ|789012345678901234|ｯ|89012345678901234|ｯ|9012345678901234|ｯ|012345678901234|/|12345678901234|/|
        |15桁と14桁で違う<br>\* 16桁と15桁の結果がたまたま一致していると思われる|67890123456789012345|ﾟ|7890123456789012345|ﾟ|890123456789012345|ﾟ|90123456789012345|ﾟ|0123456789012345|ﾟ|123456789012345|ﾟ|23456789012345|毓|
        |16桁と15桁で違う|78901234567890123456|ｺ|8901234567890123456|ｺ|901234567890123456|ｺ|01234567890123456|ｺ|1234567890123456|ｺ|234567890123456|:|34567890123456|ｺ|
        |15桁と14桁で違う<br>\* 16桁と15桁の結果がたまたま一致していると思われる|89012345678901234567|K|9012345678901234567|K|012345678901234567|K|12345678901234567|K|2345678901234567|K|345678901234567|K|45678901234567|窮|
        |16桁と15桁で違う|90123456789012345678||0123456789012345678||123456789012345678||23456789012345678||3456789012345678||456789012345678|s|56789012345678|s|
        |15桁と14桁で違う<br>\* 16桁と15桁の結果がたまたま一致していると思われる|01234567890123456789|・|1234567890123456789|・|234567890123456789|・|34567890123456789|・|4567890123456789|・|567890123456789|・|67890123456789|A|
    
    :::details 補足情報：以前のIME + 4桁で検証（最大16桁だがキリがないので打ち切り）

    ```:以前のIME + 4桁で検証（最大16桁だがキリがないので打ち切り）
    0001 - 0008    : 
    0009    : 	
    0010    : 

    0011 - 0012    : 
    0013    : 

    0014 - 0031    : 
    0032    :  
    0033    : !
    0034    : "
    0035    : #
    0036    : $
    0037    : %
    0038    : &
    0039    : '
    0040    : (
    0041    : )
    0042    : *
    0043    : +
    0044    : ,
    0045    : -
    0046    : .
    0047    : /
    0048    : 0
    0049    : 1
    0050    : 2
    0051    : 3
    0052    : 4
    0053    : 5
    0054    : 6
    0055    : 7
    0056    : 8
    0057    : 9
    0058    : :
    0059    : ;
    0060    : <
    0061    : =
    0062    : >
    0063    : ?
    0064    : @
    0065    : A
    0066    : B
    0067    : C
    0068    : D
    0069    : E
    0070    : F
    0071    : G
    0072    : H
    0073    : I
    0074    : J
    0075    : K
    0076    : L
    0077    : M
    0078    : N
    0079    : O
    0080    : P
    0081    : Q
    0082    : R
    0083    : S
    0084    : T
    0085    : U
    0086    : V
    0087    : W
    0088    : X
    0089    : Y
    0090    : Z
    0091    : [
    0092    : \
    0093    : ]
    0094    : ^
    0095    : _
    0096    : `
    0097    : a
    0098    : b
    0099    : c
    0100    : d
    0101    : e
    0102    : f
    0103    : g
    0104    : h
    0105    : i
    0106    : j
    0107    : k
    0108    : l
    0109    : m
    0110    : n
    0111    : o
    0112    : p
    0113    : q
    0114    : r
    0115    : s
    0116    : t
    0117    : u
    0118    : v
    0119    : w
    0120    : x
    0121    : y
    0122    : z
    0123    : {
    0124    : |
    0125    : }
    0126    : ~
    0127    : 
    0128    : €
    0129    : 
    0130    : ‚
    0131    : ƒ
    0132    : „
    0133    : …
    0134    : †
    0135    : ‡
    0136    : ˆ
    0137    : ‰
    0138    : Š
    0139    : ‹
    0140    : Œ
    0141    : 
    0142    : Ž
    0143    : 
    0144    : 
    0145    : ‘
    0146    : ’
    0147    : “
    0148    : ”
    0149    : •
    0150    : –
    0151    : —
    0152    : ˜
    0153    : ™
    0154    : š
    0155    : ›
    0156    : œ
    0157    : 
    0158    : ž
    0159    : Ÿ
    0160    :  
    0161    : ｡
    0162    : ｢
    0163    : ｣
    0164    : ､
    0165    : ･
    0166    : ｦ
    0167    : ｧ
    0168    : ｨ
    0169    : ｩ
    0170    : ｪ
    0171    : ｫ
    0172    : ｬ
    0173    : ｭ
    0174    : ｮ
    0175    : ｯ
    0176    : ｰ
    0177    : ｱ
    0178    : ｲ
    0179    : ｳ
    0180    : ｴ
    0181    : ｵ
    0182    : ｶ
    0183    : ｷ
    0184    : ｸ
    0185    : ｹ
    0186    : ｺ
    0187    : ｻ
    0188    : ｼ
    0189    : ｽ
    0190    : ｾ
    0191    : ｿ
    0192    : ﾀ
    0193    : ﾁ
    0194    : ﾂ
    0195    : ﾃ
    0196    : ﾄ
    0197    : ﾅ
    0198    : ﾆ
    0199    : ﾇ
    0200    : ﾈ
    0201    : ﾉ
    0202    : ﾊ
    0203    : ﾋ
    0204    : ﾌ
    0205    : ﾍ
    0206    : ﾎ
    0207    : ﾏ
    0208    : ﾐ
    0209    : ﾑ
    0210    : ﾒ
    0211    : ﾓ
    0212    : ﾔ
    0213    : ﾕ
    0214    : ﾖ
    0215    : ﾗ
    0216    : ﾘ
    0217    : ﾙ
    0218    : ﾚ
    0219    : ﾛ
    0220    : ﾜ
    0221    : ﾝ
    0222    : ﾞ
    0223    : ﾟ
    0224    : à
    0225    : á
    0226    : â
    0227    : ã
    0228    : ä
    0229    : å
    0230    : æ
    0231    : ç
    0232    : è
    0233    : é
    0234    : ê
    0235    : ë
    0236    : ì
    0237    : í
    0238    : î
    0239    : ï
    0240    : ð
    0241    : ñ
    0242    : ò
    0243    : ó
    0244    : ô
    0245    : õ
    0246    : ö
    0247    : ÷
    0248    : ø
    0249    : ù
    0250    : ú
    0251    : û
    0252    : ü
    0253    : ý
    0254    : þ
    0255    : ÿ
    0256 - 2303    : 
    2304 - 2559    : 	
    2560 - 2815    : 

    2816 - 3327    : 
    3328 - 3583    : 

    3584 - 8191    : 
    8192 - 8447    :  
    8448 - 8703    : !
    8704 - 8959    : "
    8960 - 9215    : #
    9216 - 9471    : $
    9472 - 9727    : %
    9728 - 9983    : &
    9984 - 9999    : '

    ～～～ 有効桁数の最大は16桁だが確認に時間がかかりキリがないので割愛 ～～～

    ```

    :::

::::

## 参考情報のまとめ

### Microsoft IMEのバージョンらしき情報

現在、主流のWindows 10 以降のMicrosoft IMEはOSにバンドルされているようです。
つまり、「Windows OSのバージョン = Microsoft IMEのバージョン」となっているもよう。

- Microsoft IME 詳細設定の実行ファイル「IMJPUEX.EXE」の保管場所
    `%SystemRoot%\System32\IME\IMEJP`
    → 私の環境の場合 `C:\Windows\System32\IME\IMEJP`

- IMJPUEX.EXEの詳細情報
    実行ファイルのバージョン：「`10.0.19041.1`」
    - 右クリックのコンテキストメニューからプロパティ - 詳細で確認した方法
        実行ファイルのプロパティ情報で確認したバージョン：「`10.0.19041.1`」
        ![Microsoft IME 詳細設定の実行ファイル「IMJPUEX.EXE」のプロパティ内の詳細を確認した結果](https://storage.googleapis.com/zenn-user-upload/bc27cf44942d-20231124.png)
        *画像：Microsoft IME 詳細設定の実行ファイル「IMJPUEX.EXE」のプロパティ情報*
        　
    - PowerShellコマンドレットで確認した方法

        ```powershell:コマンドで確認した結果
        PS C:\Users\"ユーザー名"> (Get-Item $Env:SystemRoot\System32\IME\IMEJP\IMJPUEX.EXE).VersionInfo | Format-Table -AutoSize -Wrap

        ProductVersion FileVersion                         FileName
        -------------- -----------                         --------
        10.0.19041.1   10.0.19041.1 (WinBuild.160101.0800) C:\WINDOWS\System32\IME\IMEJP\IMJPUEX.EXE

        PS C:\Users\"ユーザー名">
        ```

### 制御文字について

https://ja.wikipedia.org/wiki/制御文字

### Unicodeで頻繁に使う文字

https://mom-neuroscience.com/alt/

### さまざまな単位について調べている記事

https://hiramatu-hifuka.com/onyak/tani.html
https://hiramatu-hifuka.com/onyak/tani-iti.html
https://hiramatu-hifuka.com/onyak/tani-muk.html

### Microsoft Office関連で入力可能なUnicodeのショートカットキーが紹介

https://web.tuat.ac.jp/~ohashilab/knowledge.html#Alternative

## 補足情報のまとめ

### 特殊文字は、辞書に登録すると便利

たとえば、“びっくり”を日本語変換した際の絵文字「😲」を“おどろき”の変換候補でも登場させるよう、
辞書に登録してみる。

1. タスクトレイにある“A（半角モード中）”または“あ（全角モード中）”を右クリックし「単語の追加(D)」を選択
    ※ 最新のIMEを使った際の内容。以前のIMEでは、「単語の登録(O)」となる。
1. 単語の登録ウィンドウで単語(D)の欄に「`😲`」を入力
1. よみ(R)の欄に「`おどろき`」を入力
1. 品詞(P)のラジオボタンで「顔文字(O)」を選択
    ![絵文字「😲」を“おどろき”で単語登録](https://storage.googleapis.com/zenn-user-upload/e5ec0cc7a465-20231129.png)
    *画像：辞書の登録ウィンドウで絵文字“😲びっくり”を「おどろき」でも登録*
1. 「登録」ボタンをクリック
    ※ 完了した事のメッセージ等はなし。
1. 「閉じるボタン」 か 「×ボタン」 で単語の登録ウィンドウを閉じる

- 参考情報：[Microsoft IME] 単語を辞書に登録する方法
    <https://dekiru.net/article/19245/>

### ショートカットキーの調査で使用したツール

今回、新旧IMEのショートカットキー対応表を作成する際に手打ちで一つひとつショートカットキーを実行する方法も考えましたが、
思ったよりも数値の有効桁数が大きく現実的な調査方法ではなかったため、ツールを使用して確認しました。

色々な言語やツールで試した結果、行き着いたのは「**UWSC**」という自動化ツールです。

#### 実現できた方法：自動化ツール「UWSC」を使った手法

自動化ツール「UWSC」を使った方法で実現できました。

:::details 自動化ツール「UWSC」の詳細

- 公式サイト
    `http://www.uwsc.info/`は、現在はアクセス不可。2019年前後でアクセスできなくなったとの情報あり。
    [こちらの記事にあるコメント](http://itot.blog.jp/archives/21432032.html#comments)によると個人でUWSCを開発されていた「うみうみさん」という方は亡くなられているとの事。
    > コメントを引用
    > 
    > 1. ひな
    > 作者の方は亡くなられていました。
    > 2年ほど前の話ですが、昨今RPAが普及してきており、当社でも有料のRPAと無料のUWSCの、比較検討を始めました。
    > UWSCは有料の拡張機能があり、検証のため支払いをしましたが、その後連絡がありませんでした。
    > 法人として督促状も出しましたが連絡なく、いろいろな経緯で親族の方に対応していただくことができ、そこで亡くなられていることを知りました。
- UWSCのHow To サイト
    https://uwsc.jp/

:::

##### UWSCの導入・インストール

[こちら](https://uwsc.jp/howto/#UWSC)のページにも紹介がある[Vectorのダウンロードページ](https://www.vector.co.jp/soft/winnt/util/se115105.html)からFreeのポータブル版をダウンロードしました。

ダウンロードしたZipファイルにある`UWSC.exe`というEXEファイルで動作します。

##### スクリプトファイルで自動化

UWSCには、一般的なRPA・マクロツールと同様、キーボードやマウスの操作を記録してその操作をそのまま再生できる機能が備わっています。
それ以外の機能として、あらかじめスクリプトファイル（マクロファイル）内に命令文（プログラムコード）を記載する事で、
自動的に実行する事も可能です。

詳しく制御できる命令文をみると`DIM`で変数の宣言が可能だったり`FOR文`で繰り返し処理が可能だったりと、さまざまな制御が可能でありメジャーなスクリプト言語と比較しても遜色ない内容。

今回使用したスクリプトの関数は、キーボードを入力する際の関数となる[KBD関数](https://uwsc.jp/script/function/kbd/)を使用しました。
KBD関数は、ただ単純にキー入力する引数`CLICK`だけでなく、長押しや長押しを離す事が指定できる`DOWN`や`UP`の指定が可能です。

当初、FOR文を使った繰り返し処理（AltのKeyDown と AltのKeyUp の間に数値入力を1ずつ加算していき繰り返すイメージ）のあるスクリプトファイルを作成しましたが、
なぜかFOR文内だとAltキーが長押しにならず期待通りの動きになりませんでした。

結局、FOR文内でKeyDownが動作しない理由はわからなかった為、一つひとつのキーボード操作を直書きするスクリプトファイルを作成しました。
直書きする際、キー入力する数字部分を手打ちで書くのは非効率的だったので、Excelの関数を使ってある程度のコードのベースを作成しました。

:::details 実際に使用したUWSファイル

```:実際に使用したUWSC スクリプトファイル（*.UWS）
// Winキー + R を同時入力して“ファイル名を指定して実行”を開く
KBD(VK_WIN,DOWN,0)
KBD(VK_R,DOWN,0)
KBD(VK_WIN,UP,0)
KBD(VK_R,UP,0)
ACW(GETID("ファイル名を指定して実行","#32770"),15,823,399,206,0)

// “ファイル名を指定して実行”で「cmd」を入力しEnterキーを押す
KBD(VK_C,CLICK,0)
KBD(VK_M,CLICK,0)
KBD(VK_D,CLICK,0)
KBD(VK_RETURN,CLICK,0)
ACW(GETID("C:\WINDOWS\system32\cmd.exe","ConsoleWindowClass"),163,156,979,512,0)

// 文字入力するテキストファイルが既にある場合はDELコマンドで削除
//  削除コマンド「DEL /Q D:\Downloads\IME_ShortcutKey_Result.txt」
KBD(VK_D,CLICK,0)
KBD(VK_E,CLICK,0)
KBD(VK_L,CLICK,0)
KBD(VK_SPACE,CLICK,0)
KBD(VK_OEM_2,CLICK,0)
KBD(VK_Q,CLICK,0)
KBD(VK_SPACE,CLICK,0)
KBD(VK_SHIFT,DOWN,0)
KBD(VK_D,DOWN,0)
KBD(VK_SHIFT,UP,0)
KBD(VK_D,UP,0)
KBD(VK_OEM_1,CLICK,0)
KBD(VK_OEM_102,CLICK,0)
KBD(VK_SHIFT,DOWN,0)
KBD(VK_D,DOWN,0)
KBD(VK_SHIFT,UP,0)
KBD(VK_D,UP,0)
KBD(VK_O,CLICK,0)
KBD(VK_W,CLICK,0)
KBD(VK_N,CLICK,0)
KBD(VK_L,CLICK,0)
KBD(VK_O,CLICK,0)
KBD(VK_A,CLICK,0)
KBD(VK_D,CLICK,0)
KBD(VK_S,CLICK,0)
KBD(VK_OEM_102,CLICK,0)
KBD(VK_SHIFT,DOWN,0)
KBD(VK_I,CLICK,0)
KBD(VK_M,CLICK,0)
KBD(VK_E,CLICK,0)
KBD(VK_SHIFT,UP,0)
KBD(VK_RSHIFT,DOWN,0)
KBD(VK_OEM_102,DOWN,0)
KBD(VK_RSHIFT,UP,0)
KBD(VK_OEM_102,UP,0)
KBD(VK_SHIFT,DOWN,0)
KBD(VK_S,DOWN,0)
KBD(VK_SHIFT,UP,0)
KBD(VK_S,UP,0)
KBD(VK_H,CLICK,0)
KBD(VK_O,CLICK,0)
KBD(VK_R,CLICK,0)
KBD(VK_T,CLICK,0)
KBD(VK_C,CLICK,0)
KBD(VK_U,CLICK,0)
KBD(VK_T,CLICK,0)
KBD(VK_SHIFT,DOWN,0)
KBD(VK_K,DOWN,0)
KBD(VK_SHIFT,UP,0)
KBD(VK_K,UP,0)
KBD(VK_E,CLICK,0)
KBD(VK_Y,CLICK,0)
KBD(VK_RSHIFT,DOWN,0)
KBD(VK_OEM_102,DOWN,0)
KBD(VK_RSHIFT,UP,0)
KBD(VK_OEM_102,UP,0)
KBD(VK_SHIFT,DOWN,0)
KBD(VK_R,CLICK,0)
KBD(VK_SHIFT,UP,0)
KBD(VK_E,CLICK,0)
KBD(VK_S,CLICK,0)
KBD(VK_U,CLICK,0)
KBD(VK_L,CLICK,0)
KBD(VK_T,CLICK,0)
KBD(VK_OEM_PERIOD,CLICK,0)
KBD(VK_T,CLICK,0)
KBD(VK_X,CLICK,0)
KBD(VK_T,CLICK,0)
KBD(VK_RETURN,CLICK,0)

// EXITコマンドでコマンドプロンプトを終了
KBD(VK_E,CLICK,0)
KBD(VK_X,CLICK,0)
KBD(VK_I,CLICK,0)
KBD(VK_T,CLICK,0)
KBD(VK_RETURN,CLICK,0)

// Winキー + R で“ファイル名をして指定して実行”を開く
KBD(VK_WIN,DOWN,0)
KBD(VK_R,DOWN,0)
KBD(VK_WIN,UP,0)
KBD(VK_R,UP,0)
ACW(GETID("ファイル名を指定して実行","#32770"),0)

// “ファイル名をして指定して実行”からテキストエディタを起動する
//  対象の実行ファイル「C:\Program Files (x86)\sakura\sakura.exe」
KBD(VK_SHIFT,DOWN,0)
KBD(VK_C,DOWN,0)
KBD(VK_SHIFT,UP,0)
KBD(VK_C,UP,0)
KBD(VK_OEM_1,CLICK,0)
KBD(VK_OEM_102,CLICK,0)
KBD(VK_SHIFT,DOWN,0)
KBD(VK_P,CLICK,0)
KBD(VK_SHIFT,UP,0)
KBD(VK_R,CLICK,0)
KBD(VK_O,CLICK,0)
KBD(VK_G,CLICK,0)
KBD(VK_R,DOWN,0)
KBD(VK_A,DOWN,0)
KBD(VK_R,UP,0)
KBD(VK_A,UP,0)
KBD(VK_M,CLICK,0)
KBD(VK_SPACE,CLICK,0)
KBD(VK_SHIFT,DOWN,0)
KBD(VK_F,DOWN,0)
KBD(VK_SHIFT,UP,0)
KBD(VK_F,UP,0)
KBD(VK_I,CLICK,0)
KBD(VK_L,CLICK,0)
KBD(VK_E,CLICK,0)
KBD(VK_S,CLICK,0)
KBD(VK_SPACE,CLICK,0)
KBD(VK_SHIFT,DOWN,0)
KBD(VK_8,CLICK,0)
KBD(VK_SHIFT,UP,0)
KBD(VK_X,CLICK,0)
KBD(VK_8,CLICK,0)
KBD(VK_6,CLICK,0)
KBD(VK_SHIFT,DOWN,0)
KBD(VK_9,CLICK,0)
KBD(VK_SHIFT,UP,0)
KBD(VK_OEM_102,CLICK,0)
KBD(VK_S,DOWN,0)
KBD(VK_A,DOWN,0)
KBD(VK_S,UP,0)
KBD(VK_A,UP,0)
KBD(VK_K,CLICK,0)
KBD(VK_U,CLICK,0)
KBD(VK_R,DOWN,0)
KBD(VK_A,DOWN,0)
KBD(VK_R,UP,0)
KBD(VK_A,UP,0)
KBD(VK_OEM_102,CLICK,0)
KBD(VK_S,DOWN,0)
KBD(VK_A,DOWN,0)
KBD(VK_S,UP,0)
KBD(VK_K,DOWN,0)
KBD(VK_A,UP,0)
KBD(VK_K,UP,0)
KBD(VK_U,CLICK,0)
KBD(VK_R,DOWN,0)
KBD(VK_A,DOWN,0)
KBD(VK_R,UP,0)
KBD(VK_A,UP,0)
KBD(VK_OEM_PERIOD,CLICK,0)
KBD(VK_E,CLICK,0)
KBD(VK_X,CLICK,0)
KBD(VK_E,CLICK,0)
KBD(VK_RETURN,CLICK,0)
ACW(GETID("(無題)1 - sakura 2.4.1.2849","TextEditorWindowWP176"),0)

// サクラエディタで「Ctrl + S」を実行
// →起動時は、無題のドキュメントが立ち上がるため、上書き保存ではなく名前を付けて保存が実行。
KBD(VK_RETURN,CLICK,0)
KBD(VK_CTRL,DOWN,0)
KBD(VK_S,DOWN,0)
KBD(VK_CTRL,UP,0)
KBD(VK_S,UP,0)
ACW(GETID("名前を付けて保存","#32770"),0)

// 名前を付けて保存で任意の場所・ファイル名で保存
//  →保存するファイル「D:\Downloads\IME_ShortcutKey.txt」
KBD(VK_SHIFT,DOWN,0)
KBD(VK_D,DOWN,0)
KBD(VK_SHIFT,UP,0)
KBD(VK_D,UP,0)
KBD(VK_OEM_1,CLICK,0)
KBD(VK_OEM_102,CLICK,0)
KBD(VK_SHIFT,DOWN,0)
KBD(VK_D,DOWN,0)
KBD(VK_SHIFT,UP,0)
KBD(VK_D,UP,0)
KBD(VK_O,CLICK,0)
KBD(VK_W,CLICK,0)
KBD(VK_N,CLICK,0)
KBD(VK_L,CLICK,0)
KBD(VK_O,CLICK,0)
KBD(VK_A,CLICK,0)
KBD(VK_D,CLICK,0)
KBD(VK_S,CLICK,0)
KBD(VK_OEM_102,CLICK,0)
KBD(VK_SHIFT,DOWN,0)
KBD(VK_I,CLICK,0)
KBD(VK_M,CLICK,0)
KBD(VK_E,CLICK,0)
KBD(VK_SHIFT,UP,0)
KBD(VK_RSHIFT,DOWN,0)
KBD(VK_OEM_102,DOWN,0)
KBD(VK_RSHIFT,UP,0)
KBD(VK_OEM_102,UP,0)
KBD(VK_SHIFT,DOWN,0)
KBD(VK_S,DOWN,0)
KBD(VK_SHIFT,UP,0)
KBD(VK_S,UP,0)
KBD(VK_H,DOWN,0)
KBD(VK_O,DOWN,0)
KBD(VK_H,UP,0)
KBD(VK_O,UP,0)
KBD(VK_R,CLICK,0)
KBD(VK_T,CLICK,0)
KBD(VK_C,CLICK,0)
KBD(VK_U,CLICK,0)
KBD(VK_T,CLICK,0)
KBD(VK_SHIFT,DOWN,0)
KBD(VK_K,DOWN,0)
KBD(VK_SHIFT,UP,0)
KBD(VK_K,UP,0)
KBD(VK_E,CLICK,0)
KBD(VK_Y,CLICK,0)
KBD(VK_RSHIFT,DOWN,0)
KBD(VK_OEM_102,DOWN,0)
KBD(VK_RSHIFT,UP,0)
KBD(VK_OEM_102,UP,0)
KBD(VK_SHIFT,DOWN,0)
KBD(VK_R,CLICK,0)
KBD(VK_SHIFT,UP,0)
KBD(VK_E,CLICK,0)
KBD(VK_S,CLICK,0)
KBD(VK_U,CLICK,0)
KBD(VK_L,CLICK,0)
KBD(VK_T,CLICK,0)
KBD(VK_OEM_PERIOD,CLICK,0)
KBD(VK_T,CLICK,0)
KBD(VK_X,CLICK,0)
KBD(VK_T,CLICK,0)
KBD(VK_RETURN,CLICK,0)
ACW(GETID("D:\Downloads\IME_ShortcutKey_Result.txt - sakura 2.4.1.2849","TextEditorWindowWP176"),0)

// 下記のような形式でショートカットキーを入力
// “入力する数字”    : “ショートカットキー入力した結果”
//  1. ラベルの項目を作成
//      どのショートカットキーを入力した結果か分かりやすいよう“入力する数字”として「001」を入力
KBD(VK_NUMPAD0,CLICK,0)
KBD(VK_NUMPAD0,CLICK,0)
KBD(VK_NUMPAD1,CLICK,0)
//  2. スペースを4つ打つ
KBD(VK_SPACE,CLICK,0)
KBD(VK_SPACE,CLICK,0)
KBD(VK_SPACE,CLICK,0)
KBD(VK_SPACE,CLICK,0)
// 3. コロン（:）とスペース1つを入力
KBD(VK_OEM_1,CLICK,0)
KBD(VK_SPACE,CLICK,0)
// 4. ショートカットキーを入力
//      Altキーを長押し（KBD関数をDOWNで指定）
KBD(VK_ALT,DOWN,0)
//      Num数字キー「001」を入力
KBD(VK_NUMPAD0,CLICK,0)
KBD(VK_NUMPAD0,CLICK,0)
KBD(VK_NUMPAD1,CLICK,0)
//      Altキーの長押しを離す（KBD関数をUPで指定）
KBD(VK_ALT,UP,0)
// 5. Enterキーを入力して改行
KBD(VK_RETURN,CLICK,0)

// 以降、“VK_NUMPAD”の数字を1ずつ増やし 1 ～ 5 を繰り返す

```

:::

#### 実現できなかった方法

下記の方法で試しましたが実現できませんでした。
（言語やツールに対するアプローチが悪い可能性が否めません。）

長文になってしまうので、さわりの部分だけ情報を共有します。

##### C# SendKeyを使った方法

「C# と PowerShell」を組み合わせた方法 や 「C# と Windowsフォームアプリケーション」を組み合わせた方法など、
いくつかの手法で検証しましたが、C#ではMicrosoft IMEのショートカットキーである`Alt長押し → 数字入力 → Alt長押しを離す` が**正常動作しませんでした**。

- VS Codeで「C# と PowerShell」の組み合わせを試した際に参考にした記事
    <https://zenn.dev/midoliy/articles/9e3cff958ff89ba151de>

##### Python SendKeyを使った方法

[pyautoguiライブラリ](https://pyautogui.readthedocs.io/en/latest/keyboard.html)のpressやkeyDown、keyUpを使って検証しましたが、Microsoft IMEのショートカットキーである`Alt長押し → 数字入力 → Alt長押しを離す` が**正常動作しませんでした**。

- Pythonのpyautoguiライブラリを使用した際に参考にした記事
    <https://chappy88.hatenablog.com/entry/2020/08/26/004527>

##### 自動化ツール「HiMacroEx」を使った方法

「[HimacroEx](https://fefnirm.web.fc2.com/soft/himacroex/)」はUWSCと同じような機能を持っている自動化ツールです。

このHimacroExを使い最新のIMEで確認してみた結果、Microsoft IMEのショートカットキーである`Alt長押し → 数字入力 → Alt長押しを離す` は正常動作しました。

しかし、以前のIMEに切り替えた後、上記で正常動作した同じマクロファイルで実行した結果、**正常動作しませんでした**。

###### HiMacroEx

::::details 自動化ツール「HiMacroEx」の詳細

- 公式サイト
    https://fefnirm.web.fc2.com/soft/himacroex/
- ダウンロードページ
    https://fefnirm.web.fc2.com/soft/himacroex/#download

:::details 参考情報：VBランタイムを使用する「HiMacroEx」を使うリスクについて

> ❓ Bing AIへの依頼内容
> 
> HiMacroExはVBランタイムを使用していますか？
> 使用している場合、VBランタイムを使用する事のリスクも合わせて教えてください。

> ✅ Bing AIからの回答
> 
> はい、HiMacroExはVBランタイムを使用しています。VBランタイムとは、Visual Basic 6.0で作成されたアプリケーションを実行するために必要なライブラリのことです¹。VBランタイムを使用することには、いくつかのリスクがあります。例えば：
> 
> - VBランタイムは、最新のOSや機器との互換性が保証されていません。そのため、将来的にVBランタイムが動作しなくなる可能性があります²。
> - VBランタイムは、サポートが終了しているため、不具合やバグが発生しても修正パッチが提供されません。そのため、システムが正常に動作しない場合があります²。
> - VBランタイムは、古いプログラミング言語であるため、開発や保守を行う人材が少なくなっています。そのため、システムの改修や移行が困難になる可能性があります²。
> 
> これらのリスクを回避するためには、VBランタイムを使用しない最新のプログラミング言語にシステムを移行することがおすすめです²。VBランタイムからVB.NETへの移行は、Microsoftも推奨しており、様々な移行ツールが提供されています³。しかし、移行には費用や時間がかかるため、事前に計画を立てることが重要です⁴。.
> 
> ソース: Bing との会話 2023/11/29
> (1) . https://bing.com/search?q=HiMacroEx%e3%81%afVB%e3%83%a9%e3%83%b3%e3%82%bf%e3%82%a4%e3%83%a0%e3%82%92%e4%bd%bf%e7%94%a8%e3%81%97%e3%81%a6%e3%81%84%e3%81%be%e3%81%99%e3%81%8b%ef%bc%9f.
> (2) マウス操作＆キーボード入力をマクロ化！クリック連打も .... https://jun1ch.com/himacroex.
> (3) HiMacroEx のダウンロード・使い方 - フリーソフト100. https://freesoft-100.com/review/himacroex.html.
> (4) HiMacroEx - SoftNavi. https://www.softnavi.com/review/mouse/himacroex_1.html.
> (5) himacroexのダウンロード方法や使い方 - 住設設備屋「パワー .... https://knockknock-movie.jp/20221221-0252/.
> (6) undefined. https://mm-a.link/mouse-macro-himacroex.
> (7) undefined. https://himacroex.softonic.jp/.
> (8) Visual Basic 6.0（VB6）を使い続けるリスク・移行課題、ご .... https://ict-miraiz.com/risks-and-migration-issues-of-continuing-to-use-visual-basic-6/.
> (9) 【VB6 サポート】使い続けるリスクとその対策とは .... https://appwebapp.com/%e3%80%90vb6-%e3%82%b5%e3%83%9d%e3%83%bc%e3%83%88%e3%80%91%e4%bd%bf%e3%81%84%e7%b6%9a%e3%81%91%e3%82%8b%e3%83%aa%e3%82%b9%e3%82%af%e3%81%a8%e3%81%9d%e3%81%ae%e5%af%be%e7%ad%96%e3%81%a8%e3%81%af.html.
> (10) Visual Basic 6.0（VB6.0）を継続するリスクとマイグレーションの .... https://onetech.jp/blog/risk-of-vb6-0-and-migration-to-continue-with-visual-basic-12312.
> (11) en.wikipedia.org. https://en.wikipedia.org/wiki/Visual_Basic_(classic).

:::

::::

## まとめ

- IMEのショートカットキーは、特殊記号を入力するのに便利かも
- 新旧IMEで入力した結果で一部差異がある為、注意が必要
- 頻繁に使用する特殊文字は辞書登録した方が作業効率が上がる
