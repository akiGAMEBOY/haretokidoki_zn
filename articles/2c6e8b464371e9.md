---
title: "[Microsoft IME]Alt + 数字4桁で文字入力できるショートカットキーを調べた"
emoji: "🙆"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---

Alt + 数字4桁

```powershell
Add-Type -AssemblyName Microsoft.VisualBasic
Add-Type -AssemblyName System.Windows.Forms

<#
.Synopsis
   実行中の任意のプロセスにキーストロークを送る操作をします。
.DESCRIPTION
   パラメータのキーストローク、プロセス名がそれぞれ未指定の場合、何も実行されません。
   キーストロークのみが指定された場合は実行時のフォーカスへキーストロークを送り、
   プロセス名のみが指定された場合はフォーカスのみが指定されたプロセスに変更します。
.EXAMPLE
   Send-Keys -KeyStroke "test.%~" -ProcessName "LINE"

   このコマンドは既に起動中のLINEアプリに対して"test."と入力し、
   Altキーを押しながらEnterキーを押下する操作をしています。
#>
function Send-Keys
{
    [CmdletBinding()]
    [Alias("sdky")]
    Param
    (
        # キーストローク
        # アプリケーションに送りたいキーストローク内容を指定します。
        # キーストロークの記述方法は下記のWebページを参照。
        # https://msdn.microsoft.com/ja-jp/library/cc364423.aspx
        [Parameter(Mandatory=$false,
                   ValueFromPipelineByPropertyName=$true,
                   Position=0)]
        [string]
        $KeyStroke,

        # プロセス名
        # キーストロークを送りたいアプリケーションのプロセス名を指定します。
        # 複数ある場合は、PIDが一番低いプロセスを対象とする。
        [Parameter(Mandatory=$false,
                   ValueFromPipelineByPropertyName=$true)]
        [string]
        $ProcessName,

        # 待機時間
        # コマンドを実行する前の待機時間をミリ秒単位で指定します。
        [Parameter(Mandatory=$false,
                   ValueFromPipelineByPropertyName=$true)]
        [int]
        $Wait = 0
    )

    Process
    {
        $Process = ps | ? {$_.Name -eq $ProcessName} | sort -Property CPU -Descending | select -First 1
        Write-Verbose $Process", KeyStroke = "$KeyStroke", Wait = "$Wait" ms."
        sleep -Milliseconds $Wait
        if ($Process -ne $null)
        {
            [Microsoft.VisualBasic.Interaction]::AppActivate($Process.ID)
        }
        [System.Windows.Forms.SendKeys]::SendWait($KeyStroke)
    }
}
# 実行
Send-Keys "%(0181)" -ProcessName "notepad"
```

```powershell
# SendKeysを使えるようにする
Add-Type -AssemblyName System.Windows.Forms

# Altキーと数字キーの組み合わせを送信する関数
function Send-AltNum {
    Param (
        # 4桁の数字
        [Parameter(Mandatory=$true)]
        [string]$Num
    )
    # Altキーを押す
    [System.Windows.Forms.SendKeys]::SendWait("%")
    # 数字キーを押す
    foreach ($digit in $Num.ToCharArray()) {
        [System.Windows.Forms.SendKeys]::SendWait($digit)
    }
    # Altキーを離す
    [System.Windows.Forms.SendKeys]::SendWait("%")
}

# 例: Alt+0128でユーロ記号を入力する
Send-AltNum "0128"
```

https://qiita.com/nimzo6689/items/488467dbe0c4e5645745

https://pajoca.com/ms-ime-trouble-alt/
https://note.com/mirupiso/n/n1190de896767

> ❓ Bing AIへの質問
> 
> Microsoft IME で使用できるショートカットキー、Altを長押しして4桁の数字を入れると、
> 特殊文字が入力できる機能に不具合が発生している理由を教えて。
　
> ✅ Bing AIの回答
> 
> Microsoft IMEで特殊文字を入力する方法についてお尋ねですね。😊
> 
> ウェブ検索の結果によると、この機能はUnicodeの文字コード値を使って特殊文字を入力する方法です⁴。しかし、この方法はWindows 10の新しいIMEでは正常に動作しない場合があるようです⁵。その理由は、新しいIMEが以前のバージョンと互換性がないためだと考えられます³。
> 
> この問題を解決するには、次の二つの方法があります。
> 
> - 一つ目は、新しいIMEを無効にして、以前のバージョンのIMEを使用することです³。この方法では、以下の手順を実行します。
>     1. IMEを右クリックして[設定]をクリックします。
>     2. [一般]をクリックします。
>     3. [互換性設定]グループの[以前のバージョンのMicrosoft IMEを使用する]にチェックを入れます。
>     4. OKをクリックします。
> 
> - 二つ目は、特殊文字を入力するための別のショートカットキーを使用することです⁴。この方法では、以下の手順を実行します。
>     1. 特殊文字を入力したい場所にカーソルを合わせます。
>     2. Win + . (ピリオド)キーを押して、絵文字や顔文字の入力パネルを表示します。
>     3. [記号と特殊文字]タブを選択します。
>     4. 入力したい特殊文字をクリックします。
> 
> 以上が私が見つけた方法です。どちらかお試しください。もっと詳しく知りたい場合は、以下のリンク²から検索結果や回答などをご覧いただけます。ご参考になれば幸いです。😊
> 
> ソース: Bing との会話 2023/11/1
> (1) Windows のドキュメントで特殊文字を使用する方法 - Microsoft .... https://support.microsoft.com/ja-jp/topic/windows-%E3%81%AE%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88%E3%81%A7%E7%89%B9%E6%AE%8A%E6%96%87%E5%AD%97%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95-ec1a4e84-706e-67a5-e52b-e3ebab90313f.
> (2) IMEに関するバグ。仮名に切り替えようとする時 .... https://answers.microsoft.com/ja-jp/windows/forum/all/ime%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E3%83%90/44cd2c70-38aa-4417-a12c-a85740c9282b.
> (3) Microsoft 日本語 IME - Microsoft サポート. https://support.microsoft.com/ja-jp/windows/microsoft-%E6%97%A5%E6%9C%AC%E8%AA%9E-ime-da40471d-6b91-4042-ae8b-713a96476916.
> (4) 文字入力中に使えるショートカットキー紹介【11種類】 | 元 .... https://oozappase.com/windows/ime-shortcutkey/.
> (5) Windows 10 IME とキーボードのショートカット キー一覧 - Tipsfound. https://www.tipsfound.com/windows10/12013-windows10.
　
> ❓ Bing AIへの質問
> 
> PowerShell で Altを長押ししながら数字4桁をキーボード入力できるFunctionを作成して
　
> ✅ Bing AIの回答
> 
> PowerShellでAltキーを長押ししながら数字4桁をキーボード入力できる関数を作成する方法についてお尋ねですね。😊
> 
> 私はウェブ検索の結果をもとに、いくつかの方法を見つけましたので、ご紹介します。
> 
> - 一つ目の方法は、SendKeysメソッドを使って、Altキーと数字キーの組み合わせを送信することです¹。この方法では、以下のようなコードを書きます。
> 
> ```powershell
> # SendKeysを使えるようにする
> Add-Type -AssemblyName System.Windows.Forms
> 
> # Altキーと数字キーの組み合わせを送信する関数
> function Send-AltNum {
>     Param (
>         # 4桁の数字
>         [Parameter(Mandatory=$true)]
>         [string]$Num
>     )
>     # Altキーを押す
>     [System.Windows.Forms.SendKeys]::SendWait("%")
>     # 数字キーを押す
>     foreach ($digit in $Num.ToCharArray()) {
>         [System.Windows.Forms.SendKeys]::SendWait($digit)
>     }
>     # Altキーを離す
>     [System.Windows.Forms.SendKeys]::SendWait("%")
> }
> 
> # 例: Alt+0128でユーロ記号を入力する
> Send-AltNum "0128"
> ```
> 
> - 二つ目の方法は、[InputSimulator](^2^)というライブラリを使って、Altキーと数字キーの組み合わせをシミュレートすることです³。この方法では、以下のようなコードを書きます。
> 
> ```powershell
> # InputSimulatorライブラリをインストールする
> Install-Package InputSimulator
> 
> # InputSimulatorライブラリを読み込む
> Add-Type -Path "$env:USERPROFILE\.nuget\packages\inputsimulator\1.0.4\lib\net40\InputSimulator.dll"
> 
> # InputSimulatorオブジェクトを作る
> $sim = New-Object WindowsInput.InputSimulator
> 
> # Altキーと数字キーの組み合わせをシミュレートする関数
> function Simulate-AltNum {
>     Param (
>         # 4桁の数字
>         [Parameter(Mandatory=$true)]
>         [string]$Num
>     )
>     # Altキーを押す
>     $sim.Keyboard.KeyDown([WindowsInput.Native.VirtualKeyCode]::MENU)
>     # 数字キーを押す
>     foreach ($digit in $Num.ToCharArray()) {
>         $sim.Keyboard.KeyPress([WindowsInput.Native.VirtualKeyCode]::$digit)
>     }
>     # Altキーを離す
>     $sim.Keyboard.KeyUp([WindowsInput.Native.VirtualKeyCode]::MENU)
> }
> 
> # 例: Alt+0128でユーロ記号を入力する
> Simulate-AltNum "0128"
> ```
> 
> 以上が私が見つけた方法です。どちらかお試しください。もっと詳しく知りたい場合は、以下のリンク²から検索結果や回答などをご覧いただけます。ご参考になれば幸いです。😊
> 
> ソース: Bing との会話 2023/11/1
> (1) PowerShellでSendKeysを使ってみた #PowerShell - Qiita. https://qiita.com/nimzo6689/items/488467dbe0c4e5645745.
> (2) PowerShellでキーボード入力を自動化する方法 | 水戸スヤのSE .... https://mitosuya.net/automation-input-keyboard.
> (3) スタッフブログ » Blog Archive » PowerShellでキー入力の自動化. https://systemage.co.jp/blog/?p=1662.
> (4) PowerShellでキーボード入力を自動化する方法 | 水戸スヤのSE .... https://mitosuya.net/automation-input-keyboard.
> (5) undefined. https://msdn.microsoft.com/ja-jp/library/cc364423.aspx.