---
title: "[Microsoft IME]Alt + æ•°å­—4æ¡ã§æ–‡å­—å…¥åŠ›ã§ãã‚‹ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼ã‚’èª¿ã¹ãŸ"
emoji: "ğŸ™†"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: false
---

Alt + æ•°å­—4æ¡

```powershell
Add-Type -AssemblyName Microsoft.VisualBasic
Add-Type -AssemblyName System.Windows.Forms

<#
.Synopsis
   å®Ÿè¡Œä¸­ã®ä»»æ„ã®ãƒ—ãƒ­ã‚»ã‚¹ã«ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ã‚’é€ã‚‹æ“ä½œã‚’ã—ã¾ã™ã€‚
.DESCRIPTION
   ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ã€ãƒ—ãƒ­ã‚»ã‚¹åãŒãã‚Œãã‚ŒæœªæŒ‡å®šã®å ´åˆã€ä½•ã‚‚å®Ÿè¡Œã•ã‚Œã¾ã›ã‚“ã€‚
   ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ã®ã¿ãŒæŒ‡å®šã•ã‚ŒãŸå ´åˆã¯å®Ÿè¡Œæ™‚ã®ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã¸ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ã‚’é€ã‚Šã€
   ãƒ—ãƒ­ã‚»ã‚¹åã®ã¿ãŒæŒ‡å®šã•ã‚ŒãŸå ´åˆã¯ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã®ã¿ãŒæŒ‡å®šã•ã‚ŒãŸãƒ—ãƒ­ã‚»ã‚¹ã«å¤‰æ›´ã—ã¾ã™ã€‚
.EXAMPLE
   Send-Keys -KeyStroke "test.%~" -ProcessName "LINE"

   ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯æ—¢ã«èµ·å‹•ä¸­ã®LINEã‚¢ãƒ—ãƒªã«å¯¾ã—ã¦"test."ã¨å…¥åŠ›ã—ã€
   Altã‚­ãƒ¼ã‚’æŠ¼ã—ãªãŒã‚‰Enterã‚­ãƒ¼ã‚’æŠ¼ä¸‹ã™ã‚‹æ“ä½œã‚’ã—ã¦ã„ã¾ã™ã€‚
#>
function Send-Keys
{
    [CmdletBinding()]
    [Alias("sdky")]
    Param
    (
        # ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯
        # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«é€ã‚ŠãŸã„ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯å†…å®¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚
        # ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ã®è¨˜è¿°æ–¹æ³•ã¯ä¸‹è¨˜ã®Webãƒšãƒ¼ã‚¸ã‚’å‚ç…§ã€‚
        # https://msdn.microsoft.com/ja-jp/library/cc364423.aspx
        [Parameter(Mandatory=$false,
                   ValueFromPipelineByPropertyName=$true,
                   Position=0)]
        [string]
        $KeyStroke,

        # ãƒ—ãƒ­ã‚»ã‚¹å
        # ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ã‚’é€ã‚ŠãŸã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ—ãƒ­ã‚»ã‚¹åã‚’æŒ‡å®šã—ã¾ã™ã€‚
        # è¤‡æ•°ã‚ã‚‹å ´åˆã¯ã€PIDãŒä¸€ç•ªä½ã„ãƒ—ãƒ­ã‚»ã‚¹ã‚’å¯¾è±¡ã¨ã™ã‚‹ã€‚
        [Parameter(Mandatory=$false,
                   ValueFromPipelineByPropertyName=$true)]
        [string]
        $ProcessName,

        # å¾…æ©Ÿæ™‚é–“
        # ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹å‰ã®å¾…æ©Ÿæ™‚é–“ã‚’ãƒŸãƒªç§’å˜ä½ã§æŒ‡å®šã—ã¾ã™ã€‚
        [Parameter(Mandatory=$false,
                   ValueFromPipelineByPropertyName=$true)]
        [int]
        $Wait = 0
    )

    Process
    {
        $Process = ps | ? {$_.Name -eq $ProcessName} | sort -Property CPU -Descending | select -First 1
        Write-Verbose $Process", KeyStroke = "$KeyStroke", Wait = "$Wait" ms."
        sleep -Milliseconds $Wait
        if ($Process -ne $null)
        {
            [Microsoft.VisualBasic.Interaction]::AppActivate($Process.ID)
        }
        [System.Windows.Forms.SendKeys]::SendWait($KeyStroke)
    }
}
# å®Ÿè¡Œ
Send-Keys "%(0181)" -ProcessName "notepad"
```

```powershell
# SendKeysã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹
Add-Type -AssemblyName System.Windows.Forms

# Altã‚­ãƒ¼ã¨æ•°å­—ã‚­ãƒ¼ã®çµ„ã¿åˆã‚ã›ã‚’é€ä¿¡ã™ã‚‹é–¢æ•°
function Send-AltNum {
    Param (
        # 4æ¡ã®æ•°å­—
        [Parameter(Mandatory=$true)]
        [string]$Num
    )
    # Altã‚­ãƒ¼ã‚’æŠ¼ã™
    [System.Windows.Forms.SendKeys]::SendWait("%")
    # æ•°å­—ã‚­ãƒ¼ã‚’æŠ¼ã™
    foreach ($digit in $Num.ToCharArray()) {
        [System.Windows.Forms.SendKeys]::SendWait($digit)
    }
    # Altã‚­ãƒ¼ã‚’é›¢ã™
    [System.Windows.Forms.SendKeys]::SendWait("%")
}

# ä¾‹: Alt+0128ã§ãƒ¦ãƒ¼ãƒ­è¨˜å·ã‚’å…¥åŠ›ã™ã‚‹
Send-AltNum "0128"
```

https://qiita.com/nimzo6689/items/488467dbe0c4e5645745

https://pajoca.com/ms-ime-trouble-alt/
https://note.com/mirupiso/n/n1190de896767

> â“ Bing AIã¸ã®è³ªå•
> 
> Microsoft IME ã§ä½¿ç”¨ã§ãã‚‹ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼ã€Altã‚’é•·æŠ¼ã—ã—ã¦4æ¡ã®æ•°å­—ã‚’å…¥ã‚Œã‚‹ã¨ã€
> ç‰¹æ®Šæ–‡å­—ãŒå…¥åŠ›ã§ãã‚‹æ©Ÿèƒ½ã«ä¸å…·åˆãŒç™ºç”Ÿã—ã¦ã„ã‚‹ç†ç”±ã‚’æ•™ãˆã¦ã€‚
ã€€
> âœ… Bing AIã®å›ç­”
> 
> Microsoft IMEã§ç‰¹æ®Šæ–‡å­—ã‚’å…¥åŠ›ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ãŠå°‹ã­ã§ã™ã­ã€‚ğŸ˜Š
> 
> ã‚¦ã‚§ãƒ–æ¤œç´¢ã®çµæœã«ã‚ˆã‚‹ã¨ã€ã“ã®æ©Ÿèƒ½ã¯Unicodeã®æ–‡å­—ã‚³ãƒ¼ãƒ‰å€¤ã‚’ä½¿ã£ã¦ç‰¹æ®Šæ–‡å­—ã‚’å…¥åŠ›ã™ã‚‹æ–¹æ³•ã§ã™â´ã€‚ã—ã‹ã—ã€ã“ã®æ–¹æ³•ã¯Windows 10ã®æ–°ã—ã„IMEã§ã¯æ­£å¸¸ã«å‹•ä½œã—ãªã„å ´åˆãŒã‚ã‚‹ã‚ˆã†ã§ã™âµã€‚ãã®ç†ç”±ã¯ã€æ–°ã—ã„IMEãŒä»¥å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨äº’æ›æ€§ãŒãªã„ãŸã‚ã ã¨è€ƒãˆã‚‰ã‚Œã¾ã™Â³ã€‚
> 
> ã“ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ã«ã¯ã€æ¬¡ã®äºŒã¤ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚
> 
> - ä¸€ã¤ç›®ã¯ã€æ–°ã—ã„IMEã‚’ç„¡åŠ¹ã«ã—ã¦ã€ä»¥å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®IMEã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™Â³ã€‚ã“ã®æ–¹æ³•ã§ã¯ã€ä»¥ä¸‹ã®æ‰‹é †ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
>     1. IMEã‚’å³ã‚¯ãƒªãƒƒã‚¯ã—ã¦[è¨­å®š]ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
>     2. [ä¸€èˆ¬]ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
>     3. [äº’æ›æ€§è¨­å®š]ã‚°ãƒ«ãƒ¼ãƒ—ã®[ä»¥å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®Microsoft IMEã‚’ä½¿ç”¨ã™ã‚‹]ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¾ã™ã€‚
>     4. OKã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
> 
> - äºŒã¤ç›®ã¯ã€ç‰¹æ®Šæ–‡å­—ã‚’å…¥åŠ›ã™ã‚‹ãŸã‚ã®åˆ¥ã®ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™â´ã€‚ã“ã®æ–¹æ³•ã§ã¯ã€ä»¥ä¸‹ã®æ‰‹é †ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
>     1. ç‰¹æ®Šæ–‡å­—ã‚’å…¥åŠ›ã—ãŸã„å ´æ‰€ã«ã‚«ãƒ¼ã‚½ãƒ«ã‚’åˆã‚ã›ã¾ã™ã€‚
>     2. Win + . (ãƒ”ãƒªã‚ªãƒ‰)ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ã€çµµæ–‡å­—ã‚„é¡”æ–‡å­—ã®å…¥åŠ›ãƒ‘ãƒãƒ«ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
>     3. [è¨˜å·ã¨ç‰¹æ®Šæ–‡å­—]ã‚¿ãƒ–ã‚’é¸æŠã—ã¾ã™ã€‚
>     4. å…¥åŠ›ã—ãŸã„ç‰¹æ®Šæ–‡å­—ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
> 
> ä»¥ä¸ŠãŒç§ãŒè¦‹ã¤ã‘ãŸæ–¹æ³•ã§ã™ã€‚ã©ã¡ã‚‰ã‹ãŠè©¦ã—ãã ã•ã„ã€‚ã‚‚ã£ã¨è©³ã—ãçŸ¥ã‚ŠãŸã„å ´åˆã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯Â²ã‹ã‚‰æ¤œç´¢çµæœã‚„å›ç­”ãªã©ã‚’ã”è¦§ã„ãŸã ã‘ã¾ã™ã€‚ã”å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚ğŸ˜Š
> 
> ã‚½ãƒ¼ã‚¹: Bing ã¨ã®ä¼šè©± 2023/11/1
> (1) Windows ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ç‰¹æ®Šæ–‡å­—ã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³• - Microsoft .... https://support.microsoft.com/ja-jp/topic/windows-%E3%81%AE%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88%E3%81%A7%E7%89%B9%E6%AE%8A%E6%96%87%E5%AD%97%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95-ec1a4e84-706e-67a5-e52b-e3ebab90313f.
> (2) IMEã«é–¢ã™ã‚‹ãƒã‚°ã€‚ä»®åã«åˆ‡ã‚Šæ›¿ãˆã‚ˆã†ã¨ã™ã‚‹æ™‚ .... https://answers.microsoft.com/ja-jp/windows/forum/all/ime%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E3%83%90/44cd2c70-38aa-4417-a12c-a85740c9282b.
> (3) Microsoft æ—¥æœ¬èª IME - Microsoft ã‚µãƒãƒ¼ãƒˆ. https://support.microsoft.com/ja-jp/windows/microsoft-%E6%97%A5%E6%9C%AC%E8%AA%9E-ime-da40471d-6b91-4042-ae8b-713a96476916.
> (4) æ–‡å­—å…¥åŠ›ä¸­ã«ä½¿ãˆã‚‹ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼ç´¹ä»‹ã€11ç¨®é¡ã€‘ | å…ƒ .... https://oozappase.com/windows/ime-shortcutkey/.
> (5) Windows 10 IME ã¨ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã®ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ ã‚­ãƒ¼ä¸€è¦§ - Tipsfound. https://www.tipsfound.com/windows10/12013-windows10.
ã€€
> â“ Bing AIã¸ã®è³ªå•
> 
> PowerShell ã§ Altã‚’é•·æŠ¼ã—ã—ãªãŒã‚‰æ•°å­—4æ¡ã‚’ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã§ãã‚‹Functionã‚’ä½œæˆã—ã¦
ã€€
> âœ… Bing AIã®å›ç­”
> 
> PowerShellã§Altã‚­ãƒ¼ã‚’é•·æŠ¼ã—ã—ãªãŒã‚‰æ•°å­—4æ¡ã‚’ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã§ãã‚‹é–¢æ•°ã‚’ä½œæˆã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ãŠå°‹ã­ã§ã™ã­ã€‚ğŸ˜Š
> 
> ç§ã¯ã‚¦ã‚§ãƒ–æ¤œç´¢ã®çµæœã‚’ã‚‚ã¨ã«ã€ã„ãã¤ã‹ã®æ–¹æ³•ã‚’è¦‹ã¤ã‘ã¾ã—ãŸã®ã§ã€ã”ç´¹ä»‹ã—ã¾ã™ã€‚
> 
> - ä¸€ã¤ç›®ã®æ–¹æ³•ã¯ã€SendKeysãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ã¦ã€Altã‚­ãƒ¼ã¨æ•°å­—ã‚­ãƒ¼ã®çµ„ã¿åˆã‚ã›ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã§ã™Â¹ã€‚ã“ã®æ–¹æ³•ã§ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã¾ã™ã€‚
> 
> ```powershell
> # SendKeysã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹
> Add-Type -AssemblyName System.Windows.Forms
> 
> # Altã‚­ãƒ¼ã¨æ•°å­—ã‚­ãƒ¼ã®çµ„ã¿åˆã‚ã›ã‚’é€ä¿¡ã™ã‚‹é–¢æ•°
> function Send-AltNum {
>     Param (
>         # 4æ¡ã®æ•°å­—
>         [Parameter(Mandatory=$true)]
>         [string]$Num
>     )
>     # Altã‚­ãƒ¼ã‚’æŠ¼ã™
>     [System.Windows.Forms.SendKeys]::SendWait("%")
>     # æ•°å­—ã‚­ãƒ¼ã‚’æŠ¼ã™
>     foreach ($digit in $Num.ToCharArray()) {
>         [System.Windows.Forms.SendKeys]::SendWait($digit)
>     }
>     # Altã‚­ãƒ¼ã‚’é›¢ã™
>     [System.Windows.Forms.SendKeys]::SendWait("%")
> }
> 
> # ä¾‹: Alt+0128ã§ãƒ¦ãƒ¼ãƒ­è¨˜å·ã‚’å…¥åŠ›ã™ã‚‹
> Send-AltNum "0128"
> ```
> 
> - äºŒã¤ç›®ã®æ–¹æ³•ã¯ã€[InputSimulator](^2^)ã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ã€Altã‚­ãƒ¼ã¨æ•°å­—ã‚­ãƒ¼ã®çµ„ã¿åˆã‚ã›ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã™ã‚‹ã“ã¨ã§ã™Â³ã€‚ã“ã®æ–¹æ³•ã§ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã¾ã™ã€‚
> 
> ```powershell
> # InputSimulatorãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹
> Install-Package InputSimulator
> 
> # InputSimulatorãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’èª­ã¿è¾¼ã‚€
> Add-Type -Path "$env:USERPROFILE\.nuget\packages\inputsimulator\1.0.4\lib\net40\InputSimulator.dll"
> 
> # InputSimulatorã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚‹
> $sim = New-Object WindowsInput.InputSimulator
> 
> # Altã‚­ãƒ¼ã¨æ•°å­—ã‚­ãƒ¼ã®çµ„ã¿åˆã‚ã›ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã™ã‚‹é–¢æ•°
> function Simulate-AltNum {
>     Param (
>         # 4æ¡ã®æ•°å­—
>         [Parameter(Mandatory=$true)]
>         [string]$Num
>     )
>     # Altã‚­ãƒ¼ã‚’æŠ¼ã™
>     $sim.Keyboard.KeyDown([WindowsInput.Native.VirtualKeyCode]::MENU)
>     # æ•°å­—ã‚­ãƒ¼ã‚’æŠ¼ã™
>     foreach ($digit in $Num.ToCharArray()) {
>         $sim.Keyboard.KeyPress([WindowsInput.Native.VirtualKeyCode]::$digit)
>     }
>     # Altã‚­ãƒ¼ã‚’é›¢ã™
>     $sim.Keyboard.KeyUp([WindowsInput.Native.VirtualKeyCode]::MENU)
> }
> 
> # ä¾‹: Alt+0128ã§ãƒ¦ãƒ¼ãƒ­è¨˜å·ã‚’å…¥åŠ›ã™ã‚‹
> Simulate-AltNum "0128"
> ```
> 
> ä»¥ä¸ŠãŒç§ãŒè¦‹ã¤ã‘ãŸæ–¹æ³•ã§ã™ã€‚ã©ã¡ã‚‰ã‹ãŠè©¦ã—ãã ã•ã„ã€‚ã‚‚ã£ã¨è©³ã—ãçŸ¥ã‚ŠãŸã„å ´åˆã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯Â²ã‹ã‚‰æ¤œç´¢çµæœã‚„å›ç­”ãªã©ã‚’ã”è¦§ã„ãŸã ã‘ã¾ã™ã€‚ã”å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚ğŸ˜Š
> 
> ã‚½ãƒ¼ã‚¹: Bing ã¨ã®ä¼šè©± 2023/11/1
> (1) PowerShellã§SendKeysã‚’ä½¿ã£ã¦ã¿ãŸ #PowerShell - Qiita. https://qiita.com/nimzo6689/items/488467dbe0c4e5645745.
> (2) PowerShellã§ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã‚’è‡ªå‹•åŒ–ã™ã‚‹æ–¹æ³• | æ°´æˆ¸ã‚¹ãƒ¤ã®SE .... https://mitosuya.net/automation-input-keyboard.
> (3) ã‚¹ã‚¿ãƒƒãƒ•ãƒ–ãƒ­ã‚° Â» Blog Archive Â» PowerShellã§ã‚­ãƒ¼å…¥åŠ›ã®è‡ªå‹•åŒ–. https://systemage.co.jp/blog/?p=1662.
> (4) PowerShellã§ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã‚’è‡ªå‹•åŒ–ã™ã‚‹æ–¹æ³• | æ°´æˆ¸ã‚¹ãƒ¤ã®SE .... https://mitosuya.net/automation-input-keyboard.
> (5) undefined. https://msdn.microsoft.com/ja-jp/library/cc364423.aspx.