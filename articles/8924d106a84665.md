---
title: "PowerShellの出力コマンドレット「Write-*」の一覧と使用用途"
emoji: "😊"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["powershell"]
published: false
---
## 概要

主に出力系で使用しているコマンドレットは、`Write-Host` と `Write-Output` です。

それぞれの違いを雰囲気でしか把握していなかったこと。
また、`Write-`ではじまる他のコマンドレットがあり使用用途をおさえたかったこと。

以上、2点を目的に調べてみました。

## この記事のターゲット

- PowerShellユーザーの方
- （Writeではじまる）出力系のコマンドレットの違いを理解したい方

## 環境

```powershell:PowerShellのバージョン
PS C:\Users\"ユーザー名">
PS C:\Users\"ユーザー名"> $PSVersionTable

Name                           Value
----                           -----
PSVersion                      7.4.1
PSEdition                      Core
GitCommitId                    7.4.1
OS                             Microsoft Windows 10.0.19045
Platform                       Win32NT
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0…}
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1
WSManStackVersion              3.0

PS C:\Users\"ユーザー名">
```

## PowerShellにおける出力系のコマンドレットを洗い出し

`Get-Command Write-*`でWriteではじまるコマンドの一覧を取得。

```powershell:Writeではじまるコマンド一覧
PS C:\Users\"ユーザー名"> Get-Command Write-*

CommandType     Name                                               Version    Source
-----------     ----                                               -------    ------
Alias           Write-FileSystemCache                              2.0.0.0    Storage
Function        Write-DtcTransactionsTraceSession                  1.0.0.0    MsDtc
Function        Write-PrinterNfcTag                                1.1        PrintManagement
Function        Write-VolumeCache                                  2.0.0.0    Storage
Cmdlet          Write-Debug                                        7.0.0.0    Microsoft.PowerShell.Utility
Cmdlet          Write-Error                                        7.0.0.0    Microsoft.PowerShell.Utility
Cmdlet          Write-EventLog                                     3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Write-Host                                         7.0.0.0    Microsoft.PowerShell.Utility
Cmdlet          Write-Information                                  7.0.0.0    Microsoft.PowerShell.Utility
Cmdlet          Write-Output                                       7.0.0.0    Microsoft.PowerShell.Utility
Cmdlet          Write-Progress                                     7.0.0.0    Microsoft.PowerShell.Utility
Cmdlet          Write-Verbose                                      7.0.0.0    Microsoft.PowerShell.Utility
Cmdlet          Write-Warning                                      7.0.0.0    Microsoft.PowerShell.Utility

PS C:\Users\"ユーザー名">
```

## 使用用途

| コマンドレット | 説明 |
| --- | --- |
| Write-Debug | デバッグメッセージを表示する |
| Write-Error | エラーメッセージを表示する |
| Write-EventLog | イベントログにエントリを書き込む |
| Write-Host | コンソールにメッセージを表示する |
| Write-Information | 情報メッセージを表示する |
| Write-Output | パイプラインにオブジェクトを送信する |
| Write-Progress | プログレスバーを表示する |
| Write-Verbose | 詳細メッセージを表示する |
| Write-Warning | 警告メッセージを表示する |
| Write-FileSystemCache | ファイルシステムのキャッシュを書き込む |
| Write-DtcTransactionsTraceSession | DTCのトレースセッションを書き込む |
| Write-PrinterNfcTag | プリンターのNFCタグに情報を書き込む |
| Write-VolumeCache | ボリュームのキャッシュを書き込む |

## Write-Host と Write-Output の違い

$$

（ユーザー） \leftarrow コンソール表示 \leftarrow （標準出力すると自動でコンソール表示） --- 標準出力 \leftarrow （PowerShell内部）

$$

コンソール上のみに出力し、標準出力しないコマンドレットが、Write-Host。

コンソール上と標準出力するコマンドレット、Write-Output。
なお、実際の動きは、Write-Outputコマンドレット自体にコンソール出力する機能はない。
標準出力されたことによりPowerShellウィンドウ側でコンソール表示している。

## 各コマンドを実行してみる

1. Write-Debug
1. Write-Error
1. Write-EventLog
1. Write-Host
1. Write-Information
1. Write-Output
1. Write-Progress
1. Write-Verbose
1. Write-Warning
1. Write-FileSystemCache
1. Write-DtcTransactionsTraceSession
1. Write-PrinterNfcTag
1. Write-VolumeCache
