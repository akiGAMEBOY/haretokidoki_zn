---
title: "PowerShellã®å‡ºåŠ›ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€ŒWrite-*ã€ã®ä¸€è¦§ã¨ä½¿ç”¨ç”¨é€”"
emoji: "ğŸ˜Š"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---
## æ¦‚è¦

ä¸»ã«å‡ºåŠ›ç³»ã§ä½¿ç”¨ã—ã¦ã„ã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ã€`Write-Host` ã¨ `Write-Output` ã§ã™ã€‚

ãã‚Œãã‚Œã®é•ã„ã‚’é›°å›²æ°—ã§ã—ã‹æŠŠæ¡ã—ã¦ã„ãªã‹ã£ãŸã“ã¨ã€‚
ã¾ãŸã€`Write-`ã§ã¯ã˜ã¾ã‚‹ä»–ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚‚ã‚ã‚Šä½¿ç”¨ç”¨é€”ã‚’ãŠã•ãˆãŸã‹ã£ãŸã“ã¨ã€‚

ä»¥ä¸Šã€2ç‚¹ã‚’ç›®çš„ã«èª¿ã¹ã¦ã¿ã¾ã—ãŸã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- PowerShellãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- ã‚ˆãä½¿ç”¨ã™ã‚‹Write-Host ã¨ Write-Output ã®é•ã„ã‚’ç†è§£ã—ãŸã„æ–¹
- ï¼ˆWriteã§ã¯ã˜ã¾ã‚‹ï¼‰ä»–ã®å‡ºåŠ›ç³»ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®é•ã„ã‚‚ç†è§£ã—ãŸã„æ–¹

## ç’°å¢ƒ

```powershell:PowerShellã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $PSVersionTable

Name                           Value
----                           -----
PSVersion                      7.4.1
PSEdition                      Core
GitCommitId                    7.4.1
OS                             Microsoft Windows 10.0.19045
Platform                       Win32NT
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0â€¦}
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1
WSManStackVersion              3.0

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

## PowerShellã«ãŠã‘ã‚‹å‡ºåŠ›ç³»ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆ13ç¨®é¡

`Get-Command Write-*`ã§Writeã§ã¯ã˜ã¾ã‚‹ã‚³ãƒãƒ³ãƒ‰ã®ä¸€è¦§ã‚’å–å¾—ã€‚

```powershell:Writeã§ã¯ã˜ã¾ã‚‹ã‚³ãƒãƒ³ãƒ‰ä¸€è¦§
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-Command Write-*

CommandType     Name                                               Version    Source
-----------     ----                                               -------    ------
Alias           Write-FileSystemCache                              2.0.0.0    Storage
Function        Write-DtcTransactionsTraceSession                  1.0.0.0    MsDtc
Function        Write-PrinterNfcTag                                1.1        PrintManagement
Function        Write-VolumeCache                                  2.0.0.0    Storage
Cmdlet          Write-Debug                                        7.0.0.0    Microsoft.PowerShell.Utility
Cmdlet          Write-Error                                        7.0.0.0    Microsoft.PowerShell.Utility
Cmdlet          Write-EventLog                                     3.1.0.0    Microsoft.PowerShell.Management
Cmdlet          Write-Host                                         7.0.0.0    Microsoft.PowerShell.Utility
Cmdlet          Write-Information                                  7.0.0.0    Microsoft.PowerShell.Utility
Cmdlet          Write-Output                                       7.0.0.0    Microsoft.PowerShell.Utility
Cmdlet          Write-Progress                                     7.0.0.0    Microsoft.PowerShell.Utility
Cmdlet          Write-Verbose                                      7.0.0.0    Microsoft.PowerShell.Utility
Cmdlet          Write-Warning                                      7.0.0.0    Microsoft.PowerShell.Utility

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

## ä½¿ç”¨ç”¨é€”

| ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆ | èª¬æ˜ |
| --- | --- |
| Write-Debug | ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ |
| Write-Error | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ |
| Write-EventLog | ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã«ã‚¨ãƒ³ãƒˆãƒªã‚’æ›¸ãè¾¼ã‚€ |
| Write-Host | ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ |
| Write-Information | æƒ…å ±ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ |
| Write-Output | ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’é€ä¿¡ã™ã‚‹ |
| Write-Progress | ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹ |
| Write-Verbose | è©³ç´°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ |
| Write-Warning | è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ |
| Write-FileSystemCache | ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ›¸ãè¾¼ã‚€ |
| Write-DtcTransactionsTraceSession | DTCã®ãƒˆãƒ¬ãƒ¼ã‚¹ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’æ›¸ãè¾¼ã‚€ |
| Write-PrinterNfcTag | ãƒ—ãƒªãƒ³ã‚¿ãƒ¼ã®NFCã‚¿ã‚°ã«æƒ…å ±ã‚’æ›¸ãè¾¼ã‚€ |
| Write-VolumeCache | ãƒœãƒªãƒ¥ãƒ¼ãƒ ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ›¸ãè¾¼ã‚€ |

## Write-Host ã¨ Write-Output ã®é•ã„

$$

ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ \leftarrow ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤º \leftarrow æ¨™æº–å‡ºåŠ› \leftarrow ï¼ˆPowerShellå†…éƒ¨ï¼‰

$$

ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã®ã¿ã«å‡ºåŠ›ã—ã€æ¨™æº–å‡ºåŠ›ã—ãªã„ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆãŒã€Write-Hostã€‚

ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã¨æ¨™æº–å‡ºåŠ›ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€Write-Outputã€‚
ãªãŠã€å®Ÿéš›ã®å‹•ãã¯ã€Write-Outputã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆè‡ªä½“ã«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã™ã‚‹æ©Ÿèƒ½ã¯ãªã„ã€‚
æ¨™æº–å‡ºåŠ›ã•ã‚ŒãŸã“ã¨ã«ã‚ˆã‚ŠPowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å´ã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºã—ã¦ã„ã‚‹ã€‚

## å„ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã¿ã‚‹

1. Write-Debug

    ```powershell:Write-Debug
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $DebugPreference
    SilentlyContinue
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-Debug 'Write Debug Message'
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $DebugPreference = 'Continue'
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-Debug 'Write Debug Message'
    DEBUG: Write Debug Message
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    ```

    [Write-Debug - Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/write-debug)

1. Write-Error

    ```powershell:Write-Error
    # ã‚¨ãƒ©ãƒ¼å‡ºåŠ›
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-Error "Write Error Message" -ErrorId Err001 -Category InvalidResult
    Write-Error: Write Error Message
    # ã‚¨ãƒ©ãƒ¼ã®å±¥æ­´ãŒã‚ã‚‹è‡ªå‹•å¤‰æ•°ã€Œ$Errorã€ã®Propertyã‚’ç¢ºèª
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $Error[0] | Get-Member

    TypeName: System.Management.Automation.ErrorRecord

    Name                  MemberType     Definition
    ----                  ----------     ----------
    Equals                Method         bool Equals(System.Object obj)
    GetHashCode           Method         int GetHashCode()
    GetObjectData         Method         void GetObjectData(System.Runtime.Serialization.SerializationInfo info, System.Ruâ€¦
    GetType               Method         type GetType()
    ToString              Method         string ToString()
    CategoryInfo          Property       System.Management.Automation.ErrorCategoryInfo CategoryInfo {get;}
    ErrorDetails          Property       System.Management.Automation.ErrorDetails ErrorDetails {get;set;}
    Exception             Property       System.Exception Exception {get;}
    FullyQualifiedErrorId Property       string FullyQualifiedErrorId {get;}
    InvocationInfo        Property       System.Management.Automation.InvocationInfo InvocationInfo {get;}
    PipelineIterationInfo Property       System.Collections.ObjectModel.ReadOnlyCollection[int] PipelineIterationInfo {getâ€¦
    ScriptStackTrace      Property       string ScriptStackTrace {get;}
    TargetObject          Property       System.Object TargetObject {get;}
    PSMessageDetails      ScriptProperty System.Object PSMessageDetails {get=& { Set-StrictMode -Version 1; $this.Exceptioâ€¦

    # ã‚¨ãƒ©ãƒ¼æƒ…å ±ã‚’ç¢ºèª
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $Error[0].Exception

    TargetSite     :
    Message        : Write Error Message
    Data           : {}
    InnerException :
    HelpLink       :
    Source         :
    HResult        : -2146233087
    StackTrace     :

    # ã‚¨ãƒ©ãƒ¼ã®IDã‚’ç¢ºèª
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $Error[0].FullyQualifiedErrorId
    Err001

    # ã‚¨ãƒ©ãƒ¼ã®Categoryã‚’ç¢ºèª
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $Error[0].CategoryInfo

    Category   : InvalidResult
    Activity   : Write-Error
    Reason     : WriteErrorException
    TargetName :
    TargetType :

    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    ```

    [Write-Error - Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/write-error)
1. Write-EventLog
    ã“ã®`Write-EvnetLog`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ã€PowerShell 5.1ã¾ã§ã¯å®Ÿè¡Œå¯èƒ½ã§ã™ã€‚
    6.0ä»¥é™ã®Coreãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ã€å®Ÿè¡Œã§ãã¾ã›ã‚“ã€‚ã‹ã‚ã‚Šã«`New-WinEvnet`ã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

    - PowerShell 5.1ä»¥å‰
        
        ```powershell:PowerShell 5.1ã¾ã§ã¯å‹•ä½œã™ã‚‹
        PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-EventLog -LogName "Application" -Source "Windows Error Reporting" -EventID 1001 -EntryType Information -Message "Write Eventlog Message." -Category 1000
        PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
        ```

        ![Write-EventLogå®Ÿè¡Œå¾Œã«ã‚¤ãƒ™ãƒ³ãƒˆãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ã‚’ç¢ºèª](https://storage.googleapis.com/zenn-user-upload/581db8e8ae3f-20240304.png)
        *ç”»åƒï¼šWrite-EventLogå®Ÿè¡Œå¾Œã«ã‚¤ãƒ™ãƒ³ãƒˆãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ã‚’ç¢ºèª*

        [Write-EventLog - Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.management/write-eventlog)

    - PowerShell 6.0ä»¥é™

        ```powershell:Write-EventLogã¯NG
        PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-EventLog -LogName "Application" -Source "Windows Error Reporting" -EventID 1001 -EntryType Information -Message "Write Eventlog Message." -Category 1000
        Write-EventLog: The term 'Write-EventLog' is not recognized as a name of a cmdlet, function, script file, or executable program.
        Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
        PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
        ```

        ```powershell:New-WinEvnetã¯OK
        PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> New-WinEvent -ProviderName Microsoft-Windows-PowerShell -Id 4100 -Payload @("PowerShell Cmdlet", "New-WinEvent", "Test Message")
        PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
        ```

        :::details New-WinEventã®æŒ‡å®šæ–¹æ³• < ã‚¯ãƒªãƒƒã‚¯ã§æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ã >

        New-WinEventã®ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã«ã¯ã€æƒ…å ±ãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸãŒã€ã‚¤ãƒ™ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹Get-WinEventã®æ–¹ã«ã€
        ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚„ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã§ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹IDã‚’å–å¾—ã™ã‚‹æ–¹æ³•ãŒã‚ã‚Šã¾ã—ãŸã€‚

        - æŒ‡å®šå¯èƒ½ãªãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ä¸€è¦§ã‚’å–å¾—ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰
            [ã“ã¡ã‚‰](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.diagnostics/get-winevent#8)ã‚’å‚è€ƒã«**æŒ‡å®šå¯èƒ½ãªãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’æ¤œç´¢**ã€‚

            ```powershell
            Get-WinEvent -ListProvider * | Format-Table Name
            ```

        - æŒ‡å®šå¯èƒ½ãªIDã®ä¸€è¦§ã‚’å–å¾—ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰
            [ã“ã¡ã‚‰](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.diagnostics/get-winevent#9)ã‚’å‚è€ƒã«ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼å†…ã§**æŒ‡å®šå¯èƒ½ãªIDã®ä¸€è¦§ã‚’å–å¾—**ã€‚

            ```powershell
            (Get-WinEvent -ListProvider "ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼å").Events | Format-Table Id, Description
            ```

        :::

        ![New-WinEventå®Ÿè¡Œã§ã‚¤ãƒ™ãƒ³ãƒˆãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ã«ç™»éŒ²ã•ã‚ŒãŸäº‹ã‚’ç¢ºèª](https://storage.googleapis.com/zenn-user-upload/7aac7d3747bb-20240304.png)
        *ç”»åƒï¼šNew-WinEventå®Ÿè¡Œã§ã‚¤ãƒ™ãƒ³ãƒˆãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ã«ç™»éŒ²ã•ã‚ŒãŸäº‹ã‚’ç¢ºèª*

        [New-WinEvent - Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.diagnostics/new-winevent)
1. Write-Host

    ```powershell
    Write-Host 'This Message. Back Ground Color = "DarkYellow", Fore Ground Color = "White"' -BackGroundColor DarkMagenta -ForeGroundColor White
    ```

    [New-WinEvent - Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/write-host)
1. Write-Information
1. Write-Output
1. Write-Progress
1. Write-Verbose
1. Write-Warning
1. Write-FileSystemCache
1. Write-DtcTransactionsTraceSession
1. Write-PrinterNfcTag
1. Write-VolumeCache
