---
title: "PowerShellã§ã€ŒWrite-ã€ã‹ã‚‰å§‹ã¾ã‚‹9ç¨®é¡ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’èª¿ã¹ãŸ"
emoji: "ğŸ§»"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---
## æ¦‚è¦

ä¸»ã«ç§ãŒå‡ºåŠ›ç³»ã§ä½¿ç”¨ã—ã¦ã„ã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ã€`Write-Host` ã¨ `Write-Output` ã§ã™ã€‚

ãã‚Œãã‚Œã®é•ã„ã‚’é›°å›²æ°—ã§ã—ã‹æŠŠæ¡ã—ã¦ã„ãªã‹ã£ãŸã“ã¨ã€‚
ã¾ãŸã€`Write-`ã§ã¯ã˜ã¾ã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆãŒä»–ã«ã‚‚ã‚ã‚Šä½¿ç”¨ç”¨é€”ã‚’ãŠã•ãˆãŸã‹ã£ãŸã“ã¨ã€‚

ä»¥ä¸Šã€2ç‚¹ã‚’ç›®çš„ã«èª¿ã¹ã¦ã¿ã¾ã—ãŸã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- PowerShellãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- ã‚ˆãä½¿ç”¨ã™ã‚‹Write-Host ã¨ Write-Output ã®é•ã„ã‚’ç†è§£ã—ãŸã„æ–¹
- Writeã§ã¯ã˜ã¾ã‚‹ä»–ã®å‡ºåŠ›ç³»ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®é•ã„ã‚‚ç†è§£ã—ãŸã„æ–¹

## ç’°å¢ƒ

```powershell:PowerShellã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $PSVersionTable

Name                           Value
----                           -----
PSVersion                      5.1.19041.4170
PSEdition                      Desktop
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}
BuildVersion                   10.0.19041.4170
CLRVersion                     4.0.30319.42000
WSManStackVersion              3.0
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1


PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

## PowerShellã«ãŠã‘ã‚‹å‡ºåŠ›ç³»ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆ9ç¨®é¡

`Get-Command Write-*`ã§Writeã§ã¯ã˜ã¾ã‚‹ã‚³ãƒãƒ³ãƒ‰ã®ä¸€è¦§ã‚’å–å¾—ã€‚

```powershell:Writeã§ã¯ã˜ã¾ã‚‹ã‚³ãƒãƒ³ãƒ‰ä¸€è¦§
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-Command Write-* -CommandType Cmdlet

CommandType     Name                                               Version    Source
-----------     ----                                               -------    ------
Cmdlet          Write-Debug                                        3.1.0.0    Microsoft.Pow...
Cmdlet          Write-Error                                        3.1.0.0    Microsoft.Pow...
Cmdlet          Write-EventLog                                     3.1.0.0    Microsoft.Pow...
Cmdlet          Write-Host                                         3.1.0.0    Microsoft.Pow...
Cmdlet          Write-Information                                  3.1.0.0    Microsoft.Pow...
Cmdlet          Write-Output                                       3.1.0.0    Microsoft.Pow...
Cmdlet          Write-Progress                                     3.1.0.0    Microsoft.Pow...
Cmdlet          Write-Verbose                                      3.1.0.0    Microsoft.Pow...
Cmdlet          Write-Warning                                      3.1.0.0    Microsoft.Pow...


PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

## ä½¿ç”¨ç”¨é€”

| ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆ | èª¬æ˜ | ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆæ–¹æ³•ã®ä¾‹ |
| --- | --- | --- |
| Write-Output | ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’é€ä¿¡<br>PowerShell 2.0ã§å°å…¥ | `Write-Output 'Success Stream Message.' 1> Redirect01.txt` |
| Write-Error | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º<br>PowerShell 2.0ã§å°å…¥ | `Write-Error 'Error Stream Message.' 2> Redirect02.txt` |
| Write-Warning | è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º<br>PowerShell 2.0ã§å°å…¥ | `Write-Warning 'Warning Stream Message.' 3> Redirect03.txt` |
| Write-Verbose | è©³ç´°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º<br>PowerShell 2.0ã§å°å…¥ | `Write-Verbose 'Verbose Stream Message.' 4> Redirect04.txt` |
| Write-Debug | ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º<br>PowerShell 2.0ã§å°å…¥ | `Write-Debug 'Debug Stream Message.' 5> Redirect05.txt` |
| Write-Information | æƒ…å ±ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º<br>PowerShell 5.0ã§å°å…¥ | `Write-Information 'Information Stream Message.' 6> Redirect06.txt` |
| Write-Progress | ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚’è¡¨ç¤º<br>PowerShell 2.0ã§å°å…¥ | â€» Progressã‚¹ãƒˆãƒªãƒ¼ãƒ ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã¯ä¸å¯ |
| Write-Host | ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º<br>PowerShell 5.0ä»¥é™ã‹ã‚‰Informationã‚¹ãƒˆãƒªãƒ¼ãƒ ã¨ã—ã¦å‡ºåŠ›ã•ã‚Œã‚‹ã‚ˆã†ã«ã€‚ | 5.0ä»¥é™ã®å ´åˆï¼š`Write-Host 'Information Stream Message.' 6> Redirect06.txt`  |
| Write-EventLog | ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã‚’å‡ºåŠ› | - |

### Write-Host ã¨ Write-Output ã®é•ã„

é•ã„ãŒã‚ˆãã‚ã‹ã£ã¦ã„ãªã‹ã£ãŸ `Write-Host` ã¨ `Write-Output` ã®é•ã„ã‚’èª¿ã¹ã‚‹ã¨ã€

- `Write-Host`ã¯ã€æ¨™æº–å‡ºåŠ›ã›ãšã«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®ã¿ã«è¡¨ç¤ºã™ã‚‹ã‚³ãƒãƒ³ãƒ‰
- `Write-Output`ã¯ã€æ¨™æº–å‡ºåŠ›ã¨ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºã™ã‚‹ã‚³ãƒãƒ³ãƒ‰

ã¨ã„ã†ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚
ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆå„ã€…ã®è§£èª¬ã¯å¾Œè¿°ã—ã¾ã™ã€‚

### Write-Host ã¨ Write-Information ã®é•ã„

ã©ã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ã‚‚å±ã—ã¦ã„ãªã‹ã£ãŸ `Write-Host` ã§ã™ãŒã€PowerShell 5.0ä»¥é™ã‹ã‚‰ **Information ã‚¹ãƒˆãƒªãƒ¼ãƒ ** ã«å±ã™ã‚‹ã‚ˆã†ã«ãªã‚Šãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
ã¾ãŸã€åŒã˜ãPowerShell 5.0ã‹ã‚‰å°å…¥ã•ã‚ŒãŸã€ `Write-Information` ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã‚‚ **Information ã‚¹ãƒˆãƒªãƒ¼ãƒ ** ã«å‡ºåŠ›ã€ã‹ã¤ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå¯èƒ½ã€‚

ãã‚Œãã‚Œã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã§ Information ã‚¹ãƒˆãƒªãƒ¼ãƒ  ã¸ã®å‡ºåŠ›ã¯å¯èƒ½ã§ã™ãŒã€é•ã„ãŒç†è§£ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚
ãã“ã§ã€`Write-Host` ã¨ `Write-Information` ã®é•ã„ã‚’èª¿ã¹ã‚‹ã¨ã€

- `Write-Host`ã¯ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºã«ç‰¹åŒ–ã—ãŸå‡ºåŠ›ã‚³ãƒãƒ³ãƒ‰
    ï¼ˆä¸Šè¨˜ã® `Write-Output` ã¨ã®é•ã„ã‚‚ãµã¾ãˆã‚‹ã¨ã€æ¨™æº–å‡ºåŠ›ã›ãšã«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºã«ç‰¹åŒ–ã—ãŸå‡ºåŠ›ã‚³ãƒãƒ³ãƒ‰ã¨ãªã‚‹ã€‚ï¼‰
- `Write-Information` ã¯ã€ãƒ­ã‚°ã‚’è¨˜éŒ²ã™ã‚‹ã“ã¨ã«ç‰¹åŒ–ã—ãŸå‡ºåŠ›ã‚³ãƒãƒ³ãƒ‰

ã¨ã„ã†ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚
ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆå„ã€…ã®è§£èª¬ã¯å¾Œè¿°ã—ã¾ã™ã€‚

### Write-Error ã¨ Write-Warning ã®é•ã„

æ–‡å­—ã‹ã‚‰å‡ºåŠ›ã™ã‚‹ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ™ãƒ«ãŒå¤‰ã‚ã‚‹ã¨ã„ã†ã®ã¯ç†è§£ã§ãã¾ã™ãŒã€å…·ä½“çš„ãªå‹•ä½œã®é•ã„ã‚’èª¿ã¹ã‚‹ã¨ã€

- `Write-Error` ã¯ã€ç¶šè¡Œä¸å¯èƒ½ãªç•°å¸¸ãŒç™ºç”Ÿã—ãŸå ´åˆã®å‡ºåŠ›ã‚³ãƒãƒ³ãƒ‰
- `Write-Warning` ã¯ã€ç¶šè¡Œä¸å¯ã¾ã§ã¯ã„ã‹ãªã„ãŒè­¦å‘Šã™ã¹ãç•°å¸¸ãŒç™ºç”Ÿã—ãŸå ´åˆã®å‡ºåŠ›ã‚³ãƒãƒ³ãƒ‰

ã¨ã„ã†ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚
ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆå„ã€…ã®è§£èª¬ã¯å¾Œè¿°ã—ã¾ã™ã€‚

## å„ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®è§£èª¬ãƒ»å®Ÿéš›ã«å®Ÿè¡Œã—ã¦ã¿ã‚‹

ã–ã£ãã‚Šæ›¸ãã¨2024å¹´4æœˆç¾åœ¨ã€PowerShellã«ã¯å‡ºåŠ›ã™ã‚‹å ´æ‰€ï¼ˆOutput Streamsï¼‰ãŒåˆè¨ˆ7ç¨®é¡ã‚ã‚Šã¾ã™ã€‚
ä»Šå›ç´¹ä»‹ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®å¤§åŠã¯ã€ãã®7ç¨®é¡ãã‚Œãã‚Œã«å‡ºåŠ›ã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ã€‚
        
1. Write-Output
    **Success ã‚¹ãƒˆãƒªãƒ¼ãƒ ** ã«å‡ºåŠ›ã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€‚ä¸€èˆ¬çš„ãªITç”¨èªã«ã™ã‚‹ã¨æ¨™æº–å‡ºåŠ›ã®ã“ã¨ã€‚
    ã€€
    ä¸»ã«ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«æ¸¡ã—ãŸã‚Šã€å¤‰æ•°ã«ä»£å…¥ã—ãŸã‚Šã™ã‚‹ç›®çš„ã§ä½¿ç”¨ã•ã‚Œã‚‹ã€‚
    ã€€
    å‰è¿°ã®èª¬æ˜ã§ã¯ã€æ¨™æº–å‡ºåŠ›ã¨ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºã‚’è¡Œã†ã¨è¨˜è¼‰ã—ã¦ã„ã‚‹ãŒã€å³å¯†ã«ã„ã†ã¨æ©Ÿèƒ½ã¯æ¨™æº–å‡ºåŠ›ã®ã¿ã§ã€
    PowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒæ¨™æº–å‡ºåŠ›ã•ã‚ŒãŸå†…å®¹ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºã—ã¦ã„ã‚‹ã¨ã®ã“ã¨ã€‚
    ã€€
    ãªãŠã€ã“ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’æˆ»ã‚Šå€¤ã®ã‚ã‚‹Functionå†…ã§ä½¿ç”¨ã—ãŸå ´åˆã€æœŸå¾…é€šã‚Šã®æˆ»ã‚Šå€¤ã¨ãªã‚‰ãªã„ã€‚
    ãŸã¨ãˆã°ã€Functionå†…ã§ `Write-Output 'Test Message'`ã¨æ–‡å­—åˆ—ï¼ˆ`System.String`ï¼‰ã‚’æ¨™æº–å‡ºåŠ›ã—ã€æˆ»ã‚Šå€¤ã‚’ `return $True` ã¨è«–ç†å€¤ï¼ˆ`System.Boolean` ã¾ãŸã¯ `bool`ï¼‰ã§æŒ‡å®šã—ãŸå ´åˆã®æˆ»ã‚Šå€¤ã¯ã€è«–ç†å€¤ã§ã¯ãªãã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ï¼ˆ`System.Object[]`ï¼‰ã¨ã—ã¦è¿”ã£ã¦ãã‚‹ã€‚
    ã“ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†…ã«æ¨™æº–å‡ºåŠ›ã—ãŸæ–‡å­—åˆ—ã¨æˆ»ã‚Šå€¤ã§è¨­å®šã—ãŸè«–ç†å€¤ã®2ã¤ãŒå…¥ã£ã¦ã—ã¾ã†ã€‚

    ```powershell:Write-Output
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-Output 'Write Output Message'
    Write Output Message
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    ```

    [Write-Output - Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/write-output)

1. Write-Error
    **Error ã‚¹ãƒˆãƒªãƒ¼ãƒ ** ã«å‡ºåŠ›ã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€‚ä¸€èˆ¬çš„ãªITç”¨èªã«ã™ã‚‹ã¨æ¨™æº–ã‚¨ãƒ©ãƒ¼ã®ã“ã¨ã€‚
    ã€€
    é€šå¸¸ã€å‡¦ç†ã®ç¶šè¡ŒãŒä¸å¯èƒ½ãªé‡å¤§ãªå•é¡ŒãŒç™ºç”Ÿã—ãŸã‚±ãƒ¼ã‚¹ã§ä½¿ç”¨ã€‚
    ã€€
    ãªãŠã€ã“ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€PowerShellã®è‡ªå‹•å¤‰æ•° `$Error` ã«è‡ªå‹•ã§æ ¼ç´ã•ã‚Œã‚‹ã€‚
    æœ€æ–°ã®ã‚¨ãƒ©ãƒ¼ã¯ã€ä¸€ç•ªè¦ç´ ãŒä½ã„ `$Error[0]` ã«æ ¼ç´ã•ã‚Œã‚‹ã€‚è¦ç´ æ•°ãŒã‚ãŒã‚‹ã«ã¤ã‚Œã¦éå»ã®ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèªå¯èƒ½ã€‚

    ```powershell:Write-Error
    # ã‚¨ãƒ©ãƒ¼å‡ºåŠ›
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-Error "Write Error Message" -ErrorId Err001 -Category InvalidResult
    Write-Error "Write Error Message" -ErrorId Err001 -Category InvalidResult : Write Error Message
    + CategoryInfo          : InvalidResult: (:) [Write-Error]ã€WriteErrorException
    + FullyQualifiedErrorId : Err001
    # ã‚¨ãƒ©ãƒ¼ã®å±¥æ­´ãŒã‚ã‚‹è‡ªå‹•å¤‰æ•°ã€Œ$Errorã€ã®Propertyã‚’ç¢ºèª
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $Error[0] | Get-Member -MemberType Property
    

       TypeName: System.Management.Automation.ErrorRecord
    
    Name                  MemberType Definition
    ----                  ---------- ----------
    CategoryInfo          Property   System.Management.Automation.ErrorCategoryInfo CategoryInfo {get;}
    ErrorDetails          Property   System.Management.Automation.ErrorDetails ErrorDetails {get;set;}
    Exception             Property   System.Exception Exception {get;}
    FullyQualifiedErrorId Property   string FullyQualifiedErrorId {get;}
    InvocationInfo        Property   System.Management.Automation.InvocationInfo InvocationInfo {get;}
    PipelineIterationInfo Property   System.Collections.ObjectModel.ReadOnlyCollection[int] PipelineIterationInfo {get;}
    ScriptStackTrace      Property   string ScriptStackTrace {get;}
    TargetObject          Property   System.Object TargetObject {get;}
    

    # ã‚¨ãƒ©ãƒ¼æƒ…å ±ã‚’ç¢ºèª
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $Error[0].Exception
    Write Error Message

    # ã‚¨ãƒ©ãƒ¼ã®IDã‚’ç¢ºèª
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $Error[0].FullyQualifiedErrorId
    Err001

    # ã‚¨ãƒ©ãƒ¼ã®Categoryã‚’ç¢ºèª
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $Error[0].CategoryInfo

    Category   : InvalidResult
    Activity   : Write-Error
    Reason     : WriteErrorException
    TargetName :
    TargetType :


    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    ```

    [Write-Error - Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/write-error)

1. Write-Warning
    **Warning ã‚¹ãƒˆãƒªãƒ¼ãƒ ** ã«å‡ºåŠ›ã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€‚
    ã€€
    é€šå¸¸ã€å‡¦ç†ã‚’ç¶šè¡Œå¯èƒ½ã ãŒè­¦å‘ŠãŒå¿…è¦ãªå•é¡ŒãŒç™ºç”Ÿã—ãŸã‚±ãƒ¼ã‚¹ã§ä½¿ç”¨ã€‚

    ```powershell:Write-Warning
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-Warning 'Write Warning Message'
    è­¦å‘Š: Write Warning Message
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    ```

    [Write-Warning - Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/write-warning)

1. Write-Verbose
    **Verbose ã‚¹ãƒˆãƒªãƒ¼ãƒ ** ã«å‡ºåŠ›ã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€‚
    ã€€
    é€šå¸¸ã€ã‚ˆã‚Šè©³ç´°ãªæƒ…å ±ã‚’æä¾›ã—ãŸã„ã‚±ãƒ¼ã‚¹ã§ä½¿ç”¨ã€‚
    ã€€
    ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨­å®šã ã¨ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã«è¡¨ç¤ºã•ã‚Œãªã„ãŒã€`$VerbosePreference` ã‚’ã€Œ`Continue`ã€ã«ã™ã‚‹ã¨ã€
    ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã«å‡ºåŠ›ã•ã‚Œã‚‹ã€‚
    ã€€
    ã¾ãŸã€ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ `-Verbose` ã‚’æŒ‡å®šã™ã‚‹æ–¹æ³•ã§ã‚‚Verboseã‚¹ãƒˆãƒªãƒ¼ãƒ ã«å‡ºåŠ›ãŒå¯èƒ½ã€‚
    ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¯ `$VerbosePreference` ã®è¨­å®šã«ã‹ã‹ã‚ã‚‰ãšå‡ºåŠ›å¯èƒ½ã¨ãªã‚‹ã€‚

    ```powershell:Write-Verbose
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $VerbosePreference
    SilentlyContinue
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-Verbose 'Write Verbose Message'
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $VerbosePreference = "Continue"
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-Verbose 'Write Verbose Message'
    è©³ç´°: Write Verbose Message
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    ```
    
    [Write-Verbose - Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/write-verbose)

1. Write-Debug
    **Debug ã‚¹ãƒˆãƒªãƒ¼ãƒ ** ã«å‡ºåŠ›ã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€‚
    ã€€
    é€šå¸¸ã€é–‹ç™ºæ™‚ã®ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã™ã‚‹ã‚±ãƒ¼ã‚¹ã§ä½¿ç”¨ã€‚
    ã€€
    ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨­å®šã ã¨ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã«è¡¨ç¤ºã•ã‚Œãªã„ãŒã€`$DebugPreference` ã‚’ã€Œ`Continue`ã€ã«ã™ã‚‹ã¨ã€
    ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã«å‡ºåŠ›ã•ã‚Œã‚‹ã€‚
    ã€€
    ã¾ãŸã€ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ `-Debug` ã‚’æŒ‡å®šã™ã‚‹æ–¹æ³•ã§ã‚‚Debugã‚¹ãƒˆãƒªãƒ¼ãƒ ã«å‡ºåŠ›ãŒå¯èƒ½ã€‚
    ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¯ `$DebugPreference` ã®è¨­å®šã«ã‹ã‹ã‚ã‚‰ãšå‡ºåŠ›å¯èƒ½ã¨ãªã‚‹ã€‚

    ```powershell:Write-Debug
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $DebugPreference
    SilentlyContinue
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-Debug 'Write Debug Message'
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $DebugPreference = 'Continue'
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-Debug 'Write Debug Message'
    DEBUG: Write Debug Message
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    ```
    
    [Write-Debug - Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/write-debug)

1. Write-Information
    **Informationã‚¹ãƒˆãƒªãƒ¼ãƒ ** ã«å‡ºåŠ›ã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€‚
    ã€€
    é€šå¸¸ã€ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ãªã©ã«è¨˜éŒ²ã™ã‚‹ã‚±ãƒ¼ã‚¹ã§ä½¿ç”¨ã€‚

    ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨­å®šã ã¨ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã«è¡¨ç¤ºã•ã‚Œãªã„ãŒã€`$InformationPreference` ã‚’ã€Œ`Continue`ã€ã«ã™ã‚‹ã¨ã€
    ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã«å‡ºåŠ›ã•ã‚Œã‚‹ã€‚
    ã€€
    ã¾ãŸã€ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ `-InformationAction` ã‚’æŒ‡å®šã™ã‚‹æ–¹æ³•ã§ã‚‚Informationã‚¹ãƒˆãƒªãƒ¼ãƒ ã«å‡ºåŠ›ãŒå¯èƒ½ã€‚
    ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¯ `$InformationPreference` ã®è¨­å®šã«ã‹ã‹ã‚ã‚‰ãšå‡ºåŠ›å¯èƒ½ã¨ãªã‚‹ã€‚
    ã€€
    ãªãŠã€`Write-Host` ã¨ã®é•ã„ã¯ã€æ–‡å­—è‰²ãƒ»èƒŒæ™¯è‰²ãªã©è¦‹ãŸç›®ã‚’å¤‰æ›´ã§ãã‚‹ã®ãŒ`Write-Host`ã€‚Informationã‚¹ãƒˆãƒªãƒ¼ãƒ ä¸Šã§ã‚¿ã‚°ä»˜ã‘ã§ãã‚‹ãªã©ã®è¨˜éŒ²ãŒã§ãã‚‹ã®ãŒ`Write-Information`ã€‚

    ```powershell:
    # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å®Ÿè¡Œ
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $InformationPreference
    SilentlyContinue
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-Information "Write Information Message"
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    # $InformationPreference ã‚’å¤‰æ›´ã—ã¦å®Ÿè¡Œ
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $InformationPreference = "Continue"
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $InformationPreference
    Continue
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-Information "Write Information Message"
    Write Information Message
    PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
    ```

    [Write-Information - Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/write-information)

1. Write-Progress
    ã©ã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ã‚‚å‡ºåŠ›ã§ããªã„ã€‚é€²æ—ãƒãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€‚

    ```powershell:Write-Progress
    for ($i = 1; $i -le 100; $i++ ) {
        Write-Progress -Activity "Search in Progress" -Status "$i% Complete:" -PercentComplete $i
        Start-Sleep -Milliseconds 250
    }
    ```

    ![å®Ÿéš›ã«Write-Progressã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’å®Ÿè¡Œã—ãŸçµæœ](https://storage.googleapis.com/zenn-user-upload/7b6f356f8561-20240410.png)
    *ç”»åƒï¼šå®Ÿéš›ã«Write-Progressã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’å®Ÿè¡Œã—ãŸçµæœ*

    [Write-Progress - Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/write-progress)

1. Write-Host
    å‰è¿°ã—ã¦ã„ã‚‹é€šã‚Šã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€‚

    PowerShell 5.0ä»¥é™ã§ã¯ **Information ã‚¹ãƒˆãƒªãƒ¼ãƒ ** ã«å‡ºåŠ›ã•ã‚Œã‚‹ã‚ˆã†ã«ã€‚
    5.0ã‚ˆã‚Šå‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ã€ã©ã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ã‚‚å‡ºåŠ›ã§ããªã‹ã£ãŸãŸã‚ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§é€ã‚‹ã“ã¨ãŒã§ããªã‹ã£ãŸã€‚
    ã€€
    ã“ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ–‡å­—è‰²ãªã©ã®è¦‹ãŸç›®ãŒå¤‰æ›´ã§ãã‚‹ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã«é‡ç‚¹ã‚’ç½®ã„ãŸã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€‚
    ã€€
    ãªãŠã€`Write-Host` ã¨ã®é•ã„ã¯ã€æ–‡å­—è‰²ãƒ»èƒŒæ™¯è‰²ãªã©è¦‹ãŸç›®ã‚’å¤‰æ›´ã§ãã‚‹ã®ãŒ`Write-Host`ã€‚Informationã‚¹ãƒˆãƒªãƒ¼ãƒ ä¸Šã§ã‚¿ã‚°ä»˜ã‘ã§ãã‚‹ãªã©ã®è¨˜éŒ²ãŒã§ãã‚‹ã®ãŒ`Write-Information`ã€‚

    ```powershell
    Write-Host 'This Message. Back Ground Color = "DarkYellow", Fore Ground Color = "White"' -BackGroundColor DarkMagenta -ForeGroundColor White
    ```

    [Write-Host - Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/write-host)

1. Write-EventLog
    ã“ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ã€ã‚¹ãƒˆãƒªãƒ¼ãƒ ã¯é–¢ä¿‚ãªãã‚¤ãƒ™ãƒ³ãƒˆãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ã«å‡ºåŠ›ã™ã‚‹ãƒ­ã‚°ãŒç”Ÿæˆå¯èƒ½ã€‚
    ã€€
    `Write-EvnetLog`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ã€PowerShell 5.1ã¾ã§å®Ÿè¡Œå¯èƒ½ã ãŒã€6.0ä»¥é™ã®Coreã‚¨ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ã§ã¯ã€å®Ÿè¡Œã§ããªããªã£ãŸã€‚
    ã‹ã‚ã‚Šã«6.0ä»¥é™ã®Coreã‚¨ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ã§ã¯ã€`New-WinEvnet`ã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã§å¯¾å¿œå¯èƒ½ã«ã€‚
    ã€€
    - PowerShell 5.1ä»¥å‰
        
        ```powershell:PowerShell 5.1ã¾ã§ã¯å‹•ä½œã™ã‚‹
        PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-EventLog -LogName "Application" -Source "Windows Error Reporting" -EventID 1001 -EntryType Information -Message "Write Eventlog Message." -Category 1000
        PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
        ```

        ![Write-EventLogå®Ÿè¡Œå¾Œã«ã‚¤ãƒ™ãƒ³ãƒˆãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ã‚’ç¢ºèª](https://storage.googleapis.com/zenn-user-upload/581db8e8ae3f-20240304.png)
        *ç”»åƒï¼šWrite-EventLogå®Ÿè¡Œå¾Œã«ã‚¤ãƒ™ãƒ³ãƒˆãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ã‚’ç¢ºèª*

        [Write-EventLog - Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.management/write-eventlog)

    - PowerShell 6.0ä»¥é™

        6.0ä»¥é™ã§ã¯ `Write-EventLog` ãŒä½¿ç”¨ã§ããªã„ç‚ºã€ã‚¨ãƒ©ãƒ¼ã¨ãªã‚‹ã€‚

        ```powershell:Write-EventLogã¯NG
        PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-EventLog -LogName "Application" -Source "Windows Error Reporting" -EventID 1001 -EntryType Information -Message "Write Eventlog Message." -Category 1000
        Write-EventLog: The term 'Write-EventLog' is not recognized as a name of a cmdlet, function, script file, or executable program.
        Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
        PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
        ```

        6.0ä»¥é™ã§æ–°ã—ã `New-WinEvent` ã§ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã¸ã®å‡ºåŠ›ãŒå¯èƒ½ã«ã€‚

        ```powershell:New-WinEvnetã¯OK
        PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> New-WinEvent -ProviderName Microsoft-Windows-PowerShell -Id 4100 -Payload @("PowerShell Cmdlet", "New-WinEvent", "Test Message")
        PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
        ```
    
        ![New-WinEventå®Ÿè¡Œã§ã‚¤ãƒ™ãƒ³ãƒˆãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ã«ç™»éŒ²ã•ã‚ŒãŸäº‹ã‚’ç¢ºèª](https://storage.googleapis.com/zenn-user-upload/7aac7d3747bb-20240304.png)
        *ç”»åƒï¼šNew-WinEventå®Ÿè¡Œã§ã‚¤ãƒ™ãƒ³ãƒˆãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ã«ç™»éŒ²ã•ã‚ŒãŸäº‹ã‚’ç¢ºèª*

        [New-WinEvent - Microsoft Learn](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.diagnostics/new-winevent)

    :::details é–¢é€£è¨˜äº‹ï¼šPowerShellã§ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã‚’å‡ºåŠ›ã™ã‚‹æ–¹æ³•ã‚’ã‚ˆã‚Šæ·±ãèª¿ã¹ãŸ < ã‚¯ãƒªãƒƒã‚¯ã§æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ã >

    @[card](https://zenn.dev/haretokidoki/articles/0a179fe71a2cc8)
    @[card](https://zenn.dev/haretokidoki/articles/af3e404855c54b)
    @[card](https://zenn.dev/haretokidoki/articles/48de2dc693f9c0)

    :::

## å‚è€ƒæƒ…å ±

https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/about/about_output_streams
https://blog.shibata.tech/entry/2015/06/26/001944

## ã¾ã¨ã‚

PowerShellã®å‡ºåŠ›ç³»ã®ã‚³ãƒãƒ³ãƒ‰ã®é•ã„ã‚’ãŠã•ãˆã‚‹ã“ã¨ãŒã§ããŸï¼

é•ã„ã¯ä¸‹è¨˜ã®ã¨ãŠã‚Šã€‚

- Write-Outputï¼šãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’é€ä¿¡
- Write-Errorï¼šã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
- Write-Warningï¼šè­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
- Write-Verboseï¼šè©³ç´°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
- Write-Debugï¼šãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
- Write-Informationï¼šæƒ…å ±ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
- Write-Progressï¼šãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚’è¡¨ç¤º
- Write-Hostï¼šã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
- Write-EventLogï¼šã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã‚’å‡ºåŠ›ï¼ˆPowerShell 5.1ä»¥å‰ã§å‹•ä½œï¼‰
    6.0ä»¥é™ã®Coreã‚¨ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ã§ã¯ã€`New-WinEvnet`ã§å¯¾å¿œã€‚

## é–¢é€£è¨˜äº‹

https://zenn.dev/haretokidoki/articles/0a179fe71a2cc8
https://zenn.dev/haretokidoki/articles/af3e404855c54b
https://zenn.dev/haretokidoki/articles/48de2dc693f9c0
https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
