---
title: "[PowerShell]変数のデータ型をより簡単に確認できる自作Function"
emoji: "🐈"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["powershell"]
published: false
---
## 概要

コマンドを直接実行する際、データ型を意識する事は少ないです。
ただ、色々なデータを扱うようなPowerShellスクリプトを作成する場合は、意識して設計・開発する必要があり、
頻繁に確認します。

通常、PowerShell でデータ型を確認する方法は、「 `"変数名".GetType.FullName` 」というようにすこし長いコマンドを打つ必要があります。
何度も、このコマンドを実行するとキータイプが面倒だったので、今回より簡単に確認できる自作Functionを作成しました。

## この記事のターゲット

- PowerShell ユーザーの方
- 変数のデータ型をより簡単に確認したい方

## データ型を確認する自作Function「Get-Type」

実行方法は、「 `Get-Type "対象の変数"` 」とすると、下記の3つの項目が確認できます。

- 項目1：IsPublis
    `"変数名".GetType()` で確認できる変数のスコープ設定（IsPublic）を表示
- 項目2：BaseType
    `"変数名".GetType()` で確認できるベースのデータ型（BaseType）を表示
- 項目3：Type
    `"変数名".GetType().FullName` で確認できる変数のデータ型を表示

```powershell:データ型を調べる「Get-Type」Function
Function Get-Type {
	param (
	    [Parameter(Mandatory=$true)]$variable
	)

    # 変数が
	[System.String]$types_public = $variable.GetType().IsPublic.ToString()
	[System.String]$types_basetype = "$($variable.GetType().BaseType.FullName)"
	[System.String]$types_type = "$($variable.GetType().FullName)"
	
	[System.String[]]$rowdata = @(
		$types_public,
		$types_basetype,
		$types_type
	)
	
	$types_table = [PSCustomObject]@{
		IsPublic=$rowdata[0]
		BaseType=$rowdata[1]
		Type=$rowdata[2]
	}
	
	$types_table | Format-Table -Property IsPublic, BaseType, Type -AutoSize -Wrap
}
```

## いろいろなケースで自作Functionを検証

### 文字列 の場合

### 数値 の場合

### 文字列 ＆ 配列 の場合

### オブジェクト ＆ 配列 の場合

## 参考情報

> ※ PowerShell でプロファイルを使い、いつでも定義した定数や変数、Functionを呼び出せるようにする設定方法は、[こちら](https://zenn.dev/haretokidoki/articles/e2a6c521035d94)の記事を参照してください。

System.Management.Automation.PSCustomObject
https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/about/about_pscustomobject

whichインスピ
https://tex2e.github.io/blog/powershell/which
