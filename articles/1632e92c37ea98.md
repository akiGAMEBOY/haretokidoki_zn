---
title: "[PowerShell]å¤‰æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’ã‚ˆã‚Šç°¡å˜ã«ç¢ºèªã§ãã‚‹è‡ªä½œFunction"
emoji: "ğŸˆ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---
## æ¦‚è¦

ã‚³ãƒãƒ³ãƒ‰ã‚’ç›´æ¥å®Ÿè¡Œã™ã‚‹éš›ã€ãƒ‡ãƒ¼ã‚¿å‹ã‚’æ„è­˜ã™ã‚‹äº‹ã¯å°‘ãªã„ã§ã™ã€‚
ãŸã ã€è‰²ã€…ãªãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†ã‚ˆã†ãªPowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã™ã‚‹å ´åˆã¯ã€æ„è­˜ã—ã¦è¨­è¨ˆãƒ»é–‹ç™ºã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€
é »ç¹ã«ç¢ºèªã—ã¾ã™ã€‚

é€šå¸¸ã€PowerShell ã§ãƒ‡ãƒ¼ã‚¿å‹ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•ã¯ã€ã€Œ `"å¤‰æ•°å".GetType.FullName` ã€ã¨ã„ã†ã‚ˆã†ã«ã™ã“ã—é•·ã„ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã¤å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ä½•åº¦ã‚‚ã€ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã‚­ãƒ¼ã‚¿ã‚¤ãƒ—ãŒé¢å€’ã ã£ãŸã®ã§ã€ä»Šå›ã‚ˆã‚Šç°¡å˜ã«ç¢ºèªã§ãã‚‹è‡ªä½œFunctionã‚’ä½œæˆã—ã¾ã—ãŸã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- PowerShell ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- å¤‰æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’ã‚ˆã‚Šç°¡å˜ã«ç¢ºèªã—ãŸã„æ–¹

## ãƒ‡ãƒ¼ã‚¿å‹ã‚’ç¢ºèªã™ã‚‹è‡ªä½œFunctionã€ŒGet-Typeã€

å®Ÿè¡Œæ–¹æ³•ã¯ã€ã€Œ `Get-Type "å¯¾è±¡ã®å¤‰æ•°"` ã€ã¨ã™ã‚‹ã¨ã€ä¸‹è¨˜ã®3ã¤ã®é …ç›®ãŒç¢ºèªã§ãã¾ã™ã€‚

- é …ç›®1ï¼šIsPublis
    `"å¤‰æ•°å".GetType()` ã§ç¢ºèªã§ãã‚‹å¤‰æ•°ã®ã‚¹ã‚³ãƒ¼ãƒ—è¨­å®šï¼ˆIsPublicï¼‰ã‚’è¡¨ç¤º
- é …ç›®2ï¼šBaseType
    `"å¤‰æ•°å".GetType()` ã§ç¢ºèªã§ãã‚‹ãƒ™ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿å‹ï¼ˆBaseTypeï¼‰ã‚’è¡¨ç¤º
- é …ç›®3ï¼šType
    `"å¤‰æ•°å".GetType().FullName` ã§ç¢ºèªã§ãã‚‹å¤‰æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’è¡¨ç¤º

```powershell:ãƒ‡ãƒ¼ã‚¿å‹ã‚’èª¿ã¹ã‚‹ã€ŒGet-Typeã€Function
Function Get-Type {
	param (
	    [Parameter(Mandatory=$true)]$variable
	)

    # å¤‰æ•°ãŒ
	[System.String]$types_public = $variable.GetType().IsPublic.ToString()
	[System.String]$types_basetype = "$($variable.GetType().BaseType.FullName)"
	[System.String]$types_type = "$($variable.GetType().FullName)"
	
	[System.String[]]$rowdata = @(
		$types_public,
		$types_basetype,
		$types_type
	)
	
	$types_table = [PSCustomObject]@{
		IsPublic=$rowdata[0]
		BaseType=$rowdata[1]
		Type=$rowdata[2]
	}
	
	$types_table | Format-Table -Property IsPublic, BaseType, Type -AutoSize -Wrap
}
```

## ã„ã‚ã„ã‚ãªã‚±ãƒ¼ã‚¹ã§è‡ªä½œFunctionã‚’æ¤œè¨¼

### æ–‡å­—åˆ— ã®å ´åˆ

```powershell:æ–‡å­—åˆ— ã®å ´åˆ
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> [System.String]$str = '$str is String.'
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-Type $str

IsPublic BaseType      Type
-------- --------      ----
True     System.Object System.String


PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

### æ•°å€¤ ã®å ´åˆ

```powershell:æ•°å€¤ ã®å ´åˆ
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $int = 999999999999999999
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-Type $int

IsPublic BaseType         Type
-------- --------         ----
True     System.ValueType System.Int64


PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

### æ–‡å­—åˆ— ï¼‹ é…åˆ— ã®å ´åˆ

```powershell:æ–‡å­—åˆ— ï¼‹ é…åˆ— ã®å ´åˆ
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> [System.String[]]$str_array = @('text1', 'text2', 'text3')
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-Type $str_array

IsPublic BaseType     Type
-------- --------     ----
True     System.Array System.String[]


PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

### ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ï¼‹ é…åˆ— ã®å ´åˆ

```powershell:ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ï¼‹ é…åˆ— ã®å ´åˆ
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> [System.Object[]]$obj_array = @(999, 'text2')
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-Type $obj_array

IsPublic BaseType     Type
-------- --------     ----
True     System.Array System.Object[]


PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-Type $obj_array[0]

IsPublic BaseType         Type
-------- --------         ----
True     System.ValueType System.Int32


PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-Type $obj_array[1]

IsPublic BaseType      Type
-------- --------      ----
True     System.Object System.String


PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

## å‚è€ƒæƒ…å ±

è‡ªä½œã—ãŸFunctionã‚’PowerShellã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã«ç™»éŒ²ã™ã‚‹ã“ã¨ã§ã€è‡ªå‹•ã§è‡ªä½œã®Functionã‚’å®šç¾©å¯èƒ½ã€‚
[ã“ã¡ã‚‰](https://zenn.dev/haretokidoki/articles/e2a6c521035d94)ã®è¨˜äº‹ã«ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ç”¨ã®PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç™»éŒ²ã™ã‚‹æ‰‹é †ã‚’ç´¹ä»‹ã—ã¦ã„ã¾ã™ã€‚
ã“ã“ã«ã‚ã‚‹æ‰‹é †ã«ä»Šå›ã®è‡ªä½œã—ãŸFunctionã‚’å®šç¾©ã—ã¦ãã ã•ã„ã€‚

[System.Management.Automation.PSCustomObjectï¼ˆabout_PSCustomObjectï¼‰](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/about/about_pscustomobject)

[å‚è€ƒå…ƒï¼šPowerShellã§Linuxã®whichã‚³ãƒãƒ³ãƒ‰ã‚’ä½œã‚‹](https://tex2e.github.io/blog/powershell/which)
