---
title: "[PowerShell]è‡ªå‹•å¤‰æ•°ï¼ˆäºˆç´„èªï¼‰ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’èª¿ã¹ã¦ã¿ãŸ"
emoji: "ğŸ”"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell", "è‡ªå‹•å¤‰æ•°"]
published: false
---
## æ¦‚è¦
PowerShellã®äºˆç´„èªã®ã‚ˆã†ãªã‚‚ã®ã§ã‚ã‚‹[è‡ªå‹•å¤‰æ•°](https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/about/about_automatic_variables?view=powershell-7.2)ã‚’ä½¿ç”¨ã™ã‚‹éš›ã€
æ­£ã—ããƒ‡ãƒ¼ã‚¿å‹ã‚’ç†è§£ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã€æ¯å›PowerShellã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã™ã‚‹åº¦ã«ã‚³ãƒãƒ³ãƒ‰ã§èª¿ã¹ã¦ã„ã¾ã—ãŸã€‚

ã„ã£ãã®äº‹ã€äº‹å‰ã«ã™ã¹ã¦ã®è‡ªå‹•å¤‰æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’èª¿ã¹ã¦ä¸€è¦§åŒ–ã—ã¦ã—ã¾ãŠã†ã¨ã„ã†ã®ãŒè¶£æ—¨ã¨ãªã‚Šã¾ã™ã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
- PowerShellãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- è‡ªå‹•å¤‰æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’ç¢ºèªã—ãŸã„æ–¹

## ç’°å¢ƒ
```powershell:PowerShellã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³
PS C:\WINDOWS\system32> $PSVersionTable

Name                           Value
----                           -----
PSVersion                      5.1.19041.3031
PSEdition                      Desktop
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}
BuildVersion                   10.0.19041.3031
CLRVersion                     4.0.30319.42000
WSManStackVersion              3.0
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1


PS C:\WINDOWS\system32>
```

## èª¿æŸ»æ–¹æ³•
`è‡ªå‹•å¤‰æ•°å.GetType().FullName`ã«ã‚ˆã‚Šãƒ‡ãƒ¼ã‚¿å‹ã‚’èª¿ã¹ã¾ã—ãŸã€‚
å®Ÿéš›ã«ã€`$PSVersionTable`ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’èª¿ã¹ãŸéš›ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€ä¸‹è¨˜ã®é€šã‚Šã§ã™ã€‚
```powershell:$PSVersionTableã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’ç¢ºèª
PS C:\WINDOWS\system32> $PSVersionTable.GetType().FullName
System.Collections.Hashtable
PS C:\WINDOWS\system32>
```
### å‚è€ƒæƒ…å ±
https://learn.microsoft.com/ja-jp/dotnet/api/system.object.gettype?view=net-7.0
https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/about/about_properties?view=powershell-7.3

## èª¿æŸ»çµæœ
ã‚³ãƒãƒ³ãƒ‰çµæœã§`null`ã«ã‚ˆã‚Šã‚¨ãƒ©ãƒ¼ã¨ãªã£ãŸã‚‚ã®ã«å¯¾ã—ã¦ã¯ã€ã€Œã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ã€ã¨è¡¨è¨˜ã€‚
åˆæœŸå€¤ãŒ`null`ã®è‡ªå‹•å¤‰æ•°ã¯ã€å€¤ãŒå…¥ã‚‹æ¡ä»¶ï¼ˆä¾‹ãˆã°ã€`$_`ã§ã¯ForEachå†…ã§å€¤ãŒã‚»ãƒƒãƒˆï¼‰ãŒã‚ã‚‹ç‚ºã€
PowerShellã®èµ·å‹•ç›´å¾Œã§ã¯ã€`null`ã«ãªã£ã¦ã„ã‚‹ã‚‚ã®ã¨æ€ã‚ã‚Œã¾ã™ã€‚

æœºä¸Šã§ç†ç”±ãŒã‚ã‹ã‚‹ã‚‚ã®ã«é–¢ã—ã¦ã¯ã€ãã®ç†ç”±ã‚’æ³¨é‡ˆã¨ã—ã¦è¨˜è¼‰ã€‚å€¤ãŒå…¥ã‚‹æ¡ä»¶ãŒã‚ã‹ã£ãŸå ´åˆã¯ã€æ›´æ–°ã—ã¾ã™ã€‚
```powershell:å‚è€ƒï¼šã€Œ $_ ã€ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’ç¢ºèªã—ãŸéš›ã®ã‚¨ãƒ©ãƒ¼
PS C:\WINDOWS\system32> $_.GetType().FullName
null å€¤ã®å¼ã§ã¯ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã›ã¾ã›ã‚“ã€‚
ç™ºç”Ÿå ´æ‰€ è¡Œ:1 æ–‡å­—:1
+ $_.GetType().FullName
+ ~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidOperation: (:) []ã€RuntimeException
    + FullyQualifiedErrorId : InvokeMethodOnNull

PS C:\WINDOWS\system32>
```

| è‡ªå‹•å¤‰æ•°å | ãƒ‡ãƒ¼ã‚¿å‹<br>ï¼»è‡ªå‹•å¤‰æ•°å.GetType().FullNameï¼½ |
| ---- | ---- |
| `$$` | System.String |
| `$?` | System.Boolean |
| `$^` | System.String |
| `$_ï¼ˆ$PSItemï¼‰`<br>* ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§æ¸¡ã£ã¦ãã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚ˆã‚Šå¤‰åŒ– | `Get-Process | ForEach-Object -Process { Write-Host $_.GetType().FullName }`ã ã¨`System.Diagnostics.Process`<br>ãã®ã¾ã¾ç¢ºèªã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ |
| `$args` | System.Object[] |
| `$ConsoleFileName` | System.String |
| `$EnabledExperimentalFeatures`<br>* PowerShell Core å°å…¥ã§ä½¿ç”¨å¯èƒ½ | System.Management.Automation.Internal.ReadOnlyBag`1[[System.String, System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]<br>Windowsæ¨™æº–ã®PowerShellã ã¨ã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ |
| `$Error` | System.Collections.ArrayList |
| `$ErrorActionPreference` | System.Management.Automation.ActionPreference |
| `$Event` | ã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ |
| `$EventArgs` | ã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ |
| `$EventSubscriber` | ã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ |
| `$ExecutionContext` | System.Management.Automation.EngineIntrinsics |
| `$false` | System.Boolean |
| `$foreach` | ã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ |
| `$HOME` | System.String |
| `$Host` | System.Management.Automation.Internal.Host.InternalHost |
| `$input` | System.Collections.ArrayList+ArrayListEnumeratorSimple |
| `$IsCoreCLR`<br>* PowerShell Core å°å…¥ã§ä½¿ç”¨å¯èƒ½ | System.Boolean<br>Windowsæ¨™æº–ã®PowerShellã ã¨ã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ |
| `$IsLinux`<br>* PowerShell Core å°å…¥ã§ä½¿ç”¨å¯èƒ½ | System.Boolean<br>Windowsæ¨™æº–ã®PowerShellã ã¨ã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ |
| `$IsMacOS`<br>* PowerShell Core å°å…¥ã§ä½¿ç”¨å¯èƒ½ | System.Boolean<br>Windowsæ¨™æº–ã®PowerShellã ã¨ã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ |
| `$IsWindows`<br>* PowerShell Core å°å…¥ã§ä½¿ç”¨å¯èƒ½ | System.Boolean<br>Windowsæ¨™æº–ã®PowerShellã ã¨ã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ |
| `$OutputEncoding` | System.Text.ASCIIEncoding |
| `$Matches` | ã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ |
| `$MyInvocation` | System.Management.Automation.InvocationInfo |
| `$NestedPromptLevel` | System.Int32 |
| `$null` | ã‚¨ãƒ©ãƒ¼ï¼ˆnullã®ãŸã‚ï¼‰ |
| `$PID` | System.Int32 |
| `$profile` | System.String |
| `$PSBoundParameters` | System.Management.Automation.PSBoundParametersDictionary |
| `$PSCmdlet` | ã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ |
| `$PSCommandPath` | System.String |
| `$PSCulture` | System.String |
| `$PSDebugContext` | ã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ |
| `$PSEdition` | System.String |
| `$PSHOME` | System.String |
| `$PSScriptRoot` | System.String |
| `$PSSenderInfo` | ã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ |
| `$PSUICulture` | System.String |
| `$PSVersionTable` | System.Collections.Hashtable |
| `$PWD` | System.Management.Automation.PathInfo |
| `$Sender` | ã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ |
| `$ShellId` | System.String |
| `$StackTrace` | System.String |
| `$switch` | ã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ |
| `$this` | ã‚¨ãƒ©ãƒ¼ï¼ˆnullã ã£ãŸï¼‰ |
| `$true` | System.Boolean |

## å‚è€ƒæƒ…å ±
https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/about/about_automatic_variables?view=powershell-7.3
https://tex2e.github.io/blog/powershell/automatic-variables

## $Evnet $EventArgsã«ã¤ã„ã¦ç¢ºèªä¸­
```powershell:ç¢ºèªç”¨
Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName System.Drawing

[System.Windows.Forms.Form]$form = New-Object System.Windows.Forms.Form
$form.Text = "å®Ÿè¡Œå‰ã®ç¢ºèª"
$form.Size = New-Object System.Drawing.Size(460,210)
$form.StartPosition = "CenterScreen"
$form.MaximizeBox = $false
$form.MinimizeBox = $false
# ãƒ©ãƒ™ãƒ«ä½œæˆ
[System.Windows.Forms.Label]$label = New-Object System.Windows.Forms.Label
$label.Location = New-Object System.Drawing.Point(85,30)
$label.Size = New-Object System.Drawing.Size(350,80)
$label.Text = "ãƒ†ã‚¹ãƒˆãƒ•ã‚©ãƒ¼ãƒ "
$font = New-Object System.Drawing.Font("ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯",12)
$label.Font = $font
# ãƒ©ãƒ™ãƒ«ã®ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
$label.Add_DoubleClick({param($sender, $e)$Events.GetType()})
# OKãƒœã‚¿ãƒ³ã®ä½œæˆ
[System.Windows.Forms.Button]$btnOkay = New-Object System.Windows.Forms.Button
$btnOkay.Location = New-Object System.Drawing.Point(255,120)
$btnOkay.Size = New-Object System.Drawing.Size(75,30)
$btnOkay.Text = "OK"
$btnOkay.DialogResult = [System.Windows.Forms.DialogResult]::OK
# Cancelãƒœã‚¿ãƒ³ã®ä½œæˆ
[System.Windows.Forms.Button]$btnCancel = New-Object System.Windows.Forms.Button
$btnCancel.Location = New-Object System.Drawing.Point(345,120)
$btnCancel.Size = New-Object System.Drawing.Size(75,30)
$btnCancel.Text = "ã‚­ãƒ£ãƒ³ã‚»ãƒ«"
$btnCancel.DialogResult = [System.Windows.Forms.DialogResult]::Cancel
# ãƒœã‚¿ãƒ³ã®ç´ã¥ã‘
$form.AcceptButton = $btnOkay
$form.CancelButton = $btnCancel
# ãƒ•ã‚©ãƒ¼ãƒ ã«ç´ã¥ã‘
$form.Controls.Add($pic)
$form.Controls.Add($label)
$form.Controls.Add($btnOkay)
$form.Controls.Add($btnCancel)
# ãƒ•ã‚©ãƒ¼ãƒ è¡¨ç¤º
if ($form.ShowDialog() -eq [System.Windows.Forms.DialogResult]::OK)
{
    $return = $true
} else {
    $return = $false
}
```