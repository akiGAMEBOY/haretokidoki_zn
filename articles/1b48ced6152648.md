---
title: "[PowerShell CLI]ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ä¸€è¦§ã‚’æ›´æ–°æ—¥ä»˜ï¼ˆé™é †ï¼‰ã§ä¸¦ã¹æ›¿ãˆã‚‹æ–¹æ³•"
emoji: "ğŸ“š"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["windows", "powershell"]
published: false
---
## æ¦‚è¦
PowerShellã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸€è¦§ï¼ˆãƒªã‚¹ãƒˆï¼‰ã‚’å‡ºåŠ›ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ã€Œ `Get-ChildItem` ã€ã§ã™ã€‚
ä»–ã«ã‚‚ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã§ã€Œ `ls` ã€ã‚„ã€Œ `dir` ã€ãªã©ã§ã‚‚åŒã˜ãå‹•ä½œã—ã¾ã™ã€‚

åˆæœŸã®ä¸¦ã³é †ã¯åå‰ã®ã€Œ æ˜‡é † ã€ã€‚
å®Ÿéš›ã«ã‚³ãƒãƒ³ãƒ‰ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã™ã‚‹éš›ã¯ã€æ›´æ–°æ—¥ä»˜ãŒæ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ãŒå…ˆé ­ã«ãã¦ã»ã—ã„ã§ã™ã‚ˆã­ã€‚

ã„ã¾ã¾ã§æ°—ã«ãªã£ã¦ã„ãŸãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°æ—¥ä»˜ã€é™é †ã§è¡¨ç¤ºã™ã‚‹æ–¹æ³•ã‚’èª¿ã¹ãŸã®ã§ç´¹ä»‹ã—ã¾ã™ã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
- PowerShellãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸€è¦§ã‚’æ›´æ–°æ—¥ä»˜ã®é™é †ã§å–å¾—ã—ãŸã„æ–¹

## å¯¾å¿œæ–¹æ³•
ä¸€è¦§ã‚’å‡ºåŠ›ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€`Get-ChildItem`ï¼ˆã‚‚ã—ãã¯ã€`ls`ã‹`dir`ï¼‰ã«ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼ˆ `|` ï¼‰ã§ã‚³ãƒãƒ³ãƒ‰é–“ã‚’æ¸¡ã—ã¦
`Sort-Object LastWriteTime -Descending`ã‚’è¿½åŠ ã™ã‚‹ã¨ã€**æ›´æ–°æ—¥ä»˜ã®é™é †ã§è¡¨ç¤ºã•ã‚Œã¾ã™ï¼**

### å®Ÿéš›ã®ã‚³ãƒãƒ³ãƒ‰
```powershell
PS C:\WINDOWS\system32> Set-Location C:\Windows\Logs
PS C:\Windows\Logs>
PS C:\Windows\Logs> Get-ChildItem | Sort-Object LastWriteTime -Descending


    ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: C:\Windows\Logs


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----        2023/09/06     14:22                WindowsUpdate
d-----        2023/09/06     14:09                waasmedic
d-----        2023/09/06      8:20                SIH
d-----        2023/09/05     17:03                CBS
d-----        2023/09/05      9:17                DPX
d-----        2023/09/04     10:42                SystemRestore
d-----        2023/09/04      8:28                waasmediccapsule
d-----        2023/09/02     11:33                NetSetup
-a----        2023/08/17      8:30          90031 StorGroupPolicy.log
d---s-        2023/08/10     16:44                MeasuredBoot
d-----        2023/08/10     16:10                MoSetup
d-----        2022/11/17     10:09                DISM
d-----        2022/09/21     13:30                WindowsBackup
d-----        2021/11/25     11:28                Paragon Software
d-----        2021/10/13      5:44                WinREAgent


PS C:\Windows\Logs>
```

### ã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼†å°æ–‡å­—ã§å®Ÿè¡Œã™ã‚‹ã¨
ã“ã“ã§ã¯ã€Œ `ls` ã€ã§å®Ÿè¡Œã—ã¦ã„ã‚‹ãŒã€ã€Œ `dir` ã€ã«ç½®ãæ›ãˆã¦å®Ÿè¡Œã—ã¦ã‚‚å¯èƒ½ã€‚
```powershell:ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚„å°æ–‡å­—ã§å®Ÿè¡Œã—ã¦ã‚‚OK
PS C:\WINDOWS\system32> cd C:\Windows\Logs
PS C:\Windows\Logs>
PS C:\Windows\Logs> ls | sort lastwritetime -descending


    ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: C:\Windows\Logs


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----        2023/09/06     14:22                WindowsUpdate
d-----        2023/09/06     14:09                waasmedic
d-----        2023/09/06      8:20                SIH
d-----        2023/09/05     17:03                CBS
d-----        2023/09/05      9:17                DPX
d-----        2023/09/04     10:42                SystemRestore
d-----        2023/09/04      8:28                waasmediccapsule
d-----        2023/09/02     11:33                NetSetup
-a----        2023/08/17      8:30          90031 StorGroupPolicy.log
d---s-        2023/08/10     16:44                MeasuredBoot
d-----        2023/08/10     16:10                MoSetup
d-----        2022/11/17     10:09                DISM
d-----        2022/09/21     13:30                WindowsBackup
d-----        2021/11/25     11:28                Paragon Software
d-----        2021/10/13      5:44                WinREAgent


PS C:\Windows\Logs>
```

## ã¡ã¾ã¿ã«UNIXã®headã‚„tailã‚³ãƒãƒ³ãƒ‰ã¨åŒã˜äº‹ã‚’è¡Œã„ãŸã„å ´åˆ
### UNIXç³»â€œheadâ€ = PowerShellâ€œSelectt-Object -Firstâ€
```powershell:â€œSelect-Object -Firstâ€ã§å¯èƒ½
PS C:\Windows\Logs> Get-ChildItem | Sort-Object LastWriteTime -Descending | Select-Object -First 5


    ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: C:\Windows\Logs


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----        2023/09/06     14:22                WindowsUpdate
d-----        2023/09/06     14:09                waasmedic
d-----        2023/09/06      8:20                SIH
d-----        2023/09/05     17:03                CBS
d-----        2023/09/05      9:17                DPX


PS C:\Windows\Logs>
```

### UNIXç³»â€œtailâ€ = PowerShellâ€œSelectt-Object -Lastâ€
```powershell:â€œSelect-Object -Lastâ€ã§å¯èƒ½
PS C:\Windows\Logs> Get-ChildItem | Sort-Object LastWriteTime -Descending | Select-Object -Last 5


    ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: C:\Windows\Logs


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----        2023/08/10     16:10                MoSetup
d-----        2022/11/17     10:09                DISM
d-----        2022/09/21     13:30                WindowsBackup
d-----        2021/11/25     11:28                Paragon Software
d-----        2021/10/13      5:44                WinREAgent


PS C:\Windows\Logs>
```
### ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã®ä¸­èº«ã ã¨
```powershell
PS C:\Windows\Logs> Get-Content StorGroupPolicy.log -TotalCount 20
07/13/2022  0: 8:19.00000860:RegEnumKeyExW failed with (259)

07/13/2022  0: 8:19.00000860:GP object initialized successfully

07/13/2022  0: 8:19.00000891:Deny_All not set for all. Will query other 6 GUIDs

07/13/2022  0: 8:19.00000906:Policy for other GUID is not enabled, status:  1008

07/13/2022  0: 8:19.00000922:Policy for other GUID is not enabled, status:  1008

07/13/2022  0: 8:19.00000938:Policy for other GUID is not enabled, status:  1008

07/13/2022  0: 8:19.00000938:Policy for other GUID is not enabled, status:  1008

07/13/2022  0: 8:19.00000938:Policy for other GUID is not enabled, status:  1008

07/13/2022  0: 9:27.00000577:Deny_All not set for all. Will query other 6 GUIDs

PS C:\Windows\Logs>
```

```powershell
PS C:\Windows\Logs> Get-Content StorGroupPolicy.log -Tail 20
08/16/2023 23:28:26.00000966:RegEnumKeyExW failed with (259)

08/16/2023 23:28:26.00000966:GP object initialized successfully

08/16/2023 23:28:26.00000982:Deny_All not set for all. Will query other 6 GUIDs

08/16/2023 23:28:26.00000982:Policy for other GUID is not enabled, status:  2

08/16/2023 23:28:26.00000982:Policy for other GUID is not enabled, status:  2

08/16/2023 23:28:26.00000982:Policy for other GUID is not enabled, status:  2

08/16/2023 23:28:26.00000982:Policy for other GUID is not enabled, status:  2

08/16/2023 23:28:26.00000982:Policy for other GUID is not enabled, status:  2

08/16/2023 23:28:26.00000982:Policy for other GUID is not enabled, status:  2

08/16/2023 23:30:26.00000996:Deleted GP object

PS C:\Windows\Logs>
```

## å‚è€ƒæƒ…å ±
powershell get-childitem(ls or dir) æ›´æ–°æ—¥ä»˜ã®é™é †ã§è¡¨ç¤º
https://www.gamingdeputy.com/jp/windows/powershell-ãƒªã‚¹ãƒˆ-ãƒ•ã‚¡ã‚¤ãƒ«ã®æ—¥ä»˜é †ã®ä¸¦ã¹æ›¿ãˆ/

unixã§ã„ã†headãŒã€Œ Select -First "æ•°å­—" ã€
		  tailãŒã€Œ Select -Last "æ•°å­—" ã€
		  
ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã®å ´åˆ
https://tex2e.github.io/blog/powershell/Get-Content-TotalCount-Tail
