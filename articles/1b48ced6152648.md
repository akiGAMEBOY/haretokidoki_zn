---
title: "[PowerSHell CLI]ファイル・フォルダ一覧を更新日付（降順）で並べ替える方法"
emoji: "📚"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---
## 概要
PowerShellでファイルやフォルダの一覧（リスト）を出力するコマンドレットは「 `Get-ChildItem` 」です。
他にもエイリアスで「 `ls` 」や「 `dir` 」などでも同じく動作します。

初期の並び順は名前の「 昇順 」。
実際にコマンドでファイルを確認する際は、更新日付が新しいファイルが先頭にきてほしいですよね。

いままで気になっていたデータの更新日付、降順で表示する方法を調べたので紹介します。

## この記事のターゲット
- PowerShellユーザーの方
- ファイル・フォルダの一覧を更新日付の降順で取得したい方

## やり方
一覧を出力するコマンドレット、`Get-ChildItem`（もしくは、`ls`か`dir`）にパイプライン（ `|` ）でコマンド間を渡して
`Sort-Object LastWriteTime -Descending`を追加すると、**更新日付の降順で表示されます！**

```powershell
PS C:\Windows\Logs> Get-ChildItem | Sort-Object LastWriteTime -Descending


    ディレクトリ: C:\Windows\Logs


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----        2023/09/06     14:22                WindowsUpdate
d-----        2023/09/06     14:09                waasmedic
d-----        2023/09/06      8:20                SIH
d-----        2023/09/05     17:03                CBS
d-----        2023/09/05      9:17                DPX
d-----        2023/09/04     10:42                SystemRestore
d-----        2023/09/04      8:28                waasmediccapsule
d-----        2023/09/02     11:33                NetSetup
-a----        2023/08/17      8:30          90031 StorGroupPolicy.log
d---s-        2023/08/10     16:44                MeasuredBoot
d-----        2023/08/10     16:10                MoSetup
d-----        2022/11/17     10:09                DISM
d-----        2022/09/21     13:30                WindowsBackup
d-----        2021/11/25     11:28                Paragon Software
d-----        2021/10/13      5:44                WinREAgent


PS C:\Windows\Logs>
```

```powershell:アイリアスや小文字で実行してもOK
PS C:\Windows\Logs> ls | sort lastwritetime -descending


    ディレクトリ: C:\Windows\Logs


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----        2023/09/06     14:22                WindowsUpdate
d-----        2023/09/06     14:09                waasmedic
d-----        2023/09/06      8:20                SIH
d-----        2023/09/05     17:03                CBS
d-----        2023/09/05      9:17                DPX
d-----        2023/09/04     10:42                SystemRestore
d-----        2023/09/04      8:28                waasmediccapsule
d-----        2023/09/02     11:33                NetSetup
-a----        2023/08/17      8:30          90031 StorGroupPolicy.log
d---s-        2023/08/10     16:44                MeasuredBoot
d-----        2023/08/10     16:10                MoSetup
d-----        2022/11/17     10:09                DISM
d-----        2022/09/21     13:30                WindowsBackup
d-----        2021/11/25     11:28                Paragon Software
d-----        2021/10/13      5:44                WinREAgent


PS C:\Windows\Logs>
```

## ちまみにUNIXのheadやtailコマンドと同じ事を行いたい場合
### UNIX系“head” = PowerShell“Selectt-Object -First”
```powershell:“Select-Object -First”で可能
PS D:\Downloads> Get-ChildItem | Sort-Object LastWriteTime -Descending | Select-Object -First 5


    ディレクトリ: D:\Downloads


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----        2023/09/05      9:51         316610 meta_class.txt
-a----        2023/09/05      9:27       17865680 msp.log
-a----        2023/09/05      9:25        2603896 msi.log
-a----        2023/09/05      9:24         736096 SupportAssistInstaller.exe
-a----        2023/09/01     16:38            556 Win32_NTDomain.txt


PS D:\Downloads>
```

### UNIX系“tail” = PowerShell“Selectt-Object -Last”
```powershell:“Select-Object -Last”で可能
PS D:\Downloads> Get-ChildItem | Sort-Object LastWriteTime -Descending | Select-Object -Last 5


    ディレクトリ: D:\Downloads


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----        2023/09/05      9:51         316610 meta_class.txt
-a----        2023/09/05      9:27       17865680 msp.log
-a----        2023/09/05      9:25        2603896 msi.log
-a----        2023/09/05      9:24         736096 SupportAssistInstaller.exe
-a----        2023/09/01     16:38            556 Win32_NTDomain.txt


PS D:\Downloads>
```

powershell get-childitem(ls or dir) 更新日付の降順で表示
https://www.gamingdeputy.com/jp/windows/powershell-リスト-ファイルの日付順の並べ替え/

unixでいうheadが「 Select -First "数字" 」
		  tailが「 Select -Last "数字" 」
		  
テキスト形式の場合
https://tex2e.github.io/blog/powershell/Get-Content-TotalCount-Tail
