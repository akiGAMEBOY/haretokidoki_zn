---
title: "è¤‡æ•°IDã‚’æ¤œç´¢ã‚­ãƒ¼ã«winget showã®çµæœã‚’æŠ½å‡ºã—è¡¨ç¤ºã™ã‚‹Function"
emoji: "ğŸ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["windows", "powershell", "winget"]
published: true
---
## æ¦‚è¦

[ã“ã¡ã‚‰](https://zenn.dev/haretokidoki/articles/56088261fc5d58)ã§ã‚½ãƒ¼ã‚¹ãŒ `winget` ã‚‚ã—ãã¯ `msstore` ã®ã‚¢ãƒ—ãƒªï¼ˆã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ï¼‰ã«å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ä½œæ¥­ã‚’å®Ÿæ–½ã—ã¾ã„ãŸã€‚

[ã“ã¡ã‚‰ã®GitHubã®Issue](https://github.com/microsoft/winget-cli/issues/4445)ã§ã‚‚ã‚ãŒã£ã¦ã„ã¾ã™ãŒã€
ä¸å…·åˆã«ã‚ˆã‚Š `winget search` ã§ã¯è¡¨ç¤ºã•ã‚Œãªã„Microsoft Storeè£½ã®ã‚¢ãƒ—ãƒªãŒå­˜åœ¨ã—ã¾ã—ãŸã€‚

ãã‚“ãª `winget search` ã§ã¯æ¤œç´¢ã§ããªã„Microsoft Storeç‰ˆã®ã‚¢ãƒ—ãƒªã¯ã€ `winget show` ã§å–å¾—å¯èƒ½ãªç‚ºã€
ã‚³ãƒãƒ³ãƒ‰çµæœã‹ã‚‰å¿…è¦ãªæƒ…å ±ã ã‘æŠ½å‡ºã§ãã‚‹Functionã‚’ä½œæˆã—ã¾ã—ãŸã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- Windows ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- PowerShell ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- **è¤‡æ•°IDã‚’æ¤œç´¢ã‚­ãƒ¼**ã« `winget show` ã®çµæœã‚’ç¢ºèªã—ãŸã„æ–¹

## è‡ªä½œã—ãŸFunction

ä»Šå›ã€ä½œæˆã—ãŸFunctionã§ã¯ã€`winget search` ã®çµæœã‚’ã‚‚ã¨ã« ã€Œã‚¢ãƒ—ãƒªåãƒ»IDãƒ»ã‚½ãƒ¼ã‚¹ã€ ã®3ã¤ã‚’æŠ½å‡ºã—è¡¨ç¤ºã™ã‚‹ã¨ã„ã†å†…å®¹ã§ã™ã€‚
å ´åˆã«ã‚ˆã£ã¦ã¯ã‚¢ãƒ—ãƒªåã§æ¤œç´¢ã™ã‚‹äº‹ã‚‚è€ƒãˆã‚‰ã‚Œã¾ã™ã€‚ä½¿ç”¨ç”¨é€”ã«å¿œã˜ã¦ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚

```powershell:è‡ªä½œã—ãŸFunctionã€ŒWrite-WingetShowã€
# Function
Function Write-WingetShow {
    Param (
        [System.String[]]$targetIds
    )
    # æŠ½å‡ºå¯¾è±¡ã®æ–‡å­—åˆ—ã‚’æŒ‡å®š
    [System.String]$HitMessage = 'è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ '
    [System.String]$InstallerType = '  ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã®ç¨®é¡: '

    # æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’UTF-8ã«å¤‰æ›´
    [console]::OutputEncoding = [System.Text.Encoding]::UTF8

    # ã‚³ãƒãƒ³ãƒ‰çµæœã‹ã‚‰æŠ½å‡ºã—ã‚¢ãƒ—ãƒªåãƒ»IDãƒ»ã‚½ãƒ¼ã‚¹ã®ã¿ã‚’è¡¨ç¤º
    foreach ($id in $targetIds) {
        [System.String[]]$appInfo = (winget show --id $id)
        # æ¤œç´¢çµæœã‚ã‚Š
        if ($appInfo -match $HitMessage) {
            $appNameAndId = $appInfo | Select-String "$HitMessage.*" | ForEach-Object {
                $_.Matches[0].Value -replace "$HitMessage", ''
            }
            $appSource = $appInfo | Select-String "$InstallerType.*" | ForEach-Object {
                $_.Matches[0].Value -replace "$InstallerType", ''
            }
            Write-Host "$appNameAndId [$appSource]"
        }
        # æ¤œç´¢çµæœãªã—
        else {
            Write-Warning "è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ID: [$id]"
            # ä¸­æ–­ã™ã‚‹å ´åˆã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆè§£é™¤
            #return
        }
    }
}

# æ¤œç´¢å¯¾è±¡ã®IDã‚’é…åˆ—ã§æŒ‡å®š
$searchIds = @(
	#å¯¾è±¡ã®ID
)

# Function ã®å®Ÿè¡Œ
Write-WingetShow $searchIds
```

:::details å®Ÿéš›ã«å®Ÿè¡Œã—ãŸçµæœ

ç§ã®ç’°å¢ƒã§å®Ÿè¡Œã—ãŸéš›ã®çµæœã‚’è¡¨ç¤ºã€‚

```powershell:å®Ÿéš›ã«å®Ÿè¡Œã—ãŸçµæœ
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> # æ¤œç´¢å¯¾è±¡ã®IDã‚’é…åˆ—ã§æŒ‡å®š
>> $searchIds = @(
>>     'Microsoft.Edge',
>>     '1234567890AB',
>>     'XPFFZHVGQWWLHB',
>>     'Microsoft.VCLibs.Desktop.14'
>> )
>> # Function ã®å®Ÿè¡Œ
>> Write-WingetShow $searchIds
Microsoft Edge [Microsoft.Edge] [msi]
è­¦å‘Š: è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ID: [1234567890AB]
OneNote [XPFFZHVGQWWLHB] [exe]
Microsoft Visual C++ 2015 UWP Desktop Runtime Package [Microsoft.VCLibs.Desktop.14] [msix]
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

## ã¾ã¨ã‚

- ã“ã®Functionã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§`winget search`ã§è¡¨ç¤ºã•ã‚Œãªã„Microsoft Storeç‰ˆã‚¢ãƒ—ãƒªã®æƒ…å ±ã‚’è¤‡æ•°ã€å–å¾—ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸï¼
- è¡¨ç¤ºè¨€èªãŒæ—¥æœ¬èªã§ã¯ãªã„å ´åˆã€`$HitMessage = 'è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ '`ã‚„ `$InstallerType = '  ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã®ç¨®é¡: '` ã‚’è¦‹ç›´ã™å¿…è¦ã‚ã‚Š

## é–¢é€£è¨˜äº‹

https://zenn.dev/haretokidoki/articles/56088261fc5d58
https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
