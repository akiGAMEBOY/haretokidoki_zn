---
title: "IDã‚’æ¤œç´¢ã‚­ãƒ¼ã¨ã—winget showã®æ¤œç´¢çµæžœã‚’è¡¨ç¤ºã™ã‚‹Function"
emoji: "ðŸ˜Š"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

```powershell:Function
# Function
Function Write-WingetShow {
    Param (
        [System.String[]]$targetIds
    )
    # æŠ½å‡ºå¯¾è±¡ã®æ–‡å­—åˆ—ã‚’æŒ‡å®š
    [System.String]$HitMessage = 'è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ '
    [System.String]$InstallerType = '  ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã®ç¨®é¡ž: '

    # æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’UTF-8ã«å¤‰æ›´
    [console]::OutputEncoding = [System.Text.Encoding]::UTF8

    # ã‚³ãƒžãƒ³ãƒ‰çµæžœã‹ã‚‰æŠ½å‡ºã—ã‚¢ãƒ—ãƒªåãƒ»IDãƒ»ã‚½ãƒ¼ã‚¹ã®ã¿ã‚’è¡¨ç¤º
    foreach ($id in $targetIds) {
        [System.String[]]$appInfo = (winget show --id $id)
        # æ¤œç´¢çµæžœã‚ã‚Š
        if ($appInfo -match $HitMessage) {
            $appNameAndId = $appInfo | Select-String "$HitMessage.*" | ForEach-Object {
                $_.Matches[0].Value -replace "$HitMessage", ''
            }
            $appSource = $appInfo | Select-String "$InstallerType.*" | ForEach-Object {
                $_.Matches[0].Value -replace "$InstallerType", ''
            }
            Write-Host "$appNameAndId [$appSource]"
        }
        # æ¤œç´¢çµæžœãªã—
        else {
            Write-Warning "è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ID: [$id]"
            # ä¸­æ–­ã™ã‚‹å ´åˆ
            #return
        }
    }
}

# æ¤œç´¢å¯¾è±¡ã®IDã‚’é…åˆ—ã§æŒ‡å®š
$searchIds = @(
	#å¯¾è±¡ã®ID
)
# Function ã®å®Ÿè¡Œ
Write-WingetShow $searchIds
```

```powershell:å®Ÿéš›ã«å®Ÿè¡Œã—ãŸçµæžœ
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> # æ¤œç´¢å¯¾è±¡ã®IDã‚’é…åˆ—ã§æŒ‡å®š
>> $searchIds = @(
>>     'Microsoft.Edge',
>>     '1234567890AB',
>>     'XPFFZHVGQWWLHB',
>>     'Microsoft.VCLibs.Desktop.14'
>> )
>> # Function ã®å®Ÿè¡Œ
>> Write-WingetShow $searchIds
Microsoft Edge [Microsoft.Edge] [msi]
è­¦å‘Š: è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ID: [1234567890AB]
OneNote [XPFFZHVGQWWLHB] [exe]
Microsoft Visual C++ 2015 UWP Desktop Runtime Package [Microsoft.VCLibs.Desktop.14] [msix]
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```
