---
title: "IDを検索キーとしwinget showの検索結果を表示するFunction"
emoji: "😊"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["powershell"]
published: false
---

```powershell:Function
# Function
Function Write-WingetShow {
    Param (
        [System.String[]]$targetIds
    )
    # 抽出対象の文字列を指定
    [System.String]$HitMessage = '見つかりました '
    [System.String]$InstallerType = '  インストーラーの種類: '

    # 文字コードをUTF-8に変更
    [console]::OutputEncoding = [System.Text.Encoding]::UTF8

    # コマンド結果から抽出しアプリ名・ID・ソースのみを表示
    foreach ($id in $targetIds) {
        [System.String[]]$appInfo = (winget show --id $id)
        # 検索結果あり
        if ($appInfo -match $HitMessage) {
            $appNameAndId = $appInfo | Select-String "$HitMessage.*" | ForEach-Object {
                $_.Matches[0].Value -replace "$HitMessage", ''
            }
            $appSource = $appInfo | Select-String "$InstallerType.*" | ForEach-Object {
                $_.Matches[0].Value -replace "$InstallerType", ''
            }
            Write-Host "$appNameAndId [$appSource]"
        }
        # 検索結果なし
        else {
            Write-Warning "見つかりませんでした。ID: [$id]"
            # 中断する場合
            #return
        }
    }
}

# 検索対象のIDを配列で指定
$searchIds = @(
	#対象のID
)
# Function の実行
Write-WingetShow $searchIds
```

```powershell:実際に実行した結果
PS C:\Users\"ユーザー名"> # 検索対象のIDを配列で指定
>> $searchIds = @(
>>     'Microsoft.Edge',
>>     '1234567890AB',
>>     'XPFFZHVGQWWLHB',
>>     'Microsoft.VCLibs.Desktop.14'
>> )
>> # Function の実行
>> Write-WingetShow $searchIds
Microsoft Edge [Microsoft.Edge] [msi]
警告: 見つかりませんでした。ID: [1234567890AB]
OneNote [XPFFZHVGQWWLHB] [exe]
Microsoft Visual C++ 2015 UWP Desktop Runtime Package [Microsoft.VCLibs.Desktop.14] [msix]
PS C:\Users\"ユーザー名">
```
