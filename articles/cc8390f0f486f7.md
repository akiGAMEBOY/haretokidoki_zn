---
title: "å®Ÿè¡Œæ™‚ã«PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒã‚ã‚‹ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼ã‚’å–å¾—ã™ã‚‹3ã¤ã®æ–¹æ³•"
emoji: "ğŸ“‘"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: false
---
```:ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼ï¼ˆãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ï¼‰æ§‹æˆ
D:\ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”‚
â”œExecuteMain.bat
â”‚
â””source
ã€€â””powershell
ã€€ã€€â””Main.ps1
```

- ExecuteMain.bat
	Main.ps1ã‚’å®Ÿè¡Œ

- Main.ps1
	ã“ã“ã§ç›¸å¯¾ãƒ‘ã‚¹ã€ä¾‹ãˆã° ".\" ã‚’ä½¿ã£ã¦ã‚‚ã€ŒD:\ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª\source\powershellã€ã«ãªã‚‰ãªã„ã€‚
	å®Ÿéš›ã«ã¯ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ãŒå®Ÿè¡Œå ´æ‰€ã®ç‚ºã€ã€ŒD:\ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã€ã¨ãªã£ã¦ã—ã¾ã†ã€‚

## å¯¾å¿œæ–¹æ³•

### è‡ªå‹•å¤‰æ•°ã€Œ$MyInvocationã€ã‚’ä½¿ã£ãŸã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼ã®å–å¾—æ–¹æ³•

```powershell:$MyInvocation.MyCommand.Path
$currentDirectoryUsingMyInvocation01 = (Split-Path -Path $MyInvocation.MyCommand.Path -Parent)
```

```powershell:$MyInvocation.ScriptName
$currentDirectoryUsingMyInvocation02 = (Split-Path ( & { $MyInvocation.ScriptName } ) -Parent)
```

```powershell:$myInvocation.ScriptNameã‚’ä½¿ç”¨
[System.String]$current_dir=Split-Path ( & { $MyInvocation.ScriptName } ) -parent
Set-Location "$($current_dir)\..\.."
[System.String]$root_dir = (Convert-Path .)
```

### è‡ªå‹•å¤‰æ•°ã€Œ$PSScriptRootã€ã‚’ä½¿ã£ãŸã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼ã®å–å¾—æ–¹æ³•

```powershell:$PSScriptRoot
$currentDirectoryUsingPSScriptRoot = $PSScriptRoot
```

```powershell:$PSScriptRootã‚’ä½¿ç”¨
# ç¾åœ¨ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå­˜åœ¨ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å–å¾—
[System.String]$current_dir = $PSScriptRoot

# ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
Set-Location "$($current_dir)\..\.."

# ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ‘ã‚¹ã‚’å–å¾—
[System.String]$root_dir = (Convert-Path .)
```

### ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€ŒGet-Locationã€ã‚’ä½¿ã£ãŸã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼ã®å–å¾—æ–¹æ³•

```
$currentDirectoryUsingGetLocation = Get-Location
```

## ä½¿ç”¨ç”¨é€”

