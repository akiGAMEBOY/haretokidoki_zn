---
title: "Windowsã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å‰Šé™¤ã™ã‚‹2ã¤ã®æ–¹æ³•ï¼ˆãƒã‚¦ã‚¹æ“ä½œãƒ»PowerShellã‚³ãƒãƒ³ãƒ‰æ“ä½œï¼‰"
emoji: "ğŸŒŸ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["windows", "powershell"]
published: false
---

## å¯¾å¿œæ–¹æ³•

### ãƒã‚¦ã‚¹æ“ä½œ

1. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å³ã‚¯ãƒªãƒƒã‚¯ã—ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã

1. ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®è©³ç´°ã‚¿ãƒ–ã‚’é¸æŠ

1. è©³ç´°ã‚¿ãƒ–ã®å·¦ä¸‹ã«ã‚ã‚‹ãƒªãƒ³ã‚¯ã€Œãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚„å€‹äººæƒ…å ±ã‚’å‰Šé™¤ã€ã‚’é¸æŠã—ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å‰Šé™¤ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‹ã

1. ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å‰Šé™¤ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚ˆã‚Šã€"å¯èƒ½ãªã™ã¹ã¦ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å‰Šé™¤ã—ã¦ã‚³ãƒ”ãƒ¼ã‚’ä½œæˆ"ãŒé¸æŠçŠ¶æ…‹ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª

1. OKãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

1. ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒå‰Šé™¤ã•ã‚ŒãŸçŠ¶æ…‹ã®ã‚³ãƒ”ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª

### ã‚³ãƒãƒ³ãƒ‰å‹•ä½œ

ğŸŒŸå¯¾å¿œä¸­ã€‚å‰Šé™¤ã§ããªã„ï¼Ÿ

ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã ã¨ã„ã‘ã‚‹ï¼Ÿ
https://exiftool.org/exiftool-12.87.zip

```powershell
# å¯¾è±¡ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®š
$sourceDir = ""
$originalFilePath = "D:\Downloads\DesignFileSample.xlsx"
$destinationDir = "D:\Downloads\CopiedFiles"

# å¯¾è±¡ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ä½œæˆ
if (-not (Test-Path -Path $destinationDir)) {
    New-Item -ItemType Directory -Path $destinationDir
}

# ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ã—ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å‰Šé™¤ã™ã‚‹é–¢æ•°
function Remove-FileProperties {
    param (
        [string]$filePath
    )

    # ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼
    $fileName = [System.IO.Path]::GetFileName($filePath)
    $destinationPath = Join-Path -Path $destinationDir -ChildPath $fileName
    Copy-Item -Path $filePath -Destination $destinationPath

    # ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å‰Šé™¤
    $shell = New-Object -ComObject Shell.Application
    $file = $shell.Namespace((Get-Item $destinationPath).DirectoryName).ParseName((Get-Item $destinationPath).Name)
    $file.InvokeVerb("Properties")
    Start-Sleep -Seconds 1
    $file.InvokeVerb("Remove Properties and Personal Information")
}

if ([System.String]::IsNullOrEmptyString($sourceDir)) {
    # 1ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿å‡¦ç†
    Remove-FileProperties -filePath $originalFilePath
}
else {
    # å¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡¦ç†
    Get-ChildItem -Path $sourceDir -Filter *.xlsx, *.docx -Recurse | ForEach-Object {
        Remove-FileProperties -filePath $_.FullName
    }
}
```

## ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•

### ç¢ºèªã™ã‚‹ãŸã‚ã®PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```powershell:GetFileProperty.ps1
param (
    [System.String]$FolderPath = 'D:\Downloads',
    [System.String]$OutputPath = "$($FolderPath)\PropertiesLists.csv"
)

# COMã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
$shell = New-Object -COMObject Shell.Application
$folder = $shell.Namespace($FolderPath)

# ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æ ¼ç´ã™ã‚‹ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆ
$properties = @{}

# ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å†…ã®ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—
$files = (Get-ChildItem -Path $FolderPath)

foreach ($file in $files) {
    $fileItem = $folder.ParseName($file.Name)
    # å‚è€ƒè¨˜äº‹ã‚’å…ƒã«æœ€å¤§å€¤ã‚’320ã§è¨­å®šã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¨®é¡ã«ã‚ˆã‚Šç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ•°ãŒç•°ãªã‚‹ã€‚
    # å¿…è¦ã«å¿œã˜ã¦æœ€å¤§å€¤ã‚’å¤‰æ›´ã€‚
    for ($i = 0; $i -lt 320; $i++) {
        $propertyName = $folder.GetDetailsOf($null, $i)
        $propertyValue = $folder.GetDetailsOf($fileItem, $i)
        if ($propertyName -and $propertyValue) {
            if (-not ($properties.ContainsKey($propertyName))) {
                $properties[$propertyName] = @()
            }
            $properties[$propertyName] += $propertyValue
        }
    }
}

# é‡è¤‡ã™ã‚‹ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å‰Šé™¤
$uniqueProperties = @{}
foreach ($key in $properties.Keys) {
    $uniqueProperties[$key] = ($properties[$key] | Select-Object -Unique)
}

# CSVãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›
$csvContents = @()
foreach ($key in $uniqueProperties.Keys) {
    $csvContents += [PSCustomObject]@{
        Property = $key
        Values = ($uniqueProperties[$key] -join ", ")
    }
}
$csvContent | Export-Csv -Path $OutputPath -NoTypeInformation -Encoding UTF8

Write-Output "ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å–å¾—ã¨å‡ºåŠ›ãŒå®Œäº†ã—ã¾ã—ãŸã€‚[å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«: $($OutputPath)"
```

### ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ä¸€è¦§

ä¸‹è¨˜ã¯ã‚µãƒ³ãƒ—ãƒ«ã€‚å®Ÿéš›ã«ç¢ºèªã—ãŸå†…å®¹ã‚’è¨˜è¼‰ã€‚

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å                | èª¬æ˜                           |
|-----------------------------|--------------------------------|
| `Name`                      | ãƒ•ã‚¡ã‚¤ãƒ«å                     |
| `Length`                    | ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º                 |
| `CreationTime`              | ä½œæˆæ—¥æ™‚                       |
| `LastWriteTime`             | æœ€çµ‚æ›´æ–°æ—¥æ™‚                   |
| `LastAccessTime`            | æœ€çµ‚ã‚¢ã‚¯ã‚»ã‚¹æ—¥æ™‚               |
| `IsReadOnly`                | èª­ã¿å–ã‚Šå°‚ç”¨ã‹ã©ã†ã‹           |
| `IsHidden`                  | éš ã—ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã©ã†ã‹           |
| `Attributes`                | ãƒ•ã‚¡ã‚¤ãƒ«å±æ€§                   |
| `DirectoryName`             | ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå                 |
| `Extension`                 | ãƒ•ã‚¡ã‚¤ãƒ«æ‹¡å¼µå­                 |
| `Mode`                      | ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¢ãƒ¼ãƒ‰ï¼ˆå±æ€§æƒ…å ±ï¼‰     |
| `CreationTimeUtc`           | ä½œæˆæ—¥æ™‚ï¼ˆUTCï¼‰                |
| `LastWriteTimeUtc`          | æœ€çµ‚æ›´æ–°æ—¥æ™‚ï¼ˆUTCï¼‰            |
| `LastAccessTimeUtc`         | æœ€çµ‚ã‚¢ã‚¯ã‚»ã‚¹æ—¥æ™‚ï¼ˆUTCï¼‰        |
| `BaseName`                  | æ‹¡å¼µå­ã‚’é™¤ã„ãŸãƒ•ã‚¡ã‚¤ãƒ«å       |
| `FullName`                  | ãƒ•ãƒ«ãƒ‘ã‚¹                       |
| `Archive`                   | ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–å±æ€§                 |
| `Compressed`                | åœ§ç¸®å±æ€§                       |
| `Encrypted`                 | æš—å·åŒ–å±æ€§                     |
| `Temporary`                 | ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«å±æ€§               |
| `Offline`                   | ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å±æ€§                 |
| `NotContentIndexed`         | ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å¯¾è±¡å¤–   |
| `ReparsePoint`              | å†è§£æãƒã‚¤ãƒ³ãƒˆ                 |
| `SparseFile`                | ã‚¹ãƒ‘ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«å±æ€§           |
| `System`                    | ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚¡ã‚¤ãƒ«å±æ€§           |
| `Volume`                    | ãƒœãƒªãƒ¥ãƒ¼ãƒ å±æ€§                 |
| `Device`                    | ãƒ‡ãƒã‚¤ã‚¹å±æ€§                   |
| `Normal`                    | é€šå¸¸ãƒ•ã‚¡ã‚¤ãƒ«å±æ€§               |
| `IntegrityStream`           | æ•´åˆæ€§ã‚¹ãƒˆãƒªãƒ¼ãƒ å±æ€§           |
| `NoScrubData`               | ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚¯ãƒ©ãƒ–ãªã—å±æ€§         |
| `Pinned`                    | ãƒ”ãƒ³ç•™ã‚å±æ€§                   |
| `Unpinned`                  | ãƒ”ãƒ³ç•™ã‚è§£é™¤å±æ€§               |
| `RecallOnOpen`              | é–‹ãã¨ãã«ãƒªã‚³ãƒ¼ãƒ«å±æ€§         |
| `RecallOnDataAccess`        | ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã«ãƒªã‚³ãƒ¼ãƒ«å±æ€§ |
| `Owner`                     | æ‰€æœ‰è€…                         |
| `Title`                     | ã‚¿ã‚¤ãƒˆãƒ«                       |
| `Subject`                   | ä»¶å                           |
| `Comments`                  | ã‚³ãƒ¡ãƒ³ãƒˆ                       |
| `Author`                    | ä½œæˆè€…                         |
| `Keywords`                  | ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰                     |
| `Category`                  | ã‚«ãƒ†ã‚´ãƒª                       |
| `ContentStatus`             | ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®çŠ¶æ…‹               |
| `ContentType`               | ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ç¨®é¡               |
| `Copyright`                 | è‘—ä½œæ¨©                         |
| `Language`                  | è¨€èª                           |
| `ProgramName`               | ãƒ—ãƒ­ã‚°ãƒ©ãƒ å                   |
| `Duration`                  | ç¶™ç¶šæ™‚é–“                       |
| `Bitrate`                   | ãƒ“ãƒƒãƒˆãƒ¬ãƒ¼ãƒˆ                   |
| `FrameHeight`               | ãƒ•ãƒ¬ãƒ¼ãƒ é«˜ã•                   |
| `FrameWidth`                | ãƒ•ãƒ¬ãƒ¼ãƒ å¹…                     |
| `HorizontalResolution`      | æ°´å¹³æ–¹å‘ã®è§£åƒåº¦               |
| `VerticalResolution`        | å‚ç›´æ–¹å‘ã®è§£åƒåº¦               |
| `TotalBitrate`              | ç·ãƒ“ãƒƒãƒˆãƒ¬ãƒ¼ãƒˆ                 |
| `SampleRate`                | ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ãƒ¼ãƒˆ                 |
| `Protected`                 | ä¿è­·                           |
| `CameraModel`               | ã‚«ãƒ¡ãƒ©ãƒ¢ãƒ‡ãƒ«                   |
| `CameraManufacturer`        | ã‚«ãƒ¡ãƒ©è£½é€ å…ƒ                   |
| `DateTaken`                 | æ’®å½±æ—¥æ™‚                       |
| `Rating`                    | è©•ä¾¡                           |
| `Album`                     | ã‚¢ãƒ«ãƒãƒ                        |
| `AlbumArtist`               | ã‚¢ãƒ«ãƒãƒ ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ           |
| `ContributingArtists`       | å‚åŠ ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ               |
| `Genre`                     | ã‚¸ãƒ£ãƒ³ãƒ«                       |
| `Year`                      | å¹´                             |
| `TrackNumber`               | ãƒˆãƒ©ãƒƒã‚¯ç•ªå·                   |
| `Duration`                  | é•·ã•                           |
| `BitDepth`                  | ãƒ“ãƒƒãƒˆæ·±åº¦                     |
| `ColorSpace`                | è‰²ç©ºé–“                         |
| `ExposureTime`              | éœ²å‡ºæ™‚é–“                       |
| `FNumber`                   | çµã‚Šå€¤                         |
| `ISO`                       | ISOé€Ÿåº¦                        |
| `FocalLength`               | ç„¦ç‚¹è·é›¢                       |
| `MaxAperture`               | æœ€å¤§çµã‚Š                       |
| `MeteringMode`              | æ¸¬å…‰ãƒ¢ãƒ¼ãƒ‰                     |
| `FlashMode`                 | ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¢ãƒ¼ãƒ‰               |
| `WhiteBalance`              | ãƒ›ãƒ¯ã‚¤ãƒˆãƒãƒ©ãƒ³ã‚¹               |
| `ExposureProgram`           | éœ²å‡ºãƒ—ãƒ­ã‚°ãƒ©ãƒ                  |
| `ExposureBias`              | éœ²å‡ºè£œæ­£                       |
| `GPSLatitude`               | GPSç·¯åº¦                        |
| `GPSLongitude`              | GPSçµŒåº¦                        |
| `GPSAltitude`               | GPSé«˜åº¦                        |
| `GPSTimeStamp`              | GPSã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—              |
| `GPSDateStamp`              | GPSæ—¥ä»˜ã‚¹ã‚¿ãƒ³ãƒ—                |

## å‚è€ƒæƒ…å ±

https://zenn.dev/8chikuwa3/articles/fe548b14abd168
