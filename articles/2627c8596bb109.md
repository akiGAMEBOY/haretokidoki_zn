---
title: "Windowsのプロパティを削除する2つの方法（マウス操作・PowerShellコマンド操作）"
emoji: "🌟"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["windows", "powershell"]
published: false
---

## 対応方法

### マウス操作

1. ファイルを右クリックしコンテキストメニューを開く

1. コンテキストメニューの詳細タブを選択

1. 詳細タブの左下にあるリンク「プロパティや個人情報を削除」を選択し、プロパティの削除ウィンドウを開く

1. プロパティの削除ウィンドウより、"可能なすべてのプロパティを削除してコピーを作成"が選択状態であることを確認

1. OKボタンをクリック

1. プロパティが削除された状態のコピーファイルを確認

### コマンド動作

1. **PowerShellを管理者として起動**:
   - スタートメニューを開き、「PowerShell」と入力し、右クリックして「管理者として実行」を選択します。

2. **`Remove-ItemProperty`コマンドを使用**:
   - 以下のコマンドを入力して、指定したファイルのプロパティを削除します。

```powershell
# ファイルのプロパティを削除するコマンド
$Path = "C:\path\to\your\file.txt"
$Properties = @("Property1", "Property2", "Property3") # 削除したいプロパティ名を指定

foreach ($Property in $Properties) {
    Remove-ItemProperty -Path $Path -Name $Property
}
```

3. **すべてのプロパティを削除してコピーを作成**:
   - すべてのプロパティを削除してコピーを作成する場合、以下のスクリプトを使用します。

```powershell
# すべてのプロパティを削除してコピーを作成するスクリプト
$OriginalFile = "C:\path\to\your\file.txt"
$CopyFile = "C:\path\to\your\file_copy.txt"

Copy-Item -Path $OriginalFile -Destination $CopyFile
Clear-ItemProperty -Path $CopyFile -Name *
```

## プロパティ一覧

| プロパティ名                | 説明                           |
|-----------------------------|--------------------------------|
| `Name`                      | ファイル名                     |
| `Length`                    | ファイルサイズ                 |
| `CreationTime`              | 作成日時                       |
| `LastWriteTime`             | 最終更新日時                   |
| `LastAccessTime`            | 最終アクセス日時               |
| `IsReadOnly`                | 読み取り専用かどうか           |
| `IsHidden`                  | 隠しファイルかどうか           |
| `Attributes`                | ファイル属性                   |
| `DirectoryName`             | ディレクトリ名                 |
| `Extension`                 | ファイル拡張子                 |
| `Mode`                      | ファイルモード（属性情報）     |
| `CreationTimeUtc`           | 作成日時（UTC）                |
| `LastWriteTimeUtc`          | 最終更新日時（UTC）            |
| `LastAccessTimeUtc`         | 最終アクセス日時（UTC）        |
| `BaseName`                  | 拡張子を除いたファイル名       |
| `FullName`                  | フルパス                       |
| `Archive`                   | アーカイブ属性                 |
| `Compressed`                | 圧縮属性                       |
| `Encrypted`                 | 暗号化属性                     |
| `Temporary`                 | 一時ファイル属性               |
| `Offline`                   | オフライン属性                 |
| `NotContentIndexed`         | コンテンツインデックス対象外   |
| `ReparsePoint`              | 再解析ポイント                 |
| `SparseFile`                | スパースファイル属性           |
| `System`                    | システムファイル属性           |
| `Volume`                    | ボリューム属性                 |
| `Device`                    | デバイス属性                   |
| `Normal`                    | 通常ファイル属性               |
| `IntegrityStream`           | 整合性ストリーム属性           |
| `NoScrubData`               | データスクラブなし属性         |
| `Pinned`                    | ピン留め属性                   |
| `Unpinned`                  | ピン留め解除属性               |
| `RecallOnOpen`              | 開くときにリコール属性         |
| `RecallOnDataAccess`        | データアクセス時にリコール属性 |
| `Owner`                     | 所有者                         |
| `Title`                     | タイトル                       |
| `Subject`                   | 件名                           |
| `Comments`                  | コメント                       |
| `Author`                    | 作成者                         |
| `Keywords`                  | キーワード                     |
| `Category`                  | カテゴリ                       |
| `ContentStatus`             | コンテンツの状態               |
| `ContentType`               | コンテンツの種類               |
| `Copyright`                 | 著作権                         |
| `Language`                  | 言語                           |
| `ProgramName`               | プログラム名                   |
| `Duration`                  | 継続時間                       |
| `Bitrate`                   | ビットレート                   |
| `FrameHeight`               | フレーム高さ                   |
| `FrameWidth`                | フレーム幅                     |
| `HorizontalResolution`      | 水平方向の解像度               |
| `VerticalResolution`        | 垂直方向の解像度               |
| `TotalBitrate`              | 総ビットレート                 |
| `SampleRate`                | サンプルレート                 |
| `Protected`                 | 保護                           |
| `CameraModel`               | カメラモデル                   |
| `CameraManufacturer`        | カメラ製造元                   |
| `DateTaken`                 | 撮影日時                       |
| `Rating`                    | 評価                           |
| `Album`                     | アルバム                       |
| `AlbumArtist`               | アルバムアーティスト           |
| `ContributingArtists`       | 参加アーティスト               |
| `Genre`                     | ジャンル                       |
| `Year`                      | 年                             |
| `TrackNumber`               | トラック番号                   |
| `Duration`                  | 長さ                           |
| `BitDepth`                  | ビット深度                     |
| `ColorSpace`                | 色空間                         |
| `ExposureTime`              | 露出時間                       |
| `FNumber`                   | 絞り値                         |
| `ISO`                       | ISO速度                        |
| `FocalLength`               | 焦点距離                       |
| `MaxAperture`               | 最大絞り                       |
| `MeteringMode`              | 測光モード                     |
| `FlashMode`                 | フラッシュモード               |
| `WhiteBalance`              | ホワイトバランス               |
| `ExposureProgram`           | 露出プログラム                 |
| `ExposureBias`              | 露出補正                       |
| `GPSLatitude`               | GPS緯度                        |
| `GPSLongitude`              | GPS経度                        |
| `GPSAltitude`               | GPS高度                        |
| `GPSTimeStamp`              | GPSタイムスタンプ              |
| `GPSDateStamp`              | GPS日付スタンプ                |

まだあるかも、またプロパティの分類で分けた方がみやすいかも。

## プロパティを確認する方法

```powershell:
# フォルダー内のファイルプロパティを取得し、重複を削除して出力するスクリプト

# プロパティを取得するフォルダーを指定
$folderPath = 'D:\Downloads'
$outputPath = "$($folderPath)\PropertiesLists.csv"

# COMオブジェクトを作成
$shell = New-Object -COMObject Shell.Application
$folder = $shell.Namespace($folderPath)

# プロパティを格納するハッシュテーブルを作成
$properties = @{}

# フォルダー内のすべてのファイルを取得
$files = Get-ChildItem -Path $folderPath

foreach ($file in $files) {
    $fileItem = $folder.ParseName($file.Name)
    # ファイルの種類により登録されているプロパティの数が異なる為、適切な値はない。
    for ($i = 0; $i -lt 320; $i++) {
        $propertyName = $folder.GetDetailsOf($null, $i)
        $propertyValue = $folder.GetDetailsOf($fileItem, $i)
        if ($propertyName -and $propertyValue) {
            if (-not $properties.ContainsKey($propertyName)) {
                $properties[$propertyName] = @()
            }
            $properties[$propertyName] += $propertyValue
        }
    }
}

# 重複するプロパティを削除
$uniqueProperties = @{}
foreach ($key in $properties.Keys) {
    $uniqueProperties[$key] = $properties[$key] | Select-Object -Unique
}

# CSVファイルに出力
$csvContent = @()
foreach ($key in $uniqueProperties.Keys) {
    $csvContent += [PSCustomObject]@{
        Property = $key
        Values = ($uniqueProperties[$key] -join ", ")
    }
}
$csvContent | Export-Csv -Path $outputPath -NoTypeInformation -Encoding UTF8

Write-Host "プロパティの取得と出力が完了しました。出力ファイル: $outputPath"
```

## 参考情報

https://zenn.dev/8chikuwa3/articles/fe548b14abd168
