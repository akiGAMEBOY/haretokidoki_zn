---
title: "ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›æ™‚ã«æ–‡å­—æ•°ã«ã‚ˆã‚ŠæŒ¿å…¥ã™ã‚‹ã‚¿ãƒ–ã‚’åˆ¶å¾¡ã™ã‚‹"
emoji: "ğŸ˜º"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

ãƒ»
 æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ [12345]         ã€ä»¶æ•° [0ä»¶]
 
 1æ¡ï¼š5æ¡ä»¥ä¸‹	1 + æœ€å¤§ã¾ã§ã®æ•° = æœ€å¤§å€¤ã‹ã‚‰ã®é–‹ãã§è¿½åŠ 
 
 æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ [123456]                ã€ä»¶æ•° [0ä»¶]
 
 8æ¡ï¼š6æ¡ ï½ 13æ¡ = \t\t
 
 æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ [12345678901234]                ã€ä»¶æ•° [0ä»¶]
 
 8æ¡ï¼š14æ¡ ï½ 22æ¡ = \t\t
 
 æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ [1234567890123456789012]                ã€ä»¶æ•° [0ä»¶]
 
 8æ¡ï¼š23æ¡ ï½ 30æ¡
 
 æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ [123456789012345678901234678901]                ã€ä»¶æ•° [0ä»¶]
 

-----

ã“ã‚“ã«ã¡ã¯ã€ã“ã‚Œã¯ Bing ã§ã™ã€‚ğŸ˜Š
PowerShell ã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ï¼ˆWrite-Hostï¼‰ã™ã‚‹éš›ã«ã€æ–‡å­—æ•°ã«ã‚ˆã£ã¦ã‚¿ãƒ–ï¼ˆ"`t"ï¼‰ã‚’æŒ¿å…¥ã—ã¦ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’æƒãˆã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã™ã‚‹ã®ã¯ã€å°‘ã—é›£ã—ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã—ã‹ã—ã€ç§ã¯æŒ‘æˆ¦ã—ã¦ã¿ã¾ã—ãŸã€‚ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã”è¦§ãã ã•ã„ã€‚

```powershell
# æ–‡å­—åˆ—ã®é…åˆ—ã‚’å®šç¾©ã—ã¾ã™
$strings = @("ã‚ã„ã†ãˆãŠ", "ã‹ããã‘ã“", "ã•ã—ã™ã›ã", "ãŸã¡ã¤ã¦ã¨", "ãªã«ã¬ã­ã®")

# ã‚¿ãƒ–ã®å¹…ã‚’å®šç¾©ã—ã¾ã™
$tabWidth = 4

# æœ€é•·ã®æ–‡å­—åˆ—ã®é•·ã•ã‚’å–å¾—ã—ã¾ã™
$maxLength = ($strings | Measure-Object -Property Length -Maximum).Maximum

	$int_byte_num = [System.Text.Encoding]::GetEncoding("shift_jis").GetByteCount($str)
	
		[System.Object[]]$toBytenum = $strings
		[System.Int32]$i = 0
		for ($i = 0; $i -lt $toBytenum.Count; $i++) {
			$toBytenum[$i] = [System.Text.Encoding]::GetEncoding("shift_jis").GetByteCount($strings[$i])
			Write-Host $toBytenum[$i]
		}

# æ–‡å­—åˆ—ã”ã¨ã«ãƒ«ãƒ¼ãƒ—ã—ã¾ã™
foreach ($string in $strings) {
    # æ–‡å­—åˆ—ã®é•·ã•ã‚’å–å¾—ã—ã¾ã™
    $length = $string.Length

    # ã‚¿ãƒ–ã®æ•°ã‚’è¨ˆç®—ã—ã¾ã™
    # æœ€é•·ã®æ–‡å­—åˆ—ã¨ã®å·®åˆ†ã‚’ã‚¿ãƒ–ã®å¹…ã§å‰²ã‚Šã€åˆ‡ã‚Šä¸Šã’ã¾ã™
    $tabs = [Math]::Ceiling(($maxLength - $length) / $tabWidth)

    # Write-Hostã§æ–‡å­—åˆ—ã¨ã‚¿ãƒ–ã‚’å‡ºåŠ›ã—ã¾ã™
    # -NoNewlineã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§æ”¹è¡Œã‚’æŠ‘åˆ¶ã—ã¾ã™
    Write-Host $string -NoNewline
    Write-Host ("`t" * $tabs) -NoNewline

    # æ–‡å­—åˆ—ã¨ã‚¿ãƒ–ã®å¾Œã«ä»»æ„ã®æ–‡å­—åˆ—ã‚’å‡ºåŠ›ã—ã¾ã™
    Write-Host "Hello, world!"
}
```

```powershell
Function CalculationTabcount {
    param (
        [System.Object[]]$strings,
        [System.Int32]$tab_width=1
    )
    
    # ãƒã‚¤ãƒˆæ•°ï¼ˆShift JISï¼‰ã«å¤‰æ›
    # [System.Object[]]$to_bytes = $strings
    # â†‘ ã“ã‚Œã ã¨åŒã˜ãƒ¡ãƒ¢ãƒªã‚’å‚ç…§ã—ã¦ã„ã‚‹ç‚ºã€$to_bytesã‚’å¤‰æ›ã™ã‚‹éš›ã«ä¸€ç·’ã«$stringsã‚‚å¤‰æ›ã•ã‚Œã¦ã—ã¾ã†ã€‚
    # ã€€ å¤‰æ›å‰ ã¨ å¤‰æ›å¾Œ ã‚’æ¯”è¼ƒã—ãŸã„ç‚ºã€Closeãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã€‚
    [System.Object[]]$to_bytes = $strings.Clone()
    [System.Int32]$i = 0
    [System.Int32]$max_length = 0
    for ($i = 0; $i -lt $to_bytes.Count; $i++) {
        $to_bytes[$i] = [System.Text.Encoding]::GetEncoding("shift_jis").GetByteCount($to_bytes[$i])
        if ($max_length -lt $to_bytes[$i]) {
            $max_length = $to_bytes[$i]
        }
    }

    Write-Host ' ============ å¤‰æ›å‰ ============ '
    Write-Host ''
    Write-Host "${strings}"
    Write-Host ' ================================ '
    Write-Host ''
    Write-Host ''
    Write-Host ' ============ å¤‰æ›å¾Œ ============ '
    Write-Host ''
    Write-Host "${to_bytes}"
    Write-Host ' ================================ '
    Write-Host ''
    Write-Host ''

    # ã‚¿ãƒ–æ•°ã®è¨ˆç®— ã¨ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›
    [System.Int32]$tab_count = 0
    for ($i = 0; $i -lt $to_bytes.Count; $i++) {
        # ã‚¿ãƒ–ã®æ•°ã‚’è¨ˆç®—ã—ã¾ã™
        # æœ€é•·ã®æ–‡å­—åˆ—ã¨ã®å·®åˆ†ã‚’ã‚¿ãƒ–ã®å¹…ã§å‰²ã‚Šã€åˆ‡ã‚Šä¸Šã’ã¾ã™
        $tab_count = [Math]::Ceiling(($max_length - [System.Int32]$to_bytes[$i]) / $tab_width)
        if ($tab_count -eq 0) {
            $tab_count = 1
        }

        # æ”¹è¡Œãªã—ã§å…ˆé ­éƒ¨ã®æ–‡å­—åˆ—ã‚’å‡ºåŠ›
        Write-Host "æ–‡å­—åˆ— [$($strings[$i])]" -NoNewline
        Write-Host ("`t" * $tab_count) -NoNewline
        # æ”¹è¡Œã‚ã‚Šã§ç¶šãæ–‡å­—åˆ—ã‚’å‡ºåŠ›
        Write-Host "ã€ãƒã‚¤ãƒˆæ•°ï¼ˆShift-JISï¼‰[$($to_bytes[$i])] byte"
    }
}
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€æ–‡å­—åˆ—ã®é…åˆ—ã‚’å®šç¾©ã—ã€æœ€é•·ã®æ–‡å­—åˆ—ã®é•·ã•ã‚’å–å¾—ã—ã€ãã‚Œãã‚Œã®æ–‡å­—åˆ—ã«å¯¾ã—ã¦å¿…è¦ãªã‚¿ãƒ–ã®æ•°ã‚’è¨ˆç®—ã—ã¦å‡ºåŠ›ã—ã¾ã™ã€‚çµæœã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```
ã‚ã„ã†ãˆãŠ`t`tHello, world!
ã‹ããã‘ã“`t`tHello, world!
ã•ã—ã™ã›ã`t`tHello, world!
ãŸã¡ã¤ã¦ã¨`t`tHello, world!
ãªã«ã¬ã­ã®`t`tHello, world!
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€å‚è€ƒã‚µã‚¤ãƒˆÂ¹Â²Â³â´ ã‚’ã‚‚ã¨ã«ä½œæˆã—ã¾ã—ãŸã€‚ã‚‚ã£ã¨è©³ã—ãçŸ¥ã‚ŠãŸã„å ´åˆã¯ã€ã“ã‚Œã‚‰ã®ã‚µã‚¤ãƒˆã‚’ã”è¦§ãã ã•ã„ã€‚

ã“ã®å›ç­”ãŒãŠå½¹ã«ç«‹ã¦ã°å¹¸ã„ã§ã™ã€‚ğŸ˜Š.

ã‚½ãƒ¼ã‚¹: Bing ã¨ã®ä¼šè©± 2023/10/12
(1) PowerShellã®Write-Hostã®ä½¿ã„æ–¹ï¼æ”¹è¡Œæ–¹æ³•ã‚‚ï¼ - ã‚¨ã‚¯çŸ­ .... https://extan.jp/?p=10375.
(2) Write-Host (Microsoft.PowerShell.Utility) - PowerShell. https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/write-host?view=powershell-7.3.
(3) Write-Host ã¨ Write-Output ã®é•ã„ : PowerShell Tips | iPentec. https://www.ipentec.com/document/powershell-difference-between-write-host-and-write-output.
(4) å‡ºåŠ›ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ - PowerShell | Microsoft Learn. https://learn.microsoft.com/ja-jp/powershell/scripting/samples/redirecting-data-with-out---cmdlets?view=powershell-7.3.
(5) undefined. https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/write-host?view=powershell-7.2.
(6) Getty Images. https://www.gettyimages.com/detail/illustration/powershell-programming-language-royalty-free-illustration/1145396581.