---
title: "[PowerShell]å®šç¾©ã—ãŸFunctionã®å†…å®¹ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•"
emoji: "ðŸ‘€"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

```powershell:
PS D:\Downloads> Get-ChildItem function:Test-FileLocked | Get-Member
   TypeName: System.Management.Automation.FunctionInfo

Name                MemberType     Definition
----                ----------     ----------
Equals              Method         bool Equals(System.Object obj)
GetHashCode         Method         int GetHashCode()
GetType             Method         type GetType()
ResolveParameter    Method         System.Management.Automation.ParameterMetadata ResolveParameter(string name)
ToString            Method         string ToString()
PSDrive             NoteProperty   PSDriveInfo PSDrive=Function
PSIsContainer       NoteProperty   bool PSIsContainer=False
PSPath              NoteProperty   string PSPath=Microsoft.PowerShell.Core\Function::Test-FileLocked
PSProvider          NoteProperty   ProviderInfo PSProvider=Microsoft.PowerShell.Core\Function
CmdletBinding       Property       bool CmdletBinding {get;}
CommandType         Property       System.Management.Automation.CommandTypes CommandType {get;}
DefaultParameterSet Property       string DefaultParameterSet {get;}
Definition          Property       string Definition {get;}
Description         Property       string Description {get;set;}
HelpFile            Property       string HelpFile {get;}
Module              Property       psmoduleinfo Module {get;}
ModuleName          Property       string ModuleName {get;}
Name                Property       string Name {get;}
Noun                Property       string Noun {get;}
Options             Property       System.Management.Automation.ScopedItemOptions Options {get;set;}
OutputType          Property       System.Collections.ObjectModel.ReadOnlyCollection[System.Management.Automation.PS...
Parameters          Property       System.Collections.Generic.Dictionary[string,System.Management.Automation.Paramet...
ParameterSets       Property       System.Collections.ObjectModel.ReadOnlyCollection[System.Management.Automation.Co...
RemotingCapability  Property       System.Management.Automation.RemotingCapability RemotingCapability {get;}
ScriptBlock         Property       scriptblock ScriptBlock {get;}
Version             Property       version Version {get;}
Visibility          Property       System.Management.Automation.SessionStateEntryVisibility Visibility {get;set;}
HelpUri             ScriptProperty System.Object HelpUri {get=$oldProgressPreference = $ProgressPreference...


PS D:\Downloads>
PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).Definition

    param (
        [Parameter(Mandatory=$true)][System.String]$Path
    )

    if (-Not(Test-Path $Path)) {
        Write-Error 'å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚' -ErrorAction Stop
    }

    # ç›¸å¯¾ãƒ‘ã‚¹ã ã¨Openãƒ¡ã‚½ãƒƒãƒ‰ãŒæ­£å¸¸å‹•ä½œã—ãªã„ç‚ºã€çµ¶å¯¾ãƒ‘ã‚¹ã«å¤‰æ›
    $fullPath = (Resolve-Path -Path $Path -ErrorAction SilentlyContinue).Path

    $fileLocked = $false
    try {
        # èª­ã¿å–ã‚Šå°‚ç”¨ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãå‡¦ç†ã‚’å®Ÿè¡Œ
        $fileStream = [System.IO.File]::Open($fullPath, 'Open', 'ReadWrite', 'None')
    }
    catch {
        # ãƒ•ã‚¡ã‚¤ãƒ«ãŒé–‹ã‘ãªã„å ´åˆã€ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã¨åˆ¤æ–­
        $fileLocked = $true
    }
    finally {
        if ($null -ne $fileStream) {
            $fileStream.Close()
        }
    }

    return $fileLocked

PS D:\Downloads>
PS D:\Downloads> Get-ChildItem function:Test-FileLocked | Get-Member
   TypeName: System.Management.Automation.FunctionInfo
GetType             Method         type GetType()
PSDrive             NoteProperty   PSDriveInfo PSDrive=Function
PSProvider          NoteProperty   ProviderInfo PSProvider=Microsoft.PowerShell.Core\Function
DefaultParameterSet Property       string DefaultParameterSet {get;}
Module              Property       psmoduleinfo Module {get;}
ModuleName          Property       string ModuleName {get;}
Name                Property       string Name {get;}
Noun                Property       string Noun {get;}
Options             Property       System.Management.Automation.ScopedItemOptions Options {get;set;}
OutputType          Property       System.Collections.ObjectModel.ReadOnlyCollection[System.Management.Automation.PS...
Parameters          Property       System.Collections.Generic.Dictionary[string,System.Management.Automation.Paramet...
ParameterSets       Property       System.Collections.ObjectModel.ReadOnlyCollection[System.Management.Automation.Co...
RemotingCapability  Property       System.Management.Automation.RemotingCapability RemotingCapability {get;}
ScriptBlock         Property       scriptblock ScriptBlock {get;}
Source              Property       string Source {get;}
Verb                Property       string Verb {get;}
Version             Property       version Version {get;}
Visibility          Property       System.Management.Automation.SessionStateEntryVisibility Visibility {get;set;}
HelpUri             ScriptProperty System.Object HelpUri {get=$oldProgressPreference = $ProgressPreference...


PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).CmdletBinding
True
PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).DefaultParameterSet
PS D:\Downloads>
PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).Description
PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).HelpFile
PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).ModuleName

PS D:\Downloads>
PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).Name
Test-FileLocked
PS D:\Downloads>
PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).Noun
FileLocked
PS D:\Downloads>
PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).Options
None
PS D:\Downloads>
PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).OutputType
PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).Parameters

Key                 Value
---                 -----
Path                System.Management.Automation.ParameterMetadata
Verbose             System.Management.Automation.ParameterMetadata
Debug               System.Management.Automation.ParameterMetadata
ErrorAction         System.Management.Automation.ParameterMetadata
WarningAction       System.Management.Automation.ParameterMetadata
InformationAction   System.Management.Automation.ParameterMetadata
ErrorVariable       System.Management.Automation.ParameterMetadata
WarningVariable     System.Management.Automation.ParameterMetadata
InformationVariable System.Management.Automation.ParameterMetadata
OutVariable         System.Management.Automation.ParameterMetadata
OutBuffer           System.Management.Automation.ParameterMetadata
PipelineVariable    System.Management.Automation.ParameterMetadata


PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).ParameterSets

Parameter Set Name: __AllParameterSets
Is default parameter set: False

  Parameter Name: Path
    ParameterType = System.String
    Position = 0
    IsMandatory = True
    IsDynamic = False
    HelpMessage =
    ValueFromPipeline = False
    ValueFromPipelineByPropertyName = False
    ValueFromRemainingArguments = False
    Aliases = {}
    Attributes =



  Parameter Name: Verbose
    ParameterType = System.Management.Automation.SwitchParameter
    Position = -2147483648
    IsMandatory = False
    IsDynamic = False
    HelpMessage =
    ValueFromPipeline = False
    ValueFromPipelineByPropertyName = False
    ValueFromRemainingArguments = False
    Aliases = {vb}
    Attributes =



  Parameter Name: Debug
    ParameterType = System.Management.Automation.SwitchParameter
    Position = -2147483648
    IsMandatory = False
    IsDynamic = False
    HelpMessage =
    ValueFromPipeline = False
    ValueFromPipelineByPropertyName = False
    ValueFromRemainingArguments = False
    Aliases = {db}
    Attributes =



  Parameter Name: ErrorAction
    ParameterType = System.Management.Automation.ActionPreference
    Position = -2147483648
    IsMandatory = False
    IsDynamic = False
    HelpMessage =
    ValueFromPipeline = False
    ValueFromPipelineByPropertyName = False
    ValueFromRemainingArguments = False
    Aliases = {ea}
    Attributes =



  Parameter Name: WarningAction
    ParameterType = System.Management.Automation.ActionPreference
    Position = -2147483648
    IsMandatory = False
    IsDynamic = False
    HelpMessage =
    ValueFromPipeline = False
    ValueFromPipelineByPropertyName = False
    ValueFromRemainingArguments = False
    Aliases = {wa}
    Attributes =



  Parameter Name: InformationAction
    ParameterType = System.Management.Automation.ActionPreference
    Position = -2147483648
    IsMandatory = False
    IsDynamic = False
    HelpMessage =
    ValueFromPipeline = False
    ValueFromPipelineByPropertyName = False
    ValueFromRemainingArguments = False
    Aliases = {infa}
    Attributes =



  Parameter Name: ErrorVariable
    ParameterType = System.String
    Position = -2147483648
    IsMandatory = False
    IsDynamic = False
    HelpMessage =
    ValueFromPipeline = False
    ValueFromPipelineByPropertyName = False
    ValueFromRemainingArguments = False
    Aliases = {ev}
    Attributes =




  Parameter Name: WarningVariable
    ParameterType = System.String
    Position = -2147483648
    IsMandatory = False
    IsDynamic = False
    HelpMessage =
    ValueFromPipeline = False
    ValueFromPipelineByPropertyName = False
    ValueFromRemainingArguments = False
    Aliases = {wv}
    Attributes =




  Parameter Name: InformationVariable
    ParameterType = System.String
    Position = -2147483648
    IsMandatory = False
    IsDynamic = False
    HelpMessage =
    ValueFromPipeline = False
    ValueFromPipelineByPropertyName = False
    ValueFromRemainingArguments = False
    Aliases = {iv}
    Attributes =




  Parameter Name: OutVariable
    ParameterType = System.String
    Position = -2147483648
    IsMandatory = False
    IsDynamic = False
    HelpMessage =
    ValueFromPipeline = False
    ValueFromPipelineByPropertyName = False
    ValueFromRemainingArguments = False
    Aliases = {ov}


  Parameter Name: OutBuffer
    ParameterType = System.Int32
    Position = -2147483648
    IsMandatory = False
    IsDynamic = False
    HelpMessage =
    ValueFromPipeline = False
    ValueFromPipelineByPropertyName = False
    ValueFromRemainingArguments = False
    Aliases = {ob}
    Attributes =




  Parameter Name: PipelineVariable
    ParameterType = System.String
    Position = -2147483648
    IsMandatory = False
    IsDynamic = False
    HelpMessage =
    ValueFromPipeline = False
    ValueFromPipelineByPropertyName = False
    ValueFromRemainingArguments = False
    Aliases = {pv}
    Attributes =



PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).RemotingCapability
    param (
    )
    if (-Not(Test-Path $Path)) {
        Write-Error 'å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚' -ErrorAction Stop
    }

    # ç›¸å¯¾ãƒ‘ã‚¹ã ã¨Openãƒ¡ã‚½ãƒƒãƒ‰ãŒæ­£å¸¸å‹•ä½œã—ãªã„ç‚ºã€çµ¶å¯¾ãƒ‘ã‚¹ã«å¤‰æ›
    $fullPath = (Resolve-Path -Path $Path -ErrorAction SilentlyContinue).Path

    $fileLocked = $false
    try {
        # èª­ã¿å–ã‚Šå°‚ç”¨ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãå‡¦ç†ã‚’å®Ÿè¡Œ
        $fileStream = [System.IO.File]::Open($fullPath, 'Open', 'ReadWrite', 'None')
    }
    catch {
        # ãƒ•ã‚¡ã‚¤ãƒ«ãŒé–‹ã‘ãªã„å ´åˆã€ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã¨åˆ¤æ–­
        $fileLocked = $true
    }
    finally {
        if ($null -ne $fileStream) {
            $fileStream.Close()
        }
    }

    return $fileLocked

PS D:\Downloads>
PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).Source

PS D:\Downloads>
PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).Verb
Test
PS D:\Downloads>
PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).Version
PS D:\Downloads>
PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).Visibility
Public
PS D:\Downloads> (Get-ChildItem function:Test-FileLocked).HelpUri

PS D:\Downloads>
PS D:\Downloads>
```