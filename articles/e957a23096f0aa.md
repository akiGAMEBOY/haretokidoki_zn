---
title: "PowerShellでNull・空白のみ・空文字をチェックする3つの方法"
emoji: "🔥"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["powershell"]
published: false
---
## 概要

自身がPowerShellで文字列の値をチェックする際に手法を統一できていませんでした。

今回、PowerShellでNullや空白のみ、空文字の3点をチェックする際の手法を洗い出してみました。

## この記事のターゲット

- PowerShellユーザーの方
- 特定の値でNullや空白のみ、空文字をチェックしたい方

## 対応方法

Nullや空白、空文字の概念があいまいな方は、[こちらの記事](https://haretokidoki-blog.com/pasocon_program-db_null-karamoji/)をご参照ください。
（ブランクは言語により意味合いが異なる為、あえて使用していません。）

### IsNullOrWhiteSpaceメソッドで一気にすべてチェックする方法

```powershell:IsNullOrWhiteSpaceメソッドでチェックするFunction
# 値の設定
$printString = ''
#$printString = '  '
#$printString = $null

# IsNullOrWhiteSpaceメソッドで空文字・空白のみ・Nullのチェック
if ([System.String]::IsNullOrWhiteSpace($printString)) {
    Write-Warning '「Null or 空文字 or 空白のみ」のためエラー。'
    return
}

# 値を標準出力
Write-Output $printString
```


### if文で段階的にチェックする方法

```powershell:段階的にif文でチェックするFunction
# 値の設定
$printString = ''
#$printString = '  '
#$printString = $null

# 複数のif文で空文字・空白のみ・Nullのチェック
#   Nullチェック
if ($null -eq $printString) {
    Write-Warning '値がNull。'
    return
}
#   空文字をチェック
elseif ($printString -eq '') {
    Write-Warning '値が空文字。'
    return
}
#   空白のみをチェック
elseif ($printString.Trim() -eq '') {
    Write-Warning '値が空白のみ。'
    return
}
# 空文字と空白のみを一度にチェックしたい場合は下記のとおり。
# elseif ($printString.Trim() -eq '') {
#     Write-Warning '値が空文字、または空白のみ。'
#     return
# }

# 値を標準出力
Write-Output $printString
```

### Functionの引数で指定された値をチェックする方法

```powershell:Functionの引数で指定された値をチェックするFunction
function Write-String {
    param (
        [Parameter(Mandatory=$true)]
        # Functionの仕様で引数の値がNullと空文字はエラーとなる。空白のみをチェックすることで全てを網羅。
        [ValidateScript({ ($_.Trim() -ne '') })]
        [System.String]$PrintSring
    )

    # 値を標準出力
    Write-Output $PrintSring
}
```

他にも正規表現を使う方法や自作Function（カスタム関数）を使う方法も思いつきましたが、
現実的な方法ではないと判断し、ここで紹介するのは割愛します。

## まとめ

- 下記3つの方法を紹介しました。
    - `IsNullOrWhiteSpace`メソッドでチェックする方法
    - Functionの引数で指定された値をチェックする方法
    - 段階的にif文でチェックする方法

この3つの中で一番使用頻度が高いのは`IsNullOrWhiteSpace`メソッドを使用する方法でしょう。
ご自身が作成するスクリプトやFunctionに合わせてカスタマイズしてみてください！

## 関連記事

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
https://zenn.dev/haretokidoki/articles/fb6830f9155de5
