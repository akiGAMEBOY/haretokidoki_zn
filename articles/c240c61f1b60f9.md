---
title: "é…åˆ—å†…ã®è¦ç´ ã®é–“ã«æŒ‡å®šã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’å…¥ã‚Œã¦çµåˆã—ãŸæ–‡å­—åˆ—ã‚’è¿”ã™Function"
emoji: "ğŸ¤¸â€â™€ï¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

```powershell:
function Join-ArrayWithNewline {
    param (
        [Parameter(Mandatory=$true)][System.String[]]$Array,
        [ValidateSet("CRLF", "LF", "CR")][System.String]$NewlineType = "CRLF" # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ã¯CRLF
    )

    # æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã®Hashtableã‚’ä½œæˆã™ã‚‹
    [System.Collections.Hashtable]$newlineCodes = @{
        "CRLF" = "`r`n"
        "LF"   = "`n"
        "CR"   = "`r"
    }

    # é…åˆ—ã®è¦ç´ ã‚’æŒ‡å®šã•ã‚ŒãŸæ”¹è¡Œã‚³ãƒ¼ãƒ‰ã§çµåˆã™ã‚‹
    $Array -join $newlineCodes[$NewlineType]
}
```

```powershell:å®Ÿéš›ã«å®Ÿè¡Œã—ãŸçµæœ
# ä½¿ç”¨ä¾‹
$array = @("ä¸€è¡Œç›®", "äºŒè¡Œç›®", "ä¸‰è¡Œç›®")
# CRLFã‚’æŒ‡å®šã™ã‚‹å ´åˆ
$result = Join-ArrayWithNewline -Array $array -NewlineType "CRLF"

# çµæœã®å‡ºåŠ›
Write-Host $result
```
