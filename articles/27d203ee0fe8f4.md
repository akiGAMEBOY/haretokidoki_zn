---
title: "IPアドレス確認はPowerShell「gip」で！コマンドプロンプト「ipconfig」からの卒業"
emoji: "🐈"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["windows", "powershell"]
published: false
---

PowerShellのコマンドレットってコマンドが長いイメージありますよね。

モダンなWindows Terminalであれば、*Tabキー*をつかった入力補完機能を使うという手もありますが、候補が多いのでコマンドをある程度覚えておく必要があります。

わたしが最近、意識的に使っているのはエイリアスを使ったコマンドレットの実行。
タイトルにある「`gip`」とは「`Get-NetIPConfiguration`」のことで22文字から3文字で文字数の差はなんと「**19文字**」です。

コマンドの覚え方も“***G*** et ***I*** ***P*** アドレス”と簡単。

コマンドプロンプトの「`ipconfig`」の8文字と比較しても入力する文字数が少なく、出力結果も見やすいという良いことづくしな「PowerShellコマンドレットでIPアドレスを確認する方法」を紹介します。

## 新旧コマンドの比較

### PowerShellコマンドレット「gip（Get-NetIPConfiguration）」

わたしが最近、意識的に使っている「`gip`(`Get-NetIPConfiguration`)」の結果は以下のとおり。

![](https://storage.googleapis.com/zenn-user-upload/aeb686cb2e8c-20250911.png)

:::details gip(Get-NetIPConfiguration) - テキストベース

```powershell:gip(Get-NetIPConfiguration)
PowerShell 7.5.2
PS C:\Users\XXXX> gip

InterfaceAlias       : イーサネット
InterfaceIndex       : 11
InterfaceDescription : Realtek PCIe GbE Family Controller
NetProfile.Name      : ネットワーク 3
IPv4Address          : XXX.XXX.XXX.XXX
IPv4DefaultGateway   : XXX.XXX.XXX.XXX
DNSServer            : XXX.XXX.XXX.XXX
                       XXX.XXX.XXX.XXX

InterfaceAlias       : vEthernet (Default Switch)
InterfaceIndex       : 21
InterfaceDescription : Hyper-V Virtual Ethernet Adapter
IPv4Address          : XXX.XXX.XXX.XXX
IPv6DefaultGateway   :
IPv4DefaultGateway   :
DNSServer            : fec0:0:0:ffff::1
                       fec0:0:0:ffff::2
                       fec0:0:0:ffff::3

InterfaceAlias       : イーサネット 2
InterfaceIndex       : 33
InterfaceDescription : VirtualBox Host-Only Ethernet Adapter
IPv4Address          : XXX.XXX.XXX.XXX
IPv6DefaultGateway   :
IPv4DefaultGateway   :
DNSServer            : fec0:0:0:ffff::1
                       fec0:0:0:ffff::2
                       fec0:0:0:ffff::3

InterfaceAlias       : Bluetooth ネットワーク接続
InterfaceIndex       : 7
InterfaceDescription : Bluetooth Device (Personal Area Network)
NetAdapter.Status    : Disconnected

PS C:\Users\XXXX>
```

:::

### コマンドプロンプト「ipconfig」

みんな大好き「`ipconfig`」の結果は以下のとおり。

![](https://storage.googleapis.com/zenn-user-upload/a65c577bdaf2-20250911.png)

:::details ipconfig - テキストベース

```bat:ipconfig
Microsoft Windows [Version 10.0.19045.6216]
(c) Microsoft Corporation. All rights reserved.

C:\Users\XXXX>ipconfig

Windows IP 構成


イーサネット アダプター vEthernet (Default Switch):

   接続固有の DNS サフィックス . . . . .:
   リンクローカル IPv6 アドレス. . . . .: fe80::XXXX:XXXX:XXXX:XXXX%XX
   IPv4 アドレス . . . . . . . . . . . .: XXX.XXX.XXX.XXX
   サブネット マスク . . . . . . . . . .: 255.255.240.0
   デフォルト ゲートウェイ . . . . . . .:

イーサネット アダプター イーサネット:

   接続固有の DNS サフィックス . . . . .:
   IPv4 アドレス . . . . . . . . . . . .: XXX.XXX.XXX.XXX
   サブネット マスク . . . . . . . . . .: 255.255.255.0
   デフォルト ゲートウェイ . . . . . . .: XXX.XXX.XXX.XXX

イーサネット アダプター イーサネット 2:

   接続固有の DNS サフィックス . . . . .:
   リンクローカル IPv6 アドレス. . . . .: fe80::XXXX:XXXX:XXXX:XXXX%XX
   IPv4 アドレス . . . . . . . . . . . .: XXX.XXX.XXX.XXX
   サブネット マスク . . . . . . . . . .: 255.255.255.0
   デフォルト ゲートウェイ . . . . . . .:

イーサネット アダプター Bluetooth ネットワーク接続:

   メディアの状態. . . . . . . . . . . .: メディアは接続されていません
   接続固有の DNS サフィックス . . . . .:

C:\Users\XXXX>
```

:::

### 出力内容の違い

- 出力形式
    - gip: オブジェクト形式
    - ipconfig: テキスト形式

```powershell
# gip は、オブジェクト形式で出力されているため、データ加工やフィルタが容易。
PS C:\Users\XXXX> $result = ipconfig
PS C:\Users\XXXX>
PS C:\Users\XXXX> $result.GetType().FullName
System.Object[]
PS C:\Users\XXXX>
PS C:\Users\XXXX> $result[0]

InterfaceAlias       : イーサネット
InterfaceIndex       : 11
InterfaceDescription : Realtek PCIe GbE Family Controller
NetProfile.Name      : ネットワーク 3
IPv4Address          : XXX.XXX.XXX.XXX
IPv4DefaultGateway   : XXX.XXX.XXX.XXX
DNSServer            : XXX.XXX.XXX.XXX
                       XXX.XXX.XXX.XXX

PS C:\Users\XXXX>
# ipconfig は、テキスト形式で出力されているため、単純に行ごとデータが入っていてデータ加工やフィルタを行う場合は複雑なデータ変換が必要。
PS C:\Users\XXXX> $result = ipconfig
PS C:\Users\XXXX>
PS C:\Users\XXXX> $result.GetType().FullName
System.Object[]
PS C:\Users\XXXX>
PS C:\Users\XXXX> $result[0]

PS C:\Users\XXXX>
PS C:\Users\XXXX> $result[1]
Windows IP 構成
PS C:\Users\XXXX>
```

構成の違い。

```
PS C:\Users\XXXX> $result = gip
PS C:\Users\XXXX>
PS C:\Users\XXXX> $result | Get-Member -MemberType Property

   TypeName: NetIPConfiguration

Name                 MemberType Definition
----                 ---------- ----------
AllIPAddresses       Property   ciminstance[] AllIPAddresses {get;set;}
CompartmentId        Property   int CompartmentId {get;set;}
ComputerName         Property   string ComputerName {get;set;}
Detailed             Property   bool Detailed {get;set;}
DNSServer            Property   ciminstance[] DNSServer {get;set;}
InterfaceAlias       Property   string InterfaceAlias {get;set;}
InterfaceDescription Property   string InterfaceDescription {get;set;}
InterfaceIndex       Property   int InterfaceIndex {get;set;}
IPv4Address          Property   ciminstance[] IPv4Address {get;set;}
IPv4DefaultGateway   Property   ciminstance[] IPv4DefaultGateway {get;set;}
IPv6Address          Property   ciminstance[] IPv6Address {get;set;}
IPv6DefaultGateway   Property   ciminstance[] IPv6DefaultGateway {get;set;}
IPv6LinkLocalAddress Property   ciminstance[] IPv6LinkLocalAddress {get;set;}
IPv6TemporaryAddress Property   ciminstance[] IPv6TemporaryAddress {get;set;}
NetAdapter           Property   ciminstance NetAdapter {get;set;}
NetCompartment       Property   ciminstance NetCompartment {get;set;}
NetIPv4Interface     Property   ciminstance NetIPv4Interface {get;set;}
NetIPv6Interface     Property   ciminstance NetIPv6Interface {get;set;}
NetProfile           Property   ciminstance NetProfile {get;set;}

PS C:\Users\XXXX>
PS C:\Users\XXXX> $result = ipconfig
PS C:\Users\XXXX>
PS C:\Users\XXXX> $result | Get-Member -MemberType Property

   TypeName: System.String

Name   MemberType Definition
----   ---------- ----------
Length Property   int Length {get;}

PS C:\Users\XXXX>
```

視覚的にデータ構造の違いを確認。

```powershell
PS C:\Users\XXXX> gip | Out-GridView
PS C:\Users\XXXX>
PS C:\Users\XXXX> ipconfig | Out-GridView
PS C:\Users\XXXX>
```

フィルターが容易。
IPv4アドレスが設定されているネットワークインターフェイスの情報だけを表示。

```
PS C:\Users\XXXX> (gip).NetIPv4Interface

ifIndex InterfaceAlias                  AddressFamily NlMtu(Bytes) InterfaceMetric Dhcp     ConnectionState PolicyStore
------- --------------                  ------------- ------------ --------------- ----     --------------- -----------
11      イーサネット                    IPv4                  1500              25 Disabled Connected       ActiveStore
21      vEthernet (Default Switch)      IPv4                  1500              15 Disabled Connected       ActiveStore
33      イーサネット 2                  IPv4                  1500              74 Disabled Connected       ActiveStore
7       Bluetooth ネットワーク接続      IPv4                  1500              65 Enabled  Disconnected    ActiveStore

PS C:\Users\XXXX>
```

フィルターと加工。
IPv4が有効なインターフェイスのみ表示し、必要な項目である「インターフェイス名 / IPアドレス(IPv4) / デフォルトゲートウェイ」の3つを表示するケース。

```
PS C:\Users\XXXX> gip | Where-Object { $_.IPv4Address } | Select-Object InterfaceAlias,
>>     @{ Name = 'IPAddress'; Expression = { $_.IPv4Address.IPAddress } },
>>     @{ Name = 'DefaultGateway'; Expression = { $_.IPv4DefaultGateway.NextHop } }

InterfaceAlias             IPAddress       DefaultGateway
--------------             ---------       --------------
イーサネット               XXX.XXX.XXX.XXX XXX.XXX.XXX.XXX
vEthernet (Default Switch) XXX.XXX.XXX.XXX
イーサネット 2             XXX.XXX.XXX.XXX
Bluetooth ネットワーク接続 XXX.XXX.XXX.XXX

PS C:\Users\XXXX>
```

---

## メリット

表示がモダンなため見やすい（ラベル緑色・整ったレイアウト）。
画像はりつけ。

オブジェクト型で加工やフィルターが楽。

パイプラインや変数などで他の処理にも渡しやすい。

エイリアスであれば3文字で実行可能

## デメリット

覚えにくい。
→gipで

低スペックのPCではもたつく可能性。

一般的ではないため、共有するためのコスト

## 参考

PowerShellには、`gip(Get-NetIPConfiguration)`の他に`Get-NetIPAddress`というコマンドレットがある。
