---
title: "Windowsã‚³ãƒãƒ³ãƒ‰ã§æ‹¡å¼µå­ã¨ã‚½ãƒ•ãƒˆã‚’é–¢é€£ä»˜ã‘ã‚‹æ–¹æ³•"
emoji: "ğŸ¤"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["windows", "zip", "nupkg"]
published: true
---
## æ¦‚è¦

[ã“ã¡ã‚‰](https://zenn.dev/haretokidoki/articles/d3ca9fe55ab0c5)ã®è¨˜äº‹ã§ç´¹ä»‹ã—ã¦ã„ã‚‹nupkgãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€Windowsã®åˆæœŸè¨­å®šã ã¨æœªç™»éŒ²ã®æ‹¡å¼µå­ã§ã—ãŸã€‚
nupkgãƒ•ã‚¡ã‚¤ãƒ«è‡ªä½“ã¯ZIPå½¢å¼ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚ã£ãŸç‚ºã€Windowsæ¨™æº–ã®åœ§ç¸®ãƒ»è§£å‡æ©Ÿèƒ½[^1]ã¨é–¢é€£ä»˜ã‘ï¼ˆç´ã¥ã‘ï¼‰ã—ã¾ã—ãŸã€‚
ç°¡æ˜“ãªå†…å®¹ã§ã™ãŒã€ãã®æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚
[^1]: ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ï¼ˆExplorer.exeï¼‰ã‚’ä½¿ç”¨ã—ãŸæ©Ÿèƒ½

ãªãŠ[7-Zip](https://sevenzip.osdn.jp/)ãªã©ã®åœ§ç¸®ãƒ»è§£å‡ãƒ„ãƒ¼ãƒ«ã‚’å°å…¥ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€
æ‹¡å¼µå­ã‚’ç™»éŒ²ã—ã¦ã„ãªãã¨ã‚‚å³ã‚¯ãƒªãƒƒã‚¯ã®ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼‰ç­‰ã‹ã‚‰ã€
è§£å‡å‡¦ç†ã‚’å‘¼ã³å‡ºã›ã‚‹ç‚ºã€ã“ã®è¨˜äº‹ã®ä½œæ¥­ã¯ä¸è¦ã‹ã¨æ€ã„ã¾ã™ã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- Windowsã‚³ãƒãƒ³ãƒ‰ã§æœªç™»éŒ²ã®æ‹¡å¼µå­ã‚’ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã«é–¢é€£ä»˜ã‘ã—ãŸã„æ–¹

## å¯¾å¿œæ–¹æ³•

:::details ä½œæ¥­å‰ã®çŠ¶æ…‹ï¼ˆã‚¯ãƒªãƒƒã‚¯ãƒ»ã‚¿ãƒƒãƒ—ã§æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰

- ç”»é¢ï¼ˆã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ï¼‰ä¸Šã§æœªç™»éŒ²çŠ¶æ…‹ã§ã‚ã‚‹äº‹ã‚’ç¢ºèª
    ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤ºã«ã‚ˆã‚Šã€ã©ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã«ã‚‚é–¢é€£ã¥ã„ã¦ã„ãªã„äº‹ã‚’ç¢ºèªã€‚
    ![çœŸã£ç™½ãªãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¦æ‹¡å¼µå­ãŒé–¢é€£ä»˜ã‘ã•ã‚Œã¦ã„ãªã„çŠ¶æ…‹](https://storage.googleapis.com/zenn-user-upload/5c0a63a76c9e-20230412.png =800x)
    *é–¢é€£ä»˜ã‘å‰ã®æ‹¡å¼µå­ã€Œ.nupkgã€ãƒ•ã‚¡ã‚¤ãƒ«*
- ã‚³ãƒãƒ³ãƒ‰ä¸Šã§æœªç™»éŒ²çŠ¶æ…‹ã§ã‚ã‚‹äº‹ã‚’ç¢ºèª
    æœªç™»éŒ²ã®æ‹¡å¼µå­ã€Œ.nupkgã€ã®é–¢é€£ä»˜ã‘ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—ï¼‰ã®çŠ¶æ…‹ã‚ˆã‚Šã€é–¢é€£ä»˜ã‘ã•ã‚Œã¦ã„ãªã„äº‹ã‚’ç¢ºèªã€‚

    ```:ã‚³ãƒ”ãƒ¼ç”¨
    assoc .nupkg
    ```

    ```:ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
    C:\WINDOWS\system32>assoc .nupkg
    æ‹¡å¼µå­ .nupkg ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®é–¢é€£ä»˜ã‘ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“

    C:\WINDOWS\system32>
    ```

- é–¢é€£ä»˜ã‘ã™ã‚‹Windowsæ¨™æº–ã®åœ§ç¸®ãƒ»è§£å‡æ©Ÿèƒ½[^1]ã®è©³ç´°æƒ…å ±
    ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—ã€ŒCompressedFolderï¼ˆWindowsæ¨™æº–ã®åœ§ç¸®ãƒ»è§£å‡æ©Ÿèƒ½[^1]ï¼‰ã€ã®è©³ç´°æƒ…å ±ã‚’ç¢ºèªã€‚

    ```:ã‚³ãƒ”ãƒ¼ç”¨
    ftype CompressedFolder
    ```

    ```:ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
    C:\WINDOWS\system32>ftype CompressedFolder
    CompressedFolder=%SystemRoot%\Explorer.exe /idlist,%I,%L

    C:\WINDOWS\system32>
    ```

:::

### é–¢é€£ä»˜ã‘ã‚’è¨­å®šã™ã‚‹æ–¹æ³•

1. æœªç™»éŒ²ã®æ‹¡å¼µå­ã€Œ.nupkgã€ã‚’é–¢é€£ä»˜ã‘
    ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—ã€ŒCompressedFolderï¼ˆWindowsæ¨™æº–ã®åœ§ç¸®ãƒ»è§£å‡æ©Ÿèƒ½[^1]ï¼‰ã€ã«é–¢é€£ä»˜ã‘ã‚‹
    :::message
    ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§è¨­å®šå¤‰æ›´æ™‚ã¯ç®¡ç†è€…æ¨©é™[^2]ã§å®Ÿè¡Œã€‚
    :::
    [^2]: ç®¡ç†è€…æ¨©é™ã§ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’èµ·å‹•ã™ã‚‹æ–¹æ³•: Winã‚­ãƒ¼ â†’ ã‚¹ã‚¿ãƒ¼ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤º â†’ ã€Œcmdã€ã¨å…¥åŠ› â†’ ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®â€œç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œâ€ã‚’é¸æŠ

    ```:ã‚³ãƒ”ãƒ¼ç”¨
    assoc .nupkg=CompressedFolder
    ```

    ```:ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼ˆç®¡ç†è€…æ¨©é™ï¼‰
    C:\WINDOWS\system32>assoc .nupkg=CompressedFolder
    .nupkg=CompressedFolder

    C:\WINDOWS\system32>
    ```

1. é–¢é€£ä»˜ã‘ã•ã‚ŒãŸäº‹ã‚’ç¢ºèª
    - ç”»é¢ï¼ˆã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ï¼‰ä¸Šã§é–¢é€£ä»˜ã‘ã•ã‚ŒãŸäº‹ã‚’ç¢ºèª
        ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤ºã«ã‚ˆã‚Šé–¢é€£ä»˜ã‘ã‚’ç¢ºèªã€‚
        ![CompressedFolderï¼ˆåœ§ç¸®ãƒ‡ãƒ¼ã‚¿ï¼‰ã¨ã—ã¦é–¢é€£ä»˜ã‘ã•ã‚ŒãŸæ‹¡å¼µå­ãŒnupkgã®ãƒ•ã‚¡ã‚¤ãƒ«](https://storage.googleapis.com/zenn-user-upload/7829f53b413a-20230412.png =800x)
        *é–¢é€£ä»˜ã‘å¾Œã®æ‹¡å¼µå­ã€Œ.nupkgã€ãƒ•ã‚¡ã‚¤ãƒ«*
    - ã‚³ãƒãƒ³ãƒ‰ä¸Šã§é–¢é€£ä»˜ã‘ã•ã‚ŒãŸäº‹ã‚’ç¢ºèª

        ```:ã‚³ãƒ”ãƒ¼ç”¨
        assoc .nupkg
        ```

        ```:ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
        C:\WINDOWS\system32>assoc .nupkg
        .nupkg=CompressedFolder

        C:\WINDOWS\system32>
        ```

### åˆ‡ã‚Šæˆ»ã—æ‰‹é †ï¼»é–¢é€£ä»˜ã‘ã‚’è§£é™¤ï¼ˆå‰Šé™¤ï¼‰ã™ã‚‹æ–¹æ³•ï¼½

1. ç™»éŒ²æ¸ˆã¿ã®æ‹¡å¼µå­ã€Œ.nupkgã€ã®é–¢é€£ä»˜ã‘ã‚’è§£é™¤
    :::message
    ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¯ç®¡ç†è€…æ¨©é™[^2]ã§å®Ÿè¡Œã€‚
    :::

    ```:ã‚³ãƒ”ãƒ¼ç”¨
    assoc .nupkg=
    ```

    ```:ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼ˆç®¡ç†è€…æ¨©é™ï¼‰
    C:\WINDOWS\system32>assoc .nupkg=

    C:\WINDOWS\system32>
    ```

1. é–¢é€£ä»˜ã‘ãŒè§£é™¤ã•ã‚ŒãŸäº‹ã‚’ç¢ºèª

    ```:ã‚³ãƒ”ãƒ¼ç”¨
    assoc .nupkg
    ```

    ```:ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
    C:\WINDOWS\system32>assoc .nupkg
    æ‹¡å¼µå­ .nupkg ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®é–¢é€£ä»˜ã‘ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“

    C:\WINDOWS\system32>
    ```

### è£œè¶³äº‹é …ï¼šPowerShell CLIã§assocã‚„ftypeã‚’å®Ÿè¡Œã™ã‚‹å ´åˆ

PowerShellã®CLIã§ã¯ã€ã€Œassocã‚³ãƒãƒ³ãƒ‰ã€ã‚„ã€Œftypeã‚³ãƒãƒ³ãƒ‰ã€ã‚’ç›´æ¥å®Ÿè¡Œã—ãŸå ´åˆã€
ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã—ã¾ã„ã¾ã™ã€‚

:::details PowerShell CLIã§å®Ÿè¡Œã—ãŸéš›ã®ã‚¨ãƒ©ãƒ¼å†…å®¹ï¼ˆã‚¯ãƒªãƒƒã‚¯ãƒ»ã‚¿ãƒƒãƒ—ã§æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰

```powershell:assocã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸéš›ã®ã‚¨ãƒ©ãƒ¼
PS C:\WINDOWS\system32> assoc .nupkg=CompressedFolder
assoc : ç”¨èª 'assoc' ã¯ã€ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€é–¢æ•°ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆ ãƒ•ã‚¡ã‚¤ãƒ«ã€ã¾ãŸã¯æ“ä½œå¯èƒ½ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®åå‰ã¨ã—ã¦èªè­˜ã•ã‚Œã¾ã›
ã‚“ã€‚åå‰ãŒæ­£ã—ãè¨˜è¿°ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã€ãƒ‘ã‚¹ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã¯ãã®ãƒ‘ã‚¹ãŒæ­£ã—ã„ã“ã¨ã‚’ç¢ºèªã—ã¦ã‹ã‚‰ã€å†è©¦è¡Œã—ã¦ãã 
ã•ã„ã€‚
ç™ºç”Ÿå ´æ‰€ è¡Œ:1 æ–‡å­—:1
+ assoc .nupkg=CompressedFolder
+ ~~~~~
    + CategoryInfo          : ObjectNotFound: (assoc:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\WINDOWS\system32>
```

```powershell:ftypeã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸéš›ã®ã‚¨ãƒ©ãƒ¼
PS C:\WINDOWS\system32> ftype CompressedFolder
ftype : ç”¨èª 'ftype' ã¯ã€ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€é–¢æ•°ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆ ãƒ•ã‚¡ã‚¤ãƒ«ã€ã¾ãŸã¯æ“ä½œå¯èƒ½ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®åå‰ã¨ã—ã¦èªè­˜ã•ã‚Œã¾ã›
ã‚“ã€‚åå‰ãŒæ­£ã—ãè¨˜è¿°ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã€ãƒ‘ã‚¹ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã¯ãã®ãƒ‘ã‚¹ãŒæ­£ã—ã„ã“ã¨ã‚’ç¢ºèªã—ã¦ã‹ã‚‰ã€å†è©¦è¡Œã—ã¦ãã 
ã•ã„ã€‚
ç™ºç”Ÿå ´æ‰€ è¡Œ:1 æ–‡å­—:1
+ ftype CompressedFolder
+ ~~~~~
    + CategoryInfo          : ObjectNotFound: (ftype:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\WINDOWS\system32>
```

:::

#### PowerShell CLIã§ã®å®Ÿè¡Œæ–¹æ³•

PowerShellã‹ã‚‰ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ã‚³ãƒãƒ³ãƒ‰ã‚’å‘¼ã³å‡ºã™éš›ã¯ã€
å…ˆé ­ã«ã€Œ**cmd /c** ã€ã‚’ã¤ã‘ã‚‹äº‹ã§PowerShellã§ã‚‚å®Ÿè¡ŒãŒå¯èƒ½ã¨ãªã‚Šã¾ã™ã€‚

:::message
PowerShell CLIã§è¨­å®šå¤‰æ›´æ™‚ã¯ç®¡ç†è€…æ¨©é™[^3]ã§å®Ÿè¡Œã€‚
:::

[^3]: ç®¡ç†è€…æ¨©é™ã§PowerShell CLIã‚’èµ·å‹•ã™ã‚‹æ–¹æ³•ï¼šWinã‚­ãƒ¼ â†’ ã‚¹ã‚¿ãƒ¼ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤º â†’ ã€Œpowershellã€ã¨å…¥åŠ› â†’ Windows PowerShellã®â€œç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œâ€ã‚’é¸æŠ

```powershell:ã‚³ãƒ”ãƒ¼ç”¨
cmd /c assoc .nupkg=CompressedFolder
```

```powershell:PowerShell CLIï¼ˆç®¡ç†è€…æ¨©é™ï¼‰
PS C:\WINDOWS\system32> cmd /c assoc .nupkg=CompressedFolder
.nupkg=CompressedFolder
PS C:\WINDOWS\system32>
```

```powershell:ã‚³ãƒ”ãƒ¼ç”¨
cmd /c ftype CompressedFolder
```

```powershell:PowerShell CLI
PS C:\WINDOWS\system32> cmd /c ftype CompressedFolder
CompressedFolder=%SystemRoot%\Explorer.exe /idlist,%I,%L
PS C:\WINDOWS\system32>
```

## å‚è€ƒè¨˜äº‹

- Windowsã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ã‚³ãƒãƒ³ãƒ‰ã€Œassocã€
    https://windows.command-ref.com/cmd-assoc.html
- Windowsã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ã‚³ãƒãƒ³ãƒ‰ã€Œftypeã€
    https://windows.command-ref.com/cmd-ftype.html

## ã¾ã¨ã‚

- ãƒ¬ã‚¬ã‚·ãƒ¼ãªã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ã‚³ãƒãƒ³ãƒ‰ã ãŒã€ã€Œ**assocã‚³ãƒãƒ³ãƒ‰**ã€ã§ç°¡å˜ã«é–¢é€£ä»˜ã‘ãŒå¯èƒ½
- PowerShell CLIã§ã€Œaasocã‚³ãƒãƒ³ãƒ‰ã€ã‚’å®Ÿè¡Œã™ã‚‹å ´åˆã¯ã€å…ˆé ­ã«ã€Œ**cmd /c** ã€ã‚’ã¤ã‘ã‚‹

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
