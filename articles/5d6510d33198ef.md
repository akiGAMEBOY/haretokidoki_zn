---
title: "PowerShellã®ã‚ã‹ã‚Šã«ãã„æ¯”è¼ƒæ¼”ç®—å­ã‚’è¨˜å·ã§åˆ¤å®šã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹Function"
emoji: "ðŸ˜Š"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

æ¯”è¼ƒæ¼”ç®—å­ã®è‡ªèº«ã®è¨˜äº‹ã‚’ç´¹ä»‹ï¼Ÿ

ã‚‚ã¡ã‚ã‚“ã§ã™ã€‚PowerShellã§æ¯”è¼ƒæ¼”ç®—å­ã‚’è¨˜å·ã§åˆ¤å®šã™ã‚‹Functionã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚ã“ã®Functionã¯ã€å…¥åŠ›ã•ã‚ŒãŸ2ã¤ã®å€¤ã¨æ¯”è¼ƒæ¼”ç®—å­ã‚’æ–‡å­—åˆ—ã¨ã—ã¦å—ã‘å–ã‚Šã€ãã®æ¯”è¼ƒæ¼”ç®—å­ã«åŸºã¥ã„ã¦æ¯”è¼ƒã‚’è¡Œã„ã¾ã™ã€‚çµæžœã¨ã—ã¦ã€æ¯”è¼ƒãŒçœŸã‹å½ã‹ã‚’è¿”ã—ã¾ã™ã€‚

```powershell
function Test-Comparison {
    param(
        [Parameter(Mandatory=$true)][System.Object]$Value1,

        [Parameter(Mandatory=$true)]
        [System.String]$Operator,

        [Parameter(Mandatory=$true)]
        [System.Object]$Value2
    )

    switch ($Operator) {
        # é€šå¸¸ã®æ¯”è¼ƒæ¼”ç®—å­
        '=='            { return $Value1 -eq $Value2 }
        '!='            { return $Value1 -ne $Value2 }
        '>'             { return $Value1 -gt $Value2 }
        '>='            { return $Value1 -ge $Value2 }
        '<'             { return $Value1 -lt $Value2 }
        '<='            { return $Value1 -le $Value2 }
        '-like'         { return $Value1 -like $Value2 }
        '-notlike'      { return $Value1 -notlike $Value2 }
        '-match'        { return $Value1 -match $Value2 }
        '-notmatch'     { return $Value1 -notmatch $Value2 }
        '-contains'     { return $Value1 -contains $Value2 }
        '-notcontains'  { return $Value1 -notcontains $Value2 }
        '-in'           { return $Value1 -in $Value2 }
        '-notin'        { return $Value1 -notin $Value2 }
        '-is'           { return $Value1 -is $Value2 }
        '-isnot'        { return $Value1 -isnot $Value2 }
        # å¤§æ–‡å­—ã¨å°æ–‡å­—ã‚’åŒºåˆ¥ã™ã‚‹æ¯”è¼ƒæ¼”ç®—å­
        '-ceq'          { return $Value1 -ceq $Value2 }
        '-cne'          { return $Value1 -cne $Value2 }
        '-cgt'          { return $Value1 -cgt $Value2 }
        '-cge'          { return $Value1 -cge $Value2 }
        '-clt'          { return $Value1 -clt $Value2 }
        '-cle'          { return $Value1 -cle $Value2 }
        '-clike'        { return $Value1 -clike $Value2 }
        '-cnotlike'     { return $Value1 -cnotlike $Value2 }
        '-cmatch'       { return $Value1 -cmatch $Value2 }
        '-cnotmatch'    { return $Value1 -cnotmatch $Value2 }
        '-ccontains'    { return $Value1 -ccontains $Value2 }
        '-cnotcontains' { return $Value1 -cnotcontains $Value2 }
        '-cin'          { return $Value1 -cin $Value2 }
        '-cnotin'       { return $Value1 -cnotin $Value2 }
        default         { throw "Invalid operator: $Operator" }
    }
}
```

```powershell
# ä¾‹: 10 ã¨ 20 ã‚’æ¯”è¼ƒã—ã¦ã€10 ãŒ 20 ã‚ˆã‚Šå°ã•ã„ã‹ã©ã†ã‹ã‚’åˆ¤å®š
Test-Comparison -Value1 10 -Operator '<' -Value2 20
$value1 = 10
$value2 = 20
if (Test-Comparison 10 '<' 20) {
    Write-Host "Trueåˆ¤å®šï¼š$value1 ã¯ $value2 ã‚ˆã‚Šå°ã•ã„"
}
else {
    Write-Host "Falseåˆ¤å®šï¼š$value1 ã¯ $value2 ã‚ˆã‚Šå°ã•ããªã„"
}
```

https://qiita.com/turmericN/items/f3421899a4ac4bb207f1
