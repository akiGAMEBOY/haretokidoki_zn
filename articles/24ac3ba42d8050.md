---
title: "文字列配列を渡すと全てvoidで囲った文字列配列を返すFunction"
emoji: "👏"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["powershell"]
published: false
---

```powershell
# Functionの定義
function Add-FixedString {
    param (
        # 必須パラメーター：コマンドが記載された文字列配列
        [Parameter(Mandatory=$true)]
        [System.String[]]$commands,

        # オプションパラメーター：先頭に追加する文字（デフォルトは"start"）
        [System.String]$first = '[void](',

        # オプションパラメーター：末尾に追加する文字（デフォルトは"end"）
        [System.String]$last = ')'
    )

    # 結果を格納する配列を作成
    [System.String[]]$result = @()

    # 配列内のコマンドを繰り返し処理で変更
    [System.String]$modified = ''
    foreach ($command in $commands) {
        # 先頭と末尾に固定値の文字を追加
        $modified = "$($first)$($command)$($last)"

        # 結果の配列に追加
        $result += $modified
    }

    # 結果の配列を返す
    return $result
}

# Functionの呼び出し例
$commands = @(
    'Get-Date',
    'Get-Process',
    'Get-ChildItem'
)
Add-FixedString -commands $commands
Add-FixedString -commands $commands -first "Hello : " -last " : Bye"
```

Powershell FunctionにおけるReturnの制御
Function内で実行したWrite-HostとかもReturnの一部に入ってします。
PowerShell の関数 (Function) の使い方 https://microsoftou.com/powershell-function/
https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/about/about_return?view=powershell-7.4

> 質問
> 
> PowerShellで出力結果を無視、または破棄する方法を一覧で教えてください。
> また、各方法の特徴と使用用途の解説、また解説では、処理速度の観点を含めて説明してください。

> 回答
> 
> こんにちは、Copilotです。PowerShellで出力結果を無視、または破棄する方法についてお答えします。😊
> 
> PowerShellで出力結果を無視、または破棄する方法は主に以下の3つがあります。
> 
> - `Out-Null` コマンドレットを使用する
> - `$null` にリダイレクトする
> - `[void]` キャストを使用する
> 
> それぞれの方法の特徴と使用用途は以下の通りです。
> 
> - `Out-Null` コマンドレットは、パイプラインに渡されたオブジェクトを受け取り、何も出力しません。この方法は、出力結果が不要な場合に使用できます。ただし、`Out-Null` コマンドレットは、パイプラインにオブジェクトを渡す処理を行うため、処理速度が遅くなる可能性があります。¹
> - `$null` にリダイレクトする方法は、出力結果を `$null` 変数に代入することで、破棄する方法です。この方法は、`Out-Null` コマンドレットよりも処理速度が速いですが、`$null` 変数に値を代入することで、メモリを消費する可能性があります。²
> - `[void]` キャストを使用する方法は、出力結果を `[void]` 型に変換することで、破棄する方法です。この方法は、`Out-Null` コマンドレットや `$null` にリダイレクトする方法よりも処理速度が速く、メモリも消費しません。ただし、この方法は、パイプラインに対応していないため、パイプラインを使用する場合は適用できません。³
> 
> 以上が、PowerShellで出力結果を無視、または破棄する方法の一覧と解説です。ご参考になれば幸いです。😊
> 
> ¹: [Write-Output (Microsoft.PowerShell.Utility) - PowerShell](^1^)
> ²: [PowerShellで出力結果を破棄する方法 - teratail【テラテイル】](^2^)
> ³: [PowerShell - コマンドの実行結果を破棄する - ITLAB51.COM](^4^)
> 
> ソース: Bing との会話 2024/2/16
> (1) Write-Output (Microsoft.PowerShell.Utility) - PowerShell. https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/write-output?view=powershell-7.4.
> (2) PowerShellで出力結果を破棄する方法 - teratail【テラテイル】. https://teratail.com/questions/370084.
> (3) 【PowerShell】出力結果を無視する方法 - buralog. https://bing.com/search?q=PowerShell%e3%81%a7%e5%87%ba%e5%8a%9b%e7%b5%90%e6%9e%9c%e3%82%92%e7%84%a1%e8%a6%96%e3%80%81%e3%81%be%e3%81%9f%e3%81%af%e7%a0%b4%e6%a3%84%e3%81%99%e3%82%8b%e6%96%b9%e6%b3%95.
> (4) Write-Output (Microsoft.PowerShell.Utility) - PowerShell. https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/write-output?view=powershell-7.4.
> (5) PowerShellで出力結果を破棄する方法 - teratail【テラテイル】. https://teratail.com/questions/370084.
> (6) PowerShell - コマンドの実行結果を破棄する - ITLAB51.COM. https://www.itlab51.com/?p=5922.