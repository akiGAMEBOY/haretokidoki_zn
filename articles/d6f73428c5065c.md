---
title: "[PowerSHell]CLIã§Yesã¾ãŸã¯Noã®å…¥åŠ›å¿œç­”ã«ã‚ˆã‚ŠTrueãƒ»Falseã‚’è¿”ã™Function"
emoji: "ðŸ“"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell", "cli"]
published: false
---
## æ¦‚è¦

PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

## å¯¾å¿œæ–¹æ³•

### è‡ªä½œã—ãŸFunction

```powershell:
Function Read-YesNoResponse {
    param (
        [System.String]$PromptMessage='å‡¦ç†ã‚’ç¶šè¡Œã—ã¾ã™ã‹ï¼Ÿï¼ˆ Yes / No ï¼‰',
        [System.String]$YesMessage='',
        [System.String]$NoMessage='',
        [System.Int32]$MaxAttempts=3
    )

    # å…¥åŠ›ãƒ‘ã‚¿ãƒ¼ãƒ³ã®è¨­å®š
    [System.String]$yesPattern='[Yy][Ee][Ss]|[Yy]'
    [System.String]$noPattern='[Nn][Oo]|[Nn]'

    $isYes = $false

    for ($i = 0; $i -lt $MaxAttempts; $i++) {
        # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›å€¤ã‚’å–å¾—
        $userInput = (Read-Host $PromptMessage)

        # YesãŒé¸æŠžã•ã‚ŒãŸå ´åˆ
        if ($userInput -match $yesPattern) {
            # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã¯å‡ºåŠ›
            if (-not ([System.String]::IsNullOrEmpty($YesMessage))) {
                Write-Output $YesMessage
            }
            $isYes = $true
            break
        }
        # NoãŒé¸æŠžã•ã‚ŒãŸå ´åˆ
        elseif ($userInput -match $noPattern) {
            # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã¯å‡ºåŠ›
            if (-not ([System.String]::IsNullOrEmpty($NoMessage))) {
                Write-Output $NoMessage
            }
            # Noé¸æŠžã—ãŸå ´åˆã¯False
            return $isYes
        }
    }

    # è©¦è¡Œå›žæ•°ãŒè¶…éŽã—ãŸå ´åˆã¯False
    if (-not ($isYes)) {
        Write-Warning "å…¥åŠ›ã®è©¦è¡Œå›žæ•°ã‚’è¶…éŽã—ã¾ã—ãŸã€‚[è©¦è¡Œå›žæ•°: $($MaxAttempts)å›ž]"
        return $isYes
    }

    # Yesé¸æŠžã—ãŸå ´åˆã¯True
    return $isYes
}
```

### å®Ÿéš›ã«å®Ÿè¡Œã—ãŸçµæžœ

```powershell:
# è©¦è¡Œå›žæ•°ã®è¶…éŽ
PS C:\WINDOWS\system32> Read-YesNoResponse
å‡¦ç†ã‚’ç¶šè¡Œã—ã¾ã™ã‹ï¼Ÿï¼ˆ Yes / No ï¼‰:
å‡¦ç†ã‚’ç¶šè¡Œã—ã¾ã™ã‹ï¼Ÿï¼ˆ Yes / No ï¼‰:
å‡¦ç†ã‚’ç¶šè¡Œã—ã¾ã™ã‹ï¼Ÿï¼ˆ Yes / No ï¼‰:
è­¦å‘Š: å…¥åŠ›ã®è©¦è¡Œå›žæ•°ã‚’è¶…éŽã—ã¾ã—ãŸã€‚[è©¦è¡Œå›žæ•°: 3å›ž]
False
PS C:\WINDOWS\system32>
# Yesã‚’é¸æŠž
PS C:\WINDOWS\system32> Read-YesNoResponse
å‡¦ç†ã‚’ç¶šè¡Œã—ã¾ã™ã‹ï¼Ÿï¼ˆ Yes / No ï¼‰: y
True
PS C:\WINDOWS\system32>
# Noã‚’é¸æŠž
PS C:\WINDOWS\system32> Read-YesNoResponse
å‡¦ç†ã‚’ç¶šè¡Œã—ã¾ã™ã‹ï¼Ÿï¼ˆ Yes / No ï¼‰: n
False
PS C:\WINDOWS\system32>
```

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
https://zenn.dev/haretokidoki/articles/fb6830f9155de5
