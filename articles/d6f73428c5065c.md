---
title: "å…¥åŠ›ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å†…å®¹ã¨è©¦è¡Œå›æ•°ã€Yes/Noã§ã®å®Ÿè¡Œã™ã‚‹å†…å®¹ã‚’å¼•ãæ¸¡ã™ã¨å‡¦ç†ã—ã¦ãã‚Œã‚‹Function"
emoji: "ğŸ“"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

ãƒ™ãƒ¼ã‚¹ã¯ã“ã‚Œã€‚

```powershell:
# å…¥åŠ›ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    $userInput = Read-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸Šæ›¸ãã—ã¾ã™ã‹ï¼Ÿ (Yes/No)'
    $yesPatterns = '[Yy][Ee][Ss]|[Yy]'
    $noPatterns = '[Nn][Oo]|[Nn]'
    $isYes = $false
    # è©¦è¡Œå›æ•°: 3å›
    $maxCount = 2
    for ($i = 0; $i -lt $maxCount; $i++) {
        if ($userInput -match $yesPatterns) {
            $isYes = $true    
            break
        }
        else {
            Write-Host 'ä¸Šæ›¸ãä¿å­˜ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸã€‚'
            return
        }
    }
    if (-Not ($isYes)) {
        Write-Warning 'è©¦è¡Œå›æ•°ã‚’è¶…éã—ã¾ã—ãŸã€‚å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã™ã€‚'
        return
    }

    # ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€Œã¯ã„ã€ã‚’é¸æŠã—ãŸå ´åˆã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸Šæ›¸ãä¿å­˜ã—ã¾ã™
    try {
        $markdownTables | Out-File -FilePath $ToMarkdownPath -Encoding utf8
        Write-Host 'ä¸Šæ›¸ãä¿å­˜ã—ã¾ã—ãŸã€‚'
    }
    catch {
        Write-Error 'ä¸Šæ›¸ãä¿å­˜ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚'
    }
}
else {
    # æ–°è¦ä¿å­˜
    try {
        $markdownTables | Out-File -FilePath $ToMarkdownPath -Encoding utf8
        Write-Host "æ–°è¦ä¿å­˜ã—ã¾ã—ãŸã€‚"
    }
    catch {
        Write-Error 'æ–°è¦ä¿å­˜ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚'
    }
}
```

```powershell:
function Read-YesNoResponse {
    param (
        [System.String]$PromptMessage='å‡¦ç†ã‚’ç¶šè¡Œã—ã¾ã™ã‹ï¼Ÿï¼ˆ Yes / No ï¼‰',
        [System.String]$YesMessage='',
        [System.String]$NoMessage='',
        [System.Int32]$MaxAttempts=3
    )

    # å…¥åŠ›ãƒ‘ã‚¿ãƒ¼ãƒ³ã®è¨­å®š
    [System.String]$yesPattern='[Yy][Ee][Ss]|[Yy]'
    [System.String]$noPattern='[Nn][Oo]|[Nn]'

    $isYes = $false

    for ($i = 0; $i -lt $MaxAttempts; $i++) {
        # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›å€¤ã‚’å–å¾—
        $userInput = (Read-Host $PromptMessage)

        # YesãŒé¸æŠã•ã‚ŒãŸå ´åˆ
        if ($userInput -match $yesPattern) {
            # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã¯å‡ºåŠ›
            if ([System.String]::IsNullOrEmpty($YesMessage)) {
                Write-Output $YesMessage
            }
            $isYes = $true
            break
        }
        # NoãŒé¸æŠã•ã‚ŒãŸå ´åˆ
        elseif ($userInput -match $noPattern) {
            # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã¯å‡ºåŠ›
            if ([System.String]::IsNullOrEmpty($NoMessage)) {
                Write-Output $NoMessage
            }
            return $isYes
        }
    }

    if (-not ($isYes)) {
        Write-Warning "å…¥åŠ›ã®è©¦è¡Œå›æ•°ã‚’è¶…éã—ã¾ã—ãŸã€‚[è©¦è¡Œå›æ•°: $($MaxCount)å›]"
    }

    return $isYes
}
```

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
https://zenn.dev/haretokidoki/articles/fb6830f9155de5
