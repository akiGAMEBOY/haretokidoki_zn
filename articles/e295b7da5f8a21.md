---
title: "[Windows]ã‚³ãƒãƒ³ãƒ‰ã§ãƒ‰ãƒ¡ã‚¤ãƒ³å‚åŠ ã®æœ‰ç„¡ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•"
emoji: "ğŸŒ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["windows", "powershell", "cli", "domain"]
published: true
---
## æ¦‚è¦

[ã“ã¡ã‚‰](https://zenn.dev/haretokidoki/articles/fd1eeb92fa4095)ã®è¨˜äº‹ã§ã¯ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ¼ãƒ³ç’°å¢ƒã‚ˆã‚ŠPSSessionã«ã‚ˆã‚‹ãƒªãƒ¢ãƒ¼ãƒˆæ¥ç¶šã‚’å®Ÿæ–½ã—ã¾ã—ãŸã€‚
ãã®éš›ã€ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ¼ãƒ³ç’°å¢ƒã‹ Active Directory ãƒ‰ãƒ¡ã‚¤ãƒ³ç’°å¢ƒã‹ ã§æ‰‹é †ãŒç•°ãªã‚Šã€è¨¼è·¡ã¨ã—ã¦ã‚³ãƒãƒ³ãƒ‰çµæœã§è¼‰ã›ã‚‹å¿…è¦ãŒã‚ã‚‹ã¨è€ƒãˆèª¿ã¹ãŸæƒ…å ±ã‚’å…±æœ‰ã—ã¾ã™ã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- Windowsãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- ã‚³ãƒãƒ³ãƒ‰ã§ãƒ‰ãƒ¡ã‚¤ãƒ³å‚åŠ ã®æœ‰ç„¡ã‚’èª¿ã¹ãŸã„æ–¹

## ãƒ‰ãƒ¡ã‚¤ãƒ³å‚åŠ ã®æœ‰ç„¡ã‚’ç¢ºèªã™ã‚‹ã‚³ãƒãƒ³ãƒ‰

Get-WMIObject ã§ Win32_ComputerSystem ã‚’å‘¼ã³å‡ºã—ã€é …ç›®ã€ŒPartOfDomainã€ã®çµæœãŒ `True` or `False`ã«ã‚ˆã‚Šåˆ¤æ–­ã§ãã¾ã™ã€‚

- True ï¼šãƒ‰ãƒ¡ã‚¤ãƒ³å‚åŠ ä¸­ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³ç’°å¢ƒï¼‰
- Flaseï¼šãƒ‰ãƒ¡ã‚¤ãƒ³ä¸å‚åŠ ï¼ˆã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ¼ãƒ³ç’°å¢ƒï¼‰

```powershell:ã‚³ãƒ”ãƒ¼ç”¨
(Get-WMIObject Win32_ComputerSystem).PartOfDomain
```

```powershell:ç§ã®ç’°å¢ƒã ã¨Falseã®ãŸã‚ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ¼ãƒ³ç’°å¢ƒ
PS C:\WINDOWS\system32> (Get-WMIObject Win32_ComputerSystem).PartOfDomain
False
PS C:\WINDOWS\system32>
```

:::details é …ç›®ã‚’çµã‚‰ãšã«ãã®ã¾ã¾å®Ÿè¡Œã—ãŸéš›ã®çµæœ < ã‚¯ãƒªãƒƒã‚¯ã§æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ã >

```powershell:ã‚³ãƒ”ãƒ¼ç”¨
Get-WMIObject Win32_ComputerSystem
```

```powershell
PS C:\WINDOWS\system32> Get-WMIObject Win32_ComputerSystem


Domain              : "WorkgroupName" ğŸ‘ˆ å€‹äººæƒ…å ±ã®ç‚ºã€é•ã†æ–‡å­—ã«ç½®ãæ›ãˆ
Manufacturer        : "ComputerMaker" ğŸ‘ˆ ã€ƒ
Model               : "ComputerModel" ğŸ‘ˆ ã€ƒ
Name                : "ComputerName"  ğŸ‘ˆ ã€ƒ
PrimaryOwnerName    : "OwnerName"     ğŸ‘ˆ ã€ƒ
TotalPhysicalMemory : 16994529280



PS C:\WINDOWS\system32>
```

:::

## å‚è€ƒæƒ…å ±

- å…¬å¼ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ - Win32_ComputerSystem ã‚¯ãƒ©ã‚¹
    https://learn.microsoft.com/ja-jp/windows/win32/cimwin32prov/win32-computersystem
- ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ³ãƒãƒ¼ã®æœ‰ç„¡ã‚’ç¢ºèª
    https://winscript.jp/powershell/92
    https://www.vwnet.jp/windows/PowerShell/CheckDomainName.htm

## ã¾ã¨ã‚

åŸºæœ¬ã€ã”è‡ªèº«ã®ç’°å¢ƒã‚’ä½¿ç”¨ã™ã‚‹ç‚ºã€åˆ©ç”¨ã™ã‚‹æ©Ÿä¼šã¯å°‘ãªã„ã¨æ€ã„ã¾ã™ãŒã€
PowerShellã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€Get-WMIObjectã‚’ä½¿ã„ãƒ‰ãƒ¡ã‚¤ãƒ³å‚åŠ çŠ¶æ³ã‚’ç¢ºèªã§ãã¾ã—ãŸã€‚

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
