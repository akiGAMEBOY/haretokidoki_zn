---
title: "PowerShellでテキストファイル内容の有無をチェックするFunction"
emoji: "👻"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["powershell"]
published: false
---
ファイルが存在するかは、`Test-Path` を使って実施するが、データの中身を検証するコマンドレットはない為、
Functionを自作。

結構、ありふれた処理となる為、わたしが書かなくても問題ないと思っていたが、
別記事で、このFunctionを作る機会があり、どうせなら個別記事にしようと思い投稿。

```powershell:自作したFunction「Test-FileHasContents」
function Test-FileHasContents {
    param (
        [System.String]$Path
    )

    $fileContents = Get-Content $Path

    if ([System.String]::IsNullOrWhiteSpace($fileContents)) {
        $isContent = $false
    }
    else {
        $isContent = $true
    }

    return $isContent
}
```

```:中身のないテキストファイル「D:\Downloads\WithNoContent.txt」
```

```powershell:中身のないテキストファイルで検証
# 使い方
$targetFile = 'D:\Downloads\WithNoContent.txt'
if (Test-FileHasContents $targetFile) {
    Write-Host 'ファイルの中身が存在する'
}
else {
    Write-Host 'ファイルの中身が存在しない'
}
```

中身のないテキストファイルで期待通り動作を確認。

```powershell:実際の実行結果
PS C:\Users\"ユーザー名"> $targetFile = 'D:\Downloads\WithNoContent.txt'
>> if (Test-FileHasContents $targetFile) {
>>     Write-Host 'ファイルの中身が存在する'
>> }
>> else {
>>     Write-Host 'ファイルの中身が存在しない'
>> }
ファイルの中身が存在しない
PS C:\Users\"ユーザー名">
```

```:中身のあるテキストファイル「D:\Downloads\WithContents.txt」
aaa
```

```powershell:中身のあるテキストファイルで検証
$targetFile = 'D:\Downloads\WithContents.txt'
if (Test-FileHasContents $targetFile) {
    Write-Host 'ファイルの中身が存在する'
}
else {
    Write-Host 'ファイルの中身が存在しない'
}
```

中身のあるテキストファイルで期待通り動作を確認。

```powershell:実際の実行結果
PS C:\Users\"ユーザー名"> $targetFile = 'D:\Downloads\WithContents.txt'
>> if (Test-FileHasContents $targetFile) {
>>     Write-Host 'ファイルの中身が存在する'
>> }
>> else {
>>     Write-Host 'ファイルの中身が存在しない'
>> }
ファイルの中身が存在する
PS C:\Users\"ユーザー名">
```
