---
title: "PowerShellã§æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹Function"
emoji: "ğŸ‘»"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---
## æ¦‚è¦

ãƒ•ã‚¡ã‚¤ãƒ«ãã®ã‚‚ã®ãŒå­˜åœ¨ã™ã‚‹ã‹ã«ã¤ã„ã¦ã¯ã€æ¨™æº–ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€`Test-Path` ã«ã‚ˆã‚Šåˆ¤å®šã§ãã¾ã™ãŒã€
ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ã‚’ç¢ºèªã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

ãŠãã‚‰ãæ¤œç´¢ã™ã‚Œã°æ•°å¤šãä»–ã®è¨˜äº‹ãŒã‚ã‚Šãã†ãªå†…å®¹ã ã£ãŸç‚ºã€ã“ã‚Œã¾ã§è¨˜äº‹ã‚’ä½œæˆã—ã¦ã„ã¾ã›ã‚“ã§ã—ãŸãŒã€
åˆ¥ã®è¨˜äº‹ã§ã“ã®Functionã‚’ä½¿ã†ç”¨é€”ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚

ã©ã†ã›ãªã‚‰ã€è‡ªèº«ãŒæ±ºã‚ãŸå‘½åè¦å‰‡ã‚„å‡¦ç†å†…å®¹ã§Functionã‚’è‡ªä½œã—ã‚ˆã†ã¨æ€ã„ã€ã“ã®è¨˜äº‹ã‚’æŠ•ç¨¿ã—ã¾ã™ã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- PowerShellãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- å‡¦ç†å‰ã«ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã—ãŸã„æ–¹

## è‡ªä½œã—ãŸFunction

ã“ã®Functionã‚’å®Ÿè¡Œã™ã‚‹å‰ææ¡ä»¶ã¯ã€ã€Œå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ãã®ã‚‚ã®ã¯å­˜åœ¨ã™ã‚‹ã“ã¨ã€ã¨ãªã‚Šã¾ã™ã€‚
ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«è‡ªä½“ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã¯ã€`Test-Path`ã§å®Ÿç¾å¯èƒ½ã€‚ï¼‰

```powershell:Test-FileHasContent
function Test-FileHasContent {
    param (
        [System.String]$Path
    )

    try {
        $fileContents = (Get-Content $Path)
    }
    catch {
        Write-Error 'ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã‚’èª­ã¿è¾¼ã‚€éš›ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚'
        return $false
    }

    # Null ã¾ãŸã¯ ç©ºæ–‡å­—ã€ç©ºç™½ã®ã¿ã ã£ãŸå ´åˆã¯ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãªã—ã®åˆ¤å®š
    return (-not ([System.String]::IsNullOrWhiteSpace($fileContents)))
}
```

ã“ã® `Test-FileHasContent` ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€å¼•æ•°ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ã‚’ç¢ºèªã—ã€
C#ã®ãƒ¡ã‚½ãƒƒãƒ‰ã€`IsNullOrWhiteSpace`ã§ã¯ã€Null ã¾ãŸã¯ ç©ºæ–‡å­—ã€ç©ºç™½ã®ã¿ã§æ§‹æˆã•ã‚ŒãŸå†…å®¹ã ã£ãŸå ´åˆã€
Boolã®Trueã‚’è¿”ã•ã‚Œã¾ã™ã€‚

ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ãŸçµæœã‚’æˆ»ã‚Šå€¤ã¨ã—ã¦è¨­å®šã—ã¦ã„ã¾ã™ã€‚

## è‡ªä½œFunctionã®æ¤œè¨¼

### æ¤œè¨¼æ–¹æ³•

ãƒ†ã‚¹ãƒˆç”¨ã« ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ« ã¨ ãƒ‡ãƒ¼ã‚¿ã®ãªã„ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ« ã€
2ç¨®é¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æº–å‚™ã—ã¦è‡ªä½œã—ãŸFunctionãŒæ­£å¸¸å‹•ä½œã™ã‚‹ã‹ãƒ†ã‚¹ãƒˆã—ã¾ã—ãŸã€‚

### ä¸­èº«ãŒå­˜åœ¨ã—ãªã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¯¾è±¡ã«Functionã‚’å®Ÿè¡Œ

```:ä¸­èº«ã®ãªã„ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã€ŒD:\Downloads\WithNoContent.txtã€
ï¼ˆâ€» ä¸­èº«ãŒãªã„çŠ¶æ…‹ï¼‰
```

```powershell:æ¤œè¨¼ã—ãŸã‚³ãƒ¼ãƒ‰ï¼ˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãªã—ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰
# ä¸­èº«ãŒãªã„ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¨­å®š
$targetFile = 'D:\Downloads\WithNoContent.txt'
if (Test-FileHasContent $targetFile) {
    Write-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã™ã‚‹'
}
else {
    Write-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã—ãªã„'
}
```

```powershell:å®Ÿéš›ã®å®Ÿè¡Œçµæœ
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $targetFile = 'D:\Downloads\WithNoContent.txt'
>> if (Test-FileHasContent $targetFile) {
>>     Write-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã™ã‚‹'
>> }
>> else {
>>     Write-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã—ãªã„'
>> }
ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã—ãªã„
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

ä¸Šè¨˜ã®çµæœã®ã¨ãŠã‚Šã€ä¸­èº«ã®ãªã„ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§è‡ªä½œFunctionã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€
æœŸå¾…é€šã‚Š Falseåˆ¤å®š ã¨ãªã‚Šã¾ã—ãŸã€‚

### ä¸­èº«ãŒå­˜åœ¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¯¾è±¡ã«Functionã‚’å®Ÿè¡Œ

```:ä¸­èº«ã®ã‚ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã€ŒD:\Downloads\WithContents.txtã€
aaa
```

```powershell:æ¤œè¨¼ã—ãŸã‚³ãƒ¼ãƒ‰ï¼ˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚ã‚Šãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰
# ä¸­èº«ãŒã‚ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¨­å®š
$targetFile = 'D:\Downloads\WithContents.txt'
if (Test-FileHasContent $targetFile) {
    Write-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã™ã‚‹'
}
else {
    Write-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã—ãªã„'
}
```

```powershell:å®Ÿéš›ã®å®Ÿè¡Œçµæœ
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $targetFile = 'D:\Downloads\WithContents.txt'
>> if (Test-FileHasContent $targetFile) {
>>     Write-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã™ã‚‹'
>> }
>> else {
>>     Write-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã—ãªã„'
>> }
ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã™ã‚‹
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

ä¸Šè¨˜ã®çµæœã®ã¨ãŠã‚Šã€ä¸­èº«ã®ã‚ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§æœŸå¾…é€šã‚Šå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèªã€‚

## ã¾ã¨ã‚

- ãƒ•ã‚¡ã‚¤ãƒ«è‡ªä½“ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã¯æ¨™æº–ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®ã€Œ`Test-Path`ã€ã§å¯¾å¿œ
- è‡ªä½œã—ãŸFunctionã€Œ`Test-FileHasContent`ã€ã§ãƒ•ã‚¡ã‚¤ãƒ«ä¸­èº«ã®æœ‰ç„¡ã‚’ãƒã‚§ãƒƒã‚¯å¯èƒ½

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
https://zenn.dev/haretokidoki/articles/fb6830f9155de5
