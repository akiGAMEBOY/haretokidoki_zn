---
title: "PowerShellã§ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã®æœ‰ç„¡ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹Function"
emoji: "ðŸ‘»"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---
ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹ã‹ã¯ã€`Test-Path` ã‚’ä½¿ã£ã¦å®Ÿæ–½ã™ã‚‹ãŒã€ãƒ‡ãƒ¼ã‚¿ã®ä¸­èº«ã‚’æ¤œè¨¼ã™ã‚‹ã‚³ãƒžãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ãªã„ç‚ºã€
Functionã‚’è‡ªä½œã€‚

çµæ§‹ã€ã‚ã‚Šãµã‚ŒãŸå‡¦ç†ã¨ãªã‚‹ç‚ºã€ã‚ãŸã—ãŒæ›¸ã‹ãªãã¦ã‚‚å•é¡Œãªã„ã¨æ€ã£ã¦ã„ãŸãŒã€
åˆ¥è¨˜äº‹ã§ã€ã“ã®Functionã‚’ä½œã‚‹æ©Ÿä¼šãŒã‚ã‚Šã€ã©ã†ã›ãªã‚‰å€‹åˆ¥è¨˜äº‹ã«ã—ã‚ˆã†ã¨æ€ã„æŠ•ç¨¿ã€‚

```powershell:è‡ªä½œã—ãŸFunctionã€ŒTest-FileHasContentsã€
function Test-FileHasContents {
    param (
        [System.String]$Path
    )

    $fileContents = Get-Content $Path

    if ([System.String]::IsNullOrWhiteSpace($fileContents)) {
        $isContent = $false
    }
    else {
        $isContent = $true
    }

    return $isContent
}
```

```:ä¸­èº«ã®ãªã„ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã€ŒD:\Downloads\WithNoContent.txtã€
```

```powershell:ä¸­èº«ã®ãªã„ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§æ¤œè¨¼
# ä½¿ã„æ–¹
$targetFile = 'D:\Downloads\WithNoContent.txt'
if (Test-FileHasContents $targetFile) {
    Write-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã™ã‚‹'
}
else {
    Write-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã—ãªã„'
}
```

ä¸­èº«ã®ãªã„ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§æœŸå¾…é€šã‚Šå‹•ä½œã‚’ç¢ºèªã€‚

```powershell:å®Ÿéš›ã®å®Ÿè¡Œçµæžœ
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $targetFile = 'D:\Downloads\WithNoContent.txt'
>> if (Test-FileHasContents $targetFile) {
>>     Write-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã™ã‚‹'
>> }
>> else {
>>     Write-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã—ãªã„'
>> }
ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã—ãªã„
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

```:ä¸­èº«ã®ã‚ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã€ŒD:\Downloads\WithContents.txtã€
aaa
```

```powershell:ä¸­èº«ã®ã‚ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§æ¤œè¨¼
$targetFile = 'D:\Downloads\WithContents.txt'
if (Test-FileHasContents $targetFile) {
    Write-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã™ã‚‹'
}
else {
    Write-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã—ãªã„'
}
```

ä¸­èº«ã®ã‚ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§æœŸå¾…é€šã‚Šå‹•ä½œã‚’ç¢ºèªã€‚

```powershell:å®Ÿéš›ã®å®Ÿè¡Œçµæžœ
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $targetFile = 'D:\Downloads\WithContents.txt'
>> if (Test-FileHasContents $targetFile) {
>>     Write-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã™ã‚‹'
>> }
>> else {
>>     Write-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã—ãªã„'
>> }
ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã™ã‚‹
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```
