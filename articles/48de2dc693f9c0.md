---
title: "[Windowsã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°]æ—¢å­˜ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’ã‚³ãƒãƒ³ãƒ‰ã§ç¢ºèªã™ã‚‹æ–¹æ³•"
emoji: "ğŸš¨"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["windows", "powershell"]
published: false
---
## ç’°å¢ƒ

Windows æ¨™æº–ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ PowerShell ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 5.1 ã® Desktop Editionã‚„
PowerShell ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 6.0 ä»¥é™ã® Core Editionï¼ˆã¾ãŸã®åã‚’PowerShell Coreï¼‰ã§
ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã®æ›¸ãè¾¼ã¿ãŒå¯èƒ½ã§ã™ã€‚

> â€» PowerShell 5.1ã§ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã«å‡ºåŠ›ã™ã‚‹æ–¹æ³•ã¯ã€[ã“ã¡ã‚‰](https://zenn.dev/haretokidoki/articles/0a179fe71a2cc8)ã®è¨˜äº‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
> â€» PowerShell 6.0ä»¥é™ã§ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã«å‡ºåŠ›ã™ã‚‹æ–¹æ³•ã¯ã€[ã“ã¡ã‚‰](https://zenn.dev/haretokidoki/articles/af3e404855c54b)ã®è¨˜äº‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

ç®¡ç†è€…æ¨©é™ã‚’æŒãŸãªã„ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã‚’å‡ºåŠ›ã™ã‚‹å ´åˆã€Windows OS ã«ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ï¼‰ã‚„ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’èª¿ã¹ã‚‹å¿…è¦ãŒã‚ã‚Šã€
PowerShellã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã§ç¢ºèªã™ã‚‹æ–¹æ³•ã‚’è¦‹ã¤ã‘ã¾ã—ãŸã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- PowerShellãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
    æ¤œè¨¼ã¯ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 5.1 ã¨ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 7.4 ã§å®Ÿæ–½ã€‚ãŠãã‚‰ãã€5.1 ä»¥é™ã§ã‚ã‚Œã°å¯¾å¿œå¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰

- Windows OS ã§æ—¢å­˜ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ï¼‰ã‚„ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’èª¿ã¹ãŸã„æ–¹

### ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 5.1

```powershell:Desktop Edition
PS C:\WINDOWS\system32> $PSVersionTable

Name                           Value
----                           -----
PSVersion                      5.1.19041.4046
PSEdition                      Desktop
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}
BuildVersion                   10.0.19041.4046
CLRVersion                     4.0.30319.42000
WSManStackVersion              3.0
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1


PS C:\WINDOWS\system32>
```

### ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 7.4

```powershell:Core Edition
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $PSVersionTable

Name                           Value
----                           -----
PSVersion                      7.4.1
PSEdition                      Core
GitCommitId                    7.4.1
OS                             Microsoft Windows 10.0.19045
Platform                       Win32NT
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0â€¦}
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1
WSManStackVersion              3.0

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

## ç¢ºèªæ–¹æ³•

### æ—¢å­˜ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•

```powershell:æ—¢å­˜ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã‚’å–å¾—
# Get-WinEventã§ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã‚’ç¢ºèª â†’ Format-Tableã§è¡¨å½¢å¼ã«å¤‰æ›´ â†’ Outï¼File -Width ã§æ¨ªã®æœ€å¤§æ–‡å­—æ•°ã‚’è¨­å®š
Get-WinEvent -ListProvider * -Erroraction Silentlycontinue | Format-Table -AutoSize -Wrap | Out-File -filepath "å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ¶å¯¾ãƒ‘ã‚¹" -Width "è¡Œã®æœ€å¤§æ–‡å­—æ•°"
# å‡ºåŠ›ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
Get-Content "å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ¶å¯¾ãƒ‘ã‚¹"
```

```powershell:å®Ÿéš›ã«å®Ÿè¡Œã—ãŸçµæœ
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-WinEvent -ListProvider * -Erroraction Silentlycontinue | Format-Table -AutoSize -Wrap | Out-File -filepath D:\Downloads\getwinevent-listproviders-all.txt -Width 10000
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-Content D:\Downloads\getwinevent-listproviders-all.txt

Name                                                                       LogLinks                                                                                                                                                                                                                                                                                                                     
----                                                                       --------                                                                                                                                                                                                                                                                                                                     
PowerShell                                                                 {Windows PowerShell}                                                                                                                                                                                                                                                                                                         
Visual Studio Audit Log                                                    {Visual Studio}                                                                                                                                                                                                                                                                                                              
Visual Studio                                                              {Visual Studio}                                                                                                                                                                                                                                                                                                              

ï½ï½ï½ çœç•¥ ï½ï½ï½

Microsoft-IE                                                               {Microsoft-IE/Diagnostic, Microsoft-Windows-WebPlatStorage-Server}                                                                                                                                                                                                                                                           
Microsoft-Windows-MF-FrameServer                                           {MF_MediaFoundationFrameServer}                                                                                                                                                                                                                                                                                              
Microsoft-Windows-WebcamExperience                                         {Microsoft-Windows-WebcamProvider/Analytic}                                                                                                                                                                                                                                                                                  
Microsoft-Windows-Sensors-Core-Performance                                 {}                                                                                                                                                                                                                                                                                                                           
Microsoft-Windows-IdleTriggerProvider                                      {}                                                                                                                                                                                                                                                                                                                           
Microsoft-Windows-FunctionDiscovery                                        {Analytic}                                                                                                                                                                                                                                                                                                                   
Microsoft-Windows-Winsrv                                                   {Application, Microsoft-Windows-Winsrv/Analytic}                                                                                                                                                                                                                                                                             
Microsoft-AppV-ServiceLog                                                  {Microsoft-AppV-Client/Debug}                                                                                                                                                                                                                                                                                                
Microsoft-Windows-EapMethods-RasTls                                        {Microsoft-Windows-EapMethods-RasTls/Operational}                                                                                                                                                                                                                                                                            
Microsoft-Windows-Store                                                    {Microsoft-Windows-Store/Operational}                                                                                                                                                                                                                                                                                        

ï½ï½ï½ çœç•¥ ï½ï½ï½

Microsoft-Windows-ErrorReportingConsole                                    {}                                                                                                                                                                                                                                                                                                                           
Microsoft-Windows-VAN                                                      {Microsoft-Windows-VAN/Diagnostic}                                                                                                                                                                                                                                                                                           
Microsoft-Windows-ParentalControls                                         {Microsoft-Windows-ParentalControls/Operational}                                                                                                                                                                                                                                                                             
Microsoft-Windows-Security-IdentityStore                                   {Microsoft-Windows-Security-IdentityStore/Performance}                                                                                                                                                                                                                                                                       
Microsoft-Windows-Services                                                 {Microsoft-Windows-Services/Diagnostic}                                                                                                                                                                                                                                                                                      




PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

### æ—¢å­˜ã®ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’ç¢ºèªã™ã‚‹æ–¹æ³•

#### æŒ‡å®šã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã§ç™»éŒ²æ¸ˆã¿ã®ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’ç¢ºèª

```powershell:æŒ‡å®šã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã§ç™»éŒ²æ¸ˆã¿ã®ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’å–å¾—
# Get-WinEventã§ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’ç¢ºèª â†’ Format-Tableã§è¡¨å½¢å¼ã«å¤‰æ›´ â†’ Outï¼File -Width ã§æ¨ªã®æœ€å¤§æ–‡å­—æ•°ã‚’è¨­å®š
(Get-WinEvent -ListProvider "å¯¾è±¡ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹").Events | Format-Table Id, Description -AutoSize -Wrap | Out-File -filepath "å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ¶å¯¾ãƒ‘ã‚¹" -Width "è¡Œã®æœ€å¤§æ–‡å­—æ•°"
# å‡ºåŠ›ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
Get-Content "å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ¶å¯¾ãƒ‘ã‚¹"
```

```powershell:å®Ÿéš›ã«å®Ÿè¡Œã—ãŸçµæœ
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> (Get-WinEvent -ListProvider "Microsoft-Windows-Winsrv").Events | Format-Table Id, Description -AutoSize -Wrap | Out-File -filepath D:\Downloads\getwinevent-winsrv-eventid.txt -Width 10000
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-Content D:\Downloads\getwinevent-winsrv-eventid.txt

Id Description
-- -----------
10001 æ¬¡ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚Šã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸ: %1ã€‚
10002 æ¬¡ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯åœæ­¢ã—ãŸãŸã‚ã«çµ‚äº†ã—ã¾ã—ãŸ: %1ã€‚
12001
12001
12002
12002
12003
12003
12005
12005
12006
12006
12007
12007
12008
12008
12009
12010
12011
12012

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

#### ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’ç™»éŒ²ã—ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ã¿ç¢ºèªã™ã‚‹æ–¹æ³•

ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã®ä¸­ã«ã¯ã€ã‚¤ãƒ™ãƒ³ãƒˆIDãŒç™»éŒ²ã•ã‚Œã¦ã„ãªã„ãƒ‡ãƒ¼ã‚¿ã‚‚ã‚ã‚Šã¾ã™ã€‚
ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã‚’å‡ºåŠ›ã™ã‚‹å ´åˆã€ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã¨ãã®ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã§ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ç‚ºã€
ã‚¤ãƒ™ãƒ³ãƒˆIDãŒç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹æ–¹æ³•ã‚‚èª¿ã¹ã¾ã—ãŸã€‚

```powershell:ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’ç™»éŒ²ã—ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ã¿å–å¾—
# å…¨ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ï¼‰ã‚’å–å¾— â†’ ã‚¤ãƒ™ãƒ³ãƒˆIDãŒç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’æŠ½å‡º â†’ Outï¼File -Width ã§æ¨ªã®æœ€å¤§æ–‡å­—æ•°ã‚’è¨­å®š
Get-WinEvent -ListProvider * -Erroraction Silentlycontinue | Select-Object Name -ExpandProperty Events | Format-Table Name, ID, Description | Out-File -filepath "å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ¶å¯¾ãƒ‘ã‚¹" -Width "è¡Œã®æœ€å¤§æ–‡å­—æ•°"
# å‡ºåŠ›ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
Get-Content "å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ¶å¯¾ãƒ‘ã‚¹"
```

```powershell:å®Ÿéš›ã«å®Ÿè¡Œã—ãŸçµæœ
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-WinEvent -ListProvider * -Erroraction Silentlycontinue | Select-Object Name -ExpandProperty Events | Format-Table Name, ID, Description | Out-File -filepath D:\Downloads\getwinevent-all-eventid.txt -Width 10000
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-Content D:\Downloads\getwinevent-all-eventid.txt

Name                                                  Id Description
----                                                  -- -----------
Ntfs                                                  55 ãƒœãƒªãƒ¥ãƒ¼ãƒ  %1 ã®ãƒ•ã‚¡ã‚¤ãƒ« ã‚·ã‚¹ãƒ†ãƒ æ§‹é€ ã§ç ´æãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸã€‚â€¦
Ntfs                                                 130 ãƒœãƒªãƒ¥ãƒ¼ãƒ  %2 ã®ãƒ•ã‚¡ã‚¤ãƒ« ã‚·ã‚¹ãƒ†ãƒ æ§‹é€ ã¯ä¿®å¾©ã•ã‚Œã¾ã—ãŸã€‚
Ntfs                                                 131 ãƒœãƒªãƒ¥ãƒ¼ãƒ  %2 ã®ãƒ•ã‚¡ã‚¤ãƒ« ã‚·ã‚¹ãƒ†ãƒ æ§‹é€ ã¯ä¿®æ­£ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚â€¦
Ntfs                                                 132 çŸ­æ™‚é–“ã®é–“ã«ä¿®å¾©ã‚¤ãƒ™ãƒ³ãƒˆãŒæ•°å¤šãç™ºç”Ÿã—ã¾ã—ãŸã€‚â€¦
Ntfs                                                 133 %1 ã®ä¿®å¾©ã‚¤ãƒ™ãƒ³ãƒˆã®é€ä¿¡ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã—ãŸã€‚ä¿®å¾©ã‚¤ãƒ™ãƒ³ãƒˆã®é€ä¿¡ã¯å†é–‹ã•ã‚Œã¾ã™ã€‚â€¦
PowerShellCore                                      4097 Computer Name $null or . resolve to LocalHost

ï½ï½ï½ çœç•¥ ï½ï½ï½

Microsoft-Windows-Services                           203
Microsoft-Windows-Services                           204
Microsoft-Windows-Services                           205

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

## å‚è€ƒæƒ…å ±

[å‚è€ƒæƒ…å ±ï¼šè¦‹åˆ‡ã‚ŒãŸã‚Šæ”¹è¡Œã—ãŸã‚Šã™ã‚‹æ¨ªé•·ã®ã‚³ãƒãƒ³ãƒ‰çµæœã‚’æŠ˜ã‚Šè¿”ã—ã›ãšã«ç¢ºèªã™ã‚‹æ–¹æ³•](https://t-dilemma.info/windows-powershell-format/)

## ã¾ã¨ã‚

- æ—¢å­˜ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã‚’ç¢ºèªã™ã‚‹ã‚³ãƒãƒ³ãƒ‰

    ```powershell:æ—¢å­˜ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã‚’å–å¾—
    Get-WinEvent -ListProvider * -Erroraction Silentlycontinue | Format-Table -AutoSize -Wrap | Out-File -filepath "å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ¶å¯¾ãƒ‘ã‚¹" -Width "è¡Œã®æœ€å¤§æ–‡å­—æ•°"
    ```

- æ—¢å­˜ã®ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’ç¢ºèªã™ã‚‹ã‚³ãƒãƒ³ãƒ‰
    - æŒ‡å®šã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã§ç™»éŒ²æ¸ˆã¿ã®ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’ç¢ºèªã™ã‚‹ã‚³ãƒãƒ³ãƒ‰
        
        ```powershell:æŒ‡å®šã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ã§ç™»éŒ²æ¸ˆã¿ã®ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’
        (Get-WinEvent -ListProvider "å¯¾è±¡ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚¹").Events | Format-Table Id, Description -AutoSize -Wrap | Out-File -filepath "å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ¶å¯¾ãƒ‘ã‚¹" -Width "è¡Œã®æœ€å¤§æ–‡å­—æ•°"
        ```

    - ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’ç™»éŒ²ã—ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ã¿ç¢ºèªã™ã‚‹ã‚³ãƒãƒ³ãƒ‰

        ```powershell:ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’ç™»éŒ²ã—ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ã¿å–å¾—
        Get-WinEvent -ListProvider * -Erroraction Silentlycontinue | Select-Object Name -ExpandProperty Events | Format-Table Name, ID, Description | Out-File -filepath "å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ¶å¯¾ãƒ‘ã‚¹" -Width "è¡Œã®æœ€å¤§æ–‡å­—æ•°"
        ```

## é–¢é€£è¨˜äº‹

https://zenn.dev/haretokidoki/articles/0a179fe71a2cc8
https://zenn.dev/haretokidoki/articles/af3e404855c54b
https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
