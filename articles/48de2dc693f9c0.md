---
title: "イベントログで登録済みのイベントソース・イベントIDを確認する方法"
emoji: "🐥"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["windows"]
published: false
---


## 確認方法

### 登録済みのイベントソースを確認する方法

```powershell:登録済みのイベントソースを確認
# Get-WinEventでイベントソースを確認 → Format-Tableで表形式に変更 → Out－File -Width で横の最大文字数を設定
Get-WinEvent -ListProvider * -Erroraction Silentlycontinue | Format-Table -AutoSize -Wrap | Out-File -filepath "出力ファイルの絶対パス" -Width "行の最大文字数"
# 出力したファイルを確認
Get-Content "出力ファイルの絶対パス"
```

```powershell:実際に実行した結果
PS C:\Users\"ユーザー名"> Get-WinEvent -ListProvider * -Erroraction Silentlycontinue | Format-Table -AutoSize -Wrap | Out-File -filepath D:\Downloads\getwinevent-listproviders-all.txt -Width 10000
PS C:\Users\"ユーザー名">
PS C:\Users\"ユーザー名"> Get-Content D:\Downloads\getwinevent-listproviders-all.txt

Name                                                                       LogLinks                                                                                                                                                                                                                                                                                                                     
----                                                                       --------                                                                                                                                                                                                                                                                                                                     
PowerShell                                                                 {Windows PowerShell}                                                                                                                                                                                                                                                                                                         
Visual Studio Audit Log                                                    {Visual Studio}                                                                                                                                                                                                                                                                                                              
Visual Studio                                                              {Visual Studio}                                                                                                                                                                                                                                                                                                              

～～～ 省略 ～～～

Microsoft-IE                                                               {Microsoft-IE/Diagnostic, Microsoft-Windows-WebPlatStorage-Server}                                                                                                                                                                                                                                                           
Microsoft-Windows-MF-FrameServer                                           {MF_MediaFoundationFrameServer}                                                                                                                                                                                                                                                                                              
Microsoft-Windows-WebcamExperience                                         {Microsoft-Windows-WebcamProvider/Analytic}                                                                                                                                                                                                                                                                                  
Microsoft-Windows-Sensors-Core-Performance                                 {}                                                                                                                                                                                                                                                                                                                           
Microsoft-Windows-IdleTriggerProvider                                      {}                                                                                                                                                                                                                                                                                                                           
Microsoft-Windows-FunctionDiscovery                                        {Analytic}                                                                                                                                                                                                                                                                                                                   
Microsoft-Windows-Winsrv                                                   {Application, Microsoft-Windows-Winsrv/Analytic}                                                                                                                                                                                                                                                                             
Microsoft-AppV-ServiceLog                                                  {Microsoft-AppV-Client/Debug}                                                                                                                                                                                                                                                                                                
Microsoft-Windows-EapMethods-RasTls                                        {Microsoft-Windows-EapMethods-RasTls/Operational}                                                                                                                                                                                                                                                                            
Microsoft-Windows-Store                                                    {Microsoft-Windows-Store/Operational}                                                                                                                                                                                                                                                                                        

～～～ 省略 ～～～

Microsoft-Windows-ErrorReportingConsole                                    {}                                                                                                                                                                                                                                                                                                                           
Microsoft-Windows-VAN                                                      {Microsoft-Windows-VAN/Diagnostic}                                                                                                                                                                                                                                                                                           
Microsoft-Windows-ParentalControls                                         {Microsoft-Windows-ParentalControls/Operational}                                                                                                                                                                                                                                                                             
Microsoft-Windows-Security-IdentityStore                                   {Microsoft-Windows-Security-IdentityStore/Performance}                                                                                                                                                                                                                                                                       
Microsoft-Windows-Services                                                 {Microsoft-Windows-Services/Diagnostic}                                                                                                                                                                                                                                                                                      




PS C:\Users\"ユーザー名">
```

### 登録済みのイベントIDを確認する方法

#### 指定したイベントソースに登録されているイベントIDを取得

```powershell:指定したイベントソースに登録されているイベントIDを取得
# Get-WinEventでイベントIDを確認 → Format-Tableで表形式に変更 → Out－File -Width で横の最大文字数を設定
(Get-WinEvent -ListProvider "対象のイベントソース").Events | Format-Table Id, Description -AutoSize -Wrap | Out-File -filepath "出力ファイルの絶対パス" -Width "行の最大文字数"
# 出力したファイルを確認
Get-Content "出力ファイルの絶対パス"
```

```powershell:実際に実行した結果
PS C:\Users\"ユーザー名"> (Get-WinEvent -ListProvider "Microsoft-Windows-Winsrv").Events | Format-Table Id, Description -AutoSize -Wrap | Out-File -filepath D:\Downloads\getwinevent-winsrv-eventid.txt -Width 10000
PS C:\Users\"ユーザー名">
PS C:\Users\"ユーザー名"> Get-Content D:\Downloads\getwinevent-winsrv-eventid.txt

Id Description
-- -----------
10001 次のアプリケーションによりシャットダウンが拒否されました: %1。
10002 次のアプリケーションは停止したために終了しました: %1。
12001
12001
12002
12002
12003
12003
12005
12005
12006
12006
12007
12007
12008
12008
12009
12010
12011
12012

PS C:\Users\"ユーザー名">
```

#### イベントIDを登録しているデータのみを取得する方法

```powershell:イベントIDを登録しているデータのみを取得
# 全イベントソース（イベントプロバイダー）を取得 → イベントIDが登録されているデータのみを抽出 → Out－File -Width で横の最大文字数を設定
Get-WinEvent -ListProvider * -Erroraction Silentlycontinue | Select-Object Name -ExpandProperty Events | Format-Table Name, ID, Description | Out-File -filepath "出力ファイルの絶対パス" -Width "行の最大文字数"
# 出力したファイルを確認
Get-Content "出力ファイルの絶対パス"
```

```powershell:実際に実行した結果
PS C:\Users\"ユーザー名"> Get-WinEvent -ListProvider * -Erroraction Silentlycontinue | Select-Object Name -ExpandProperty Events | Format-Table Name, ID, Description | Out-File -filepath D:\Downloads\getwinevent-all-eventid.txt -Width 10000
PS C:\Users\"ユーザー名">
PS C:\Users\"ユーザー名"> Get-Content D:\Downloads\getwinevent-all-eventid.txt

Name                                                  Id Description
----                                                  -- -----------
Ntfs                                                  55 ボリューム %1 のファイル システム構造で破損が検出されました。…
Ntfs                                                 130 ボリューム %2 のファイル システム構造は修復されました。
Ntfs                                                 131 ボリューム %2 のファイル システム構造は修正できませんでした。…
Ntfs                                                 132 短時間の間に修復イベントが数多く発生しました。…
Ntfs                                                 133 %1 の修復イベントの送信をスキップしました。修復イベントの送信は再開されます。…
PowerShellCore                                      4097 Computer Name $null or . resolve to LocalHost

～～～ 省略 ～～～

Microsoft-Windows-Services                           203
Microsoft-Windows-Services                           204
Microsoft-Windows-Services                           205

PS C:\Users\"ユーザー名">
```

## 参考情報

[参考情報：見切れたり改行したりする横長のコマンド結果を折り返しせずに確認する方法](https://t-dilemma.info/windows-powershell-format/)

## まとめ

- 