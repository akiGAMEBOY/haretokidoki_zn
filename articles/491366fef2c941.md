---
title: "[PowerShell]ç¾åœ¨ã®HTTPé€šä¿¡ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•"
emoji: "ðŸ“Œ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell", "http", "security"]
published: false
---

PowerShell 5.1 ã®åˆæœŸå€¤ã¯ã€ã€ŒSSL 3.0, TSL 1.0ã€ã§é€šä¿¡ã™ã‚‹ãŒã€
æœ€æ–°ã®Webã‚µãƒ¼ãƒãƒ¼ã¨HTTPé€šä¿¡ã‚’è¡Œã†å ´åˆã¯ã€è¦æ ¼ãŒå¤ã„ç‚ºã€ã‚¨ãƒ©ãƒ¼ã¨ãªã£ã¦ã—ã¾ã™ã€‚

HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½¿ç”¨ã—ã¦ç¾åœ¨ã®TLSãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•

```powershell
$url = "https://check-tls.akamai.io/v1/tlsinfo.json"
$result = Invoke-WebRequest -Uri $url
$result.Content
```

```powershell
PS C:\Users\XXXX> $url = "https://check-tls.akamai.io/v1/tlsinfo.json"
>> $result = Invoke-WebRequest -Uri $url
>> $result.Content
{






"tls_sni_status": "present",
"scheme": "https",
"tls_version": "tls1.2",
"tls_sni_value": "check-tls.akamai.io",
"host_header_value": "check-tls.akamai.io",
"tls_cipher_name": "ECDHE-RSA-AES256-GCM-SHA384",
"alpn": "",
"client_ip": "XXX.XXX.XXX.XXX",
"client_ip_version": "ipv4",
"client_port": 60507,
"user_agent": "Mozilla%2f5.0%20(Windows%20NT%3b%20Windows%20NT%2010.0%3b%20ja-JP)%20WindowsPowerShell%2f5.1.19041.4648",
"output_version": "0.1.21",
"timestamp": 1721975655
}

PS C:\Users\XXXX>
```

TLS 1.2ã‚’æœ‰åŠ¹ã«ã™ã‚‹æ–¹æ³•

```powershell
[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
```

```powershell
PS C:\Users\XXXX> [Net.ServicePointManager]::SecurityProtocol
SystemDefault
PS C:\Users\XXXX>
PS C:\Users\XXXX> [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
PS C:\Users\XXXX>
PS C:\Users\XXXX> [Net.ServicePointManager]::SecurityProtocol
Tls12
PS C:\Users\XXXX>
```

â˜… TSL1.0ã®çŠ¶æ…‹ã§Imort-Moduleã‚³ãƒžãƒ³ãƒ‰ãŒã§ããªã„ã®ã‚’ãƒ†ã‚¹ãƒˆã—ãŸã„ã€‚å¤‰æ›´æ–¹æ³•ã‚’ç¢ºèªä¸­ã€‚

ä¸‹è¨˜ã®ã¨ãŠã‚Šã€è¨­å®šã¯ã§ããŸã®ã§å¾Œã¯Import-Moduleã§è©¦ã™ã€‚

```powershell
PS C:\Users\XXXX> # TLS 1.0ã‚’æœ‰åŠ¹ã«ã™ã‚‹
>> [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.SecurityProtocolType]::Tls
PS C:\Users\XXXX>
PS C:\Users\XXXX> $url = "https://check-tls.akamai.io/v1/tlsinfo.json"
>> $result = Invoke-WebRequest -Uri $url
>> $result.Content
{






"tls_sni_status": "present",
"scheme": "https",
"tls_version": "tls1",
"tls_sni_value": "check-tls.akamai.io",
"host_header_value": "check-tls.akamai.io",
"tls_cipher_name": "ECDHE-RSA-AES256-SHA",
"alpn": "",
"client_ip": "60.32.10.209",
"client_ip_version": "ipv4",
"client_port": 63031,
"user_agent": "Mozilla%2f5.0%20(Windows%20NT%3b%20Windows%20NT%2010.0%3b%20ja-JP)%20WindowsPowerShell%2f5.1.19041.4648",
"output_version": "0.1.21",
"timestamp": 1721980570
}

PS C:\Users\XXXX>
```
