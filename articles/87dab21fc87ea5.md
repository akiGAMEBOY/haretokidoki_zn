---
title: "PowerShellで指定したシート名がExcelファイル内に存在するかチェックするFunction"
emoji: "👌"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["powershell", "excel"]
published: false
---
## 概要

```powershell:
Function Test-ExcelSheetExists {
    param(
        [System.String]$Path,
        [System.String]$CheckSheet
    )
    $excel = New-Object -ComObject Excel.Application
    $excel.Visible = $false
    $workbook = $excel.Workbooks.Open($Path)
    $sheetExists = $false

    foreach ($worksheet in $workbook.Sheets) {
        if ($worksheet.Name -eq $CheckSheet) {
            $sheetExists = $true
            break
        }
    }

    $workbook.Close($false)
    $excel.Quit()
    [System.Runtime.Interopservices.Marshal]::ReleaseComObject($excel)

    return $sheetExists
}
```