---
title: "指定のZIPファイルを解凍するFunction"
emoji: "🐡"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["powershell"]
published: false
---
指定したZIPファイルを解凍。

```powershell:
function Extract-ZipFile {
    param(
        [System.String]$ZipPath,
        [System.String]$DestPath
    )

    # ZIPファイルが存在するか確認
    if (-Not(Test-Path -Path $ZipPath)) {
        Write-Error "指定されたZIPファイルが見つかりません: ZIPファイル[$ZipPath]"
        return
    }

    # 展開先のフォルダーが存在しない場合は作成
    if (-Not(Test-Path -Path $DestPath)) {
        try {
            (New-Item -Path $DestPath -ItemType Directory) > $null
        }
        catch {
            Write-Error "展開先のフォルダー作成時にエラーが発生しました: 展開先[$Destpath]"
            return
        }
    }

    # 展開先にZIP形式のファイルをコピー
    $copyToZip = "$Destpath\$((Get-Item $ZipPath).BaseName).zip"
    try {
        Copy-Item $ZipPath $copyToZip
    }
    catch {
        Write-Error "展開先へのコピー処理でエラーが発生しました: ZIPファイル[$ZipPath], 展開先[$Destpath]"
    }

    # ZIPファイルを展開
    try {
        Expand-Archive -Path $copyToZip -DestinationPath $DestPath
    }
    catch {
        Write-Error "ZIPファイルを展開時にエラーが発生しました: ZIPファイル[$copyToZip], 展開先[$Destpath]"
        return
    }

    Write-Output "ZIPファイルが展開されました: $ZipPath -> $DestPath"
}
```
