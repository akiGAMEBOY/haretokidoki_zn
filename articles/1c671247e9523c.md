---
title: ""
emoji: "🤖"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---

```powershell
PowerShell 7.3.10

   A new PowerShell stable release is available: v7.4.0
   Upgrade now, or check out the release page at:
     https://aka.ms/PowerShell-Release?tag=v7.4.0

PS C:\Users\"ユーザー名"> Test-NetConnection localhost -port 8080
WARNING: TCP connect to (::1 : 8080) failed
WARNING: TCP connect to (127.0.0.1 : 8080) failed

ComputerName           : localhost
RemoteAddress          : ::1
RemotePort             : 8080
InterfaceAlias         : Loopback Pseudo-Interface 1
SourceAddress          : ::1
PingSucceeded          : True
PingReplyDetails (RTT) : 0 ms
TcpTestSucceeded       : False


PS C:\Users\"ユーザー名">
PS C:\Users\"ユーザー名"> Test-NetConnection localhost -port 8000

ComputerName     : localhost
RemoteAddress    : ::1
RemotePort       : 8000
InterfaceAlias   : Loopback Pseudo-Interface 1
SourceAddress    : ::1
TcpTestSucceeded : True


PS C:\Users\"ユーザー名">  
PS C:\Users\"ユーザー名"> Test-NetConnection google.com -port 443

ComputerName     : google.com
RemoteAddress    : 142.250.206.206
RemotePort       : 443
InterfaceAlias   : イーサネット
SourceAddress    : 192.168.XXX.XXX
TcpTestSucceeded : True


PS C:\Users\"ユーザー名">
PS C:\Users\"ユーザー名"> Test-NetConnection smtp.gmail.com -port 25

ComputerName     : smtp.gmail.com
RemoteAddress    : 64.233.187.109
RemotePort       : 25
InterfaceAlias   : イーサネット
SourceAddress    : 192.168.XXX.XXX
TcpTestSucceeded : True


PS C:\Users\"ユーザー名">  
```

たとえば、ホスト名 と ポート番号 のデータが格納されている2次元配列を繰り返し実行して、
ポートの疎通確認を行う場合、

```powershell:ポートの疎通確認
$port_check_lists = @(
    @('localhost','8080'),
    @('localhost','8000'),
    @('google.com','443'),
    @('smtp.google.com','25')
)

for($i = 0; $i -lt $port_check_lists.Count; $i++) {
    $port_check_command = 'Test-NetConnection '
    $target_row = $port_check_lists[$i]

    Test-NetConnection $target_row[0] -Port $target_row[1]
}
```