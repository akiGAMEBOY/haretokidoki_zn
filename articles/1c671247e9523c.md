---
title: "[PowerShell]è¤‡æ•°ã®ã‚µãƒ¼ãƒãƒ¼ã«å¯¾ã—æŒ‡å®šã—ãŸãƒãƒ¼ãƒˆã§ç–é€šç¢ºèªã™ã‚‹æ–¹æ³•"
emoji: "ğŸ¤–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

```powershell:PowerShellãƒãƒ¼ã‚¸ãƒ§ãƒ³
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $PSVersionTable

Name                           Value
----                           -----
PSVersion                      7.3.10
PSEdition                      Core
GitCommitId                    7.3.10
OS                             Microsoft Windows 10.0.19045
Platform                       Win32NT
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0â€¦}
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1
WSManStackVersion              3.0

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

```powershell:è‡ªèº«ã®ãƒ‘ã‚½ã‚³ãƒ³ã«å¯¾ã—ãƒãƒ¼ãƒˆã€Œ8080ã€ã§ç–é€šç¢ºèª
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Test-NetConnection localhost -port 8080
WARNING: TCP connect to (::1 : 8080) failed
WARNING: TCP connect to (127.0.0.1 : 8080) failed

ComputerName           : localhost
RemoteAddress          : ::1
RemotePort             : 8080
InterfaceAlias         : Loopback Pseudo-Interface 1
SourceAddress          : ::1
PingSucceeded          : True
PingReplyDetails (RTT) : 0 ms
TcpTestSucceeded       : False


PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

```powershell:è‡ªèº«ã®ãƒ‘ã‚½ã‚³ãƒ³ã«å¯¾ã—ãƒãƒ¼ãƒˆã€Œ8000ã€ã§ç–é€šç¢ºèª
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Test-NetConnection localhost -port 8000

ComputerName     : localhost
RemoteAddress    : ::1
RemotePort       : 8000
InterfaceAlias   : Loopback Pseudo-Interface 1
SourceAddress    : ::1
TcpTestSucceeded : True


PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> 
```

```powershell:google.comã«å¯¾ã—ãƒãƒ¼ãƒˆã€Œ443ï¼ˆHTTPSï¼‰ã€ã§ç–é€šç¢ºèª
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Test-NetConnection google.com -port 443

ComputerName     : google.com
RemoteAddress    : 142.250.206.206
RemotePort       : 443
InterfaceAlias   : ã‚¤ãƒ¼ã‚µãƒãƒƒãƒˆ
SourceAddress    : 192.168.XXX.XXX
TcpTestSucceeded : True


PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

```powershell:smtp.google.comã«å¯¾ã—ãƒãƒ¼ãƒˆã€Œ25ï¼ˆSMTPï¼‰ã€ã§ç–é€šç¢ºèª
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Test-NetConnection smtp.gmail.com -port 25

ComputerName     : smtp.gmail.com
RemoteAddress    : 64.233.187.109
RemotePort       : 25
InterfaceAlias   : ã‚¤ãƒ¼ã‚µãƒãƒƒãƒˆ
SourceAddress    : 192.168.XXX.XXX
TcpTestSucceeded : True


PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">  
```

ãŸã¨ãˆã°ã€ãƒ›ã‚¹ãƒˆå ã¨ ãƒãƒ¼ãƒˆç•ªå· ã®ãƒ‡ãƒ¼ã‚¿ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹2æ¬¡å…ƒé…åˆ—ã‚’ç¹°ã‚Šè¿”ã—å®Ÿè¡Œã—ã¦ã€
ãƒãƒ¼ãƒˆã®ç–é€šç¢ºèªã‚’è¡Œã†å ´åˆã€

```powershell:ãƒãƒ¼ãƒˆã®ç–é€šç¢ºèª
$port_check_lists = @(
    @('localhost','8080'),
    @('localhost','8000'),
    @('google.com','443'),
    @('smtp.google.com','25')
)

for($i = 0; $i -lt $port_check_lists.Count; $i++) {
    $port_check_command = 'Test-NetConnection '
    $target_row = $port_check_lists[$i]

    Test-NetConnection $target_row[0] -Port $target_row[1]
}
```
