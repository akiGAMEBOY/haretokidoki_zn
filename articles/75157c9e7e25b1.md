---
title: "PowerShellã§Excelãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚·ãƒ¼ãƒˆåã‚’ãƒã‚§ãƒƒã‚¯"
emoji: "ğŸŒŸ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell", 'excel']
published: false
---

![](https://storage.googleapis.com/zenn-user-upload/ec7312f11040-20240624.png)
*ç”»åƒï¼šExcelã§è¨±å¯ã™ã‚‹ã‚·ãƒ¼ãƒˆå*

å…¥åŠ›æ–‡å­—ãŒ31æ–‡å­—ä»¥å†…
:\/?*[]ã§ãªã„ã“ã¨
åå‰ãŒç©ºç™½ã§ãªã„ã“ã¨

```powershell:
Function Test-ExcelSheetname {
    param(
        [Parameter(Mandatory=$true)][System.String]$SheetName
    )
    
    # åå‰ãŒç©ºç™½ã§ãªã„ã‹ãƒã‚§ãƒƒã‚¯
    if ([string]::IsNullOrWhiteSpace($SheetName)) {
        Write-Warning 'ç©ºç™½ã§ã‚ã‚‹ï¼ˆNullã‚„ç©ºæ–‡å­—ã‚’å«ã‚€ï¼‰'
        return $false
    }

    # æ–‡å­—æ•°ãŒ31æ–‡å­—ä»¥å†…ã‹ãƒã‚§ãƒƒã‚¯
    if ($SheetName.Length -gt 31) {
        Write-Warning 'æ–‡å­—æ•°ãŒ31æ–‡å­—ä»¥å†…ã§ã¯ãªã„'
        return $false
    }

    # ç¦æ­¢ã•ã‚ŒãŸæ–‡å­—ã‚’å«ã‚€ã‹ãƒã‚§ãƒƒã‚¯
    if ($SheetName -match "[:\\\/\?\*\[\]]") {
        Write-Warning 'ã‚³ãƒ­ãƒ³(:)ã¾ãŸã¯å††è¨˜å·(\)ã€ã‚¹ãƒ©ãƒƒã‚·ãƒ¥(/)ã€ç–‘å•ç¬¦(?)ã€ã‚¢ã‚¹ã‚¿ãƒªã‚¹ã‚¯(*)ã€å·¦å³ã®è§’ã‹ã£ã“([])ãŒå«ã¾ã‚Œã¦ã„ã‚‹'
        return $false
    }

    return $true
}
```

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
https://zenn.dev/haretokidoki/articles/fb6830f9155de5
