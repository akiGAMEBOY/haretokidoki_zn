---
title: "[PowerShell]ãƒ•ã‚¡ã‚¤ãƒ«ã®æ‹¡å¼µå­ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹Funciton"
emoji: "ğŸŒŠ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

```powershell:
function Test-FileExtension {
    param (
        [Parameter(Mandatory=$true)][System.String]$FullFilename,
        [Parameter(Mandatory=$true)][System.String[]]$Extensions
    )

    # æ–‡å­—åˆ—ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    #   ç©ºæ–‡å­—ãƒ»ç©ºç™½ãƒ»Nullãƒã‚§ãƒƒã‚¯
    if ([System.String]::IsNullOrWhiteSpace($FullFilename.Trim())) {
        Write-Error 'ãƒã‚§ãƒƒã‚¯å¯¾è±¡ã®æ–‡å­—åˆ—ã«å€¤ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚'
        return $false
    }
    #   ãƒ”ãƒªã‚ªãƒ‰ã‚’å«ã‚“ã§ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    if ($FullFilename -notmatch '\.') {
        Write-Error 'ãƒã‚§ãƒƒã‚¯å¯¾è±¡ã®æ–‡å­—åˆ—ã«ãƒ”ãƒªã‚ªãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚'
        return $false
    }
    #   ãƒ”ãƒªã‚ªãƒ‰ã®ä½ç½®ãŒå…ˆé ­ã€ã¾ãŸã¯æœ«å°¾ã§ãªã„ã“ã¨ã‚’ãƒã‚§ãƒƒã‚¯
    $dotIndex = $FullFilename.LastIndexOf('.')
    if (($dotIndex -eq 0) -or
        ($dotIndex -eq $FullFilename.Length - 1)) {
        Write-Error 'ãƒã‚§ãƒƒã‚¯å¯¾è±¡ã®æ–‡å­—åˆ—ãŒæ­£ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«åã®è¡¨è¨˜ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚'
        return $false
    }

    # é…åˆ—å†…ã®ãƒã‚§ãƒƒã‚¯
    foreach ($item in $Extensions) {
        # Nullã¾ãŸã¯ç©ºæ–‡å­—ã€ç©ºç™½ã®ãƒã‚§ãƒƒã‚¯
        if ([System.String]::IsNullOrWhiteSpace($item.Trim())) {
            Write-Warning 'æ‹¡å¼µå­ã®é…åˆ—å†…ã§å€¤ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã™ã€‚'
            return $false
        }
        # å…ˆé ­æ–‡å­—ãŒãƒ”ãƒªã‚ªãƒ‰ã‹ã‚‰å§‹ã¾ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
        if ($item -notmatch '^\.') {
            Write-Warning 'æ‹¡å¼µå­ã®é…åˆ—å†…ã«å…ˆé ­æ–‡å­—ãŒãƒ”ãƒªã‚ªãƒ‰ã§å§‹ã¾ã£ã¦ã„ãªã„ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã™ã€‚'
            return $false
        }
    }

    # æ‹¡å¼µå­ã®ãƒã‚§ãƒƒã‚¯
    #   æ‹¡å¼µå­ã‚’å–å¾—
    [System.String]$fileExtension = $FullFilename -replace '.*(\..*)', '$1'

    #   æ‹¡å¼µå­ã®æ¯”è¼ƒ
    $isHit = $false
    foreach ($item in $Extensions) {
        # ãƒã‚§ãƒƒã‚¯å¯¾è±¡ã®æ‹¡å¼µå­ã¨æ¯”è¼ƒã™ã‚‹æ‹¡å¼µå­ãŒåˆè‡´ã—ãŸå ´åˆ
        if ($fileExtension -eq $item) {
            $isHit = $true
            break
        }
    }

    # åˆ¤å®šã—ãŸçµæœ
    return $isHit
}
```

```powershell:
$checkString = 'ãƒã‚§ãƒƒã‚¯ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«.xlsx'
$officeExtensions = @('.doc', '.docx', '.xls', '.xlsx', '.ppt', '.pptx', '.pub', '.one', '.pst', '.ost')
Test-FileExtension $checkString $officeExtensions
#True
```
