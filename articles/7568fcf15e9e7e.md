---
title: "[PowerShell]ãƒ•ã‚¡ã‚¤ãƒ«ã®æ‹¡å¼µå­ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹Funciton"
emoji: "ğŸŒŠ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

```powershell:
function Test-FileExtension {
    param (
        [Parameter(Mandatory=$true)]
        [ValidateScript({ ($_ -ne $null) -and ($_.Trim() -ne '') })]
        [System.String]$FullFilename,
        [System.String[]]$Extensions
    )

    # æ–‡å­—åˆ—ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    #   
    #   ãƒ”ãƒªã‚ªãƒ‰ã‚’å«ã‚“ã§ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    if ($FullFilename -notmatch '\.') {
        Write-Error 'ãƒã‚§ãƒƒã‚¯å¯¾è±¡ã®æ–‡å­—åˆ—ã«ãƒ”ãƒªã‚ªãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚'
        return $false
    }
    #   ãƒ”ãƒªã‚ªãƒ‰ã®ä½ç½®ãŒå…ˆé ­ã€ã¾ãŸã¯æœ«å°¾ã§ãªã„ã“ã¨ã‚’ãƒã‚§ãƒƒã‚¯
    $dotIndex = $FullFilename.LastIndexOf('.')
    if (($dotIndex -eq 0) -or
        ($dotIndex -eq $FullFilename.Length - 1)) {
        Write-Error 'ãƒã‚§ãƒƒã‚¯å¯¾è±¡ã®æ–‡å­—åˆ—ãŒæ­£ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«åã®è¡¨è¨˜ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚'
        return $false
    }

    }
    if ([System.String]::IsNullOrWhiteSapce($FullFilename.Trim())) {
        Write-Error 'ãƒã‚§ãƒƒã‚¯å¯¾è±¡ã®æ–‡å­—åˆ—ã«å€¤ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚'
        return $false
    }
    if (-Not(Test-Path $Path)) {
        Write-Error "å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚[å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«: $($Path)]"
        return $false
    }

    # é…åˆ—å†…ã®ãƒã‚§ãƒƒã‚¯
    foreach ($item in $Extensions) {
        # Nullã¾ãŸã¯ç©ºæ–‡å­—ã€ç©ºç™½ã®ãƒã‚§ãƒƒã‚¯
        if ([System.String]::IsNullOrWhiteSpace($item.Trim())) {
            Write-Warning 'æ‹¡å¼µå­ã®é…åˆ—å†…ã§å€¤ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚'
            return $false
        }
        # å…ˆé ­æ–‡å­—ãŒãƒ”ãƒªã‚ªãƒ‰ã‹ã‚‰å§‹ã¾ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
        if ($item -notmatch '^\.') {
            Write-Warning 'æ‹¡å¼µå­ã®é…åˆ—å†…ã«å…ˆé ­æ–‡å­—ãŒãƒ”ãƒªã‚ªãƒ‰ã§å§‹ã¾ã£ã¦ã„ãªã„æ–‡å­—åˆ—ãŒã‚ã‚Šã¾ã™ã€‚'
            return $false
        }
    }

    # æ‹¡å¼µå­ã®ãƒã‚§ãƒƒã‚¯
    #   æ‹¡å¼µå­ã‚’å–å¾—
    [System.String]$path_extension = $Path -replace '.*(\..*)', '$1'

    #   æ‹¡å¼µå­ã®æ¯”è¼ƒ
    foreach ($item in $Extensions) {
        if 
    }


    # æ‹¡å¼µå­ã®é…åˆ—ã«å€¤ãŒã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    Get-ChildItem -Path $filePath -Recurse | Where-Object { $_.Extension -eq '.xlsx' -or $_.Extension -eq '.xls' }
}
```

