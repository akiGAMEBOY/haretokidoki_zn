---
title: "[PowerShell]あらかじめ定義した文字列変数の値で変数を宣言・呼び出す方法"
emoji: "📞"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["powershell"]
published: false
---

変数名だけ変えて同じ処理を繰り返し行う際に宣言する変数名も変数で宣言してみます。

👆 の文章では伝わりにくいと思うので下記のコードをご確認ください。

## 基本：変数名を変数で宣言しておき新たな変数を宣言・呼び出すコード

```powershell:変数名を変数で宣言しておき新たな変数を宣言するコード
# 文字列型の変数名を宣言
$variableName = 'stringData'

# あらかじめ定義した文字列変数の値で変数を宣言
Set-Variable -Name $variableName -Value @('a','b','c','d','e')
```

```powershell:変数名を変数で宣言しておき変数を呼び出すコード
# 文字列型の変数名を宣言
$variableName = 'stringData'

# あらかじめ定義した文字列変数の値で変数の呼び出し
$variableValue = (Get-Variable -Name $variableName -ValueOnly)

# 取得した変数の値を表示
Write-Host $variableValue
```

```powershell:変数呼び出し時の実行結果
PS C:\Users\XXXX> Write-Host $variableValue
a b c d e
```

## 応用：引数を元に宣言する変数名を変更する方法

## まとめ

```powershell
# 文字列型の変数名を宣言
$variableName = 'stringData'

# あらかじめ定義した文字列変数の値で変数を宣言
Set-Variable -Name $variableName -Value @('a','b','c','d','e')

# あらかじめ定義した文字列変数の値で変数の呼び出し
$variableValue = (Get-Variable -Name $variableName -ValueOnly)

# 取得した変数の値を表示
Write-Host $variableValue
```

## 関連記事

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
https://zenn.dev/haretokidoki/articles/fb6830f9155de5
