---
title: "[PowerShell]æ–‡å­—åˆ—å¤‰æ•°ã‚’ä»‹ã—å¤‰æ•°åã‚’å®£è¨€ã—ãã®å¤‰æ•°åã‚’æ–‡å­—åˆ—å¤‰æ•°ã§å‘¼ã³å‡ºã™æ–¹æ³•"
emoji: "ğŸ“"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•

PowerShellã§å¤‰æ•°åã‚’æ–‡å­—åˆ—ã¨ã—ã¦å®£è¨€ã—ã€ãã®æ–‡å­—åˆ—ã‚’ä½¿ç”¨ã—ã¦å¤‰æ•°ã‚’å‘¼ã³å‡ºã™æ–¹æ³•ã¯ã€`Get-Variable` ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™ã€‚ä»¥ä¸‹ã«ä¾‹ã‚’ç¤ºã—ã¾ã™ï¼š

```powershell
# æ–‡å­—åˆ—å‹ã®å¤‰æ•°åã‚’å®£è¨€
$variableName = 'stringData'

# å®Ÿéš›ã®å¤‰æ•°ã‚’å®£è¨€ã—ã€å€¤ã‚’ä»£å…¥
$stringData = @('a', 'b', 'c', 'd', 'e')

# æ–‡å­—åˆ—å‹ã®å¤‰æ•°åã‚’ä½¿ç”¨ã—ã¦å¤‰æ•°ã®å€¤ã‚’å–å¾—
$variableValue = (Get-Variable -Name $variableName -ValueOnly)

# å–å¾—ã—ãŸå€¤ã‚’è¡¨ç¤º
Write-Host $variableValue
```

ã“ã®ä¾‹ã§ã¯ã€`$variableNameAsString` ã¨ã„ã†æ–‡å­—åˆ—å‹ã®å¤‰æ•°ã« `'variableName'` ã¨ã„ã†æ–‡å­—åˆ—ã‚’ä»£å…¥ã—ã¦ã„ã¾ã™ã€‚`$variableName` ã¨ã„ã†å®Ÿéš›ã®å¤‰æ•°ã« `'å€¤'` ã‚’ä»£å…¥ã—ã€`Get-Variable` ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ `$variableNameAsString` ã§æŒ‡å®šã•ã‚ŒãŸå¤‰æ•°ã®å€¤ã‚’å–å¾—ã—ã¦ã„ã¾ã™ã€‚`-ValueOnly` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¯ã€å¤‰æ•°ã®å€¤ã®ã¿ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

ã“ã®æ–¹æ³•ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€å‹•çš„ã«å¤‰æ•°åã‚’æŒ‡å®šã—ã¦ã€ãã®å¤‰æ•°ã®å€¤ã‚’æ“ä½œã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™Â¹Â²Â³ã€‚ãŸã ã—ã€å¤‰æ•°ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã®ã§ã€`-ErrorAction` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚’é©åˆ‡ã«è¡Œã†ã“ã¨ãŒé‡è¦ã§ã™ã€‚ğŸ”

ã‚½ãƒ¼ã‚¹: Copilot ã¨ã®ä¼šè©±ã€ 2024/6/12
(1) PowerShellã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æ–‡å­—åˆ—ã®ä¸­ã§å±•é–‹ã—ãŸã„ .... https://qiita.com/yutami/items/7f3d28c4873da9d1a359.
(2) Get-Variable (Microsoft.PowerShell.Utility) - PowerShell. https://bing.com/search?q=PowerShell+%e6%96%87%e5%ad%97%e5%88%97%e5%9e%8b%e3%81%ae%e5%a4%89%e6%95%b0%e5%90%8d%e3%81%a7%e5%a4%89%e6%95%b0%e3%82%92%e5%91%bc%e3%81%b3%e5%87%ba%e3%81%99%e6%96%b9%e6%b3%95.
(3) PowerShellã®å¤‰æ•°ã®æ§˜ã€…ãªä½¿ã„æ–¹ | æ™´è€•é›¨èª­. https://tex2e.github.io/blog/powershell/variables.
(4) æ–‡å­—åˆ—ã§ã®å¤‰æ•°ã®ä»£å…¥ã«ã¤ã„ã¦çŸ¥ã‚ŠãŸã‹ã£ãŸã“ã¨ã®ã™ã¹ã¦ .... https://learn.microsoft.com/ja-jp/powershell/scripting/learn/deep-dives/everything-about-string-substitutions?view=powershell-7.4.
(5) [PowerShell][åŸºæœ¬] å¤‰æ•°ã®ä½¿ç”¨æ–¹æ³• | PowerShell from Japan .... https://blog.powershell-from.jp/?p=2832.

ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã›ãšã‚³ãƒ¼ãƒ‰ä¸Šã§å®Ÿç¾ã™ã‚‹æ–¹æ³•

ã¯ã„ã€PowerShellã§ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã›ãšã«å¤‰æ•°ã®å€¤ã‚’å–å¾—ã™ã‚‹æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚å¤‰æ•°ã®ã‚¹ã‚³ãƒ¼ãƒ—ã‚’åˆ©ç”¨ã—ã¦ã€å¤‰æ•°åã‚’æ–‡å­—åˆ—ã¨ã—ã¦ä¿æŒã—ã€ãã®æ–‡å­—åˆ—ã‚’ä½¿ã£ã¦å¤‰æ•°ã®å€¤ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ã«ä¾‹ã‚’ç¤ºã—ã¾ã™ï¼š

```powershell
# æ–‡å­—åˆ—ã¨ã—ã¦å¤‰æ•°åã‚’ä¿æŒ
$variableName = "å¤‰æ•°å"

# å®Ÿéš›ã®å¤‰æ•°ã‚’å®£è¨€ã—ã€å€¤ã‚’ä»£å…¥
$å¤‰æ•°å = "å€¤"

# ã‚¹ã‚³ãƒ¼ãƒ—ã‚’åˆ©ç”¨ã—ã¦å¤‰æ•°ã®å€¤ã‚’å–å¾—
$retrievedValue = $ExecutionContext.InvokeCommand.ExpandString("`$$variableName")

# å–å¾—ã—ãŸå€¤ã‚’è¡¨ç¤º
Write-Host $retrievedValue
```

```powershell:
PS D:\Downloads> $variableName = "numberData"
PS D:\Downloads>
PS D:\Downloads> $numberData = @(1, 2, 3, 4, 5)
PS D:\Downloads>
PS D:\Downloads> $variableValue = $ExecutionContext.InvokeCommand.ExpandString("`$$variableName")
PS D:\Downloads>
PS D:\Downloads> Write-Host $variableValue
1 2 3 4 5
PS D:\Downloads>
```

```powershell:ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€ŒGet-Variableã€ã‚’ä½¿ã†å®Ÿä¾‹
# å¤šæ®µéšé…åˆ—ï¼ˆã‚¸ãƒ£ã‚°é…åˆ—ï¼‰ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
$multiLevelArray = @( @(1, 2), @(3, 4, 5), @(6) )

# å¤šæ¬¡å…ƒé…åˆ—ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
$multiDimArray = New-Object 'object[,]' 2,2
$multiDimArray[0,0] = 1
$multiDimArray[0,1] = 2
$multiDimArray[1,0] = 3
$multiDimArray[1,1] = 4

# Functionã®ãƒ†ã‚¹ãƒˆ
Write-Host "--- å¤šæ®µéšé…åˆ—ã®ãƒ†ã‚¹ãƒˆçµæœ ---`n"
# æ–‡å­—åˆ—å‹ã®å¤‰æ•°åã‚’å®£è¨€
$variableName = 'multiLevelArray'
# æ–‡å­—åˆ—å‹ã®å¤‰æ•°åã‚’ä½¿ç”¨ã—ã¦å¤‰æ•°ã®å€¤ã‚’å–å¾—
$variableValue = (Get-Variable -Name $variableName -ValueOnly)
switch ((Get-ArrayType -Array $variableValue)) {
    # å¤šæ®µé…åˆ—ã®å ´åˆ
    "1" {
        Write-Host "`$$($variableName) ã¯ å¤šæ®µé…åˆ— ã§ã™ã€‚`n"
    }
    # å¤šæ¬¡å…ƒé…åˆ—ã®å ´åˆ
    "2" {
        Write-Host "`$$($variableName) ã¯ å¤šæ¬¡å…ƒé…åˆ— ã§ã™ã€‚`n"
    }
    # ãã‚Œä»¥å¤–
    "-1" {
        Write-Host "`$$($variableName) ã¯ å¤šæ®µé…åˆ—ãƒ»å¤šæ¬¡å…ƒé…åˆ—ä»¥å¤–ã®ãƒ‡ãƒ¼ã‚¿å‹ ã§ã™ã€‚`n"
    }
}

Write-Host "--- å¤šæ¬¡å…ƒé…åˆ—ã®ãƒ†ã‚¹ãƒˆçµæœ ---`n"
# æ–‡å­—åˆ—å‹ã®å¤‰æ•°åã‚’å®£è¨€
$variableName = 'multiDimArray'
# æ–‡å­—åˆ—å‹ã®å¤‰æ•°åã‚’ä½¿ç”¨ã—ã¦å¤‰æ•°ã®å€¤ã‚’å–å¾—
$variableValue = (Get-Variable -Name $variableName -ValueOnly)
switch ((Get-ArrayType -Array $variableValue)) {
    # å¤šæ®µé…åˆ—ã®å ´åˆ
    "1" {
        Write-Host "`$$($variableName) ã¯ å¤šæ®µé…åˆ— ã§ã™ã€‚`n"
    }
    # å¤šæ¬¡å…ƒé…åˆ—ã®å ´åˆ
    "2" {
        Write-Host "`$$($variableName) ã¯ å¤šæ¬¡å…ƒé…åˆ— ã§ã™ã€‚`n"
    }
    # ãã‚Œä»¥å¤–
    "-1" {
        Write-Host "`$$($variableName) ã¯ å¤šæ®µé…åˆ—ãƒ»å¤šæ¬¡å…ƒé…åˆ—ä»¥å¤–ã®ãƒ‡ãƒ¼ã‚¿å‹ ã§ã™ã€‚`n"
    }
}
```

```powershell:ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€ŒGet-Variableã€ã‚’ä½¿ã†å®Ÿä¾‹
# å¤šæ®µéšé…åˆ—ï¼ˆã‚¸ãƒ£ã‚°é…åˆ—ï¼‰ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
$multiLevelArray = @( @(1, 2), @(3, 4, 5), @(6) )

# å¤šæ¬¡å…ƒé…åˆ—ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
$multiDimArray = New-Object 'object[,]' 2,2
$multiDimArray[0,0] = 1
$multiDimArray[0,1] = 2
$multiDimArray[1,0] = 3
$multiDimArray[1,1] = 4

# Functionã®ãƒ†ã‚¹ãƒˆ
Write-Host "--- å¤šæ®µéšé…åˆ—ã®ãƒ†ã‚¹ãƒˆçµæœ ---`n"
# æ–‡å­—åˆ—å‹ã®å¤‰æ•°åã‚’å®£è¨€
$variableName = 'multiLevelArray'
# æ–‡å­—åˆ—å‹ã®å¤‰æ•°åã‚’ä½¿ç”¨ã—ã¦å¤‰æ•°ã®å€¤ã‚’å–å¾—
$variableValue = (Get-Variable -Name $variableName -ValueOnly)
switch ((Get-ArrayType -Array $variableValue)) {
    # å¤šæ®µé…åˆ—ã®å ´åˆ
    "1" {
        Write-Host "`$$($variableName) ã¯ å¤šæ®µé…åˆ— ã§ã™ã€‚`n"
    }
    # å¤šæ¬¡å…ƒé…åˆ—ã®å ´åˆ
    "2" {
        Write-Host "`$$($variableName) ã¯ å¤šæ¬¡å…ƒé…åˆ— ã§ã™ã€‚`n"
    }
    # ãã‚Œä»¥å¤–
    "-1" {
        Write-Host "`$$($variableName) ã¯ å¤šæ®µé…åˆ—ãƒ»å¤šæ¬¡å…ƒé…åˆ—ä»¥å¤–ã®ãƒ‡ãƒ¼ã‚¿å‹ ã§ã™ã€‚`n"
    }
}

Write-Host "--- å¤šæ¬¡å…ƒé…åˆ—ã®ãƒ†ã‚¹ãƒˆçµæœ ---`n"
# æ–‡å­—åˆ—å‹ã®å¤‰æ•°åã‚’å®£è¨€
$variableName = 'multiDimArray'
# æ–‡å­—åˆ—å‹ã®å¤‰æ•°åã‚’ä½¿ç”¨ã—ã¦å¤‰æ•°ã®å€¤ã‚’å–å¾—
$variableValue = (Get-Variable -Name $variableName -ValueOnly)
switch ((Get-ArrayType -Array $variableValue)) {
    # å¤šæ®µé…åˆ—ã®å ´åˆ
    "1" {
        Write-Host "`$$($variableName) ã¯ å¤šæ®µé…åˆ— ã§ã™ã€‚`n"
    }
    # å¤šæ¬¡å…ƒé…åˆ—ã®å ´åˆ
    "2" {
        Write-Host "`$$($variableName) ã¯ å¤šæ¬¡å…ƒé…åˆ— ã§ã™ã€‚`n"
    }
    # ãã‚Œä»¥å¤–
    "-1" {
        Write-Host "`$$($variableName) ã¯ å¤šæ®µé…åˆ—ãƒ»å¤šæ¬¡å…ƒé…åˆ—ä»¥å¤–ã®ãƒ‡ãƒ¼ã‚¿å‹ ã§ã™ã€‚`n"
    }
}
```

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
https://zenn.dev/haretokidoki/articles/fb6830f9155de5
