---
title: "[PowerShell]æ–‡å­—åˆ—å¤‰æ•°ã‚’å…ƒã«å¤‰æ•°åãŒå‹•çš„ãªå¤‰æ•°ã‚’å®£è¨€ãƒ»å‘¼ã³å‡ºã™æ–¹æ³•"
emoji: "ğŸ“"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

å¤‰æ•°åã ã‘å¤‰ãˆã¦åŒã˜å‡¦ç†ã‚’ç¹°ã‚Šè¿”ã™ã‚±ãƒ¼ã‚¹ã‚’æƒ³å®šã—ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¾ã—ãŸã€‚

æ–‡ç« ã ã‘ã§ã¯ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒä¼ã‚ã‚Šã«ãã„ã¨æ€ã†ã®ã§ã€ä¸‹è¨˜ã®ã‚³ãƒ¼ãƒ‰ã‚’ã”è¦§ãã ã•ã„ã€‚

## åŸºæœ¬ï¼šæ–‡å­—åˆ—å¤‰æ•°ã‚’å…ƒã«å¤‰æ•°åãŒå‹•çš„ãªå¤‰æ•°ã‚’å®£è¨€ãƒ»å‘¼ã³å‡ºã™ã‚³ãƒ¼ãƒ‰

```powershell:æ–‡å­—åˆ—å¤‰æ•°ã‚’å…ƒã«å¤‰æ•°åãŒå‹•çš„ãªå¤‰æ•°ã‚’å®£è¨€ã™ã‚‹ã‚³ãƒ¼ãƒ‰
# ã¤ãã§å®£è¨€ã™ã‚‹å¤‰æ•°åã‚’è¨­å®š
$variableName = 'stringData'

# ã‚ã‚‰ã‹ã˜ã‚å®šç¾©ã—ãŸæ–‡å­—åˆ—å¤‰æ•°ã®å€¤ï¼ˆstringDataï¼‰ã§å¤‰æ•°ã‚’å®£è¨€
Set-Variable -Name $variableName -Value @('a','b','c','d','e')
```

```powershell:æ–‡å­—åˆ—å¤‰æ•°ã‚’å…ƒã«å¤‰æ•°åãŒå‹•çš„ãªå¤‰æ•°ã‚’å‘¼ã³å‡ºã™ã‚³ãƒ¼ãƒ‰
# å¿…é ˆæ¡ä»¶ï¼šä¸Šè¨˜ã‚³ãƒ¼ãƒ‰ã§å¤‰æ•°ãŒå®£è¨€æ¸ˆã¿ã§ã‚ã‚‹ã“ã¨

# æ–‡å­—åˆ—å‹ã®å¤‰æ•°åã‚’å®£è¨€
$variableName = 'stringData'

# ã‚ã‚‰ã‹ã˜ã‚å®šç¾©ã—ãŸæ–‡å­—åˆ—å¤‰æ•°ã®å€¤ï¼ˆstringDataï¼‰ã§å¤‰æ•°ã®å€¤ã®ã¿å‘¼ã³å‡ºã—
$variableValue = (Get-Variable -Name $variableName -ValueOnly)

# å–å¾—ã—ãŸå¤‰æ•°ã®å€¤ã‚’è¡¨ç¤º
Write-Host $variableValue
```

ä¸‹è¨˜ã®ã¨ãŠã‚ŠæœŸå¾…é€šã‚Šã®çµæœã€‚

```powershell:å¤‰æ•°å‘¼ã³å‡ºã—æ™‚ã®å®Ÿè¡Œçµæœ
PS C:\Users\XXXX> Write-Host $variableValue
a b c d e
```

## å¿œç”¨ï¼šå¼•æ•°ã‚’å…ƒã«å¤‰æ•°åãŒå‹•çš„ãªå¤‰æ•°ã‚’å®£è¨€ãƒ»å‘¼ã³å‡ºã™Function

```powershell:å¼•æ•°ã‚’å…ƒã«å¤‰æ•°åãŒå‹•çš„ãªå¤‰æ•°ã‚’å®£è¨€ãƒ»å‘¼ã³å‡ºã™Function
Function Get-DynamicVariable {
    param(
        [Parameter(Mandatory = $true)]
        [string]$variableName
    )

    # å¤‰æ•°ã‚’å®£è¨€
    Set-Variable -Name $variableName -Value @('a', 'b', 'c', 'd', 'e')

    # å¤‰æ•°ã®å€¤ã®ã¿å–å¾—
    $variableValue = Get-Variable -Name $variableName -ValueOnly

    # çµæœã‚’è¡¨ç¤º
    Write-Host "å¤‰æ•°å[$($variableName)]ã€å€¤[$($variableValue)]"
}
```

```
PS C:\Users\XXXX> Get-DynamicVariable 'dynamicVar'
å¤‰æ•°å[dynamicVar]ã€å€¤[a b c d e]
PS C:\Users\XXXX>
```

## ã¾ã¨ã‚

```powershell
# æ–‡å­—åˆ—å‹ã®å¤‰æ•°åã‚’å®£è¨€
$variableName = 'stringData'

# ã‚ã‚‰ã‹ã˜ã‚å®šç¾©ã—ãŸæ–‡å­—åˆ—å¤‰æ•°ã®å€¤ã§å¤‰æ•°ã‚’å®£è¨€
Set-Variable -Name $variableName -Value @('a','b','c','d','e')

# ã‚ã‚‰ã‹ã˜ã‚å®šç¾©ã—ãŸæ–‡å­—åˆ—å¤‰æ•°ã®å€¤ã§å¤‰æ•°ã®å‘¼ã³å‡ºã—
$variableValue = (Get-Variable -Name $variableName -ValueOnly)

# å–å¾—ã—ãŸå¤‰æ•°ã®å€¤ã‚’è¡¨ç¤º
Write-Host $variableValue
```

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
https://zenn.dev/haretokidoki/articles/fb6830f9155de5
