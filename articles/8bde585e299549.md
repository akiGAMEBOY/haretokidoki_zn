---
title: "[Excel VBA]è‡ªä½œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®é–¢æ•°ã¾ã¨ã‚"
emoji: "ğŸ‘´"
type: "tech"
topics:
  - "excel"
  - "vba"
published: true
published_at: "2023-02-22 16:19"
---

## æ¦‚è¦
Excel VBAã‚’ä½œæˆã™ã‚‹éš›ã€ã‚ˆãæ›¸ãå‡¦ç†ã¯è‡ªä½œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½œæˆã—ã€
é–¢æ•°ã‚’ä½œæˆã—ã¦ã„ã¾ã™ã€‚
è‡ªèº«ã§ãµã‚Šè¿”ã‚Šä½¿ã†äº‹ã‚‚ã‚ã‚‹ã®ã§å‚™å¿˜ã‚‚ã‹ã­ã¦è¨˜äº‹ã«ã—ã¾ã™ã€‚
## ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
Excel VBAãƒ¦ãƒ¼ã‚¶
## å…±é€šå‡¦ç†ã®ã¾ã¨ã‚
:::message
æ™®æ®µã€ç§ãŒä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€ŒmdlCommon.basã€ã‹ã‚‰æŠœç²‹ã—ã¦ã„ã‚‹ç‚ºã€
é–¢æ•°ã®ä¸­ã«ã¯æ±ç”¨çš„ã«ãªã£ã¦ã„ãªã„ç®‡æ‰€ãŒã‚ã‚Šã¾ã™ã€‚

åˆ©ç”¨ã•ã‚Œã‚‹éš›ã¯èª­ã¿æ›ãˆã¦ã€ã”å¯¾å¿œãã ã•ã„ã€‚
:::
### æœªå…¥åŠ›ãƒã‚§ãƒƒã‚¯
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šIsCheckInputtext
'* æ©Ÿèƒ½ã€€ã€€ï¼šæœªå…¥åŠ›ãƒã‚§ãƒƒã‚¯
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼šTrue=å€¤ã‚ã‚Š, False=å€¤ãªã—
'* å¼•æ•°ã€€ã€€ï¼šstrValueï¼šå¯¾è±¡æ–‡å­—åˆ—
'--------------------------------------------------------------------------------
'********************************************************************************
Function IsCheckInputtext(strValue As String) As Boolean
    IsCheckInputtext = strValue <> ""
End Function
```
-----
### æ•°å€¤ãƒã‚§ãƒƒã‚¯
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šIsCheckNumber
'* æ©Ÿèƒ½ã€€ã€€ï¼šæ•°å€¤ãƒã‚§ãƒƒã‚¯
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼šTrue=æ•°å€¤ã§ã‚ã‚‹, False=æ•°å€¤ã§ã¯ãªã„ï¼‰
'* å¼•æ•°ã€€ã€€ï¼šstrValueï¼šå¯¾è±¡æ–‡å­—åˆ—
'--------------------------------------------------------------------------------
'********************************************************************************
Function IsCheckNumber(strValue As String) As Boolean
    IsCheckNumber = IsNumeric(strValue)
End Function
```
-----
### æ•°å€¤ãƒã‚§ãƒƒã‚¯æ‹¡å¼µç‰ˆï¼ˆåŠè§’æ•°å€¤ã®ç¢ºèªï¼‰
ä¸Šè¨˜ã®é–¢æ•°ã€ŒIsCheckNumberã€ã ã¨ã€
å…¨è§’æ–‡å­—ã®æ•°å€¤ï¼ˆä¾‹ï¼šï¼‘ï¼’ï¼“ï¼”ï¼‰ã‚‚æ•°å€¤ã§ã‚ã‚‹ã¨åˆ¤å®šã—ã¾ã™ã€‚
åŠè§’æ•°å€¤ã®ã¿ã‚’â€œæ•°å€¤â€ã¨ã—ãŸã„å ´åˆã«ã€ã“ã®é–¢æ•°ã‚’ä½¿ç”¨ã€‚
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šIsCheckNumberEx
'* æ©Ÿèƒ½ã€€ã€€ï¼šæ•°å€¤ãƒã‚§ãƒƒã‚¯ï¼ˆåŠè§’æ•°å€¤ã®ç¢ºèªï¼‰
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼šBooleanï¼šTrue=åŠè§’æ•°å€¤ã€False=åŠè§’æ•°å€¤ä»¥å¤–
'* å¼•æ•°ã€€ã€€ï¼šstrTargettextï¼šå¯¾è±¡æ–‡å­—åˆ—
'--------------------------------------------------------------------------------
'********************************************************************************
Function IsCheckNumberEx(strTargettext As String) As Boolean
    Dim objReg As New RegExp

    ' æ¤œç´¢æ¡ä»¶ï¼šåŠè§’æ•°å€¤ã®ã¿
    objReg.Pattern = "[+-]?(?:\d+\.?\d*|\.\d+)"
    objReg.Global = True

    IsCheckNumberEx = objReg.Test(strTargettext)
    
End Function
```
-----
### ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šIsCheckAlivefile
'* æ©Ÿèƒ½ã€€ã€€ï¼šãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼šTrue=å­˜åœ¨ã™ã‚‹, False=å­˜åœ¨ã—ãªã„ï¼‰
'* å¼•æ•°ã€€ã€€ï¼šstrTargetpathï¼šå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«
'--------------------------------------------------------------------------------
'********************************************************************************
Function IsCheckAlivefile(strTargetpath As String) As Boolean
    IsCheckAlivefile = Dir(strTargetpath) <> ""
End Function
```
-----
### ãƒ•ã‚©ãƒ«ãƒ€ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šIsCheckAlivefolder
'* æ©Ÿèƒ½ã€€ã€€ï¼šãƒ•ã‚©ãƒ«ãƒ€ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼šTrue=å­˜åœ¨ã™ã‚‹, False=å­˜åœ¨ã—ãªã„
'* å¼•æ•°ã€€ã€€ï¼šstrTargetpathï¼šå¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€
'--------------------------------------------------------------------------------
'********************************************************************************
Function IsCheckAlivefolder(strTargetpath As String) As Boolean
    IsCheckAlivefolder = Dir(strTargetpath, vbDirectory) <> ""
End Function
```
-----
### èª­ã¿å–ã‚Šå°‚ç”¨ã‹ãƒã‚§ãƒƒã‚¯
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šIsCheckReadonly
'* æ©Ÿèƒ½ã€€ã€€ï¼šèª­ã¿å–ã‚Šå°‚ç”¨ã‹ãƒã‚§ãƒƒã‚¯
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼šBooleanï¼ˆTrueï¼šèª­ã¿å–ã‚Šå°‚ç”¨ã§ã‚ã‚‹, Falseï¼šèª­ã¿å–ã‚Šå°‚ç”¨ã§ã¯ãªã„ï¼‰
'* å¼•æ•°ã€€ã€€ï¼šstrTargetpathï¼šå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«
'--------------------------------------------------------------------------------
'********************************************************************************
Function IsCheckReadonly(strTargetpath As String) As Boolean
    Dim vbResult As VbFileAttribute
    
    ' ãƒ•ã‚¡ã‚¤ãƒ«ã®å±æ€§ã‚’å–å¾—
    vbResult = GetAttr(strTargetpath)
    
    ' èª­ã¿å–ã‚Šå°‚ç”¨ã‹ã®åˆ¤æ–­
    IsCheckReadonly = ((vbResult And vbReadOnly) = vbReadOnly)
    
End Function
```
-----
### ãƒ•ã‚¡ã‚¤ãƒ«ãŒé–‹ãçŠ¶æ…‹ã‹ãƒã‚§ãƒƒã‚¯
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šIsCheckOpened
'* æ©Ÿèƒ½ã€€ã€€ï¼šãƒ•ã‚¡ã‚¤ãƒ«ãŒé–‹ãçŠ¶æ…‹ã‹ãƒã‚§ãƒƒã‚¯
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼šBooleanï¼ˆTrueï¼šé–‹ã‹ã‚Œã¦ã„ã‚‹, Falseï¼šé–‹ã„ã¦ã„ãªã„ï¼‰
'* å¼•æ•°ã€€ã€€ï¼šstrTargetpathï¼šå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«
'--------------------------------------------------------------------------------
'********************************************************************************
Function IsCheckOpened(strTargetpath As String) As Boolean
    Dim intFileno As Integer
    
    intFileno = FreeFile
    
    ' ä¿å­˜æ¸ˆã¿ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‹è¿½è¨˜ãƒ¢ãƒ¼ãƒ‰ã®è¿”ã‚Šå€¤ã§åˆ¤å®š
    On Error Resume Next
    Open strTargetpath For Append As #intFileno
    Close #intFileno
    
    IsCheckOpened = (Err.Number >= 1)
    
End Function
```
-----
### æœªå…¥åŠ›ãƒã‚§ãƒƒã‚¯ï¼ˆExcelã‚·ãƒ¼ãƒˆã®è¡¨ã®å€¤ï¼‰
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šIsCheckInputsheet
'* æ©Ÿèƒ½ã€€ã€€ï¼šæœªå…¥åŠ›ãƒã‚§ãƒƒã‚¯
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼šBooleanï¼ˆTrueï¼šã™ã¹ã¦å…¥åŠ›ã‚ã‚Š, Falseï¼šã„ãšã‚Œã‹æœªå…¥åŠ›ï¼‰
'* å¼•æ•°ã€€ã€€ï¼šstrSheetnameï¼šå¯¾è±¡ã‚·ãƒ¼ãƒˆå, lngStartrowï¼šè¡Œé–‹å§‹ä½ç½®, lngStartcolï¼šåˆ—é–‹å§‹ä½ç½®, strCheckcol_arrayï¼šå¿…é ˆé …ç›®
'--------------------------------------------------------------------------------
'* æ³¨æ„äº‹é …ï¼šåˆ—é–‹å§‹ä½ç½®ã®æœ€å¤§è¡Œæ•°ã¾ã§ã‚’å¯¾è±¡ã«ãƒã‚§ãƒƒã‚¯ã™ã‚‹
'********************************************************************************
Function IsCheckInputsheet(strSheetname As String, strRange As String, aryCheckcol() As String) As Boolean
    Dim wbTargetbook As Workbook
    Dim wsTargetsheet As Worksheet
    
    Dim rngTarget As Range
    Dim lngStartrow As Long
    Dim lngStartcol As Long
    Dim lngMaxrow As Long
    Dim lngMaxcol As Long
    Dim strExcelrange As String
    Dim lngRow As Long
    Dim lngCount As Long
    Dim strValue As String
    
    Set rngTarget = Range(strRange)
    lngStartrow = rngTarget.Row
    lngStartcol = rngTarget.Column
    
    Set wbTargetbook = ThisWorkbook
    ' å¯¾è±¡ã‚·ãƒ¼ãƒˆãŒãªã„å ´åˆã§ã‚‚ã‚¨ãƒ©ãƒ¼ã‚’ç™ºç”Ÿã•ã›ãšç¶šè¡Œã•ã›ã‚‹
    On Error Resume Next
    Set wsTargetsheet = wbTargetbook.Worksheets(strSheetname)
    On Error GoTo 0
    
    ' ã‚·ãƒ¼ãƒˆãŒã‚ã‚‹å ´åˆ
    If (IsCheckAlivesheet(strSheetname)) And _
       (UBound(aryCheckcol) <> -1) Then
        With wsTargetsheet
            lngMaxrow = .Cells(Rows.Count, lngStartcol).End(xlUp).Row
            If lngStartrow > lngMaxrow Then
                ' ãƒ‡ãƒ¼ã‚¿0ä»¶ã®ç‚ºã€ã‚¹ã‚­ãƒƒãƒ—
                Exit Function
            End If
            lngMaxcol = .Cells(lngStartrow, Columns.Count).End(xlToLeft).Column
            
            For lngRow = lngStartrow To lngMaxrow
                For lngCount = 0 To UBound(aryCheckcol)
                    strValue = .Cells(lngRow, CLng(aryCheckcol(lngCount)))
                    strExcelrange = .Cells(lngRow, CLng(aryCheckcol(lngCount))).Address(False, False)
                    If IsCheckInputtext(strValue) = False Then
                        IsCheckInputsheet = False
                        Exit Function
                    End If
                Next
            Next
        End With
    End If
    
    IsCheckInputsheet = True
    
    Set wbTargetbook = Nothing
    Set wsTargetsheet = Nothing
    
End Function
```
-----
### ã‚·ãƒ¼ãƒˆã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šIsCheckAlivesheet
'* æ©Ÿèƒ½ã€€ã€€ï¼šã‚·ãƒ¼ãƒˆã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼šBooleanï¼ˆTrueï¼šå­˜åœ¨ã™ã‚‹, Falseï¼šå­˜åœ¨ã—ãªã„ï¼‰
'* å¼•æ•°ã€€ã€€ï¼šstrSheetnameï¼šå¯¾è±¡ã‚·ãƒ¼ãƒˆå
'--------------------------------------------------------------------------------
'********************************************************************************
Function IsCheckAlivesheet(strSheetname As String) As Boolean
    Dim wbTargetbook As Workbook
    Dim wsTargetsheet As Worksheet
    Set wbTargetbook = ThisWorkbook
    Set wsTargetsheet = Nothing

    On Error Resume Next
    Set wsTargetsheet = wbTargetbook.Worksheets(strSheetname)
    On Error GoTo 0

    IsCheckAlivesheet = (Not (wsTargetsheet Is Nothing))
    
    Set wsTargetsheet = Nothing
    Set wbTargetbook = Nothing
    
End Function
```
### è¨­å®šæƒ…å ±ã‚·ãƒ¼ãƒˆã®ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
Excel VBAã‚’ä½œã‚‹éš›ã€æ¯å›åŒã˜ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿æ•´å½¢ã‚’è¡Œã†ãŒã€
Excelã®å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã§å€¤ãŒé–‹å§‹ã•ã‚Œã‚‹ã‚»ãƒ«ä½ç½®ãªã©å¾®é‡ãªå¤‰åŒ–ãŒã‚ã‚‹ã€‚
ãã®ã‚ˆã†ãªçŠ¶æ³ã«å¯¾å¿œã™ã‚‹ç‚ºã€ã‚ˆãå¤‰åŒ–ã™ã‚‹æƒ…å ±ã‚’Excelã‚·ãƒ¼ãƒˆã«å¤–ã ã—ã—ã¦ã„ã‚‹ã€‚
ã“ã®é–¢æ•°ã¯ã€ãã®å¤–ã ã—ã—ã¦ã„ã‚‹ã‚·ãƒ¼ãƒˆã®æƒ…å ±ã‚’èª­ã¿è¾¼ã‚€ç‚ºã®é–¢æ•°ã¨ãªã‚‹ã€‚
#### ä¾‹ï¼‰è¨­å®šæƒ…å ±ã‚’å¤–ã ã—ã—ã¦ã„ã‚‹Excelã‚·ãƒ¼ãƒˆ
![](https://storage.googleapis.com/zenn-user-upload/e03ba7b07dd5-20230222.png =600x)
*ç”»åƒï¼šè¨­å®šæƒ…å ±ã‚·ãƒ¼ãƒˆã®ä¾‹*
#### å®šæ•°éƒ¨åˆ†
```excel-formula
' ã€€ãƒã‚§ãƒƒã‚¯æ™‚
Public Const PC_EXE As String = "D4,D5,D6,D7,D8,D9,D10"
' ã€€å…¥åŠ›ã‚·ãƒ¼ãƒˆ
Public Const PC_INPUT As String = "D13,D14,D15,D16,D17,D18,D19,D20,D21,D22,D23,D24,D25,D26,D27,D28,D29"
' ã€€å‡ºåŠ›ã‚·ãƒ¼ãƒˆ
Public Const PC_OUTPUT As String = "D32,D33,D34,D35,D36,D37,D38,D39,D40,D41,D42,D43,D44,D45,D46,D47,D48"
' ã€€ã‚¨ãƒ©ãƒ¼æƒ…å ±
Public Const PC_ERROR As String = "D51,D52,D53,D54,D55"
' ã€€éè¡¨ç¤ºã‚·ãƒ¼ãƒˆ
Public Const PC_HIDDEN_SHEETS As String = "D5,D15,D16,D17,D34,D35,D36,D37,D38,D51"
```
#### é–¢æ•°éƒ¨åˆ†
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šFuncLoadSetup
'* æ©Ÿèƒ½ã€€ã€€ï¼šè¨­å®šæƒ…å ±ã®èª­ã¿è¾¼ã¿
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼šString() è©²å½“ã®è¨­å®šæƒ…å ±ãƒ‡ãƒ¼ã‚¿
'* å¼•æ•°ã€€ã€€ï¼šstrGroupid è¨­å®šã®ã‚°ãƒ«ãƒ¼ãƒ—å
'--------------------------------------------------------------------------------
'********************************************************************************
Function FuncLoadSetup(strGroupid As String) As String()
    Dim arySetuprange() As String
    
    Select Case strGroupid
        ' å®Ÿè¡Œç”»é¢
        Case "EXE"
            arySetuprange = Split(PC_EXE, ",")
        Case "INPUT"
            arySetuprange = Split(PC_INPUT, ",")
        Case "OUTPUT"
            arySetuprange = Split(PC_OUTPUT, ",")
        Case "ERROR"
            arySetuprange = Split(PC_ERROR, ",")
        Case "HIDDEN_SHEETS"
            arySetuprange = Split(PC_HIDDEN_SHEETS, ",")
    End Select
    
    FuncLoadSetup = arySetuprange
    
End Function
```
-----
### æŒ‡å®šã‚»ãƒ«ã®é¸æŠ
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šSubSelectCell
'* æ©Ÿèƒ½ã€€ã€€ï¼šæŒ‡å®šã‚»ãƒ«ã®é¸æŠ
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼šãªã—
'* å¼•æ•°ã€€ã€€ï¼šstrSheetnameï¼šå¯¾è±¡ã‚·ãƒ¼ãƒˆåã€strRangeï¼šå¯¾è±¡ã‚»ãƒ«
'--------------------------------------------------------------------------------
'********************************************************************************
Sub SubSelectCell(strSheetname As String, strRange As String)
    With Worksheets(strSheetname)
        .Select
        .Range(strRange).Select
    End With
End Sub
```
-----
### ã‚·ãƒ¼ãƒˆã®ã‚¯ãƒªã‚¢
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šSubInitExcelsheet
'* æ©Ÿèƒ½ã€€ã€€ï¼šã‚·ãƒ¼ãƒˆã®ã‚¯ãƒªã‚¢
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼š-
'* å¼•æ•°ã€€ã€€ï¼šstrSheetnameï¼šå¯¾è±¡ã‚·ãƒ¼ãƒˆ, lngStartrowï¼šè¡Œé–‹å§‹ä½ç½®ï¼ˆå‰Šé™¤é–‹å§‹ã™ã‚‹è¡Œï¼‰, lngStartcolï¼šåˆ—é–‹å§‹ä½ç½®
'--------------------------------------------------------------------------------
'********************************************************************************
Sub SubInitExcelsheet(strSheetname As String, strRange As String)
    Dim wbTargetbook As Workbook
    Dim wsTargetsheet As Worksheet
    
    Dim rngTarget As Range
    Dim lngStartrow As Long
    Dim lngStartcol As Long
    Dim lngMaxrow As Long
    
    Set wbTargetbook = ThisWorkbook
    
    ' å¯¾è±¡ã‚·ãƒ¼ãƒˆãŒãªã„å ´åˆã§ã‚‚ã‚¨ãƒ©ãƒ¼ã‚’ç™ºç”Ÿã•ã›ãšç¶šè¡Œã•ã›ã‚‹
    On Error Resume Next
    Set wsTargetsheet = wbTargetbook.Worksheets(strSheetname)
    On Error GoTo 0
    
    Set rngTarget = Range(strRange)
    lngStartrow = rngTarget.Row
    lngStartcol = rngTarget.Column
    
    ' ã‚·ãƒ¼ãƒˆãŒã‚ã‚‹å ´åˆ
    If (IsCheckAlivesheet(strSheetname)) Then
        With wsTargetsheet
            lngMaxrow = .Cells(Rows.Count, lngStartcol).End(xlUp).Row
            ' è¡¨ã«å€¤ãŒãªã„å ´åˆã¯æœ€å¤§è¡Œæ•°ã‚’é–‹å§‹è¡Œã¸å¤‰æ›´ã™ã‚‹
            If lngStartrow > lngMaxrow Then
                lngMaxrow = lngStartrow
            End If
            .Range(.Cells(lngStartrow, lngStartcol), .Cells(lngMaxrow, Columns.Count)).ClearContents
            .Range(.Cells(lngStartrow, lngStartcol), .Cells(Rows.Count, Columns.Count)).Interior.ColorIndex = 2
            .Range(.Cells(lngStartrow, lngStartcol), .Cells(Rows.Count, Columns.Count)).Borders.LineStyle = False
        End With
    End If
    
    Set wbTargetbook = Nothing
    Set wsTargetsheet = Nothing
    
End Sub
```
-----
### CSVãƒ•ã‚¡ã‚¤ãƒ«å–ã‚Šè¾¼ã¿
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šSubInputCsvfile
'* æ©Ÿèƒ½ã€€ã€€ï¼šCSVãƒ•ã‚¡ã‚¤ãƒ«å–ã‚Šè¾¼ã¿
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼š-
'* å¼•æ•°ã€€ã€€ï¼šstrValueï¼šå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«, strSheetnameï¼šå¯¾è±¡ã‚·ãƒ¼ãƒˆ, strCsvrangeï¼šCSVå€¤é–‹å§‹ä½ç½®, strExcelrangeï¼šã‚·ãƒ¼ãƒˆå€¤é–‹å§‹ä½ç½®, strCharcodeï¼šæ–‡å­—ã‚³ãƒ¼ãƒ‰
'--------------------------------------------------------------------------------
'********************************************************************************
Sub SubInputCsvfile(strValue As String, strSheetname As String, strCsvrange As String, strExcelrange As String, strCharcode As String)
    Dim qtbTargetfile As QueryTable
    Dim rngCsv As Range
    Dim rngExcel As Range
    Dim lngCsvstartrow As Long
    Dim lngExcelstartrow As Long
    Dim lngExcelstartcol As Long
    Dim lngMaxrow As Long
    Set rngCsv = Range(strCsvrange)
    lngCsvstartrow = rngCsv.Row
    Set rngExcel = Range(strExcelrange)
    lngExcelstartrow = rngExcel.Row
    lngExcelstartcol = rngExcel.Column
    
    With Worksheets(strSheetname)
        lngMaxrow = .Cells(Rows.Count, lngExcelstartcol).End(xlUp).Row
    End With
    
    If lngMaxrow > lngExcelstartrow Then
        lngExcelstartrow = lngMaxrow + 1
    End If
    
    Set qtbTargetfile = Worksheets(strSheetname).QueryTables.Add(Connection:="TEXT;" & strValue, _
        Destination:=Worksheets(strSheetname).Cells(lngExcelstartrow, lngExcelstartcol))
    
    With qtbTargetfile
        .TextFileCommaDelimiter = True                       ' ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã®æŒ‡å®š
        .TextFileParseType = xlDelimited                     ' åŒºåˆ‡ã‚Šæ–‡å­—ã®å½¢å¼
        .TextFileTextQualifier = xlTextQualifierDoubleQuote  ' å¼•ç”¨ç¬¦ã‚ã‚Šãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®š
        If strCharcode = "UTF8" Then
            .TextFilePlatform = 65001                        ' æ–‡å­—ã‚³ãƒ¼ãƒ‰UTF-8ã‚’æŒ‡å®š
        Else
            .TextFilePlatform = 932                          ' æ–‡å­—ã‚³ãƒ¼ãƒ‰Shift_JISã‚’æŒ‡å®š
        End If
       .TextFileStartRow = lngCsvstartrow                   ' é–‹å§‹è¡Œã®æŒ‡å®š
       .RefreshStyle = xlOverwriteCells                     ' ã‚»ãƒ«ã¯è¿½åŠ ã›ãšä¸Šæ›¸ãã™ã‚‹
       .Refresh                                             ' QueryTablesã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ›´æ–°ã—ã€ã‚·ãƒ¼ãƒˆä¸Šã«å‡ºåŠ›
       .Delete                                              ' QueryTables.Addãƒ¡ã‚½ãƒƒãƒ‰ã§å–ã‚Šè¾¼ã‚“ã CSVã¨ã®æ¥ç¶šã‚’è§£é™¤
    End With
    
    Set qtbTargetfile = Nothing

End Sub
```
-----
### CSVãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šSubOutputCsvfile
'* æ©Ÿèƒ½ã€€ã€€ï¼šCSVãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼š-
'* å¼•æ•°ã€€ã€€ï¼šstrFilepathï¼šå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«, strSheetnameï¼šå¯¾è±¡ã‚·ãƒ¼ãƒˆ, lngCsvstartrowï¼šè¡Œé–‹å§‹ä½ç½®, lngStartcolï¼šåˆ—é–‹å§‹ä½ç½®
'--------------------------------------------------------------------------------
'********************************************************************************
Sub SubOutputCsvfile(strSheetname As String, strSheetrange As String, strFilepath As String, strCsvrange As String)
    Dim rngSheet As Range
    Dim lngSheetstartrow As Long
    Dim lngSheetstartcol As Long
    Dim lngCsvstartrow As Long
    Dim lngCsvstartcol As Long
    Dim rngCsv As Range
    Dim lngMaxrow As Long
    Dim lngMaxcol As Long
    Dim lngRow As Long
    Dim lngCol As Long
    Dim strCsvdata As String
    Dim strLine As String
    Dim strValue As String
    Dim strDelimiter As String
    Dim aryItems() As String

    Set rngSheet = Range(strSheetrange)
    lngSheetstartrow = rngSheet.Row
    lngSheetstartcol = rngSheet.Column
    Set rngCsv = Range(strCsvrange)
    lngCsvstartrow = rngCsv.Row
    lngCsvstartcol = rngCsv.Column

    Dim objUtf8 As Object
    Dim objNonbom As Object
    Set objUtf8 = CreateObject("ADODB.Stream")
    Set objNonbom = CreateObject("ADODB.Stream")

    ' CSVå½¢å¼ã®æº–å‚™
    With Worksheets(strSheetname)
        lngMaxrow = .Cells(Rows.Count, lngSheetstartcol).End(xlUp).Row
        lngMaxcol = .Cells(lngSheetstartrow - 1, Columns.Count).End(xlToLeft).Column
    End With
    
    If lngCsvstartrow > lngMaxrow Then
        lngMaxrow = lngCsvstartrow
    End If

    strDelimiter = ","

    For lngRow = lngSheetstartrow To lngMaxrow
        strLine = ""
        For lngCol = lngSheetstartcol To lngMaxcol
            With Worksheets(strSheetname)
                strValue = .Cells(lngRow, lngCol).Value
            End With
            If strLine = "" Then
                strLine = strValue
            Else
                ReDim aryItems(1)
                aryItems(0) = strLine
                aryItems(1) = strValue
                strLine = Join(aryItems, strDelimiter)
            End If
        Next

        If strCsvdata = "" Then
            strCsvdata = strLine
        Else
            ReDim aryItems(1)
            aryItems(0) = strCsvdata
            aryItems(1) = strLine
            strCsvdata = Join(aryItems, vbCrLf)
        End If
    Next
    ' æœ€çµ‚è¡Œã«ç©ºæ–‡å­—è¡Œ
    ReDim aryItems(1)
    aryItems(0) = strCsvdata
    aryItems(1) = ""
    strCsvdata = Join(aryItems, vbCrLf)

    ' æ›¸ãè¾¼ã¿
    With objUtf8
        .Charset = "UTF-8"
        .Open
        .WriteText strCsvdata
        .Position = 0
        .Type = 1           'Binary
        .Position = 3
    End With

    With objNonbom
        .Type = 1           'Binary
        .Open
        objUtf8.CopyTo objNonbom
        .SaveToFile strFilepath, 2 ' SaveCreateOverWrite
    End With

    objNonbom.Close
    objUtf8.Close

    Set objNonbom = Nothing
    Set objUtf8 = Nothing

End Sub
```
-----
### ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ã®è¡¨ç¤º
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šSubViewMessagebox
'* æ©Ÿèƒ½ã€€ã€€ï¼šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¡¨ç¤º
'---------------------------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼š-
'* å¼•æ•°ã€€ã€€ï¼šstrMessagecodeï¼šå¯¾è±¡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ¼ãƒ‰ã€strPlusmessagesï¼šè¿½åŠ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸(ä»»æ„)
'--------------------------------------------------------------------------------
'********************************************************************************
Sub SubViewMessagebox(strResultcode As String, Optional strPlusmessages As String = "")
    Dim strMessage As String
    Dim lngCount As Long
    Dim lngLevel As Long
    Dim strLevel As String
    
    Dim aryMessages(20, 1) As String
    ' æ­£å¸¸çµ‚äº†ã‚³ãƒ¼ãƒ‰
    aryMessages(0, 0) = "0"
    aryMessages(0, 1) = "æ­£å¸¸çµ‚äº†ã€‚"
    aryMessages(1, 0) = "10"
    aryMessages(1, 1) = "åˆæœŸåŒ–ã‚’å®Ÿè¡Œã€‚"
    aryMessages(2, 0) = "20"
    aryMessages(2, 1) = "å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚"
    ' ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    ' ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆãƒœã‚¿ãƒ³
    aryMessages(3, 0) = "-101"
    aryMessages(3, 1) = "ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆå‡¦ç†ã§ç•°å¸¸çµ‚äº†ã€‚"
    ' å…¥åŠ›ãƒã‚§ãƒƒã‚¯
    aryMessages(4, 0) = "-211"
    aryMessages(4, 1) = "æœªå…¥åŠ›ã®é …ç›®ãŒã‚ã‚Šã€‚"
    ' å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    aryMessages(5, 0) = "-212"
    aryMessages(5, 1) = "å‚ç…§ã§ããªã„ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã€‚"
    aryMessages(6, 0) = "-213"
    aryMessages(6, 1) = "å‚ç…§ã§ããªã„ãƒ•ã‚©ãƒ«ãƒ€ãŒã‚ã‚Šã€‚"
    ' å¿…é ˆãƒã‚§ãƒƒã‚¯
    aryMessages(7, 0) = "-214"
    aryMessages(7, 1) = "å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã«æ¬ æãŒã‚ã‚Šã€‚"
    ' å‡¦ç†æ¯ã®ã‚¨ãƒ©ãƒ¼
    aryMessages(8, 0) = "-301"
    aryMessages(8, 1) = "å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿æ™‚ã«ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(9, 0) = "-311"
    aryMessages(9, 1) = "å•†å“1ãƒ‡ãƒ¼ã‚¿ã®å‡ºåŠ›ã§ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(10, 0) = "-312"
    aryMessages(10, 1) = "å•†å“2ãƒ‡ãƒ¼ã‚¿ã®å‡ºåŠ›ã§ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(11, 0) = "-313"
    aryMessages(11, 1) = "å•†å“3ãƒ‡ãƒ¼ã‚¿ã®å‡ºåŠ›ã§ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(12, 0) = "-314"
    aryMessages(12, 1) = "å•†å“4ãƒ‡ãƒ¼ã‚¿ã®å‡ºåŠ›ã§ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(13, 0) = "-315"
    aryMessages(13, 1) = "å•†å“5ãƒ‡ãƒ¼ã‚¿ã®å‡ºåŠ›ã§ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(14, 0) = "-321"
    aryMessages(14, 1) = "ãƒ‡ãƒ¼ã‚¿ã®ä¸¦ã³æ›¿ãˆã§ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(15, 0) = "-331"
    aryMessages(15, 1) = "ãƒ‡ãƒ¼ã‚¿æ•´å½¢ã®å‡¦ç†1ã§ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(16, 0) = "-332"
    aryMessages(16, 1) = "ãƒ‡ãƒ¼ã‚¿æ•´å½¢ã®å‡¦ç†2ã§ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(17, 0) = "-341"
    aryMessages(17, 1) = "ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›æ™‚ã«ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(18, 0) = "-801"
    aryMessages(18, 1) = "åˆæœŸåŒ–ä¸­ã«ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(19, 0) = "-901"
    aryMessages(19, 1) = "å®Ÿè¡Œä¸­ã«ä¸­æ–­ã€‚"
    aryMessages(20, 0) = "-999"
    aryMessages(20, 1) = "ä¾‹å¤–ãŒç™ºç”Ÿã€‚"
    
    lngCount = 0
    strMessage = "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚"
    For lngCount = LBound(aryMessages, 1) To UBound(aryMessages, 1)
        If aryMessages(lngCount, 0) = strResultcode Then
            strMessage = aryMessages(lngCount, 1)
            strMessage = strMessage & vbCrLf & strPlusmessages & vbCrLf
            Exit For
        End If
    Next
    
    If Left(aryMessages(lngCount, 0), 1) = "-" Then
        lngLevel = vbExclamation
        strLevel = "æ³¨æ„"
    Else
        lngLevel = vbInformation
        strLevel = "æƒ…å ±"
    End If
    
    strMessage = strMessage & vbCrLf & "Message Codeï¼š" & "[" & strResultcode & "]"
    
    MsgBox strMessage, vbOKOnly + lngLevel, strLevel
    
End Sub
```
-----
### é€šçŸ¥ç”¨ã®æ–‡å­—åˆ—ä½œæˆ
#### å®šæ•°éƒ¨åˆ†
```excel-formula
Public Const PC_SETUPSHEET As String = "è¨­å®šæƒ…å ±ã‚·ãƒ¼ãƒˆ"
```
#### é–¢æ•°éƒ¨åˆ†
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šSubViewMessagelabel
'* æ©Ÿèƒ½ã€€ã€€ï¼šé€šçŸ¥ç”¨ã®æ–‡å­—åˆ—ä½œæˆ
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼š-
'* å¼•æ•°ã€€ã€€ï¼šstrLabelcodeï¼šå¯¾è±¡ãƒ©ãƒ™ãƒ«ã‚³ãƒ¼ãƒ‰ã€strPlusmessagesï¼šè¿½åŠ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸(ä»»æ„)
'--------------------------------------------------------------------------------
'********************************************************************************
Public Sub SubViewMessagelabel(strLabelcode As String, Optional strPlusmessage As String = "")
    Dim arySetuprange() As String
    arySetuprange = mdlCommon.FuncLoadSetup("EXE")
    
    Dim strSheetname As String
    Dim strRange As String
    Dim strMessage As String
    Dim strDatetime As String
    Dim lngCount As Long
    
    strDatetime = Format(Now, "yyyy/mm/dd hh:mm:ss")
    
    With Worksheets(mdlCommon.PC_SETUPSHEET)
        strSheetname = .Range(arySetuprange(0)).Value
        strRange = .Range(arySetuprange(2)).Value
    End With
    
    Dim aryMessages(2, 1) As String
    ' æ­£å¸¸çµ‚äº†ã‚³ãƒ¼ãƒ‰
    aryMessages(0, 0) = "+00"
    aryMessages(0, 1) = "å‡¦ç†å®Œäº†ã€‚"
    aryMessages(1, 0) = "+01"
    aryMessages(1, 1) = "ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆå®Œäº†ã€‚"
    aryMessages(2, 0) = "+02"
    aryMessages(2, 1) = "ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆæ¸ˆã¿ã€‚"
    
    lngCount = 0
    strMessage = ""
    For lngCount = LBound(aryMessages, 1) To UBound(aryMessages, 1)
        If aryMessages(lngCount, 0) = strLabelcode Then
            strMessage = aryMessages(lngCount, 1)
            strMessage = strDatetime & " " & _
                         strMessage & vbCrLf & _
                         strPlusmessage
            Exit For
        End If
    Next
    
    With Worksheets(strSheetname)
        .Range(strRange).Font.ColorIndex = 11
        If UBound(aryMessages, 1) >= lngCount Then
            If Left(aryMessages(lngCount, 0), 1) = "-" Then
                .Range(strRange).Font.ColorIndex = 3
            End If
        End If
        .Range(strRange).Value = strMessage
    End With
    
End Sub
```
-----
### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ã®è¡¨ç¤º
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šSubViewStatusbar
'* æ©Ÿèƒ½ã€€ã€€ï¼šã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ã®è¡¨ç¤º
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼š-
'* å¼•æ•°ã€€ã€€ï¼šblStatusbarï¼šã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºã®æœ‰ç„¡(Trueï¼šè¡¨ç¤º, Falseï¼šéè¡¨ç¤º), strPlusmessagesï¼š(ä»»æ„)è¿½åŠ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
'--------------------------------------------------------------------------------
'********************************************************************************
Sub SubViewStatusbar(blStatusbar As Boolean, Optional strPlusmessages As String)
    If blStatusbar = True Then
        Application.StatusBar = "Excel-VBA å®Ÿè¡Œä¸­ã§ã™..." & strPlusmessages
    Else
        Application.StatusBar = False
    End If
End Sub
```
-----
### VBAå‡¦ç†ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚¢ãƒƒãƒ—è¨­å®š
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šSubSetVbaspeed
'* æ©Ÿèƒ½ã€€ã€€ï¼šVBAå‡¦ç†ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚¢ãƒƒãƒ—è¨­å®š
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼š-
'* å¼•æ•°ã€€ã€€ï¼šblProcessstart(Trueï¼šé«˜é€ŸåŒ–æœ‰åŠ¹, Falseï¼šé«˜é€ŸåŒ–ç„¡åŠ¹)
'--------------------------------------------------------------------------------
'********************************************************************************
Sub SubSetVbaspeed(blProcessstart As Boolean)
    Dim strCurrentpath As String
    If blProcessstart = True Then
        ' å‡¦ç†é«˜é€ŸåŒ–
        ' ã‚«ãƒ¼ã‚½ãƒ«ã‚’å¾…æ©Ÿä¸­ã«è¨­å®š
        Application.Cursor = xlWait
	
        ' ç”»é¢æå†™ã®åœæ­¢ã‚’è¨­å®š
        Application.ScreenUpdating = False
        ' è‡ªå‹•è¨ˆç®—ã®åœæ­¢ã‚’è¨­å®š
        Application.Calculation = xlCalculationManual
        ' ãƒ¦ãƒ¼ã‚¶æ“ä½œç¦æ­¢ã‚’è¨­å®š
        Application.Interactive = False
    Else
        ' ç”»é¢æå†™ã‚’å†é–‹
        Application.ScreenUpdating = True
        ' è‡ªå‹•è¨ˆç®—ã‚’å†é–‹
        Application.Calculation = xlCalculationAutomatic
        ' ãƒ¦ãƒ¼ã‚¶æ“ä½œã‚’å†é–‹
        Application.Interactive = True
        ' ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹•
        strCurrentpath = ThisWorkbook.Path
        ChDrive strCurrentpath
        ChDir strCurrentpath
        
        ' ã‚«ãƒ¼ã‚½ãƒ«ã‚’å…ƒã«æˆ»ã™
        Application.Cursor = xlDefault
    End If
End Sub
```
-----
### ã‚·ãƒ¼ãƒˆè¡¨ç¤ºï¼éè¡¨ç¤ºã®è¨­å®š
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šSubVisiblesheet
'* æ©Ÿèƒ½ã€€ã€€ï¼šã‚·ãƒ¼ãƒˆè¡¨ç¤ºï¼éè¡¨ç¤ºã®è¨­å®š
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼š-
'* å¼•æ•°ã€€ã€€ï¼šstrTargetgroupï¼šå¯¾è±¡ã‚°ãƒ«ãƒ¼ãƒ—, blVisible(True è¡¨ç¤º, False éè¡¨ç¤º)
'--------------------------------------------------------------------------------
'********************************************************************************
Sub SubVisiblesheet(strTargetgroup As String, blVisible As Boolean)
    Dim arySetuprange() As String
    arySetuprange = mdlCommon.FuncLoadSetup(strTargetgroup)
    
    Dim lngCount As Long
    Dim strSheetname As String
    
    For lngCount = 0 To UBound(arySetuprange)
        strSheetname = Worksheets(mdlCommon.PC_SETUPSHEET).Range(arySetuprange(lngCount)).Value
        Worksheets(strSheetname).Visible = blVisible
    Next

End Sub
```
-----
### Excelã‚·ãƒ¼ãƒˆã®ã‚³ãƒ”ãƒ¼
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šSubCopyExcelsheet
'* æ©Ÿèƒ½ã€€ã€€ï¼šExcelã‚·ãƒ¼ãƒˆã®ã‚³ãƒ”ãƒ¼
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼š-
'* å¼•æ•°ã€€ã€€ï¼šstrSheetnameFmï¼šèª­è¾¼å´ å¯¾è±¡ã‚·ãƒ¼ãƒˆ, lngStartrowFmï¼šèª­è¾¼å´ è¡Œé–‹å§‹ä½ç½®, lngStartcolFmï¼šèª­è¾¼å´ åˆ—é–‹å§‹ä½ç½®
'*     ã€€ã€€ï¼šstrSheetnameToï¼šå‡ºåŠ›å´ å¯¾è±¡ã‚·ãƒ¼ãƒˆ, lngStartrowToï¼šå‡ºåŠ›å´ è¡Œé–‹å§‹ä½ç½®, lngStartcolToï¼šå‡ºåŠ›å´ åˆ—é–‹å§‹ä½ç½®
'--------------------------------------------------------------------------------
'********************************************************************************
Sub SubCopyExcelsheet(strSheetnameFm As String, lngStartrowFm As Long, lngStartcolFm As Long, _
                      strSheetnameTo As String, lngStartrowTo As Long, lngStartcolTo As Long)
    Dim wbTargetbook As Workbook
    Dim wsFromsheet As Worksheet
    Dim wsTosheet As Worksheet
    
    Dim lngMaxrowFm As Long
    Dim lngMaxcolFm As Long
    Dim lngMaxrowTo As Long
    Dim lngMaxcolTo As Long
    
    Dim lngRowFm As Long
    Dim lngColFm As Long
    Dim lngRowTo As Long
    Dim lngColTo As Long
    
    Dim lngRow As Long
    
    Dim varImportdata As Variant
    Dim varExportdata As Variant
    
    Set wbTargetbook = ThisWorkbook
    
    On Error Resume Next
    Set wsFromsheet = wbTargetbook.Worksheets(strSheetnameFm)
    Set wsTosheet = wbTargetbook.Worksheets(strSheetnameTo)
    On Error GoTo 0
    
    ' ã‚·ãƒ¼ãƒˆãŒã‚ã‚‹å ´åˆ
    If Not (wsFromsheet Is Nothing) And _
       Not (wsTosheet Is Nothing) Then
        With wsFromsheet
            lngMaxrowFm = .Cells(Rows.Count, lngStartcolFm + 1).End(xlUp).Row
            If lngStartrowFm > lngMaxrowFm Then
                lngMaxrowFm = lngStartrowFm
            End If
            
            lngRowFm = lngStartrowFm
            lngColFm = lngStartcolFm
            lngRowTo = lngStartrowTo
            lngColTo = lngStartcolTo
            
            ReDim varExportdata(lngMaxrowFm - 1, 30)
            
            varImportdata = .Range(.Cells(lngRowFm, lngColFm), .Cells(lngMaxrowFm, lngColFm + 30)).Value
        End With
        
        varExportdata = varImportdata
        
        ' æ—¥ä»˜ã‚’YYYY-MM-DDã§è¡¨ç¤º
        For lngRow = 1 To UBound(varExportdata)
            varExportdata(lngRow, 30) = "'" & varExportdata(lngRow, 30)
        Next
        
        With wsTosheet
            .Range(.Cells(lngRowTo, lngColTo), .Cells(lngMaxrowFm, lngColTo + 30)).Value = varExportdata
            ' ç½«ç·šã®è¨­å®š
            lngMaxrowTo = .Cells(Rows.Count, lngStartcolTo).End(xlUp).Row
            lngMaxcolTo = .Cells(1, Columns.Count).End(xlToLeft).Column
            .Range(Cells(lngStartrowTo, lngStartcolTo), Cells(lngMaxrowTo, lngMaxcolTo)).Borders.LineStyle = True
        End With
    End If
    
    Set wsFromsheet = Nothing
    Set wsTosheet = Nothing
    Set wbTargetbook = Nothing
    
End Sub
```
-----
### æŒ‡å®šãƒ•ã‚©ãƒ«ãƒ€ã‚’é–‹ã
```excel-formula
'********************************************************************************
'* å‡¦ç†åã€€ï¼šSubOpenFolder
'* æ©Ÿèƒ½ã€€ã€€ï¼šæŒ‡å®šãƒ•ã‚©ãƒ«ãƒ€ã‚’é–‹ã
'--------------------------------------------------------------------------------
'* è¿”ã‚Šå€¤ã€€ï¼š-
'* å¼•æ•°ã€€ã€€ï¼šstrValue
'--------------------------------------------------------------------------------
'********************************************************************************
Sub SubOpenFolder(strValue As String)
On Error GoTo CATCH
    Shell "C:\WIndows\Explorer.exe " & strValue, vbNormalFocus
CATCH:
End Sub
```
## ã¾ã¨ã‚
ã‹ãªã‚Šãƒ¬ã‚¬ã‚·ãƒ¼ãªExcel VBAã§ã™ãŒã€
ã¡ã‚‡ã£ã¨ã—ãŸãƒ„ãƒ¼ãƒ«ä½œæˆã§ã¯åŠ›ã‚’ç™ºæ®ã—ã¦ãã‚Œã¾ã™ã€‚
ã“ã®è¨˜äº‹ãŒã”å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚