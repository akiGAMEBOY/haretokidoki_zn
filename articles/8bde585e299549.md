---
title: "[Excel VBA]è‡ªä½œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®é–¢æ•°ã¾ã¨ã‚"
emoji: "ğŸ‘´"
type: "tech"
topics:
  - "excel"
  - "vba"
published: true
published_at: "2023-02-22 16:19"
---

## æ¦‚è¦
Excel VBAã§ç°¡å˜ãªãƒ„ãƒ¼ãƒ«ã‚’ä½œæˆã™ã‚‹éš›ã€
ã‚ˆãæ›¸ãå‡¦ç†ã¯è‡ªä½œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆmdlCommon.basï¼‰ã«ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚
è‡ªèº«ã§ãµã‚Šè¿”ã‚Šä½¿ã†äº‹ã‚‚ã‚ã‚‹ã®ã§å‚™å¿˜ã‚‚ã‹ã­ã¦è¨˜äº‹ã«ã—ã¾ã™ã€‚
## ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
Excel VBAãƒ¦ãƒ¼ã‚¶
## å…±é€šå‡¦ç†ã®ã¾ã¨ã‚
:::message
æ™®æ®µã€ç§ãŒä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€ŒmdlCommon.basã€ã‹ã‚‰æŠœç²‹ã—ã¦ã„ã‚‹ç‚ºã€
é–¢æ•°ã®ä¸­ã«ã¯æ±ç”¨çš„ã«ãªã£ã¦ã„ãªã„ç®‡æ‰€ãŒã‚ã‚Šã¾ã™ã€‚

åˆ©ç”¨ã•ã‚Œã‚‹éš›ã¯èª­ã¿æ›ãˆã¦ã€ã”å¯¾å¿œãã ã•ã„ã€‚
:::
### Functionãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£
#### ç©ºæ–‡å­—ãƒã‚§ãƒƒã‚¯
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œIsEmptyText
'* æ©Ÿèƒ½ã€€ã€€ï½œç©ºæ–‡å­—ãƒã‚§ãƒƒã‚¯
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue=å€¤ã‚ã‚Š, False=å€¤ãªã—ï¼‰
'* å¼•æ•°ã€€ã€€ï½œstrValueï¼šå¯¾è±¡æ–‡å­—åˆ—
'********************************************************************************
Function IsEmptyText(strValue As String) As Boolean
    IsEmptyText = strValue == ""

End Function
```
-----
#### æ•°å€¤ãƒã‚§ãƒƒã‚¯ï¼ˆåŠè§’æ•°å€¤ã®åˆ¤å®šï¼‰
ã€ŒIsNumeric("æ–‡å­—åˆ—")ã€ã§æ•°å€¤ã‚’åˆ¤å®šã™ã‚‹ã¨ã€
å…¨è§’æ–‡å­—ã®æ•°å€¤ï¼ˆä¾‹ï¼šï¼‘ï¼’ï¼“ï¼”ï¼‰ã‚‚æ•°å€¤ã§ã‚ã‚‹ã¨åˆ¤å®šã—ã¦ã—ã¾ã†ã€‚
åŠè§’æ•°å€¤ã®ã¿ã‚’â€œæ•°å€¤â€ã¨ã—ãŸã„å ´åˆã«ã€ã“ã®é–¢æ•°ã‚’ä½¿ç”¨ã€‚
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œIsNumericEx
'* æ©Ÿèƒ½ã€€ã€€ï½œæ•°å€¤ãƒã‚§ãƒƒã‚¯ï¼ˆåŠè§’æ•°å€¤ã®åˆ¤å®šï¼‰
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue=åŠè§’æ•°å€¤ã€False=åŠè§’æ•°å€¤ä»¥å¤–ï¼‰
'* å¼•æ•°ã€€ã€€ï½œstrValueï¼šå¯¾è±¡æ–‡å­—åˆ—
'********************************************************************************
Function IsNumericEx(strValue As String) As Boolean
    Dim objReg As New RegExp

    ' æ¤œç´¢æ¡ä»¶ï¼šåŠè§’æ•°å€¤ã®ã¿
    objReg.Pattern = "[+-]?(?:\d+\.?\d*|\.\d+)"
    objReg.Global = True

    IsNumericEx = objReg.Test(strValue)

End Function
```
-----
#### ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œIsExistsFile
'* æ©Ÿèƒ½ã€€ã€€ï½œãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue=å­˜åœ¨ã™ã‚‹, False=å­˜åœ¨ã—ãªã„ï¼‰
'* å¼•æ•°ã€€ã€€ï½œstrPathï¼šå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«
'********************************************************************************
Function IsExistsFile(strPath As String) As Boolean
    IsExistsFile = Dir(strPath) <> ""

End Function
```
-----
#### ãƒ•ã‚©ãƒ«ãƒ€ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œIsExistsFolder
'* æ©Ÿèƒ½ã€€ã€€ï½œãƒ•ã‚©ãƒ«ãƒ€ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue=å­˜åœ¨ã™ã‚‹, False=å­˜åœ¨ã—ãªã„ï¼‰
'* å¼•æ•°ã€€ã€€ï½œstrPathï¼šå¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€
'********************************************************************************
Function IsExistsFolder(strPath As String) As Boolean
    IsExistsFolder = Dir(strPath, vbDirectory) <> ""

End Function
```
-----
#### ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿å–ã‚Šå°‚ç”¨ã‚’ãƒã‚§ãƒƒã‚¯
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œIsReadonlyFile
'* æ©Ÿèƒ½ã€€ã€€ï½œãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿å–ã‚Šå°‚ç”¨ã‚’ãƒã‚§ãƒƒã‚¯
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue=èª­ã¿å–ã‚Šå°‚ç”¨ã§ã‚ã‚‹, False=èª­ã¿å–ã‚Šå°‚ç”¨ã§ã¯ãªã„ï¼‰
'* å¼•æ•°ã€€ã€€ï½œstrPathï¼šå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«
'********************************************************************************
Function IsReadonlyFile(strPath As String) As Boolean
    Dim vbResult As VbFileAttribute
    
    ' ãƒ•ã‚¡ã‚¤ãƒ«ã®å±æ€§ã‚’å–å¾—
    vbResult = GetAttr(strPath)
    
    ' èª­ã¿å–ã‚Šå°‚ç”¨ã®åˆ¤å®š
    IsReadonlyFile = ((vbResult And vbReadOnly) = vbReadOnly)

End Function
```
-----
#### ãƒ•ã‚¡ã‚¤ãƒ«ã®é–‹ãçŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œIsOpenedFile
'* æ©Ÿèƒ½ã€€ã€€ï½œãƒ•ã‚¡ã‚¤ãƒ«ã®é–‹ãçŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue=ã²ã‚‰ãçŠ¶æ…‹, False=ã¨ã˜ãŸçŠ¶æ…‹ï¼‰
'* å¼•æ•°ã€€ã€€ï½œstrPathï¼šå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«
'********************************************************************************
Function IsOpenedFile(strPath As String) As Boolean
    Dim intFileno As Integer
    
    intFileno = FreeFile
    
    ' æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½è¨˜ãƒ¢ãƒ¼ãƒ‰ã§é–‹ã„ãŸæ™‚ã®æˆ»ã‚Šå€¤ã§åˆ¤å®š
    On Error Resume Next
    Open strPath For Append As #intFileno
    Close #intFileno
    
    IsOpenedFile = (Err.Number >= 1)

End Function
```
-----
#### ç©ºæ–‡å­—ãƒã‚§ãƒƒã‚¯ï¼ˆExcelã‚·ãƒ¼ãƒˆã€è¡¨ã®å€¤ï¼‰
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œIsEmptyTable
'* æ©Ÿèƒ½ã€€ã€€ï½œç©ºæ–‡å­—ãƒã‚§ãƒƒã‚¯ï¼ˆExcelã‚·ãƒ¼ãƒˆã€è¡¨ã®å€¤ï¼‰
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue=ã„ãšã‚Œã‹ç©ºæ–‡å­—ã‚ã‚Š, False=ã™ã¹ã¦ç©ºæ–‡å­—ãªã—ï¼‰
'* å¼•æ•°ã€€ã€€ï½œstrSheetnameï¼šå¯¾è±¡ã‚·ãƒ¼ãƒˆå, strRangeï¼šã‚»ãƒ«ä½ç½®, aryCheckcolï¼šå¿…é ˆé …ç›®
'--------------------------------------------------------------------------------
'* æ³¨æ„äº‹é …ï¼šåˆ—ã®é–‹å§‹ä½ç½®ã®æœ€å¤§è¡Œæ•°ã‚’å¯¾è±¡ã«ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã€‚
'********************************************************************************
Function IsEmptyTable(strSheetname As String, strRange As String, aryCheckcol() As String) As Boolean
    Dim wbTarget As Workbook
    Dim wsTarget As Worksheet
    
    Dim rngTarget As Range
    Dim lngBeginrow As Long
    Dim lngBegincol As Long
    Dim lngEndrow As Long
    Dim lngEndcol As Long
    Dim strAddress As String
    Dim lngRow As Long
    Dim lngCount As Long
    Dim strValue As String
    
    Set rngTarget = Range(strRange)
    lngBeginrow = rngTarget.Row
    lngBegincol = rngTarget.Column
    
    Set wbTarget = ThisWorkbook
    ' å¯¾è±¡ã‚·ãƒ¼ãƒˆãŒãªã„å ´åˆã§ã‚‚ã‚¨ãƒ©ãƒ¼ã‚’ç™ºç”Ÿã•ã›ãšå‡¦ç†ã‚’ç¶šè¡Œ
    On Error Resume Next
    Set wsSheet = wbTarget.Worksheets(strSheetname)
    On Error GoTo 0
    
    ' ã‚·ãƒ¼ãƒˆãŒã‚ã‚‹å ´åˆ
    If (IsEmptyTable(strSheetname)) And _
       (UBound(aryCheckcol) <> -1) Then
        With wsSheet
            lngEndrow = .Cells(Rows.Count, lngBegincol).End(xlUp).Row
            If lngBeginrow > lngEndrow Then
                ' ãƒ‡ãƒ¼ã‚¿0ä»¶ã®å ´åˆã¯çµ‚äº†
                Exit Function
            End If
            lngEndcol = .Cells(lngBeginrow, Columns.Count).End(xlToLeft).Column
            
            For lngRow = lngBeginrow To lngEndrow
                For lngCount = 0 To UBound(aryCheckcol)
                    strValue = .Cells(lngRow, CLng(aryCheckcol(lngCount)))
                    strAddress = .Cells(lngRow, CLng(aryCheckcol(lngCount))).Address(False, False)
                    If IsEmptyText(strValue) = True Then
                        IsEmptyTable = True
                        Exit Function
                    End If
                Next
            Next
        End With
    End If
    
    IsEmptyTable = False
    
    Set wbTarget = Nothing
    Set wsTarget = Nothing

End Function
```
-----
#### ã‚·ãƒ¼ãƒˆã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œIsExistsSheet
'* æ©Ÿèƒ½ã€€ã€€ï½œã‚·ãƒ¼ãƒˆã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue=å­˜åœ¨ã™ã‚‹, False=å­˜åœ¨ã—ãªã„ï¼‰
'* å¼•æ•°ã€€ã€€ï½œstrSheetnameï¼šå¯¾è±¡ã‚·ãƒ¼ãƒˆå
'********************************************************************************
Function IsExistsSheet(strSheetname As String) As Boolean
    Dim wbTarget As Workbook
    Dim wsTarget As Worksheet
    Set wbTarget = ThisWorkbook
    Set wsTarget = Nothing

    On Error Resume Next
    Set wsTarget = wbTarget.Worksheets(strSheetname)
    On Error GoTo 0

    IsExistsSheet = (Not (wsTarget Is Nothing))
    
    Set wsTarget = Nothing
    Set wbTarget = Nothing

End Function
```
#### è¨­å®šæƒ…å ±ã®èª­ã¿è¾¼ã¿
Excel VBAã‚’ä½œã‚‹éš›ã€ãƒ„ãƒ¼ãƒ«ã®ä»•æ§˜ã¯åŒã˜ã ãŒã€
å…¥å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãŒå°‘ã—ã ã‘ç•°ãªã‚‹å ´åˆãªã©ã‚’æƒ³å®šã—ãŸé–¢æ•°ã€‚

é–¢æ•°ã‚’ä½¿ã†å‰ã®æº–å‚™ã¨ã—ã¦ã€
ã‚ã‚‰ã‹ã˜ã‚ã‚»ãƒ«ã®å‚ç…§ä½ç½®ãªã©ã®å¤‰åŒ–ã™ã‚‹æƒ…å ±ã‚’å¤–ã ã—ã—ãŸExcelã‚·ãƒ¼ãƒˆã‚’ä½œæˆã™ã‚‹ã€‚
ãªãŠã€å¤–ã ã—ã™ã‚‹æƒ…å ±ã¯å‡¦ç†åŒºåˆ†æ¯ã«ã‚ã‘ã¦è¨˜è¼‰ã—ã€ãã®ã‚»ãƒ«ä½ç½®ã‚’å®šæ•°ã§å®£è¨€ã€‚

é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹éš›ã¯ã€
å‡¦ç†åŒºåˆ†ã®åå‰ã‚’å¼•æ•°ã§æ¸¡ã—ã¦å®Ÿè¡Œã™ã‚‹äº‹ã§ã€é–¢é€£ã™ã‚‹ã‚»ãƒ«ä½ç½®ã®é…åˆ—ã‚’å–å¾—ã™ã‚‹å‹•ãã€‚
##### ä¾‹ï¼‰å¤‰åŒ–ç‚¹ã‚’å¤–ã ã—ã—ãŸExcelã‚·ãƒ¼ãƒˆ
![](https://storage.googleapis.com/zenn-user-upload/e03ba7b07dd5-20230222.png =600x)
*ç”»åƒï¼šã‚·ãƒ¼ãƒˆã€Œè¨­å®šæƒ…å ±ã‚·ãƒ¼ãƒˆã€ã®ä¾‹*
##### å®šæ•°éƒ¨åˆ†
```vbnet
' å®šæ•°
'   å®Ÿè¡Œæƒ…å ±
Public Const PC_EXE As String = "D4,D5,D6,D7,D8,D9,D10"
' ã€€å…¥åŠ›æƒ…å ±
Public Const PC_INPUT As String = "D13,D14,D15,D16,D17,D18,D19,D20,D21,D22,D23,D24,D25,D26,D27,D28,D29"
' ã€€å‡ºåŠ›æƒ…å ±
Public Const PC_OUTPUT As String = "D32,D33,D34,D35,D36,D37,D38,D39,D40,D41,D42,D43,D44,D45,D46,D47,D48"
' ã€€ã‚¨ãƒ©ãƒ¼æƒ…å ±
Public Const PC_ERROR As String = "D51,D52,D53,D54,D55"
' ã€€éè¡¨ç¤ºã™ã‚‹ã‚·ãƒ¼ãƒˆæƒ…å ±
Public Const PC_HIDDEN As String = "D5,D15,D16,D17,D34,D35,D36,D37,D38,D51"
```
##### é–¢æ•°éƒ¨åˆ†
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œFuncReadSetinfo
'* æ©Ÿèƒ½ã€€ã€€ï½œè¨­å®šæƒ…å ±ã®èª­ã¿è¾¼ã¿
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œString()ï¼šæŒ‡å®šã—ãŸå‡¦ç†åŒºåˆ†ã®æƒ…å ±
'* å¼•æ•°ã€€ã€€ï½œstrClassï¼šå‡¦ç†åŒºåˆ†ã®åå‰
'********************************************************************************
Function FuncReadSetinfo(strClass As String) As String()
    Dim aryRange() As String
    
    Select Case strClass
        Case "EXE"
            aryRange = Split(PC_EXE, ",")
        Case "INPUT"
            aryRange = Split(PC_INPUT, ",")
        Case "OUTPUT"
            aryRange = Split(PC_OUTPUT, ",")
        Case "ERROR"
            aryRange = Split(PC_ERROR, ",")
        Case "HIDDEN"
            aryRange = Split(PC_HIDDEN, ",")
    End Select
    
    FuncReadSetinfo = aryRange
    
End Function
```
-----
### Subãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£
#### æŒ‡å®šã—ãŸã‚»ãƒ«ã‚’é¸æŠ
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubSelectCell
'* æ©Ÿèƒ½ã€€ã€€ï½œæŒ‡å®šã—ãŸã‚»ãƒ«ã‚’é¸æŠ
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œãªã—
'* å¼•æ•°ã€€ã€€ï½œstrSheetnameï¼šå¯¾è±¡ã‚·ãƒ¼ãƒˆåã€strRangeï¼šå¯¾è±¡ã‚»ãƒ«
'********************************************************************************
Sub SubSelectCell(strSheetname As String, strRange As String)
    With Worksheets(strSheetname)
        .Select
        .Range(strRange).Select
    End With

End Sub
```
-----
#### ã‚·ãƒ¼ãƒˆã®ã‚¯ãƒªã‚¢
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubClearSheet
'* æ©Ÿèƒ½ã€€ã€€ï½œã‚·ãƒ¼ãƒˆã®ã‚¯ãƒªã‚¢
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œstrSheetnameï¼šå¯¾è±¡ã‚·ãƒ¼ãƒˆ, lngBeginrowï¼šè¡Œé–‹å§‹ä½ç½®, lngBegincolï¼šåˆ—é–‹å§‹ä½ç½®
'********************************************************************************
Sub SubClearSheet(strSheetname As String, strRange As String)
    Dim wbTarget As Workbook
    Dim wsTarget As Worksheet
    
    Dim rngTarget As Range
    Dim lngBeginrow As Long
    Dim lngBegincol As Long
    Dim lngEndrow As Long
    
    Set wbTarget = ThisWorkbook
    
    ' å¯¾è±¡ã‚·ãƒ¼ãƒˆãŒãªã„å ´åˆã§ã‚‚ã‚¨ãƒ©ãƒ¼ã‚’ç™ºç”Ÿã•ã›ãšå‡¦ç†ã‚’ç¶šè¡Œ
    On Error Resume Next
    Set wsTarget = wbTarget.Worksheets(strSheetname)
    On Error GoTo 0
    
    Set rngTarget = Range(strRange)
    lngBeginrow = rngTarget.Row
    lngBegincol = rngTarget.Column
    
    ' ã‚·ãƒ¼ãƒˆãŒã‚ã‚‹å ´åˆ
    If (IsExistsSheet(strSheetname)) Then
        With wsTarget
            lngEndrow = .Cells(Rows.Count, lngBegincol).End(xlUp).Row
            ' è¡¨ã«å€¤ãŒãªã„å ´åˆã€æœ€å¤§è¡Œæ•°ã‚’é–‹å§‹è¡Œã«å¤‰æ›´
            If lngBeginrow > lngEndrow Then
                lngEndrow = lngBeginrow
            End If
            .Range(.Cells(lngBeginrow, lngBegincol), .Cells(lngEndrow, Columns.Count)).ClearContents
            .Range(.Cells(lngBeginrow, lngBegincol), .Cells(Rows.Count, Columns.Count)).Interior.ColorIndex = 2
            .Range(.Cells(lngBeginrow, lngBegincol), .Cells(Rows.Count, Columns.Count)).Borders.LineStyle = False
        End With
    End If
    
    Set wbTarget = Nothing
    Set wsTarget = Nothing
    
End Sub
```
-----
#### CSVãƒ•ã‚¡ã‚¤ãƒ«å–ã‚Šè¾¼ã¿
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubLoadCsv
'* æ©Ÿèƒ½ã€€ã€€ï½œCSVãƒ•ã‚¡ã‚¤ãƒ«ã®å–ã‚Šè¾¼ã¿
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œstrValueï¼šå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«, strCsvrangeï¼šCSVå€¤é–‹å§‹ä½ç½®, strSheetnameï¼šå¯¾è±¡ã‚·ãƒ¼ãƒˆ, strExcelrangeï¼šã‚·ãƒ¼ãƒˆå€¤é–‹å§‹ä½ç½®, [ä»»æ„]strCharcodeï¼šæ–‡å­—ã‚³ãƒ¼ãƒ‰
'********************************************************************************
Sub SubLoadCsv(strValue As String, strCsvrange As String, strSheetname As String, strExcelrange As String, Optional strCharcode As String = "UTF8")
    Dim qtTarget As QueryTable
    Dim rngCsv As Range
    Dim rngExcel As Range
    Dim lngCsvrow As Long
    Dim lngExcelrow As Long
    Dim lngExcelcol As Long
    Dim lngEndrow As Long
    Set rngCsv = Range(strCsvrange)
    lngCsvrow = rngCsv.Row
    Set rngExcel = Range(strExcelrange)
    lngExcelrow = rngExcel.Row
    lngExcelcol = rngExcel.Column
    
    With Worksheets(strSheetname)
        lngEndrow = .Cells(Rows.Count, lngExcelcol).End(xlUp).Row
    End With
    
    If lngEndrow > lngExcelrow Then
        lngExcelrow = lngEndrow + 1
    End If
    
    Set qtTarget = Worksheets(strSheetname).QueryTables.Add(Connection:="TEXT;" & strValue, _
        Destination:=Worksheets(strSheetname).Cells(lngExcelrow, lngExcelcol))
    
    With qtTarget
        .TextFileCommaDelimiter = True                          ' ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã®æŒ‡å®š
        .TextFileParseType = xlDelimited                        ' åŒºåˆ‡ã‚Šæ–‡å­—ã®å½¢å¼
        .TextFileTextQualifier = xlTextQualifierDoubleQuote     ' å¼•ç”¨ç¬¦ã‚ã‚Šãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®š
        If strCharcode = "UTF8" Then
            .TextFilePlatform = 65001                           ' æ–‡å­—ã‚³ãƒ¼ãƒ‰UTF-8ã‚’æŒ‡å®š
        Else
            .TextFilePlatform = 932                             ' æ–‡å­—ã‚³ãƒ¼ãƒ‰Shift_JISã‚’æŒ‡å®š
        End If
       .TextFileStartRow = lngCsvrow                            ' é–‹å§‹è¡Œã®æŒ‡å®š
       .RefreshStyle = xlOverwriteCells                         ' ã‚»ãƒ«ã¯è¿½åŠ ã›ãšä¸Šæ›¸ãã™ã‚‹
       .Refresh                                                 ' QueryTablesã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ›´æ–°ã—ã€ã‚·ãƒ¼ãƒˆä¸Šã«å‡ºåŠ›
       .Delete                                                  ' QueryTables.Addãƒ¡ã‚½ãƒƒãƒ‰ã§å–ã‚Šè¾¼ã‚“ã CSVã¨ã®æ¥ç¶šã‚’è§£é™¤
    End With
    
    Set qtTarget = Nothing

End Sub
```
-----
#### CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜ï¼ˆæ–‡å­—ã‚³ãƒ¼ãƒ‰ï¼šUTF-8ï¼‰
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubSaveCsv
'* æ©Ÿèƒ½ã€€ã€€ï½œCSVãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜ï¼ˆæ–‡å­—ã‚³ãƒ¼ãƒ‰ï¼šUTF-8ï¼‰ãƒ«å‡ºåŠ›
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œstrSheetnameï¼šå¯¾è±¡ã‚·ãƒ¼ãƒˆ, strSheetrangeï¼šé–‹å§‹ã‚»ãƒ«ä½ç½®, strSavepathï¼šä¿å­˜å…ˆ, lngCsvbeginrowï¼šè¡Œé–‹å§‹ä½ç½®, lngBegincolï¼šåˆ—é–‹å§‹ä½ç½®
'********************************************************************************
Sub SubSaveCsv(strSheetname As String, strSheetrange As String, strSavepath As String, lngCsvbeginrow As Long)
    Dim rngSheet As Range
    Dim lngSheetbeginrow As Long
    Dim lngSheetbegincol As Long
    Dim lngEndrow As Long
    Dim lngEndcol As Long
    Dim lngRow As Long
    Dim lngCol As Long
    Dim strCsvdata As String
    Dim strLine As String
    Dim strValue As String
    Dim strDelimiter As String
    Dim aryItems() As String

    Set rngSheet = Range(strSheetrange)
    lngSheetbeginrow = rngSheet.Row
    lngSheetbegincol = rngSheet.Column

    Dim objUtf8 As Object
    Dim objNonbom As Object
    Set objUtf8 = CreateObject("ADODB.Stream")
    Set objNonbom = CreateObject("ADODB.Stream")

    ' CSVå½¢å¼ã®æº–å‚™
    With Worksheets(strSheetname)
        lngEndrow = .Cells(Rows.Count, lngSheetbegincol).End(xlUp).Row
        lngEndcol = .Cells(lngSheetbeginrow - 1, Columns.Count).End(xlToLeft).Column
    End With
    
    If lngCsvbeginrow > lngEndrow Then
        lngEndrow = lngCsvbeginrow
    End If

    strDelimiter = ","

    For lngRow = lngSheetbeginrow To lngEndrow
        strLine = ""
        For lngCol = lngSheetbegincol To lngEndcol
            With Worksheets(strSheetname)
                strValue = .Cells(lngRow, lngCol).Value
            End With
            If strLine = "" Then
                strLine = strValue
            Else
                ReDim aryItems(1)
                aryItems(0) = strLine
                aryItems(1) = strValue
                strLine = Join(aryItems, strDelimiter)
            End If
        Next

        If strCsvdata = "" Then
            strCsvdata = strLine
        Else
            ReDim aryItems(1)
            aryItems(0) = strCsvdata
            aryItems(1) = strLine
            strCsvdata = Join(aryItems, vbCrLf)
        End If
    Next
    ' æœ€çµ‚è¡Œã«ç©ºæ–‡å­—è¡Œ
    ReDim aryItems(1)
    aryItems(0) = strCsvdata
    aryItems(1) = ""
    strCsvdata = Join(aryItems, vbCrLf)

    ' ä¿å­˜
    With objUtf8
        .Charset = "UTF-8"
        .Open
        .WriteText strCsvdata
        .Position = 0
        .Type = 1           'Binary
        .Position = 3
    End With

    With objNonbom
        .Type = 1           'Binary
        .Open
        objUtf8.CopyTo objNonbom
        .SaveToFile strSavepath, 2 ' SaveCreateOverWrite
    End With

    objNonbom.Close
    objUtf8.Close

    Set objNonbom = Nothing
    Set objUtf8 = Nothing

End Sub
```
-----
#### ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ã®è¡¨ç¤º
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubShowMessagebox
'* æ©Ÿèƒ½ã€€ã€€ï½œãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¡¨ç¤º
'---------------------------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œstrMessagecodeï¼šå¯¾è±¡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ¼ãƒ‰, [ä»»æ„]strAppendï¼šè¿½åŠ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
'********************************************************************************
Sub SubShowMessagebox(strResultcode As String, Optional strAppend As String = "")
    Dim strMessage As String
    Dim lngCount As Long
    Dim lngLevel As Long
    Dim strLevel As String
    
    Dim aryMessages(20, 1) As String
    ' æ­£å¸¸çµ‚äº†ã‚³ãƒ¼ãƒ‰
    aryMessages(0, 0) = "0"
    aryMessages(0, 1) = "æ­£å¸¸çµ‚äº†ã€‚"
    aryMessages(1, 0) = "10"
    aryMessages(1, 1) = "åˆæœŸåŒ–ã‚’å®Ÿè¡Œã€‚"
    aryMessages(2, 0) = "20"
    aryMessages(2, 1) = "å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚"
    ' ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    ' ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆãƒœã‚¿ãƒ³
    aryMessages(3, 0) = "-101"
    aryMessages(3, 1) = "ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆå‡¦ç†ã§ç•°å¸¸çµ‚äº†ã€‚"
    ' å…¥åŠ›ãƒã‚§ãƒƒã‚¯
    aryMessages(4, 0) = "-211"
    aryMessages(4, 1) = "æœªå…¥åŠ›ã®é …ç›®ãŒã‚ã‚Šã€‚"
    ' å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    aryMessages(5, 0) = "-212"
    aryMessages(5, 1) = "å‚ç…§ã§ããªã„ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã€‚"
    aryMessages(6, 0) = "-213"
    aryMessages(6, 1) = "å‚ç…§ã§ããªã„ãƒ•ã‚©ãƒ«ãƒ€ãŒã‚ã‚Šã€‚"
    ' å¿…é ˆãƒã‚§ãƒƒã‚¯
    aryMessages(7, 0) = "-214"
    aryMessages(7, 1) = "å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã«æ¬ æãŒã‚ã‚Šã€‚"
    ' å‡¦ç†æ¯ã®ã‚¨ãƒ©ãƒ¼
    aryMessages(8, 0) = "-301"
    aryMessages(8, 1) = "å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿æ™‚ã«ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(9, 0) = "-311"
    aryMessages(9, 1) = "å•†å“1ãƒ‡ãƒ¼ã‚¿ã®å‡ºåŠ›ã§ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(10, 0) = "-312"
    aryMessages(10, 1) = "å•†å“2ãƒ‡ãƒ¼ã‚¿ã®å‡ºåŠ›ã§ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(11, 0) = "-313"
    aryMessages(11, 1) = "å•†å“3ãƒ‡ãƒ¼ã‚¿ã®å‡ºåŠ›ã§ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(12, 0) = "-314"
    aryMessages(12, 1) = "å•†å“4ãƒ‡ãƒ¼ã‚¿ã®å‡ºåŠ›ã§ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(13, 0) = "-315"
    aryMessages(13, 1) = "å•†å“5ãƒ‡ãƒ¼ã‚¿ã®å‡ºåŠ›ã§ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(14, 0) = "-321"
    aryMessages(14, 1) = "ãƒ‡ãƒ¼ã‚¿ã®ä¸¦ã³æ›¿ãˆã§ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(15, 0) = "-331"
    aryMessages(15, 1) = "ãƒ‡ãƒ¼ã‚¿æ•´å½¢ã®å‡¦ç†1ã§ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(16, 0) = "-332"
    aryMessages(16, 1) = "ãƒ‡ãƒ¼ã‚¿æ•´å½¢ã®å‡¦ç†2ã§ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(17, 0) = "-341"
    aryMessages(17, 1) = "ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›æ™‚ã«ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(18, 0) = "-801"
    aryMessages(18, 1) = "åˆæœŸåŒ–ä¸­ã«ç•°å¸¸çµ‚äº†ã€‚"
    aryMessages(19, 0) = "-901"
    aryMessages(19, 1) = "å®Ÿè¡Œä¸­ã«ä¸­æ–­ã€‚"
    aryMessages(20, 0) = "-999"
    aryMessages(20, 1) = "ä¾‹å¤–ãŒç™ºç”Ÿã€‚"
    
    lngCount = 0
    strMessage = "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚"
    For lngCount = LBound(aryMessages, 1) To UBound(aryMessages, 1)
        If aryMessages(lngCount, 0) = strResultcode Then
            strMessage = aryMessages(lngCount, 1)
            strMessage = strMessage & vbCrLf & strAppend & vbCrLf
            Exit For
        End If
    Next
    
    If Left(aryMessages(lngCount, 0), 1) = "-" Then
        lngLevel = vbCritical
        strLevel = "è­¦å‘Š"
    Else
        lngLevel = vbInformation
        strLevel = "æƒ…å ±"
    End If
    
    strMessage = strMessage & vbCrLf & "Message Codeï¼š" & "[" & strResultcode & "]"
    
    MsgBox strMessage, vbOKOnly + lngLevel, strLevel
    
End Sub
```
-----
#### é€šçŸ¥ç”¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚·ãƒ¼ãƒˆè¡¨ç¤º
##### å®šæ•°éƒ¨åˆ†
```vbnet
Public Const PC_SETINFO As String = "è¨­å®šæƒ…å ±ã‚·ãƒ¼ãƒˆ"
```
##### é–¢æ•°éƒ¨åˆ†
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubDisplayMessage
'* æ©Ÿèƒ½ã€€ã€€ï½œé€šçŸ¥ç”¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚·ãƒ¼ãƒˆè¡¨ç¤º
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œstrLabelcodeï¼šå¯¾è±¡ãƒ©ãƒ™ãƒ«ã‚³ãƒ¼ãƒ‰ã€[ä»»æ„]strAppendï¼šè¿½åŠ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
'********************************************************************************
Public Sub SubDisplayMessage(strCode As String, Optional strAppend As String = "")
    Dim arySetinfo() As String
    arySetinfo = mdlCommon.FuncReadSetinfo("EXE")
    
    Dim strSheetname As String
    Dim strRange As String
    Dim strMessage As String
    Dim strDatetime As String
    Dim lngCount As Long
    
    strDatetime = Format(Now, "yyyy/mm/dd hh:mm:ss")
    
    With Worksheets(mdlCommon.PC_SETINFO)
        strSheetname = .Range(arySetinfo(0)).Value
        strRange = .Range(arySetinfo(2)).Value
    End With
    
    Dim aryMessages(2, 1) As String
    ' æ­£å¸¸çµ‚äº†ã‚³ãƒ¼ãƒ‰
    aryMessages(0, 0) = "+00"
    aryMessages(0, 1) = "å‡¦ç†å®Œäº†ã€‚"
    aryMessages(1, 0) = "+01"
    aryMessages(1, 1) = "ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆå®Œäº†ã€‚"
    aryMessages(2, 0) = "+02"
    aryMessages(2, 1) = "ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆæ¸ˆã¿ã€‚"
    
    lngCount = 0
    strMessage = ""
    For lngCount = LBound(aryMessages, 1) To UBound(aryMessages, 1)
        If aryMessages(lngCount, 0) = strCode Then
            strMessage = aryMessages(lngCount, 1)
            strMessage = strDatetime & " " & _
                         strMessage & vbCrLf & _
                         strAppend
            Exit For
        End If
    Next
    
    With Worksheets(strSheetname)
        .Range(strRange).Font.ColorIndex = 11
        If UBound(aryMessages, 1) >= lngCount Then
            If Left(aryMessages(lngCount, 0), 1) = "-" Then
                .Range(strRange).Font.ColorIndex = 3
            End If
        End If
        .Range(strRange).Value = strMessage
    End With
    
End Sub
```
-----
#### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ã®è¡¨ç¤º
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubDisplayStatusbar
'* æ©Ÿèƒ½ã€€ã€€ï½œã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ã®è¡¨ç¤º
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œblValidï¼ˆTrue=ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼æœ‰åŠ¹, False=ç„¡åŠ¹), [ä»»æ„]strAppendï¼šè¿½åŠ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
'********************************************************************************
Sub SubDisplayStatusbar(blStatusbar As Boolean, Optional strAppend As String)
    If blValid = True Then
        Application.StatusBar = "å®Ÿè¡Œä¸­ ..." & strAppend
    Else
        Application.StatusBar = False
    End If

End Sub
```
-----
#### VBAå‡¦ç†ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚¢ãƒƒãƒ—è¨­å®š
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubOnSpeedup
'* æ©Ÿèƒ½ã€€ã€€ï½œVBAå‡¦ç†ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚¢ãƒƒãƒ—è¨­å®š
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œblValidï¼ˆTrue=é«˜é€ŸåŒ–æœ‰åŠ¹, False=ç„¡åŠ¹)
'********************************************************************************
Sub SubOnSpeedup(blValid As Boolean)
    Dim strPath As String
    If blValid = True Then
        ' å‡¦ç†é«˜é€ŸåŒ–
        ' ã‚«ãƒ¼ã‚½ãƒ«ã‚’å¾…æ©Ÿä¸­ã«è¨­å®š
        Application.Cursor = xlWait
	
        ' ç”»é¢æå†™ã®åœæ­¢ã‚’è¨­å®š
        Application.ScreenUpdating = False
        ' è‡ªå‹•è¨ˆç®—ã®åœæ­¢ã‚’è¨­å®š
        Application.Calculation = xlCalculationManual
        ' ãƒ¦ãƒ¼ã‚¶æ“ä½œç¦æ­¢ã‚’è¨­å®š
        Application.Interactive = False
    Else
        ' ç”»é¢æå†™ã‚’å†é–‹
        Application.ScreenUpdating = True
        ' è‡ªå‹•è¨ˆç®—ã‚’å†é–‹
        Application.Calculation = xlCalculationAutomatic
        ' ãƒ¦ãƒ¼ã‚¶æ“ä½œã‚’å†é–‹
        Application.Interactive = True
        ' ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹•
        strPath = ThisWorkbook.Path
        ChDrive strPath
        ChDir strPath
        
        ' ã‚«ãƒ¼ã‚½ãƒ«ã‚’å…ƒã«æˆ»ã™
        Application.Cursor = xlDefault
    End If

End Sub
```
-----
#### ã‚·ãƒ¼ãƒˆè¡¨ç¤ºï¼éè¡¨ç¤ºã®è¨­å®š
##### å®šæ•°éƒ¨åˆ†
```vbnet
Public Const PC_SETINFO As String = "è¨­å®šæƒ…å ±ã‚·ãƒ¼ãƒˆ"
```
##### é–¢æ•°éƒ¨åˆ†
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubVisibleSheet
'* æ©Ÿèƒ½ã€€ã€€ï½œã‚·ãƒ¼ãƒˆè¡¨ç¤ºï¼éè¡¨ç¤ºã®è¨­å®š
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œstrClassï¼šå¯¾è±¡ã‚°ãƒ«ãƒ¼ãƒ—, blVisibleï¼ˆTrue=è¡¨ç¤º, False=éè¡¨ç¤ºï¼‰
'********************************************************************************
Sub SubVisibleSheet(strClass As String, blVisible As Boolean)
    Dim arySetinfo() As String
    arySetinfo = mdlCommon.FuncReadSetinfo(strClass)
    
    Dim lngCount As Long
    Dim strSheetname As String
    
    For lngCount = 0 To UBound(arySetinfo)
        strSheetname = Worksheets(mdlCommon.PC_SETINFO).Range(arySetinfo(lngCount)).Value
        Worksheets(strSheetname).Visible = blVisible
    Next

End Sub
```
-----
#### Excelã‚·ãƒ¼ãƒˆã®ã‚³ãƒ”ãƒ¼
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubCopySheet
'* æ©Ÿèƒ½ã€€ã€€ï½œExcelã‚·ãƒ¼ãƒˆã®ã‚³ãƒ”ãƒ¼
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œã‚³ãƒ”ãƒ¼å…ƒï¼ˆstrFmName=ã‚·ãƒ¼ãƒˆå, lngFmBeginrow=é–‹å§‹è¡Œ, lngFmBegincol=é–‹å§‹åˆ—ï¼‰
'*        ï½œã‚³ãƒ”ãƒ¼å…ˆï¼ˆstrToName=ã‚·ãƒ¼ãƒˆå, lngToBeginrow=é–‹å§‹è¡Œ, lngToBegincol=é–‹å§‹åˆ—ï¼‰
'********************************************************************************
Sub SubCopySheet(strFmName As String, lngFmBeginrow As Long, lngFmBegincol As Long, _
                 strToName As String, lngToBeginrow As Long, lngToBegincol As Long)
    Dim wbTarget As Workbook
    Dim wsFmSheet As Worksheet
    Dim wsToSheet As Worksheet
    
    Dim lngFmEndrow As Long
    Dim lngFmEndcol As Long
    Dim lngToEndrow As Long
    Dim lngToEndcol As Long
    
    Dim lngFmRow As Long
    Dim lngFmCol As Long
    Dim lngToRow As Long
    Dim lngToCol As Long
    
    Dim lngRow As Long
    
    Dim varFmCopydata As Variant
    Dim varToCopydata As Variant
    
    Set wbTarget = ThisWorkbook
    
    On Error Resume Next
    Set wsFmSheet = wbTarget.Worksheets(strFmName)
    Set wsToSheet = wbTarget.Worksheets(strToName)
    On Error GoTo 0
    
    ' ã‚·ãƒ¼ãƒˆãŒã‚ã‚‹å ´åˆ
    If Not (wsFmSheet Is Nothing) And _
       Not (wsToSheet Is Nothing) Then
        With wsFmSheet
            lngFmEndrow = .Cells(Rows.Count, lngFmBegincol + 1).End(xlUp).Row
            If lngFmBeginrow > lngFmEndrow Then
                lngFmEndrow = lngFmBeginrow
            End If
            
            lngFmRow = lngFmBeginrow
            lngFmCol = lngFmBegincol
            lngToRow = lngToBeginrow
            lngToCol = lngToBegincol
            
            ReDim varToCopydata(lngFmEndrow - 1, 30)
            
            varFmCopydata = .Range(.Cells(lngFmRow, lngFmCol), .Cells(lngFmEndrow, lngFmCol + 30)).Value
        End With
        
        varToCopydata = varFmCopydata
        
        ' æ—¥ä»˜ã‚’YYYY-MM-DDã§è¡¨ç¤º
        For lngRow = 1 To UBound(varToCopydata)
            varToCopydata(lngRow, 30) = "'" & varToCopydata(lngRow, 30)
        Next
        
        With wsToSheet
            .Range(.Cells(lngToRow, lngToCol), .Cells(lngFmEndrow, lngToCol + 30)).Value = varToCopydata
            ' ç½«ç·šã®è¨­å®š
            lngToEndrow = .Cells(Rows.Count, lngToBegincol).End(xlUp).Row
            lngToEndcol = .Cells(1, Columns.Count).End(xlToLeft).Column
            .Range(Cells(lngToBeginrow, lngToBegincol), Cells(lngToEndrow, lngToEndcol)).Borders.LineStyle = True
        End With
    End If
    
    Set wsFmSheet = Nothing
    Set wsToSheet = Nothing
    Set wbTarget = Nothing
    
End Sub
```
-----
#### æŒ‡å®šãƒ•ã‚©ãƒ«ãƒ€ã‚’é–‹ã
```vbnet
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubOpenFolder
'* æ©Ÿèƒ½ã€€ã€€ï½œæŒ‡å®šãƒ•ã‚©ãƒ«ãƒ€ã‚’é–‹ã
'--------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œstrValue
'********************************************************************************
Sub SubOpenFolder(strValue As String)
On Error GoTo CATCH
    Shell "C:\Windows\explorer.exe " & strValue, vbNormalFocus
CATCH:

End Sub
```
## ã¾ã¨ã‚
ã‹ãªã‚Šãƒ¬ã‚¬ã‚·ãƒ¼ãªExcel VBAã§ã™ãŒã€
ã¡ã‚‡ã£ã¨ã—ãŸãƒ„ãƒ¼ãƒ«ã®ä½œæˆã§ã¯åŠ›ã‚’ç™ºæ®ã—ã¦ãã‚Œã¾ã™ã€‚
ã“ã®è¨˜äº‹ãŒã”å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚