---
title: "[Excel VBA]å…±é€šåŒ–ã—ãŸâ€œFunctionãƒ»Subãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£â€ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ç´¹ä»‹"
emoji: "ğŸ‘´"
type: "tech"
topics: ["excel", "vba", "ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ "]
published: true
---
## æ¦‚è¦
Excel VBAã§ç°¡å˜ãªãƒ„ãƒ¼ãƒ«ã‚’é–‹ç™ºã™ã‚‹éš›ã€é »ç¹ã«æ›¸ãFunctionãƒ»Subãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ï¼ˆé–¢æ•°ï¼‰ã¯ã€
å…±é€šåŒ–ã—ãŸãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£[^1]ã‚’ä½¿ã„ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°[^2]ã—ã¦ã„ã¾ã™ã€‚
[^1]: â€œå…±é€šåŒ–ã—ãŸãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£â€ãŒä¸€èˆ¬çš„ãªå‘¼ç§°ãªã®ã‹ä¸æ˜ã€‚ä»–ã«èã„ãŸäº‹ãŒã‚ã‚‹å‘¼ã³æ–¹ã¨ã—ã¦ã¯â€œå…±é€šå‡¦ç†â€ã‚„â€œå…±é€šãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£â€ã€â€œå…±é€šé–¢æ•°â€ãªã©ãŒã‚ã‚Šã€‚
[^2]: å…·ä½“çš„ãªæ–¹æ³•ã¯ã€æ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…ã«ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ–°è¦è¿½åŠ ã—å…±é€šåŒ–ã—ãŸãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚’ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã™ã‚‹äº‹ã§è‡ªä½œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½œæˆã€‚

è‡ªèº«ã§VBAã®ãƒ„ãƒ¼ãƒ«ã‚’ä½œæˆã™ã‚‹éš›ã«ãµã‚Šè¿”ã‚‹ã“ã¨ã‚‚ã‚ã‚Šã€å‚™å¿˜ã‚’ã‹ã­ã¦è¨˜äº‹ã«ã—ã¾ã™ã€‚

-----
**2023.03.14è¿½è¨˜**
ã“ã®è¨˜äº‹ã§ç´¹ä»‹ã—ãŸå†…å®¹ãŒçµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã—ã¾ã—ãŸã€‚
[ã“ã¡ã‚‰ã®è¨˜äº‹](https://zenn.dev/haretokidoki/articles/cb016a39a1562e)ã§è©³ç´°ãªå†…å®¹ã‚’ç´¹ä»‹ä¸­ã€‚
https://zenn.dev/haretokidoki/articles/cb016a39a1562e

ãªãŠã€ä¸Šè¨˜ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã¯ã€ã“ã®è¨˜äº‹ã®â€œå…±é€šåŒ–ã—ãŸãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£â€ç¾¤ã‚’ã€
ã€Œ`mdlCommon.bas`ã€ã¨ã„ã†æ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã¾ã¨ã‚ã¦æ›¸ã„ã¦ã„ã¾ã™ã€‚

-----

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
- Excel VBAãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- é »ç¹ã«æ›¸ãå‡¦ç†ã‚’å…±é€šåŒ–ã—ãŸã„æ–¹
- å…±é€šåŒ–ã—ãŸãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å‚è€ƒã«ã—ãŸã„æ–¹
## å…±é€šå‡¦ç†ã®ã¾ã¨ã‚
::::message
**æ³¨æ„äº‹é …**

- **ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ï¼ˆã‚·ã‚¹ãƒ†ãƒ ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ï¼‰ã‚’ä½¿ç”¨**
    ç¾åœ¨ã€ä¸»æµã§ã¯ãªã„å‘½åè¦å‰‡ã®ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã‚’ã€ã‚ãˆã¦ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚
    åˆå­¦è€…ãƒ»åˆç´šè€…ã®æ–¹ã¯ã€**ã“ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ä½¿ç”¨ã—ã¦ã„ã‚‹å‘½åè¦å‰‡ã¯ä¸»æµã§ãªããƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚‚å¤šã„**ã¨ã„ã†ç‚¹ã‚’ç†è§£ã—ãŸä¸Šã§ã”å‚è€ƒãã ã•ã„ã€‚
    ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å‘½åè¦å‰‡ã¤ã„ã¦ã€ã€Œ[ãƒ—ãƒ­ã‚°ãƒ©ãƒ  + åå‰ + è¦å‰‡](https://www.google.com/search?q=ãƒ—ãƒ­ã‚°ãƒ©ãƒ +åå‰+è¦å‰‡&ei=d4uwZIfWDpv6wAPX7paICg&ved=0ahUKEwjH7dDg7YyAAxUbPXAKHVe3BaEQ4dUDCA8&uact=5&oq=ãƒ—ãƒ­ã‚°ãƒ©ãƒ +åå‰+è¦å‰‡&gs_lp=Egxnd3Mtd2l6LXNlcnAiHeODl-ODreOCsOODqeODoCDlkI3liY0g6KaP5YmHMgQQABgeSO5UUPkCWK1ScAF4AZABAZgB0QWgAfkVqgENMC4xLjIuMC4yLjEuMbgBA8gBAPgBAcICChAAGEcY1gQYsAPCAgUQABiiBMICCBAAGIkFGKIEwgIHEAAYigUYQ8ICBRAAGIAEwgIGEAAYHhgPwgIGEAAYCBgewgIGEAAYBRgewgIIEAAYBRgeGA_iAwQYACBBiAYBkAYK&sclient=gws-wiz-serp)ã€ãªã©ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§èª¿ã¹ã¦ã¿ã‚‹äº‹ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚
    :::details ã‚ãˆã¦VBAã§ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã‚’æ¡ç”¨ã—ã¦ã„ã‚‹ç†ç”±
    Excel VBAã«é™ã£ã¦ã¯ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹ç‚ºã¨ãªã‚Šã¾ã™ã€‚å…·ä½“çš„ã«ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚
    - åˆå­¦è€…ãƒ»åˆç´šè€…ãŒãƒ‡ãƒ¼ã‚¿å‹ã‚’æ„è­˜ã—ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã§ãã‚‹ã“ã¨
        ãƒ‡ãƒ¼ã‚¿å‹ã‚’æ„è­˜ã—ã¦ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã™ã‚‹äº‹ã¯é‡è¦ã€‚æ„è­˜ã›ãšã«ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã™ã‚‹ã¨ãƒã‚°ã®æ¸©åºŠã¨ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚
    - Excel VBAã§ã¯ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã®ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã®å½±éŸ¿ãŒå°‘ãªã„ãŸã‚
        - å°è¦æ¨¡ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨ãªã‚Šè¤‡æ•°äººã§é–‹ç™ºã—ãªã„ï¼ˆãŠãã‚‰ãåŸºæœ¬ã€1äººã§é–‹ç™ºï¼‰
        - å°è¦æ¨¡ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨ãªã‚Šãƒ‡ãƒ¼ã‚¿å‹ã®å¤‰æ›´ã®å½±éŸ¿ãŒå°‘ãªã„
    - Excel VBAã®ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼[Microsoft Visual Basic for Applications](https://ja.wikipedia.org/wiki/Visual_Basic_for_Applications)ã®æ©Ÿèƒ½ãŒä¹ã—ã„ãŸã‚
        ãƒ‡ãƒãƒƒã‚°ä¸­ã«ãƒ‡ãƒ¼ã‚¿å‹ã‚’ç¢ºèªã™ã‚‹å ´åˆã€ç°¡å˜ã«ç¢ºèªã§ããªã„ã€‚æœ€è¿‘ã®IDEã§ã¯å¯¾è±¡ã®å¤‰æ•°ã«ãƒã‚¦ã‚¹ã‚ªãƒ¼ãƒãƒ¼[^3]ã™ã‚‹ã¨ç°¡å˜ã«ãƒ‡ãƒ¼ã‚¿å‹ã‚„å€¤ã‚’ãƒã‚§ãƒƒã‚¯ã§ãã‚‹ãŒã€
        VBAã®å ´åˆã¯ã‚¦ã‚©ãƒƒãƒå¼ã«å¤‰æ•°åã‚’è¿½åŠ ã™ã‚‹ãªã©æ‰‹é–“ãŒã‚ã‚Šã€ã‹ã¤è¡¨ç¤ºã‚‚è¦‹ã¥ã‚‰ã„
    - Excelã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã®äºˆç´„èªã¨å¤‰æ•°åã®ãƒãƒƒãƒ†ã‚£ãƒ³ã‚°ã‚’é¿ã‘ã‚„ã™ã„ãŸã‚
        ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ä»˜å±ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ è¨€èªã§ã‚ã‚‹ç‚ºã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã®äºˆç´„èªã¨åå‰ãŒãƒãƒƒãƒ†ã‚£ãƒ³ã‚°ã—ã¦ã—ã¾ã†ç‚ºã€å‘½åã—ã‚„ã™ã„ã€‚
    - Excel VBAã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ä½¿ç”¨ã—ã¦ã„ã‚‹å‘½åè¦å‰‡ãŒã‚·ã‚¹ãƒ†ãƒ ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã§ã‚ã‚Šçµ±ä¸€æ„ŸãŒã‚ã‚‹ãŸã‚
    [^3]: ãƒã‚¦ã‚¹ã‚ªãƒ¼ãƒãƒ¼ï¼šãƒã‚¦ã‚¹ã‚«ãƒ¼ã‚½ãƒ«ï¼ˆãƒã‚¤ãƒ³ã‚¿ï¼‰ã‚’å¯¾è±¡ç‰©ã®ä¸Šã«é‡ã­ã‚‹ã“ã¨ã€‚
    :::

- **ã‚³ãƒ¼ãƒ‰ã«æ±ç”¨çš„ãªè¨˜è¿°ã§ã¯ãªã„ç®‡æ‰€ã‚‚ã‚ã‚Š**
    Excel VBAã®ãƒ„ãƒ¼ãƒ«ä½œæˆã§ä½¿ç”¨ã—ãŸè‡ªä½œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€ŒmdlCommon.basã€ã‚’ãã®ã¾ã¾ç´¹ä»‹ã—ã¦ã„ã¾ã™ã€‚
    ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ä½œæˆã—ãŸãƒ„ãƒ¼ãƒ«ã®ä»•æ§˜ã«åˆã‚ã›ãŸå‡¦ç†ã§ã‚ã‚‹ç‚ºã€æ±ç”¨çš„ãªå†…å®¹ã«ãªã£ã¦ã„ãªã„éƒ¨åˆ†ãŒã‚ã‚Šã¾ã™ã€‚
- **å¼•æ•°ã®å±æ€§ã€å‚ç…§æ¸¡ã—ï¼ˆByRefï¼‰ã¨å€¤æ¸¡ã—ï¼ˆByValï¼‰**
    ç§ãŒExcel VBAã‚’ä½œæˆã™ã‚‹éš›ã¯ç°¡æ˜“ãªãƒ„ãƒ¼ãƒ«ã®ã¿ä½œæˆã—ã¦ãŠã‚Šã€å¯èª­æ€§ã‚’å„ªå…ˆã—ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ã¦ã„ã¾ã™ã€‚
    Excel VBAã®ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã®å¼•æ•°ã«ã¯é€šå¸¸ã€å±æ€§ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€ã“ã“ã§ã¯çœç•¥ã€‚
    å¼•æ•°ã‚’çœç•¥ã—ã¦ã„ã‚‹ç‚ºã€å±æ€§ã¯è¦å®šå€¤ã®â€œå‚ç…§æ¸¡ã—ï¼ˆByRefï¼‰â€ã¨ãªã£ã¦ã„ã¾ã™ãŒã€
    ç¾çŠ¶ã€ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£å´ã§å¼•æ•°ã®å€¤ã‚’å¤‰æ›´ã—ã¦ã„ã‚‹å‡¦ç†ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
    ä»®ã«å¼•æ•°ã®å€¤ãŒãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£å´ã§å¤‰æ›´ã™ã‚‹å‡¦ç†ã‚’ä½œæˆã™ã‚‹å ´åˆã¯ã€å±æ€§ã‚’çœç•¥ã›ãšæ˜ç¤ºçš„ã«å‚ç…§æ¸¡ã—ï¼ˆByRefï¼‰ã‚’æŒ‡å®šã™ã‚‹äºˆå®šã§ã™ã€‚

ä»¥ä¸ŠãŒæ³¨æ„äº‹é …ã¨ãªã‚Šã¾ã™ã€‚**å¿…è¦ã«å¿œã˜ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å†…å®¹ã‚’ç½®ãæ›ãˆ**ã¦ã”å¯¾å¿œãã ã•ã„ã€‚
::::
### Functionãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£
æˆ»ã‚Šå€¤ã®ã‚ã‚‹Functionãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚’ç´¹ä»‹ã€‚
#### ç©ºæ–‡å­—ãƒã‚§ãƒƒã‚¯
```vbnet:IsEmptyText
'********************************************************************************
'* å‡¦ç†åã€€ï½œIsEmptyText
'* æ©Ÿèƒ½ã€€ã€€ï½œç©ºæ–‡å­—ãƒã‚§ãƒƒã‚¯
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue=å€¤ãªã—, False=å€¤ã‚ã‚Šï¼‰
'* å¼•æ•°ã€€ã€€ï½œstrValue: å¯¾è±¡æ–‡å­—åˆ—
'********************************************************************************
Function IsEmptyText(strValue As String) As Boolean
    IsEmptyText = (strValue = "")

End Function
```
-----
#### æ•°å€¤ãƒã‚§ãƒƒã‚¯ï¼ˆåŠè§’æ•°å€¤ã®åˆ¤å®šï¼‰
ã€ŒIsNumeric("æ–‡å­—åˆ—")ã€ã§æ•°å€¤ã‚’åˆ¤å®šã™ã‚‹ã¨ã€
å…¨è§’æ–‡å­—ã®æ•°å€¤ï¼ˆä¾‹ï¼šï¼‘ï¼’ï¼“ï¼”ï¼‰ã‚‚æ•°å€¤ã§ã‚ã‚‹ã¨åˆ¤å®šã—ã¦ã—ã¾ã†ã€‚
åŠè§’æ•°å€¤ã®ã¿ã‚’â€œæ•°å€¤â€ã¨ã—ãŸã„å ´åˆã«ã€ã“ã®ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚’ä½¿ç”¨ã€‚
##### å¯¾å¿œè¡¨
![](https://storage.googleapis.com/zenn-user-upload/4a2706df0a2c-20230314.png =600x)
*ç”»åƒï¼šIsNumericEx æ–‡å­—åˆ—ãƒ‘ã‚¿ãƒ¼ãƒ³æ¯ã®åˆ¤å®šçµæœ*

##### ä½¿ç”¨å‰ã®è¨­å®šï¼ˆå‚ç…§è¨­å®šï¼‰
VBAã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼[^4]ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼[`ãƒ„ãƒ¼ãƒ«(T)`] -> [`å‚ç…§è¨­å®š(R)`]ã§ã€
ã€Œ**Microsoft VBScript Regular Expressions 5.5**ã€ã‚’ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦OKã€‚
[^4]: Microsoft Visual Basic for Applicationsï¼šã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼ã¯[`Alt + F11`]ã§èµ·å‹•ã€‚

![](https://storage.googleapis.com/zenn-user-upload/53db505b2a31-20230313.png =600x)
*ç”»åƒï¼šå‚ç…§è¨­å®šã®ã€ŒMicrosoft VBScript Regular Expressions 5.5ã€*
```vbnet:IsNumericEx
'********************************************************************************
'* å‡¦ç†åã€€ï½œIsNumericEx
'* æ©Ÿèƒ½ã€€ã€€ï½œæ•°å€¤ãƒã‚§ãƒƒã‚¯ï¼ˆåŠè§’æ•°å€¤ã®åˆ¤å®šï¼‰
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue=åŠè§’æ•°å€¤ã€False=åŠè§’æ•°å€¤ä»¥å¤–ï¼‰
'* å¼•æ•°ã€€ã€€ï½œstrValue: å¯¾è±¡æ–‡å­—åˆ—
'********************************************************************************
Function IsNumericEx(strValue As String) As Boolean
    Dim objReg As New RegExp

    ' æ¤œç´¢æ¡ä»¶: åŠè§’æ•°å€¤ã®ã¿
    objReg.Pattern = "^[+,-]?([1-9]\d*|0)(\.\d+)?$"
    objReg.Global = True

    IsNumericEx = objReg.Test(strValue)

End Function
```
-----
#### ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
```vbnet:IsExistsFile
'********************************************************************************
'* å‡¦ç†åã€€ï½œIsExistsFile
'* æ©Ÿèƒ½ã€€ã€€ï½œãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue=å­˜åœ¨ã™ã‚‹, False=å­˜åœ¨ã—ãªã„ï¼‰
'* å¼•æ•°ã€€ã€€ï½œstrPath: å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ¶å¯¾ãƒ‘ã‚¹
'********************************************************************************
Function IsExistsFile(strPath As String) As Boolean
    IsExistsFile = Dir(strPath) <> ""

End Function
```
-----
#### ãƒ•ã‚©ãƒ«ãƒ€ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
```vbnet:IsExistsFolder
'********************************************************************************
'* å‡¦ç†åã€€ï½œIsExistsFolder
'* æ©Ÿèƒ½ã€€ã€€ï½œãƒ•ã‚©ãƒ«ãƒ€ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue=å­˜åœ¨ã™ã‚‹, False=å­˜åœ¨ã—ãªã„ï¼‰
'* å¼•æ•°ã€€ã€€ï½œstrPath: å¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€ã®çµ¶å¯¾ãƒ‘ã‚¹
'********************************************************************************
Function IsExistsFolder(strPath As String) As Boolean
    IsExistsFolder = Dir(strPath, vbDirectory) <> ""

End Function
```
-----
#### ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿å–ã‚Šå°‚ç”¨ã‚’ãƒã‚§ãƒƒã‚¯
```vbnet:IsReadonlyFile
'********************************************************************************
'* å‡¦ç†åã€€ï½œIsReadonlyFile
'* æ©Ÿèƒ½ã€€ã€€ï½œãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿å–ã‚Šå°‚ç”¨ã‚’ãƒã‚§ãƒƒã‚¯
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue=èª­ã¿å–ã‚Šå°‚ç”¨ã§ã‚ã‚‹, False=èª­ã¿å–ã‚Šå°‚ç”¨ã§ã¯ãªã„ï¼‰
'* å¼•æ•°ã€€ã€€ï½œstrPath: å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ¶å¯¾ãƒ‘ã‚¹
'********************************************************************************
Function IsReadonlyFile(strPath As String) As Boolean
    Dim vbResult As VbFileAttribute
    
    ' ãƒ•ã‚¡ã‚¤ãƒ«ã®å±æ€§ã‚’å–å¾—
    vbResult = GetAttr(strPath)
    
    ' èª­ã¿å–ã‚Šå°‚ç”¨ã®åˆ¤å®š
    IsReadonlyFile = ((vbResult And vbReadOnly) = vbReadOnly)

End Function
```
-----
#### ãƒ•ã‚¡ã‚¤ãƒ«ã®é–‹ãçŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯
```vbnet:IsOpenedFile
'********************************************************************************
'* å‡¦ç†åã€€ï½œIsOpenedFile
'* æ©Ÿèƒ½ã€€ã€€ï½œãƒ•ã‚¡ã‚¤ãƒ«ã®é–‹ãçŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue=ã²ã‚‰ãçŠ¶æ…‹, False=ã¨ã˜ãŸçŠ¶æ…‹ï¼‰
'* å¼•æ•°ã€€ã€€ï½œstrPath: å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ¶å¯¾ãƒ‘ã‚¹
'********************************************************************************
Function IsOpenedFile(strPath As String) As Boolean
    Dim intFileno As Integer
    
    intFileno = FreeFile
    
    ' æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½è¨˜ãƒ¢ãƒ¼ãƒ‰ã§é–‹ã„ãŸæ™‚ã®æˆ»ã‚Šå€¤ã§åˆ¤å®š
    On Error Resume Next
    Open strPath For Append As #intFileno
    Close #intFileno
    
    IsOpenedFile = (Err.Number >= 1)

End Function
```
-----
#### ã‚·ãƒ¼ãƒˆã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
```vbnet:IsExistsSheet
'********************************************************************************
'* å‡¦ç†åã€€ï½œIsExistsSheet
'* æ©Ÿèƒ½ã€€ã€€ï½œã‚·ãƒ¼ãƒˆã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue=å­˜åœ¨ã™ã‚‹, False=å­˜åœ¨ã—ãªã„ï¼‰
'* å¼•æ•°ã€€ã€€ï½œstrSheetname: å¯¾è±¡ã‚·ãƒ¼ãƒˆå
'********************************************************************************
Function IsExistsSheet(strSheetname As String) As Boolean
    Dim wbTarget As Workbook
    Dim wsTarget As Worksheet
    Set wbTarget = ThisWorkbook
    Set wsTarget = Nothing

    On Error Resume Next
    Set wsTarget = wbTarget.Worksheets(strSheetname)
    On Error GoTo 0

    IsExistsSheet = (Not (wsTarget Is Nothing))
    
    Set wsTarget = Nothing
    Set wbTarget = Nothing

End Function
```
-----
#### å¿…é ˆé …ç›®ãƒã‚§ãƒƒã‚¯ï¼ˆå¯¾è±¡ï¼šExcelã®è¡¨ï¼‰
```vbnet:IsEmptyTablerequired
'********************************************************************************
'* å‡¦ç†åã€€ï½œIsEmptyTablerequired
'* æ©Ÿèƒ½ã€€ã€€ï½œå¿…é ˆé …ç›®ãƒã‚§ãƒƒã‚¯ï¼ˆå¯¾è±¡ã¯Excelã®è¡¨ï¼‰
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue=ã„ãšã‚Œã‹ç©ºæ–‡å­—ã‚ã‚Š, False=ç©ºæ–‡å­—ãªã— or 0ä»¶ï¼‰
'* å¼•æ•°ã€€ã€€ï½œstrSheetname: å¯¾è±¡ã‚·ãƒ¼ãƒˆå, strRange: ã‚»ãƒ«ä½ç½®, aryCheckcol: å¿…é ˆé …ç›®
'*-------------------------------------------------------------------------------
'* æ³¨æ„äº‹é …ï¼š1.å¯¾è±¡ã‚·ãƒ¼ãƒˆã¯å­˜åœ¨ã™ã‚‹äº‹ãŒå‰æã¨ãªã‚‹ã€‚
'* ã€€ã€€ã€€ã€€ã€€ã€€ã“ã®ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚’å‘¼ã³å‡ºã™å‰ã«ã‚·ãƒ¼ãƒˆã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯ï¼ˆIsExistsSheetï¼‰ã‚’ã€
'* ã€€ã€€ã€€ã€€ã€€ã€€å®Ÿè¡Œã—ã‚¨ãƒ©ãƒ¼åˆ¶å¾¡ã™ã‚‹ã“ã¨ã€‚
'* ã€€ã€€ã€€ã€€ã€€2.åˆ—ã®é–‹å§‹ä½ç½®ã®æœ€å¤§è¡Œæ•°ã‚’å¯¾è±¡ã«ãƒã‚§ãƒƒã‚¯ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚
'********************************************************************************
Function IsEmptyTablerequired(strSheetname As String, strRange As String, aryCheckcol() As String) As Boolean
    Dim wbTarget As Workbook
    Dim wsTarget As Worksheet
    
    Dim rngTarget As Range
    Dim lngBeginrow As Long
    Dim lngBegincol As Long
    Dim lngEndrow As Long
    Dim lngEndcol As Long
    Dim strAddress As String
    Dim lngRow As Long
    Dim lngCount As Long
    Dim strValue As String
    
    Set rngTarget = Range(strRange)
    lngBeginrow = rngTarget.Row
    lngBegincol = rngTarget.Column
    
    Set wbTarget = ThisWorkbook
    Set wsTarget = wbTarget.Worksheets(strSheetname)
    
    With wsTarget
        lngEndrow = .Cells(Rows.Count, lngBegincol).End(xlUp).Row
        If lngBeginrow > lngEndrow Then
            ' ãƒ‡ãƒ¼ã‚¿0ä»¶ã®å ´åˆã¯çµ‚äº†
            IsEmptyTablerequired = False
            Exit Function
        End If
        lngEndcol = .Cells(lngBeginrow, Columns.Count).End(xlToLeft).Column
        
        For lngRow = lngBeginrow To lngEndrow
            For lngCount = 0 To UBound(aryCheckcol)
                strValue = .Cells(lngRow, CLng(aryCheckcol(lngCount)))
                strAddress = .Cells(lngRow, CLng(aryCheckcol(lngCount))).Address(False, False)
                Call SubSelectCell(strSheetname, strAddress)
                If IsEmptyText(strValue) Then
                    IsEmptyTablerequired = True
                    Exit Function
                End If
            Next
        Next
    End With
    
    IsEmptyTablerequired = False
    
    Set wbTarget = Nothing
    Set wsTarget = Nothing

End Function
```
-----
#### è¨­å®šæƒ…å ±ã®èª­ã¿è¾¼ã¿
ãƒ„ãƒ¼ãƒ«ã®ä»•æ§˜ã¯åŒã˜ã ãŒã€å…¥å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãŒå°‘ã—ã ã‘ç•°ãªã‚‹å ´åˆãªã©ã‚’æƒ³å®šã—ãŸãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã€‚

ã“ã®ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚’ä½¿ã†æº–å‚™ã¨ã—ã¦ã€ã‚»ãƒ«ã®å‚ç…§ä½ç½®ãªã©å¤‰åŒ–ã™ã‚‹æƒ…å ±ã‚’ã€
ã‚ã‚‰ã‹ã˜ã‚å¤–ã ã—ã—ãŸExcelã‚·ãƒ¼ãƒˆã‚’ä½œæˆã™ã‚‹ã€‚
ãªãŠã€ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã¯ã€å¤–ã ã—ã—ã¦ã„ã‚‹æƒ…å ±ã¯å‡¦ç†åŒºåˆ†æ¯ã«ã‚ã‘ã¦å®šæ•°ã§å®£è¨€ã—ã¦ã„ã‚‹ã€‚

ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã®å®Ÿè¡Œæ™‚ã€ã‚ã‚‰ã‹ã˜ã‚å®šã‚ãŸå‡¦ç†åŒºåˆ†ã®åå‰ã‚’å¼•æ•°ã§æ¸¡ã™ã€‚
å®Ÿè¡Œå¾Œã€æŒ‡å®šã—ãŸå‡¦ç†åŒºåˆ†ã«é–¢ã™ã‚‹æƒ…å ±ãŒæ–‡å­—åˆ—é…åˆ—ã¨ã—ã¦æˆ»ã•ã‚Œã‚‹ã€‚
##### ä¾‹ï¼‰å¤‰åŒ–ç‚¹ã‚’å¤–ã ã—ã—ãŸExcelã‚·ãƒ¼ãƒˆ
![](https://storage.googleapis.com/zenn-user-upload/a813158cd23f-20230310.png =600x)
*ç”»åƒï¼šã‚·ãƒ¼ãƒˆã€Œè¨­å®šæƒ…å ±ã‚·ãƒ¼ãƒˆã€ã®ä¾‹*
##### å®šæ•°éƒ¨åˆ†
```vbnet:å®šæ•° - FuncReadSetinfo
' å®šæ•°
'   ãƒ¡ã‚¤ãƒ³
Public Const MAIN_RANGE As String = "D3,D4,D5,D6,D7,D8,D9,D10"
' ã€€ã‚¨ãƒ©ãƒ¼æƒ…å ±
Public Const ERROR_RANGE As String = "D13,D14"
' ã€€å…¥åŠ›æƒ…å ±
Public Const INPUT_RANGE As String = "D17,D18,D19,D20,D21"
' ã€€å‡ºåŠ›æƒ…å ±
Public Const OUTPUT_RANGE As String = "D24,D25"
' ã€€ãƒã‚¹ã‚¿ãƒ¼
Public Const MASTER_RANGE As String = "D28,D29,D30"
' ã€€éè¡¨ç¤ºã™ã‚‹ã‚·ãƒ¼ãƒˆæƒ…å ±
Public Const HIDDEN_RANGE As String = "D33,D34,D35,D36,D37,D38,D39,D40,D41,D42,D43,D44,D45,D46,D47"
'   ã‚·ãƒ¼ãƒˆå
Public Const SETINFO_SHEETNAME As String = "è¨­å®šæƒ…å ±"
'   ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼
Public Const MAIN_PARA As String = "MAIN"
Public Const ERROR_PARA As String = "ERROR"
Public Const INPUT_PARA As String = "INPUT"
Public Const OUTPUT_PARA As String = "OUTPUT"
Public Const MASTER_PARA As String = "MASTER"
Public Const HIDDEN_PARA As String = "HIDDEN"
```
##### ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£éƒ¨åˆ†
```vbnet:FuncReadSetinfo
'********************************************************************************
'* å‡¦ç†åã€€ï½œFuncReadSetinfo
'* æ©Ÿèƒ½ã€€ã€€ï½œè¨­å®šæƒ…å ±ã®èª­ã¿è¾¼ã¿
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œString(): æŒ‡å®šã—ãŸå‡¦ç†åŒºåˆ†ã®æƒ…å ±
'* å¼•æ•°ã€€ã€€ï½œstrClass: å‡¦ç†åŒºåˆ†ã®åå‰
'********************************************************************************
Function FuncReadSetinfo(strClass As String) As String()
    Dim arySetinfo() As String
    
    Select Case strClass
        Case mdlCommon.MAIN_PARA
            arySetinfo = Split(MAIN_RANGE, ",")
        Case mdlCommon.ERROR_PARA
            arySetinfo = Split(ERROR_RANGE, ",")
        Case mdlCommon.INPUT_PARA
            arySetinfo = Split(INPUT_RANGE, ",")
        Case mdlCommon.OUTPUT_PARA
            arySetinfo = Split(OUTPUT_RANGE, ",")
        Case mdlCommon.MASTER_PARA
            arySetinfo = Split(MASTER_RANGE, ",")
        Case mdlCommon.HIDDEN_PARA
            arySetinfo = Split(HIDDEN_RANGE, ",")
    End Select
    
    FuncReadSetinfo = arySetinfo
    
End Function
```
-----
#### ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ¶å¯¾ãƒ‘ã‚¹ã‹ã‚‰ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ‘ã‚¹ã‚’æŠ½å‡º
```vbnet:FuncExtractFolderpath
'********************************************************************************
'* å‡¦ç†åã€€ï½œFuncExtractFolderpath
'* æ©Ÿèƒ½ã€€ã€€ï½œãƒ•ã‚¡ã‚¤ãƒ«ã®çµ¶å¯¾ãƒ‘ã‚¹ã‹ã‚‰ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ‘ã‚¹ã‚’æŠ½å‡º
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œString: ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ‘ã‚¹
'* å¼•æ•°ã€€ã€€ï½œ-
'********************************************************************************
Public Function FuncExtractFolderpath(strPath As String) As String
    Dim aryPath() As String

    aryPath = Split(strPath, "\")
    If UBound(aryPath) > 0 Then
        ReDim Preserve aryPath(UBound(aryPath) - 1)
    End If

    FuncExtractFolderpath = Join(aryPath, "\")
    
End Function
```
-----
#### å‡¦ç†ä¸­æ–­ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
```vbnet:FuncShowBreakmessage
'********************************************************************************
'* å‡¦ç†åã€€ï½œFuncShowBreakmessage
'* æ©Ÿèƒ½ã€€ã€€ï½œå‡¦ç†ä¸­æ–­ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œBooleanï¼ˆTrue=ä¸­æ–­ã™ã‚‹, False=ä¸­æ–­ã—ãªã„ï¼‰
'* å¼•æ•°ã€€ã€€ï½œ-
'********************************************************************************
Public Function FuncShowBreakmessage() As Boolean
    Dim strMessage As String
    
    strMessage = "å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã™ã‹ï¼Ÿ" & vbCrLf & _
                  vbCrLf & _
                  "ã€€ã€Œã„ã„ãˆã€ã‚’é¸æŠã—ä¸­æ–­ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ãŸå ´åˆã§ã‚‚ã€" & vbCrLf & _
                  "ã€€ä¸­æ–­ã—ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«ã‚ˆã£ã¦ãƒ‡ãƒ¼ã‚¿ã®ä¸æ•´åˆãŒç™ºç”Ÿã—ã¾ã™ã€‚" & vbCrLf & _
                  vbCrLf & _
                  "ã€€å¿…ãšæœ€åˆã‹ã‚‰å†å‡¦ç†ã—ã¦ãã ã•ã„ã€‚"
    FuncShowBreakmessage = (MsgBox(strMessage, vbQuestion + vbYesNo, "ç¢ºèª") = vbYes)

End Function
```
-----
#### ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å–å¾—
```vbnet:FuncRetrieveMessage
'********************************************************************************
'* å‡¦ç†åã€€ï½œFuncRetrieveMessage
'* æ©Ÿèƒ½ã€€ã€€ï½œãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å–å¾—
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œString: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹
'* å¼•æ•°ã€€ã€€ï½œlngCode: å¯¾è±¡ãƒ©ãƒ™ãƒ«ã‚³ãƒ¼ãƒ‰
'********************************************************************************
Public Function FuncRetrieveMessage(strCode As String) As String
    Dim aryMessages(10, 1) As String
    ' æ­£å¸¸çµ‚äº†ã‚³ãƒ¼ãƒ‰
    aryMessages(0, 0) = "0"
    aryMessages(0, 1) = "æ­£å¸¸çµ‚äº†ã€‚"
    aryMessages(1, 0) = "10"
    aryMessages(1, 1) = "åˆæœŸåŒ–ã‚’å®Ÿè¡Œã€‚"
    aryMessages(2, 0) = "20"
    aryMessages(2, 1) = "ãƒ•ã‚©ãƒ«ãƒ€ã®ä½œæˆå‡¦ç†ãŒå®Œäº†ã€‚"
    aryMessages(3, 0) = "999"
    aryMessages(3, 1) = ""
    ' ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    ' æœªå…¥åŠ›ãƒã‚§ãƒƒã‚¯
    aryMessages(4, 0) = "-111"
    aryMessages(4, 1) = "å¿…é ˆé …ç›®ãŒæœªå…¥åŠ›ã€‚"
    ' å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    aryMessages(5, 0) = "-211"
    aryMessages(5, 1) = "å‚ç…§ã§ããªã„ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã€‚"
    aryMessages(6, 0) = "-212"
    aryMessages(6, 1) = "å‚ç…§ã§ããªã„ãƒ•ã‚©ãƒ«ãƒ€ãŒã‚ã‚Šã€‚"
    ' 0ä»¶ãƒã‚§ãƒƒã‚¯
    aryMessages(7, 0) = "-311"
    aryMessages(7, 1) = "å–ã‚Šè¾¼ã‚“ã ãƒ‡ãƒ¼ã‚¿ãŒ0ä»¶ã€‚"
    ' ãƒã‚¹ã‚¿ãƒ¼ã®ã‚¨ãƒ©ãƒ¼
    aryMessages(8, 0) = "-411"
    aryMessages(8, 1) = "ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã®å¿…é ˆé …ç›®ãŒæœªå…¥åŠ›ã€‚"
    ' ãã®ä»–ã‚¨ãƒ©ãƒ¼
    aryMessages(9, 0) = "-901"
    aryMessages(9, 1) = "å®Ÿè¡Œä¸­ã«ä¸­æ–­ã€‚"
    aryMessages(10, 0) = "-999"
    aryMessages(10, 1) = "ä¾‹å¤–ãŒç™ºç”Ÿã€‚"
    
    Dim lngCount As Long
    lngCount = 0
    For lngCount = LBound(aryMessages, 1) To UBound(aryMessages, 1)
        If aryMessages(lngCount, 0) = strCode Then
            FuncRetrieveMessage = aryMessages(lngCount, 1)
            Exit Function
        End If
    Next

    FuncRetrieveMessage = ""

End Function
```
-----
### Subãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£
æˆ»ã‚Šå€¤ã®ãªã„Subãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚’ç´¹ä»‹ã€‚
#### æŒ‡å®šã—ãŸã‚»ãƒ«ã‚’é¸æŠ
```vbnet:SubSelectCell
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubSelectCell
'* æ©Ÿèƒ½ã€€ã€€ï½œæŒ‡å®šã—ãŸã‚»ãƒ«ã‚’é¸æŠ
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œãªã—
'* å¼•æ•°ã€€ã€€ï½œstrSheetname: å¯¾è±¡ã‚·ãƒ¼ãƒˆåã€strRange: å¯¾è±¡ã‚»ãƒ«
'********************************************************************************
Sub SubSelectCell(strSheetname As String, strRange As String)
    With Worksheets(strSheetname)
        .Select
        .Range(strRange).Select
    End With

End Sub
```
-----
#### ã‚·ãƒ¼ãƒˆã®ã‚¯ãƒªã‚¢
```vbnet:SubClearSheet
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubClearSheet
'* æ©Ÿèƒ½ã€€ã€€ï½œã‚·ãƒ¼ãƒˆã®ã‚¯ãƒªã‚¢
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œstrSheetname: å¯¾è±¡ã‚·ãƒ¼ãƒˆ, strRange: é–‹å§‹ã‚»ãƒ«ä½ç½®
'********************************************************************************
Sub SubClearSheet(strSheetname As String, strRange As String)
    Dim wbTarget As Workbook
    Dim wsTarget As Worksheet
    
    Dim rngTarget As Range
    Dim lngBeginrow As Long
    Dim lngBegincol As Long
    Dim lngEndrow As Long
    
    Set wbTarget = ThisWorkbook
    
    ' å¯¾è±¡ã‚·ãƒ¼ãƒˆãŒãªã„å ´åˆã§ã‚‚ã‚¨ãƒ©ãƒ¼ã‚’ç™ºç”Ÿã•ã›ãšå‡¦ç†ã‚’ç¶šè¡Œ
    On Error Resume Next
    Set wsTarget = wbTarget.Worksheets(strSheetname)
    On Error GoTo 0
    
    Set rngTarget = Range(strRange)
    lngBeginrow = rngTarget.Row
    lngBegincol = rngTarget.Column
    
    ' ã‚·ãƒ¼ãƒˆãŒã‚ã‚‹å ´åˆ
    If (IsExistsSheet(strSheetname)) Then
        With wsTarget
            lngEndrow = .Cells(Rows.Count, lngBegincol).End(xlUp).Row
            ' è¡¨ã«å€¤ãŒãªã„å ´åˆã€æœ€å¤§è¡Œæ•°ã‚’é–‹å§‹è¡Œã«å¤‰æ›´
            If lngBeginrow > lngEndrow Then
                lngEndrow = lngBeginrow
            End If
            With .Range(.Cells(lngBeginrow, lngBegincol), .Cells(lngEndrow, Columns.Count))
                .ClearContents
            End With
            With .Range(.Cells(lngBeginrow, lngBegincol), .Cells(Rows.Count, Columns.Count))
                .Interior.ColorIndex = 0
                .Borders.LineStyle = False
            End With
        End With
    End If
    
    Set wbTarget = Nothing
    Set wsTarget = Nothing

End Sub
```
-----
#### Excelã‚·ãƒ¼ãƒˆã®ã‚³ãƒ”ãƒ¼
```vbnet:SubCopySheet
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubCopySheet
'* æ©Ÿèƒ½ã€€ã€€ï½œExcelã‚·ãƒ¼ãƒˆã®ã‚³ãƒ”ãƒ¼
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œã‚³ãƒ”ãƒ¼å…ƒï¼ˆstrFmName=ã‚·ãƒ¼ãƒˆå, lngFmBeginrow=é–‹å§‹è¡Œ, lngFmBegincol=é–‹å§‹åˆ—ï¼‰
'* ã€€ã€€ã€€ã€€ï½œã‚³ãƒ”ãƒ¼å…ˆï¼ˆstrToName=ã‚·ãƒ¼ãƒˆå, lngToBeginrow=é–‹å§‹è¡Œ, lngToBegincol=é–‹å§‹åˆ—ï¼‰
'********************************************************************************
Sub SubCopySheet(strFmName As String, lngFmBeginrow As Long, lngFmBegincol As Long, _
                 strToName As String, lngToBeginrow As Long, lngToBegincol As Long)
    Dim wbTarget As Workbook
    Dim wsFmSheet As Worksheet
    Dim wsToSheet As Worksheet
    
    Dim lngFmEndrow As Long
    Dim lngFmEndcol As Long
    Dim lngToEndrow As Long
    Dim lngToEndcol As Long
    
    Dim lngFmRow As Long
    Dim lngFmCol As Long
    Dim lngToRow As Long
    Dim lngToCol As Long
    
    Dim lngRow As Long
    
    Dim varFmCopydata As Variant
    Dim varToCopydata As Variant
    
    Set wbTarget = ThisWorkbook
    
    On Error Resume Next
    Set wsFmSheet = wbTarget.Worksheets(strFmName)
    Set wsToSheet = wbTarget.Worksheets(strToName)
    On Error GoTo 0
    
    ' ã‚·ãƒ¼ãƒˆãŒã‚ã‚‹å ´åˆ
    If Not (wsFmSheet Is Nothing) And _
       Not (wsToSheet Is Nothing) Then
        With wsFmSheet
            lngFmEndrow = .Cells(Rows.Count, lngFmBegincol + 1).End(xlUp).Row
            If lngFmBeginrow > lngFmEndrow Then
                lngFmEndrow = lngFmBeginrow
            End If
            
            lngFmRow = lngFmBeginrow
            lngFmCol = lngFmBegincol
            lngToRow = lngToBeginrow
            lngToCol = lngToBegincol
            
            ReDim varToCopydata(lngFmEndrow - 1, 30)
            
            varFmCopydata = .Range(.Cells(lngFmRow, lngFmCol), .Cells(lngFmEndrow, lngFmCol + 30)).Value
        End With
        
        varToCopydata = varFmCopydata
        
        ' ç·¨é›†å‡¦ç†ï¼ˆã‚ã‚Œã°ï¼‰
        '   æ—¥ä»˜ã‚’YYYY-MM-DDã§è¡¨ç¤º
        For lngRow = 1 To UBound(varToCopydata)
            varToCopydata(lngRow, 30) = "'" & varToCopydata(lngRow, 30)
        Next
        
        With wsToSheet
            .Range(.Cells(lngToRow, lngToCol), .Cells(lngFmEndrow, lngToCol + 30)).Value = varToCopydata
            ' ç½«ç·šã®è¨­å®š
            lngToEndrow = .Cells(Rows.Count, lngToBegincol).End(xlUp).Row
            lngToEndcol = .Cells(1, Columns.Count).End(xlToLeft).Column
            With .Range(.Cells(lngToBeginrow, lngToBegincol), .Cells(lngToEndrow, lngToEndcol))
                .Borders.LineStyle = True
            End With
        End With
    End If
    
    Set wsFmSheet = Nothing
    Set wsToSheet = Nothing
    Set wbTarget = Nothing
    
End Sub
```
-----
#### CSVãƒ•ã‚¡ã‚¤ãƒ«å–ã‚Šè¾¼ã¿
```vbnet:SubLoadCsv
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubLoadCsv
'* æ©Ÿèƒ½ã€€ã€€ï½œCSVãƒ•ã‚¡ã‚¤ãƒ«ã®å–ã‚Šè¾¼ã¿
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œstrPath: å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ¶å¯¾ãƒ‘ã‚¹, lngCsvrow: CSVé–‹å§‹è¡Œ,
'* ã€€ã€€ã€€ã€€ï½œstrSheetname: å¯¾è±¡ã‚·ãƒ¼ãƒˆ, strExcelrange: Excelé–‹å§‹ã‚»ãƒ«ä½ç½®,
'* ã€€ã€€ã€€ã€€ï½œ[ä»»æ„]strCharcode: æ–‡å­—ã‚³ãƒ¼ãƒ‰
'********************************************************************************
Sub SubLoadCsv(strPath As String, lngCsvrow As Long, _
               strSheetname As String, strExcelrange As String, _
               Optional strCharcode As String = "UTF8")
    Dim qtTarget As QueryTable
    Dim rngExcel As Range
    Dim lngExcelbeginrow As Long
    Dim lngExcelbegincol As Long
    Dim lngEndrow As Long
    Set rngExcel = Range(strExcelrange)
    lngExcelbeginrow = rngExcel.Row
    lngExcelbegincol = rngExcel.Column
    
    With Worksheets(strSheetname)
        lngEndrow = .Cells(Rows.Count, lngExcelbegincol).End(xlUp).Row
    End With
    
    If lngEndrow > lngExcelbeginrow Then
        lngExcelbeginrow = lngEndrow + 1
    End If
    
    Set qtTarget = Worksheets(strSheetname).QueryTables.Add(Connection:="TEXT;" & strPath, _
        Destination:=Worksheets(strSheetname).Cells(lngExcelbeginrow, lngExcelbegincol))
    
    With qtTarget
        .TextFileCommaDelimiter = True                          ' ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã®æŒ‡å®š
        .TextFileParseType = xlDelimited                        ' åŒºåˆ‡ã‚Šæ–‡å­—ã®å½¢å¼
        .TextFileTextQualifier = xlTextQualifierDoubleQuote     ' å¼•ç”¨ç¬¦ã‚ã‚Šãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®š
        If strCharcode = "UTF8" Then
            .TextFilePlatform = 65001                           ' æ–‡å­—ã‚³ãƒ¼ãƒ‰UTF-8ã‚’æŒ‡å®š
        Else
            .TextFilePlatform = 932                             ' æ–‡å­—ã‚³ãƒ¼ãƒ‰Shift_JISã‚’æŒ‡å®š
        End If
       .TextFileStartRow = lngCsvrow                            ' é–‹å§‹è¡Œã®æŒ‡å®š
       .RefreshStyle = xlOverwriteCells                         ' ã‚»ãƒ«ã¯è¿½åŠ ã›ãšä¸Šæ›¸ãã™ã‚‹
       .Refresh                                                 ' QueryTablesã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ›´æ–°ã—ã€ã‚·ãƒ¼ãƒˆä¸Šã«å‡ºåŠ›
       .Delete                                                  ' QueryTables.Addãƒ¡ã‚½ãƒƒãƒ‰ã§å–ã‚Šè¾¼ã‚“ã CSVã¨ã®æ¥ç¶šã‚’è§£é™¤
    End With
    
    Set qtTarget = Nothing

End Sub
```
-----
#### CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜ï¼ˆæ–‡å­—ã‚³ãƒ¼ãƒ‰ï¼šUTF-8ï¼‰
```vbnet:SubSaveCsv
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubSaveCsv
'* æ©Ÿèƒ½ã€€ã€€ï½œCSVãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜ï¼ˆæ–‡å­—ã‚³ãƒ¼ãƒ‰ï¼šUTF-8ï¼‰
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œstrSheetname: å¯¾è±¡ã‚·ãƒ¼ãƒˆ, strExcelrange: Excelé–‹å§‹ã‚»ãƒ«ä½ç½®,
'* ã€€ã€€ã€€ã€€ï½œstrSavepath: ä¿å­˜å…ˆ, lngCsvrow: CSVé–‹å§‹è¡Œ
'********************************************************************************
Sub SubSaveCsv(strSheetname As String, strExcelrange As String, _
               strSavepath As String, lngCsvbeginrow As Long)
    Dim rngExcel As Range
    Dim lngExcelbeginrow As Long
    Dim lngExcelbegincol As Long
    Dim lngEndrow As Long
    Dim lngEndcol As Long
    Dim lngRow As Long
    Dim lngCol As Long
    Dim strCsvdata As String
    Dim strLine As String
    Dim strValue As String
    Dim strDelimiter As String
    Dim aryItems() As String

    Set rngExcel = Range(strExcelrange)
    lngExcelbeginrow = rngExcel.Row
    lngExcelbegincol = rngExcel.Column

    Dim objUtf8 As Object
    Dim objNonbom As Object
    Set objUtf8 = CreateObject("ADODB.Stream")
    Set objNonbom = CreateObject("ADODB.Stream")

    ' CSVå½¢å¼ã®æº–å‚™
    With Worksheets(strSheetname)
        lngEndrow = .Cells(Rows.Count, lngExcelbegincol).End(xlUp).Row
        lngEndcol = .Cells(lngExcelbeginrow - 1, Columns.Count).End(xlToLeft).Column
    End With
    
    If lngCsvbeginrow > lngEndrow Then
        lngEndrow = lngCsvbeginrow
    End If

    strDelimiter = ","

    For lngRow = lngExcelbeginrow To lngEndrow
        strLine = ""
        For lngCol = lngExcelbegincol To lngEndcol
            With Worksheets(strSheetname)
                strValue = .Cells(lngRow, lngCol).Value
            End With
            If strLine = "" Then
                strLine = strValue
            Else
                ReDim aryItems(1)
                aryItems(0) = strLine
                aryItems(1) = strValue
                strLine = Join(aryItems, strDelimiter)
            End If
        Next

        If strCsvdata = "" Then
            strCsvdata = strLine
        Else
            ReDim aryItems(1)
            aryItems(0) = strCsvdata
            aryItems(1) = strLine
            strCsvdata = Join(aryItems, vbCrLf)
        End If
    Next
    ' æœ€çµ‚è¡Œã«ç©ºæ–‡å­—è¡Œ
    ReDim aryItems(1)
    aryItems(0) = strCsvdata
    aryItems(1) = ""
    strCsvdata = Join(aryItems, vbCrLf)

    ' ä¿å­˜
    With objUtf8
        .Charset = "UTF-8"
        .Open
        .WriteText strCsvdata
        .Position = 0
        .Type = 1                       ' Binary
        .Position = 3
    End With

    With objNonbom
        .Type = 1                       ' Binary
        .Open
        objUtf8.CopyTo objNonbom
        .SaveToFile strSavepath, 2      ' SaveCreateOverWrite
    End With

    objNonbom.Close
    objUtf8.Close

    Set objNonbom = Nothing
    Set objUtf8 = Nothing

End Sub
```
-----
#### ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ã®è¡¨ç¤º
```vbnet:SubShowMessagebox
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubShowMessagebox
'* æ©Ÿèƒ½ã€€ã€€ï½œãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¡¨ç¤º
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œlngCode: å¯¾è±¡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ¼ãƒ‰, [ä»»æ„]strAppend: è¿½åŠ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
'********************************************************************************
Sub SubShowMessagebox(lngCode As Long, Optional strAppend As String = "")
    Dim strMessage As String
    Dim lngLevel As Long
    Dim strLevel As String

    strMessage = FuncRetrieveMessage(CStr(lngCode))
    strMessage = strMessage & vbCrLf & strAppend & vbCrLf
    
    If Left(CStr(lngCode), 1) = "-" Then
        lngLevel = vbCritical
        strLevel = "è­¦å‘Š"
    Else
        lngLevel = vbInformation
        strLevel = "æƒ…å ±"
    End If
    
    strMessage = strMessage & vbCrLf & "Message Code: " & "[" & CStr(lngCode) & "]"
    
    MsgBox strMessage, vbOKOnly + lngLevel, strLevel
    
End Sub
```
-----
#### é€šçŸ¥ç”¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚·ãƒ¼ãƒˆè¡¨ç¤º
##### å®šæ•°éƒ¨åˆ†
```vbnet:å®šæ•° - SubDisplayMessage
' å®šæ•°
'   ã‚·ãƒ¼ãƒˆå
Public Const SETINFO_SHEETNAME As String = "è¨­å®šæƒ…å ±"
'   ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼
Public Const MAIN_PARA As String = "MAIN"
```
##### ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£éƒ¨åˆ†
```vbnet:SubDisplayMessage
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubDisplayMessage
'* æ©Ÿèƒ½ã€€ã€€ï½œé€šçŸ¥ç”¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚·ãƒ¼ãƒˆè¡¨ç¤º
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œlngCode: å¯¾è±¡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ¼ãƒ‰ã€[ä»»æ„]strAppend: è¿½åŠ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
'********************************************************************************
Public Sub SubDisplayMessage(lngCode As Long, Optional strAppend As String = "")
    Dim arySetinfo() As String
    arySetinfo = FuncReadSetinfo(mdlCommon.MAIN_PARA)
    
    Dim strSheetname As String
    Dim strRange As String
    Dim strMessage As String
    Dim strDatetime As String
    Dim lngCount As Long
    
    strDatetime = Format(Now, "yyyy/mm/dd hh:mm:ss")
    
    With Worksheets(SETINFO_SHEETNAME)
        strSheetname = .Range(arySetinfo(0)).Value
        strRange = .Range(arySetinfo(1)).Value
    End With
    
    strMessage = FuncRetrieveMessage(CStr(lngCode))
    If Not (mdlCommon.IsEmptyText(strMessage)) Then
        strMessage = strDatetime & " " & _
                     strMessage & vbCrLf & _
                     strAppend
    End If
    
    With Worksheets(strSheetname)
        .Range(strRange).Font.ColorIndex = 11
        If Left(CStr(lngCode), 1) = "-" Then
            .Range(strRange).Font.ColorIndex = 3
        End If
        .Range(strRange).Value = strMessage
    End With
    
End Sub
```
-----
#### ã‚¨ãƒ©ãƒ¼æƒ…å ±ã¸ã®æ›¸ãè¾¼ã¿
```vbnet:SubWriteError
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubWriteError
'* æ©Ÿèƒ½ã€€ã€€ï½œã‚¨ãƒ©ãƒ¼æƒ…å ±ã¸ã®æ›¸ãè¾¼ã¿
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œlngCode: å¯¾è±¡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ¼ãƒ‰ã€[ä»»æ„]strAppend: è¿½åŠ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
'********************************************************************************
Public Sub SubWriteError(lngCode As Long, Optional strAppend As String = "")
    Dim strDatetime As String
    Dim strLevel As String
    Dim strMessage As String
    
    strDatetime = Format(Now, "yyyy/mm/dd hh:mm:ss")
    If Left(CStr(lngCode), 1) = "-" Then
        strLevel = "è­¦å‘Š"
    Else
        strLevel = "æƒ…å ±"
    End If
    strMessage = FuncRetrieveMessage(CStr(lngCode))

    Dim arySetinfo() As String
    Dim strErrorsheet As String
    Dim strRange As String
    Dim rngTarget As Range
    Dim lngBeginrow As Long
    Dim lngBegincol As Long
    Dim lngEndrow As Long
    arySetinfo = mdlCommon.FuncReadSetinfo(mdlCommon.ERROR_PARA)
    With Worksheets(mdlCommon.SETINFO_SHEETNAME)
        strErrorsheet = .Range(arySetinfo(0)).Value
        strRange = .Range(arySetinfo(1)).Value
    End With

    Set rngTarget = Range(strRange)
    lngBeginrow = rngTarget.Row
    lngBegincol = rngTarget.Column

    With Worksheets(strErrorsheet)
        lngEndrow = .Cells(Rows.Count, lngBegincol).End(xlUp).Row

        .Cells(lngEndrow + 1, lngBegincol).Value = strDatetime
        .Cells(lngEndrow + 1, lngBegincol + 1).Value = strLevel
        .Cells(lngEndrow + 1, lngBegincol + 2).Value = strMessage
        .Cells(lngEndrow + 1, lngBegincol + 3).Value = strAppend

        With .Range(.Cells(lngBeginrow, lngBegincol), .Cells(lngEndrow + 1, lngBegincol + 3))
            .Borders.LineStyle = True
        End With
    End With
End Sub
```
-----
#### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ã®è¡¨ç¤º
```vbnet:SubDisplayStatusbar
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubDisplayStatusbar
'* æ©Ÿèƒ½ã€€ã€€ï½œã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ã®è¡¨ç¤º
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œblValidï¼ˆTrue=ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼æœ‰åŠ¹, False=ç„¡åŠ¹ï¼‰, [ä»»æ„]strAppend: è¿½åŠ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
'********************************************************************************
Sub SubDisplayStatusbar(blValid As Boolean, Optional strAppend As String)
    If blValid Then
        Application.StatusBar = "å®Ÿè¡Œä¸­ ..." & strAppend
    Else
        Application.StatusBar = False
    End If

End Sub
```
-----
#### VBAå‡¦ç†ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚¢ãƒƒãƒ—è¨­å®š
ãƒ„ãƒ¼ãƒ«é–‹ç™ºæ™‚ã€ãƒ†ã‚¹ãƒˆã—ã¦ã„ã‚‹æ®µéšã§ã“ã®ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã§ä½¿ç”¨ã—é«˜é€ŸåŒ–ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã¨ã€
äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸéš›ã€ç”»é¢ãŒå›ºã¾ã£ã¦ã—ã¾ã„æ“ä½œã§ããªããªã£ã¦ã—ã¾ã†ã€‚
ãã®ç‚ºã€ãƒ†ã‚¹ãƒˆæ®µéšã§ã¯æœ‰åŠ¹ã«ã›ãšãƒ†ã‚¹ãƒˆçµ‚äº†å¾Œã«å®Ÿè£…ã—ãŸæ–¹ãŒã‚ˆã„ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã€‚
```vbnet:SubOnSpeedup
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubOnSpeedup
'* æ©Ÿèƒ½ã€€ã€€ï½œVBAå‡¦ç†ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚¢ãƒƒãƒ—è¨­å®š
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œblValidï¼ˆTrue=é«˜é€ŸåŒ–æœ‰åŠ¹, False=ç„¡åŠ¹ï¼‰
'********************************************************************************
Sub SubOnSpeedup(blValid As Boolean)
    Dim strPath As String
    If blValid Then
        ' å‡¦ç†é«˜é€ŸåŒ–
        ' ã‚«ãƒ¼ã‚½ãƒ«ã‚’å¾…æ©Ÿä¸­ã«è¨­å®š
        Application.Cursor = xlWait
    
        ' ç”»é¢æå†™ã®åœæ­¢ã‚’è¨­å®š
        Application.ScreenUpdating = False
        ' è‡ªå‹•è¨ˆç®—ã®åœæ­¢ã‚’è¨­å®š
        Application.Calculation = xlCalculationManual
        ' ãƒ¦ãƒ¼ã‚¶æ“ä½œç¦æ­¢ã‚’è¨­å®š
        Application.Interactive = False
    Else
        ' ç”»é¢æå†™ã‚’å†é–‹
        Application.ScreenUpdating = True
        ' è‡ªå‹•è¨ˆç®—ã‚’å†é–‹
        Application.Calculation = xlCalculationAutomatic
        ' ãƒ¦ãƒ¼ã‚¶æ“ä½œã‚’å†é–‹
        Application.Interactive = True
        ' ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹•
        strPath = ThisWorkbook.Path
        ChDrive strPath
        ChDir strPath
        
        ' ã‚«ãƒ¼ã‚½ãƒ«ã‚’å…ƒã«æˆ»ã™
        Application.Cursor = xlDefault
    End If

End Sub
```
-----
#### ã‚·ãƒ¼ãƒˆè¡¨ç¤ºï¼éè¡¨ç¤ºã®è¨­å®š
##### å®šæ•°éƒ¨åˆ†
```vbnet:å®šæ•° - SubVisibleSheet
' å®šæ•°
'   ã‚·ãƒ¼ãƒˆå
Public Const SETINFO_SHEETNAME As String = "è¨­å®šæƒ…å ±"
```
##### ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£éƒ¨åˆ†
```vbnet:SubVisibleSheet
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubVisibleSheet
'* æ©Ÿèƒ½ã€€ã€€ï½œã‚·ãƒ¼ãƒˆè¡¨ç¤ºï¼éè¡¨ç¤ºã®è¨­å®š
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œstrClass: å¯¾è±¡ã‚°ãƒ«ãƒ¼ãƒ—, blVisibleï¼ˆTrue=è¡¨ç¤º, False=éè¡¨ç¤ºï¼‰
'********************************************************************************
Sub SubVisibleSheet(strClass As String, blVisible As Boolean)
    Dim arySetinfo() As String
    arySetinfo = FuncReadSetinfo(strClass)
    
    Dim lngCount As Long
    Dim strSheetname As String
    
    For lngCount = 0 To UBound(arySetinfo)
        strSheetname = Worksheets(SETINFO_SHEETNAME).Range(arySetinfo(lngCount)).Value
        Worksheets(strSheetname).Visible = blVisible
    Next

End Sub
```
-----
#### æŒ‡å®šãƒ•ã‚©ãƒ«ãƒ€ã‚’é–‹ã
```vbnet:SubOpenFolder
'********************************************************************************
'* å‡¦ç†åã€€ï½œSubOpenFolder
'* æ©Ÿèƒ½ã€€ã€€ï½œæŒ‡å®šãƒ•ã‚©ãƒ«ãƒ€ã‚’é–‹ã
'*-------------------------------------------------------------------------------
'* æˆ»ã‚Šå€¤ã€€ï½œ-
'* å¼•æ•°ã€€ã€€ï½œstrPath: å¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€ã®çµ¶å¯¾ãƒ‘ã‚¹
'********************************************************************************
Sub SubOpenFolder(strPath As String)
On Error GoTo CATCH
    Shell "C:\Windows\explorer.exe " & strPath, vbNormalFocus
CATCH:

End Sub
```
## ã¾ã¨ã‚
ã‹ãªã‚Šãƒ¬ã‚¬ã‚·ãƒ¼ãªExcel VBAã§ã™ãŒã€ã¡ã‚‡ã£ã¨ã—ãŸãƒ„ãƒ¼ãƒ«ä½œæˆã§ã¯åŠ›ã‚’ç™ºæ®ã—ã¦ãã‚Œã¾ã™ã€‚
ã“ã®è¨˜äº‹ãŒã”å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚
