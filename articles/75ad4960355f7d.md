---
title: "[PowerShell]PSCustomObjectを判定する方法"
emoji: "✨"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---

[こちらの記事](https://zenn.dev/haretokidoki/articles/45c5af7cbf7eb8)で配列を判定するFunctionを紹介。
今回は、PSCustomObjectを判定するFunctionを自作したので紹介します。

```powershell:
function Test-PSCustomObject {
    param(
        [Parameter(Mandatory=$true)]
        [object[]]$Arguments
    )

    foreach ($arg in $Arguments) {
        if (-not ($arg -is [pscustomobject])) {
            Write-Host "$arg is not a PSCustomObject."
            return $false
        }
    }
    Write-Host "All arguments are PSCustomObjects."
    return $true
}

# 使用例
# PSCustomObjectの例を作成
$customObject1 = [pscustomobject]@{Name='Object1'}
$customObject2 = [pscustomobject]@{Name='Object2'},[pscustomobject]@{Name='Object3'}

# 関数をテスト
Test-PSCustomObject -Arguments $customObject1, $customObject2
```
