---
title: "[PowerShell]TREEã‚³ãƒãƒ³ãƒ‰ã¨åŒã˜çµæœã‚’å‡ºåŠ›ã™ã‚‹Function"
emoji: "ğŸŒŠ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

```powershell
function Get-FolderTree {
    param (
        [string]$Path
    )

    function Show-Tree {
        param (
            [string]$CurrentPath,
            [int]$Level,
            [bool]$IsLast
        )

        $items = Get-ChildItem -Path $CurrentPath | Sort-Object { -not $_.PSIsContainer }, Name
        $count = $items.Count
        $index = 0

        foreach ($item in $items) {
            $index++
            $isLastItem = $index -eq $count
            $indent = " " * ($Level * 6)

            $line = if ($isLastItem) { "â””â”€ " } else { "â”œâ”€ " }

            if ($item.PSIsContainer) {
                Write-Output "$indent$line< $item >"
                Show-Tree -CurrentPath $item.FullName -Level ($Level + 1) -IsLast $isLastItem
            } else {
                Write-Output "$indent$line$item"
            }
        }
    }

    if (Test-Path -Path $Path) {
        Show-Tree -CurrentPath $Path -Level 0 -IsLast $true
    } else {
        Write-Output "æŒ‡å®šã•ã‚ŒãŸãƒ‘ã‚¹ã¯å­˜åœ¨ã—ã¾ã›ã‚“: $Path"
    }
}

# Example usage
Get-Tree -Path "C:\Program Files\WindowsPowerShell\Modules\ImportExcel"
```
