---
title: "[PowerShell]TREEコマンドと同じ結果を出力するFunction"
emoji: "🌊"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["powershell"]
published: false
---

```powershell
function Get-Tree {
    param (
        [string]$Path
    )

    function Get-TreeRecursive {
        param (
            [string]$CurrentPath,
            [string]$Indent
        )

        $items = Get-ChildItem -Path $CurrentPath
        $files = $items | Where-Object { -not $_.PSIsContainer }
        $folders = $items | Where-Object { $_.PSIsContainer }

        foreach ($file in $files) {
            Write-Output "$Indent    │   $($file.Name)"
        }

        foreach ($folder in $folders) {
            Write-Output "$Indent└───$($folder.Name)"
            Get-TreeRecursive -CurrentPath $folder.FullName -Indent "$Indent    "
        }
    }

    Write-Output "Folder PATH listing for volume $((Get-Volume -Path $Path).FileSystemLabel)"
    Write-Output "Volume serial number is $((Get-Volume -Path $Path).DriveLetter):$((Get-Volume -Path $Path).SerialNumber)"
    Write-Output $Path
    Get-TreeRecursive -CurrentPath $Path -Indent ""
}

# Example usage
Get-Tree -Path "C:\Program Files\WindowsPowerShell\Modules\ImportExcel"
```
