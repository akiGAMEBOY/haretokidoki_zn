---
title: "[PowerShell]ImportExcelãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹2ã¤ã®æ–¹æ³•"
emoji: "ğŸ¤–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell", "excel"]
published: false
---

## å¯¾å¿œæ–¹æ³•

### ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•

æ¥ç¶šæ–¹å¼ã‚’å¤‰æ›´ã—ã€Install-Moduleã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã§å°å…¥ã€‚

NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå°å…¥ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®å¿…è¦ãŒã‚ã‚‹ã€‚

```powershell:
ç¶šè¡Œã™ã‚‹ã«ã¯ NuGet ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãŒå¿…è¦ã§ã™
PowerShellGet ã§ NuGet ãƒ™ãƒ¼ã‚¹ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’æ“ä½œã™ã‚‹ã«ã¯ã€'2.8.5.201' ä»¥é™ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã® NuGet
ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãŒå¿…è¦ã§ã™ã€‚NuGet ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¯ 'C:\Program Files\PackageManagement\ProviderAssemblies' ã¾ãŸã¯
'C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData\Local\PackageManagement\ProviderAssemblies' ã«é…ç½®ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚'Install-PackageProvider
-Name NuGet -MinimumVersion 2.8.5.201 -Force' ã‚’å®Ÿè¡Œã—ã¦ NuGet ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ä»Šã™ã
PowerShellGet ã§ NuGet ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã‹?
[Y] ã¯ã„(Y)  [N] ã„ã„ãˆ(N)  [S] ä¸­æ–­(S)  [?] ãƒ˜ãƒ«ãƒ— (æ—¢å®šå€¤ã¯ "Y"): Y
è­¦å‘Š: URI 'https://go.microsoft.com/fwlink/?LinkID=627338&clcid=0x409' ã‹ã‚‰ '' ã¸ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã›ã‚“ã€‚
è­¦å‘Š: åˆ©ç”¨å¯èƒ½ãªãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ä¸€è¦§ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã›ã‚“ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
PackageManagement\Install-PackageProvider : ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ 'NuGet' ã«ã¤ã„ã¦ã€æŒ‡å®šã•ã‚ŒãŸæ¤œç´¢æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹ã‚‚ã®ãŒè¦‹ã¤ã‹ã‚Šã¾
ã›ã‚“ã§ã—ãŸã€‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã«ã¯ 'PackageManagement' ã‚¿ã‚°ã¨ 'Provider' ã‚¿ã‚°ãŒå¿…è¦ã§ã™ã€‚æŒ‡å®šã•ã‚ŒãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ã“
ã‚Œã‚‰ã®ã‚¿ã‚°ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
ç™ºç”Ÿå ´æ‰€ C:\Program Files\WindowsPowerShell\Modules\PowerShellGet\1.0.0.1\PSModule.psm1:7468 æ–‡å­—:21
+ ...     $null = PackageManagement\Install-PackageProvider -Name $script:N ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (Microsoft.Power...PackageProvider:InstallPackageProvider) [Install-Pac
   kageProvider]ã€Exception
    + FullyQualifiedErrorId : NoMatchFoundForProvider,Microsoft.PowerShell.PackageManagement.Cmdlets.InstallPackagePro
   vider

PackageManagement\Import-PackageProvider : ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼å 'NuGet' ã«ã¤ã„ã¦ã€æŒ‡å®šã•ã‚ŒãŸæ¤œç´¢æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹ã‚‚ã®ãŒè¦‹ã¤ã‹ã‚Š
ã¾ã›ã‚“ã§ã—ãŸã€‚'Get-PackageProvider -ListAvailable' ã‚’ä½¿ç”¨ã—ã¦ã€ã“ã®ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãŒã‚·ã‚¹ãƒ†ãƒ ä¸Šã«å­˜åœ¨ã™ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„
ã€‚
ç™ºç”Ÿå ´æ‰€ C:\Program Files\WindowsPowerShell\Modules\PowerShellGet\1.0.0.1\PSModule.psm1:7474 æ–‡å­—:21
+ ...     $null = PackageManagement\Import-PackageProvider -Name $script:Nu ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (NuGet:String) [Import-PackageProvider]ã€Exception
    + FullyQualifiedErrorId : NoMatchFoundForCriteria,Microsoft.PowerShell.PackageManagement.Cmdlets.ImportPackageProv
   ider

è­¦å‘Š: URI 'https://go.microsoft.com/fwlink/?LinkID=627338&clcid=0x409' ã‹ã‚‰ '' ã¸ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã›ã‚“ã€‚
è­¦å‘Š: åˆ©ç”¨å¯èƒ½ãªãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ä¸€è¦§ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã›ã‚“ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
PackageManagement\Get-PackageProvider : ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ 'NuGet' ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ã¾ã ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„å¯
èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚'Get-PackageProvider -ListAvailable' ã‚’å®Ÿè¡Œã—ã¦ã¿ã¦ãã ã•ã„ã€‚
ç™ºç”Ÿå ´æ‰€ C:\Program Files\WindowsPowerShell\Modules\PowerShellGet\1.0.0.1\PSModule.psm1:7478 æ–‡å­—:30
+ ... tProvider = PackageManagement\Get-PackageProvider -Name $script:NuGet ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (Microsoft.Power...PackageProvider:GetPackageProvider) [Get-PackageProvi
   der], Exception
    + FullyQualifiedErrorId : UnknownProviderFromActivatedList,Microsoft.PowerShell.PackageManagement.Cmdlets.GetPacka
   geProvider

```

### ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•

äº‹å‰ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦ã‚ã‚Šã€‚
