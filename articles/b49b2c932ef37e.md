---
title: "powershell"
emoji: "üêÜ"
type: "tech" # tech: ÊäÄË°ìË®ò‰∫ã / idea: „Ç¢„Ç§„Éá„Ç¢
topics: ["powershell", "excel"]
published: false
---

```powershell:
function Test-ExcelInstalled {
    $excelInstalled = $false

    try {
        $excelApp = New-Object -ComObject Excel.Application\
        $excelInstalled = $true
    }   
    catch {
        Write-Warning "Excel„ÅÆÂ≠òÂú®„ÉÅ„Çß„ÉÉ„ÇØ„Åß„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇíÂëº„Å≥Âá∫„Åô„Åì„Å®„Åå„Åß„Åç„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ[Ë©≥Á¥∞: $($_.Exception.Message)]"
    }
    finally {
        # Excel„Ç¢„Éó„É™ÁµÇ‰∫Ü
        if ($null -ne $excelApp) {
            [System.GC]::Collect()
            [System.GC]::WaitForPendingFinalizers()
            [System.GC]::Collect()

            $excelApp.Quit()
            [System.Runtime.Interopservices.Marshal]::ReleaseComObject($excelApp) > $null
            $excelApp = $null
            Remove-Variable excelApp -ErrorAction SilentlyContinue

            [System.GC]::Collect()
            [System.GC]::WaitForPendingFinalizers()
            [System.GC]::Collect()
        }
    }

    return $excelInstalled
}

# Èñ¢Êï∞„ÅÆÂÆüË°å‰æã
if (Test-ExcelInstalled) {
    Write-Output "Excel is installed."
} else {
    Write-Output "Excel is not installed."
}
```
