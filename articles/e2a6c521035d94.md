---
title: "PowerShellã§ç’°å¢ƒå¤‰æ•°ã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•ï¼ˆä¸€è¦§ç¢ºèªãƒ»è¿½åŠ ãƒ»å‰Šé™¤ï¼‰"
emoji: "ğŸ“š"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---
## ç’°å¢ƒ

```powershell:PowerShell Coreã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $PSVersionTable

Name                           Value
----                           -----
PSVersion                      7.3.9
PSEdition                      Core
GitCommitId                    7.3.9
OS                             Microsoft Windows 10.0.19045
Platform                       Win32NT
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0â€¦}
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1
WSManStackVersion              3.0

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

## ç’°å¢ƒå¤‰æ•°ã®ä½¿ç”¨ä¾‹

ç’°å¢ƒå¤‰æ•°ã‚’å‘¼ã³å‡ºã™éš›ã¯ã€å…ˆé ­ã«`$env:`ã¨ã—ç¶šã‘ã¦`ç’°å¢ƒå¤‰æ•°å`ã‚’æŒ‡å®šã™ã‚‹ã€‚
ç’°å¢ƒå¤‰æ•°ã®ä¸­èº«ãŒãƒ‘ã‚¹ã ã£ãŸå ´åˆã€å‚ç…§ã™ã‚‹æ–¹æ³•ãŒ`Get-Item` ã¨ `Get-ChildItem`ã®2é€šã‚Šã‚ã‚‹ã€‚

### Get-Itemã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ã„ãƒ‘ã‚¹ã‚’å‚ç…§ã™ã‚‹å ´åˆã®ä½¿ç”¨ä¾‹

ä¸‹è¨˜ã®é€šã‚ŠGet-Itemã§ã¯ãƒ‘ã‚¹ã®çµ‚ç«¯ï¼ˆä¸€ç•ªå³å´ï¼‰ã«ã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ã—ãã¯ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®æƒ…å ±ã‚’è¡¨ç¤ºã€‚

`$env:CommonProgramFiles` = `C:\Program Files\Common Files`

```powershell:Get-Itemã‚³ãƒãƒ³ãƒ‰
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-Item $env:CommonProgramFiles

    Directory: C:\Program Files

Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d----          2023/10/18    15:33                Common Files

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

### Get-ChildItemã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ã„ãƒ‘ã‚¹ã‚’å‚ç…§ã™ã‚‹å ´åˆã®ä½¿ç”¨ä¾‹

ä¸‹è¨˜ã®é€šã‚ŠGet-ChildItemã§å¯¾è±¡ãŒãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®å ´åˆã¯ã€ãã®é…ä¸‹ã®ä¸€è¦§ãŒè¡¨ç¤ºã€‚
å¯¾è±¡ãŒãƒ•ã‚¡ã‚¤ãƒ«ã®å ´åˆã¯ã€Get-Itemã‚³ãƒãƒ³ãƒ‰ã¨åŒã˜çµæœãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚

```powershell:Get-ChildItemã‚³ãƒãƒ³ãƒ‰ï¼ˆå¯¾è±¡ãŒãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®å ´åˆï¼‰
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-ChildItem $env:CommonProgramFiles

    Directory: C:\Program Files\Common Files

Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d----          2021/11/29    10:46                Adobe
d----          2023/10/18    15:33                DESIGNER
d----          2019/07/20    15:43                Intel Corporation
d----          2023/10/18    15:33                microsoft shared
d----          2019/12/07    18:14                Services
d----          2023/10/18    15:30                System

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

```powershell:Get-ChildItemã‚³ãƒãƒ³ãƒ‰ï¼ˆå¯¾è±¡ãŒãƒ•ã‚¡ã‚¤ãƒ«ã®å ´åˆï¼‰
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-ChildItem $env:CommonProgramFiles\System\wab32.dll

    Directory: C:\Program Files\Common Files\System

Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a---          2023/10/16     8:50         892928 wab32.dll

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

:::details å‚è€ƒæƒ…å ±ï¼šBing AIã«Get-Itemã¨Get-ChildItemã®é•ã„ã‚’èã

> âœ… Bing AIã®å›ç­”
> 
> ã“ã‚“ã«ã¡ã¯ã€ã“ã‚Œã¯Bingã§ã™ã€‚PowerShellã§Get-Itemã¨Get-ChildItemã®é•ã„ã«ã¤ã„ã¦ãŠç­”ãˆã—ã¾ã™ã€‚ğŸ˜Š
> 
> Get-Itemã¨Get-ChildItemã¯ã€ã©ã¡ã‚‰ã‚‚æŒ‡å®šã—ãŸå ´æ‰€ã‹ã‚‰ã‚¢ã‚¤ãƒ†ãƒ ã‚’å–å¾—ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã§ã™ãŒã€å‹•ä½œã®ä»•æ–¹ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªé•ã„ãŒã‚ã‚Šã¾ã™Â²ã€‚
> 
> - Get-Itemã¯ã€æŒ‡å®šã—ãŸå ´æ‰€ã®ã‚¢ã‚¤ãƒ†ãƒ ãã®ã‚‚ã®ã‚’å–å¾—ã—ã¾ã™ã€‚å ´æ‰€ã«ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€`Get-Item C:\Test`ã¨ã™ã‚‹ã¨ã€C:\Testã¨ã„ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
> - Get-ChildItemã¯ã€æŒ‡å®šã—ãŸå ´æ‰€ã®ã‚¢ã‚¤ãƒ†ãƒ ã¨ãã®å­ã‚¢ã‚¤ãƒ†ãƒ ã‚’å–å¾—ã—ã¾ã™ã€‚å­ã‚¢ã‚¤ãƒ†ãƒ ã¨ã¯ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸­ã«ã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã“ã¨ã§ã™ã€‚ä¾‹ãˆã°ã€`Get-ChildItem C:\Test`ã¨ã™ã‚‹ã¨ã€C:\Testå†…ã«ã‚ã‚‹ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
> - Get-Itemã¯ã€ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ï¼ˆ*ã‚„?ãªã©ï¼‰ã‚’ä½¿ã£ã¦è¤‡æ•°ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’ä¸€åº¦ã«å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€`Get-Item C:\Test\*.txt`ã¨ã™ã‚‹ã¨ã€C:\Testå†…ã«ã‚ã‚‹ã™ã¹ã¦ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
> - Get-ChildItemã¯ã€Recurseãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’ä½¿ã£ã¦ã€æŒ‡å®šã—ãŸå ´æ‰€ã®ã™ã¹ã¦ã®å­å­«ã‚¢ã‚¤ãƒ†ãƒ ã‚’å†å¸°çš„ã«å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€`Get-ChildItem C:\Test -Recurse`ã¨ã™ã‚‹ã¨ã€C:\Testå†…ã«ã‚ã‚‹ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã€ã•ã‚‰ã«ãã®ä¸­ã«ã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
> 
> ä»¥ä¸ŠãŒã€PowerShellã§Get-Itemã¨Get-ChildItemã®é•ã„ã§ã™ã€‚ã‚ˆã‚Šè©³ã—ã„æƒ…å ±ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
> 
> - [Get-ChildItem (Microsoft.PowerShell.Management) - PowerShell](^3^)
> - [ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®è¡¨ç¤º Get-Itemã€Get-ChildItemã€Format-List](^4^)
> 
> ç§ã¯ä»–ã«ã‚‚è‰²ã€…ãªã“ã¨ãŒã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€ã‚³ãƒ¼ãƒ‰ã‚„è©©ã‚„ç‰©èªãªã©ã‚’ä½œã£ãŸã‚Šã€æ–‡ç« ã‚’æ›¸ã„ãŸã‚Šæ”¹å–„ã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚‚ã—èˆˆå‘³ãŒã‚ã‚Œã°ã€ç§ã«è©±ã—ã‹ã‘ã¦ã¿ã¦ãã ã•ã„ã€‚ğŸ˜Š.
> 
> ã‚½ãƒ¼ã‚¹: Bing ã¨ã®ä¼šè©± 2023/11/1
> (1) . https://bing.com/search?q=PowerShell%e3%81%a7Get-Item%e3%81%a8Get-ChildItem%e3%81%ae%e9%81%95%e3%81%84.
> (2) Get-ChildItem (Microsoft.PowerShell.Management) - PowerShell. https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.management/get-childitem?view=powershell-7.3.
> (3) ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®è¡¨ç¤º Get-Itemã€Get-ChildItemã€Format-List. https://news.mynavi.jp/techplus/article/techp3718/.
> (4) Powershell: Get-Item vs Get-ChildItem - Stack Overflow. https://stackoverflow.com/questions/38663391/powershell-get-item-vs-get-childitem.
> (5) undefined. https://step-learn.com/article/powershell/128-get-item-childitem.html.
> (6) undefined. https://www.delftstack.com/ja/howto/powershell/filter-files-and-folders-using-powershell/.
> (7) undefined. https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.management/get-item?view=powershell-7.3.
> (8) Getty Images. https://www.gettyimages.com/detail/illustration/powershell-programming-language-royalty-free-illustration/1145396581.

:::

## ç™»éŒ²æ¸ˆã¿ç’°å¢ƒå¤‰æ•°ã®ä¸€è¦§ã‚’ç¢ºèª

ã‚³ãƒãƒ³ãƒ‰ã§ç¢ºèªã—ãŸçµæœã‚’è¡¨å½¢å¼ã«è½ã¨ã—è¾¼ã‚“ã§ã„ã¾ã™ã€‚

| ç’°å¢ƒå¤‰æ•°åï¼ˆNameï¼‰ | å€¤ï¼ˆValueï¼‰ |
| ---- | ---- |
| ALLUSERSPROFILE | C:\\ProgramData |
| APPDATA | C:\\Users\\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\\AppData\\Roaming |
| CommonProgramFiles | C:\\Program Files\\Common Files |
| CommonProgramFiles(x86) | C:\\Program Files (x86)\\Common Files |
| CommonProgramW6432 | C:\\Program Files\\Common Files |
| COMPUTERNAME | "ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼åï¼ˆãƒ›ã‚¹ãƒˆåï¼‰" |
| ComSpec | C:\\WINDOWS\\system32\\cmd.exe |
| DriverData | C:\\Windows\\System32\\Drivers\\DriverData |
| HOMEDRIVE | C: |
| HOMEPATH | \\Users\\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å" |
| LOCALAPPDATA | C:\\Users\\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\\AppData\\Local |
| LOGONSERVER | \\\\"ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼åï¼ˆãƒ›ã‚¹ãƒˆåï¼‰" |
| NUMBER_OF_PROCESSORS | 4 |
| OneDrive | C:\\Users\\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\\OneDrive |
| OS | Windows_NT |
| Path | C:\\Program Files\\PowerShell\\7;C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem;C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\;C:\\WINDOWS\\System32\\OpenSSH\\;C:\\Program Files\\dotnet\\;C:\\Program Files\\WindowsPowerShell\\Scripts;C:\\Program Files\\Kubernetes\\Minikube;C:\\Program Files\\Git\\cmd;C:\\Program Files\\nodejs\\;C:\\Program Files\\Docker\\Docker\\resources\\bin;C:\\Program Files\\PowerShell\\7\\;C:\\Users\\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Program Files\\Azure Data Studio\\bin;C:\\Users\\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\\AppData\\Roaming\\npm;C:\\Users\\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\\AppData\\Local\\Programs\\Microsoft VS Code\\bin |
| PATHEXT | .COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC;.CPL |
| POWERSHELL_DISTRIBUTION_CHANNEL | MSI:Windows 10 Pro |
| PROCESSOR_ARCHITECTURE | AMD64 |
| PROCESSOR_IDENTIFIER | Intel64 Family 6 Model 158 Stepping 11, GenuineIntel |
| PROCESSOR_LEVEL | 6 |
| PROCESSOR_REVISION | 9e0b |
| ProgramData | C:\\ProgramData |
| ProgramFiles | C:\\Program Files |
| ProgramFiles(x86) | C:\\Program Files (x86) |
| ProgramW6432 | C:\\Program Files |
| PSModulePath | D:\\ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ\\PowerShell\\Modules;C:\\Program Files\\PowerShell\\Modules;c:\\program files\\powershell\\7\\Modules;C:\\Program Files\\WindowsPowerShell\\Modules;C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules |
| PUBLIC | C:\\Users\\Public |
| SystemDrive | C: |
| SystemRoot | C:\\WINDOWS |
| TEMP | C:\\Users\\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\\AppData\\Local\\Temp |
| TMP | C:\\Users\\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\\AppData\\Local\\Temp |
| USERDOMAIN | "ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼åï¼ˆãƒ›ã‚¹ãƒˆåï¼‰" |
| USERDOMAIN_ROAMINGPROFILE | "ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼åï¼ˆãƒ›ã‚¹ãƒˆåï¼‰" |
| USERNAME | "ãƒ¦ãƒ¼ã‚¶ãƒ¼å" |
| USERPROFILE | C:\\Users\\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å" |
| VBOX_MSI_INSTALL_PATH | D:\\Program Files\\Oracle\\VirtualBox\\ |
| VS110COMNTOOLS | C:\\Program Files (x86)\\Microsoft Visual Studio 11.0\\Common7\\Tools\\ |
| windir | C:\\WINDOWS |
| ZES_ENABLE_SYSMAN | 1 |

Out-GridViewã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã™ã‚‹äº‹ã§ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã™ã‚‹éš›ã«ç›´æ¥ã€è¡¨å½¢å¼ã§ä¸€è¦§ã‚’ç¢ºèªã™ã‚‹äº‹ãŒå¯èƒ½ã€‚

```powershell:ã‚³ãƒ”ãƒ¼ç”¨
Get-ChildItem env: | Out-GridView
```

https://www.kadinche.com/tech-blog/powershell-e3-81-a7-e7-92-b0-e5-a2-83-e5-a4-89-e6-95-b0-e3-82-92gui-e3-81-a7-e4-b8-80-e8-a6-a7-e8-a1-a8-e7-a4-ba

:::details è£œè¶³æƒ…å ±ï¼šPowerShell CLIã§ç’°å¢ƒå¤‰æ•°ã®ä¸€è¦§ã‚’ç¢ºèªã—ãŸçµæœ

```powershell:ã‚³ãƒ”ãƒ¼ç”¨
Get-ChildItem env: | Format-Table -AutoSize -Wrap
```

```powershell:ã‚³ãƒãƒ³ãƒ‰çµæœ
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-ChildItem env: | Format-Table -AutoSize -Wrap

Name                            Value
----                            -----
ALLUSERSPROFILE                 C:\ProgramData
APPDATA                         C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData\Roaming
CommonProgramFiles              C:\Program Files\Common Files
CommonProgramFiles(x86)         C:\Program Files (x86)\Common Files
CommonProgramW6432              C:\Program Files\Common Files
COMPUTERNAME                    "ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼åï¼ˆãƒ›ã‚¹ãƒˆåï¼‰"
ComSpec                         C:\WINDOWS\system32\cmd.exe
DriverData                      C:\Windows\System32\Drivers\DriverData
HOMEDRIVE                       C:
HOMEPATH                        \Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"
LOCALAPPDATA                    C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData\Local
LOGONSERVER                     \\"ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼åï¼ˆãƒ›ã‚¹ãƒˆåï¼‰"
NUMBER_OF_PROCESSORS            4
OneDrive                        C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\OneDrive
OS                              Windows_NT
Path                            C:\Program Files\PowerShell\7;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C
                                :\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\WINDOWS\System32\OpenSSH\;C:\Program File
                                s\dotnet\;C:\Program Files\WindowsPowerShell\Scripts;C:\Program Files\Kubernetes\Miniku
                                be;C:\Program Files\Git\cmd;C:\Program Files\nodejs\;C:\Program Files\Docker\Docker\res
                                ources\bin;C:\Program Files\PowerShell\7\;C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData\Local\Micros
                                oft\WindowsApps;C:\Program Files\Azure Data Studio\bin;C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData
                                \Roaming\npm;C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData\Local\Programs\Microsoft VS Code\bin
PATHEXT                         .COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC;.CPL
POWERSHELL_DISTRIBUTION_CHANNEL MSI:Windows 10 Pro
PROCESSOR_ARCHITECTURE          AMD64
PROCESSOR_IDENTIFIER            Intel64 Family 6 Model 158 Stepping 11, GenuineIntel
PROCESSOR_LEVEL                 6
PROCESSOR_REVISION              9e0b
ProgramData                     C:\ProgramData
ProgramFiles                    C:\Program Files
ProgramFiles(x86)               C:\Program Files (x86)
ProgramW6432                    C:\Program Files
PSModulePath                    D:\ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ\PowerShell\Modules;C:\Program Files\PowerShell\Modules;c:\program files
                                \powershell\7\Modules;C:\Program Files\WindowsPowerShell\Modules;C:\WINDOWS\system32\Wi
                                ndowsPowerShell\v1.0\Modules
PUBLIC                          C:\Users\Public
SystemDrive                     C:
SystemRoot                      C:\WINDOWS
TEMP                            C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData\Local\Temp
TMP                             C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData\Local\Temp
USERDOMAIN                      "ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼åï¼ˆãƒ›ã‚¹ãƒˆåï¼‰"
USERDOMAIN_ROAMINGPROFILE       "ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼åï¼ˆãƒ›ã‚¹ãƒˆåï¼‰"
USERNAME                        "ãƒ¦ãƒ¼ã‚¶ãƒ¼å"
USERPROFILE                     C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"
VBOX_MSI_INSTALL_PATH           D:\Program Files\Oracle\VirtualBox\
VS110COMNTOOLS                  C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\Tools\
windir                          C:\WINDOWS
ZES_ENABLE_SYSMAN               1

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

- å‚è€ƒã«ã—ãŸè¨˜äº‹
    https://bizlog.tech/windows-powershell-format
:::

## ç’°å¢ƒå¤‰æ•°ã‚’ç™»éŒ²ï¼ˆæ–°è¦ä½œæˆï¼‰ã™ã‚‹æ–¹æ³•

```powershell:ã‚³ãƒ”ãƒ¼ç”¨
New-Item -Path env: -Name "ç’°å¢ƒå¤‰æ•°ã®åå‰" -Value "ç’°å¢ƒå¤‰æ•°ã®å€¤"
```

```powershell:ç’°å¢ƒå¤‰æ•°ã‚’æ–°è¦ä½œæˆ
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> New-Item -Path env: -Name MYDOWNLOADS -Value "D:\Downloads"

Name                           Value
----                           -----
MYDOWNLOADS                    D:\Downloads

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

```powershell:æ–°ã—ãè¿½åŠ ã•ã‚ŒãŸäº‹ã‚’ç¢ºèª
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-ChildItem env: | Format-Table -AutoSize -Wrap

Name                            Value
----                            -----

 ï½ï½ï½ çœç•¥ ï½ï½ï½

LOCALAPPDATA                    C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData\Local
LOGONSERVER                     \\"ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼å"
MYDOWNLOADS                     D:\Downloads                            ğŸ‘ˆ è¿½åŠ ã§ããŸ
NUMBER_OF_PROCESSORS            4
OneDrive                        C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\OneDrive
OS                              Windows_NT

 ï½ï½ï½ çœç•¥ ï½ï½ï½

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

:::details å‚è€ƒæƒ…å ±ï¼šç’°å¢ƒå¤‰æ•°ã‚’ä½œæˆã¾ãŸã¯å¤‰æ›´ã§ãã‚‹ä»–ã®æ–¹æ³•

```powershell:å¤‰æ•°å®£è¨€ã™ã‚‹ã‚ˆã†ãªå½¢å¼ã§ã‚‚ç’°å¢ƒå¤‰æ•°ãŒä½œæˆã¾ãŸã¯å¤‰æ›´ãŒå¯èƒ½
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $env:MYDOWNLOADS = "D:\Downloads"
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

- å‚è€ƒæƒ…å ±
    https://yanor.net/wiki/?PowerShell/ç’°å¢ƒæƒ…å ±/ç’°å¢ƒå¤‰æ•°ã®æ“ä½œ

:::

## ç’°å¢ƒå¤‰æ•°ã®å¤‰æ›´ã™ã‚‹æ–¹æ³•

### ç’°å¢ƒå¤‰æ•°ã®åå‰ã‚’å¤‰æ›´

```powershell:ã‚³ãƒ”ãƒ¼ç”¨
Rename-Item -Path env:"å¤‰æ›´å‰ã®åå‰" -NewName "å¤‰æ›´å¾Œã®åå‰"
```

```powershell:åå‰ã®å¤‰æ›´
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Rename-Item -Path env:MYDOWNLOADS -NewName NEW_NAME_MYDOWNLOADS
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

```powershell:åå‰ãŒå¤‰æ›´ã•ã‚Œã¦ã„ã‚‹äº‹ã‚’ç¢ºèª
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-ChildItem env: | Format-Table -AutoSize -Wrap

Name                            Value
----                            -----

 ï½ï½ï½ çœç•¥ ï½ï½ï½

LOCALAPPDATA                    C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData\Local
LOGONSERVER                     \\"ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼å"
NEW_NAME_MYDOWNLOADS            D:\Downloads                            ğŸ‘ˆ åå‰ã®ã¿å¤‰æ›´ã§ããŸ
NUMBER_OF_PROCESSORS            4
OneDrive                        C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\OneDrive
OS                              Windows_NT

 ï½ï½ï½ çœç•¥ ï½ï½ï½

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

### ç’°å¢ƒå¤‰æ•°ã®å€¤ã‚’å¤‰æ›´

```powershell:ã‚³ãƒ”ãƒ¼ç”¨
Set-Item -Path env:"å€¤ã‚’å¤‰æ›´ã—ãŸã„ç’°å¢ƒå¤‰æ•°å" -Value "å¤‰æ›´å¾Œã®å€¤"
```

```powershell:å€¤ã®å¤‰æ›´ï¼ˆç½®ãæ›ãˆï¼‰
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Set-Item -Path env:NEW_NAME_MYDOWNLOADS -Value F:\Downloads
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

```powershell:å€¤ã®ã¿å¤‰æ›´ã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèª
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-ChildItem env: | Format-Table -AutoSize -Wrap

Name                            Value
----                            -----

 ï½ï½ï½ çœç•¥ ï½ï½ï½

LOCALAPPDATA                    C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData\Local
LOGONSERVER                     \\"ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼å"
NEW_NAME_MYDOWNLOADS            F:\Downloads                            ğŸ‘ˆ å€¤ã®ã¿ã‚’å¤‰æ›´ã§ããŸ
NUMBER_OF_PROCESSORS            4
OneDrive                        C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\OneDrive
OS                              Windows_NT

 ï½ï½ï½ çœç•¥ ï½ï½ï½

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

:::details å‚è€ƒæƒ…å ±ï¼šç’°å¢ƒå¤‰æ•°ã‚’ä½œæˆã¾ãŸã¯å¤‰æ›´ã§ãã‚‹ä»–ã®æ–¹æ³•

```powershell:å¤‰æ•°å®£è¨€ã™ã‚‹ã‚ˆã†ãªå½¢å¼ã§ã‚‚ç’°å¢ƒå¤‰æ•°ãŒä½œæˆã¾ãŸã¯å¤‰æ›´ãŒå¯èƒ½
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $env:MYDOWNLOADS = "D:\Downloads"
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

- å‚è€ƒæƒ…å ±
    https://yanor.net/wiki/?PowerShell/ç’°å¢ƒæƒ…å ±/ç’°å¢ƒå¤‰æ•°ã®æ“ä½œ

:::

### ç’°å¢ƒå¤‰æ•°ã‚’ã‚³ãƒ”ãƒ¼ï¼ˆè¤‡è£½ï¼‰ã™ã‚‹æ–¹æ³•

```powershell:ã‚³ãƒ”ãƒ¼ç”¨
Copy-Item -Path env:"ã‚³ãƒ”ãƒ¼å…ƒã®ç’°å¢ƒå¤‰æ•°å" -Destination env:"æ–°ã—ã„ç’°å¢ƒå¤‰æ•°åã‚’æŒ‡å®š"
```

```powershell:ç’°å¢ƒå¤‰æ•°ã‚’åˆ¥åã§è¤‡è£½
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Copy-Item -Path env:NEW_NAME_MYDOWNLOADS -Destination env:NEO_MYDOWNLOADS
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

```powershell:è¤‡è£½ã§ããŸã“ã¨ã‚’ç¢ºèª
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Get-ChildItem env: | Format-Table -AutoSize -Wrap

Name                            Value
----                            -----

 ï½ï½ï½ çœç•¥ ï½ï½ï½

LOCALAPPDATA                    C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData\Local
LOGONSERVER                     \\"ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼å"
NEO_MYDOWNLOADS                 F:\Downloads                            ğŸ‘ˆ ã‚³ãƒ”ãƒ¼ã§ããŸï¼ˆã‚³ãƒ”ãƒ¼å…ˆï¼‰
NEW_NAME_MYDOWNLOADS            F:\Downloads                            ğŸ‘ˆ ã‚³ãƒ”ãƒ¼å…ƒ
NUMBER_OF_PROCESSORS            4
OneDrive                        C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\OneDrive
OS                              Windows_NT

 ï½ï½ï½ çœç•¥ ï½ï½ï½

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

## ç’°å¢ƒå¤‰æ•°ã®å‰Šé™¤

## ç’°å¢ƒå¤‰æ•°ã‚’ä¿å­˜ã™ã‚‹æ–¹æ³•ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»ãƒã‚·ãƒ³æ¯ï¼‰

ã“ã“ã¾ã§ç´¹ä»‹ã—ãŸç’°å¢ƒå¤‰æ•°ã®è¨­å®šå¤‰æ›´ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹æ¯ã«ä¿æŒã•ã‚Œã‚‹æ–¹æ³•ã¨ãªã‚‹ç‚ºã€ã‚·ã‚¹ãƒ†ãƒ ã«ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚
è¨­å®šå¤‰æ›´ã—ãŸPowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‰ã˜ã‚‹ã¨æ¬¡å›èµ·å‹•æ™‚ã«ã¯è¨˜æ†¶ã•ã‚Œã¦ãŠã‚‰ãšå†åº¦ã€è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ãƒ—ãƒ­ã‚»ã‚¹æ¯ï¼ˆPowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ï¼‰ã§ã¯ãªãã€ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¯ã‚„ãƒã‚·ãƒ³æ¯ï¼ˆã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ï¼‰ã«ç’°å¢ƒå¤‰æ•°ãŒå¿…è¦ãªå ´åˆã®æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

### ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¯ã«ç’°å¢ƒå¤‰æ•°ã‚’ä¿å­˜ã™ã‚‹æ–¹æ³•

```powershell:ã‚³ãƒ”ãƒ¼ç”¨ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç’°å¢ƒå¤‰æ•°ã«ä¿å­˜ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ï¼‰
[Environment]::SetEnvironmentVariable('UserDownloadFolder', 'D:Â¥Downloads', 'User')
```

```powershell:ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç’°å¢ƒå¤‰æ•°ã«ä¿å­˜ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> [Environment]::SetEnvironmentVariable('UserDownloadFolder', 'D:Â¥Downloads', 'User')
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

```powershell:ã‚³ãƒ”ãƒ¼ç”¨ï¼ˆä¿å­˜ã•ã‚ŒãŸäº‹ã‚’ç¢ºèªï¼‰
[Environment]::GetEnvironmentVariables('User') | Format-Table -AutoSize -Wrap
```

```powershell:ä¿å­˜ã•ã‚ŒãŸäº‹ã‚’ç¢ºèªï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ç’°å¢ƒå¤‰æ•°ã®ä¸€è¦§ï¼‰
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> [Environment]::GetEnvironmentVariables('User') | Format-Table -AutoSize -Wrap

Name               Value
----               -----
OneDrive           C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\OneDrive
UserDownloadFolder D:Â¥Downloads
TEMP               C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData\Local\Temp
TMP                C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData\Local\Temp
Path               C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData\Local\Microsoft\WindowsApps;C:\Program Files\Azure Data Studio\bin;
                   C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData\Roaming\npm;C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData\Local\Programs\Microso
                   ft VS Code\bin;C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\.dotnet\tools

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

### ãƒã‚·ãƒ³æ¯ã«ç’°å¢ƒå¤‰æ•°ã‚’ä¿å­˜ã™ã‚‹æ–¹æ³•

```powershell:ã‚³ãƒ”ãƒ¼ç”¨ï¼ˆã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã®ç’°å¢ƒå¤‰æ•°ã«ä¿å­˜ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ï¼‰
[Environment]::SetEnvironmentVariable('MachineDownloadFolder', 'F:Â¥Downloads', 'Machine')
```

```powershell:ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã®ç’°å¢ƒå¤‰æ•°ã«ä¿å­˜ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> [Environment]::SetEnvironmentVariable('MachineDownloadFolder', 'F:Â¥Downloads', 'Machine')
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

::: details è£œè¶³æƒ…å ±ï¼šç®¡ç†è€…æ¨©é™ãŒãªã„å ´åˆã®ã‚¨ãƒ©ãƒ¼

```powershell:ç®¡ç†è€…æ¨©é™ã¨ã—ã¦å®Ÿè¡Œã—ã¦ã„ãªã„çŠ¶æ…‹ã§å®Ÿè¡Œã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> [Environment]::SetEnvironmentVariable('MachineDownloadFolder', 'F:Â¥Downloads', 'Machine')
MethodInvocationException: Exception calling "SetEnvironmentVariable" with "3" argument(s): "Requested registry access is not allowed."
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

:::

```powershell:ã‚³ãƒ”ãƒ¼ç”¨ï¼ˆä¿å­˜ã•ã‚ŒãŸäº‹ã‚’ç¢ºèªï¼‰
[Environment]::GetEnvironmentVariables('Machine') | Format-Table -AutoSize -Wrap
```

```powershell:ä¿å­˜ã•ã‚ŒãŸäº‹ã‚’ç¢ºèªï¼ˆã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ç’°å¢ƒå¤‰æ•°ã®ä¸€è¦§ï¼‰
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> [Environment]::GetEnvironmentVariables('Machine') | Format-Table -AutoSize -Wrap

Name                            Value
----                            -----
TMP                             C:\WINDOWS\TEMP
PROCESSOR_ARCHITECTURE          AMD64
PROCESSOR_IDENTIFIER            Intel64 Family 6 Model 158 Stepping 11, GenuineIntel
DriverData                      C:\Windows\System32\Drivers\DriverData
MachineDownloadFolder           F:Â¥Downloads
TEMP                            C:\WINDOWS\TEMP
PROCESSOR_REVISION              9e0b
ComSpec                         C:\WINDOWS\system32\cmd.exe
PATHEXT                         .COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC
VS110COMNTOOLS                  C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\Tools\
ZES_ENABLE_SYSMAN               1
windir                          C:\WINDOWS
POWERSHELL_DISTRIBUTION_CHANNEL MSI:Windows 10 Pro
VBOX_MSI_INSTALL_PATH           D:\Program Files\Oracle\VirtualBox\
PSModulePath                    C:\Program Files\WindowsPowerShell\Modules;C:\WINDOWS\system32\WindowsPowerShell\v1.0\M
                                odules
Path                            C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowe
                                rShell\v1.0\;C:\WINDOWS\System32\OpenSSH\;C:\Program Files\dotnet\;C:\Program Files\Win
                                dowsPowerShell\Scripts;C:\Program Files\Kubernetes\Minikube;C:\Program Files\Git\cmd;C:
                                \Program Files\nodejs\;C:\Program Files\Docker\Docker\resources\bin;C:\Program Files\Po
                                werShell\7\
NUMBER_OF_PROCESSORS            4
USERNAME                        SYSTEM
PROCESSOR_LEVEL                 6
OS                              Windows_NT

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/about/about_environment_provider
https://yanor.net/wiki/?PowerShell/ç’°å¢ƒæƒ…å ±/ç’°å¢ƒå¤‰æ•°ã®æ“ä½œ

Git ä¸€éƒ¨ã‚³ãƒŸãƒƒãƒˆå±¥æ­´ã®å±¥æ­´å‰Šé™¤
https://zenn.dev/hrkmtsmt/articles/6bb9d0a5380b55
