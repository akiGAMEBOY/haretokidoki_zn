---
title: "[PowerShell]wingetã®çµæœã‚’å¤‰æ•°ã«ä»£å…¥ã—å‡ºåŠ›ã™ã‚‹ã¨æ–‡å­—åŒ–ã‘ãŒç™ºç”Ÿ"
emoji: "ğŸ¥–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---
## æ¦‚è¦

æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒUTF-8ã§å‡ºåŠ›ã•ã‚Œã‚‹ã‚³ãƒãƒ³ãƒ‰ã€wingetã®ã‚³ãƒãƒ³ãƒ‰çµæœã‚’å¤‰æ•°ã«ä»£å…¥ã—ã€
Write-Outputã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã§å¤‰æ•°ã®ä¸­èº«ã‚’ç¢ºèªã™ã‚‹ã¨æ–‡å­—åŒ–ã‘ã—ã¦ã—ã¾ã„ã¾ã—ãŸã€‚

PowerShellã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã§æ–‡å­—åŒ–ã‘ã‚’å›é¿ã™ã‚‹äº‹ãŒã§ãã¾ã—ãŸã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- PowerShellãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- wingetã‚³ãƒãƒ³ãƒ‰ã®çµæœã‚’å¤‰æ•°ã«ã„ã‚Œã¦æ–‡å­—åŒ–ã‘ã›ãšã«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã—ãŸã„æ–¹
- PowerShellã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¾ã‚ã‚Šã®è¨­å®šã‚’ä¸€æ‹¬å¤‰æ›´å¯èƒ½ãªFunctionã‚’çŸ¥ã‚ŠãŸã„æ–¹

## ç’°å¢ƒ

### Windows PowerShellï¼ˆ5.1ã®ç’°å¢ƒï¼‰

```powershell:Windows PowerShellã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $PSVersionTable

Name                           Value
----                           -----
PSVersion                      5.1.19041.3930
PSEdition                      Desktop
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}
BuildVersion                   10.0.19041.3930
CLRVersion                     4.0.30319.42000
WSManStackVersion              3.0
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1


PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

### PowerShell Coreï¼ˆ6.0ä»¥é™ã®ç’°å¢ƒï¼‰

```powershell:PowerShell Coreã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $PSVersionTable

Name                           Value
----                           -----
PSVersion                      7.3.11
PSEdition                      Core
GitCommitId                    7.3.11
OS                             Microsoft Windows 10.0.19045
Platform                       Win32NT
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0â€¦}
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1
WSManStackVersion              3.0

PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

## äº‹è±¡

å†’é ­ã§èª¬æ˜ã—ã¦ã„ã‚‹ã¨ãŠã‚Šã€`winget upgrade`ã®ã‚³ãƒãƒ³ãƒ‰çµæœã‚’å¤‰æ•°ã«ä»£å…¥ã—ã€
`Write-Output`ã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã™ã‚‹ã¨ã€ä¸‹è¨˜ã®é€šã‚Šæ–‡å­—åŒ–ã‘ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚

:::message
**ã‚³ãƒãƒ³ãƒ‰çµæœã®å¤‰æ•°ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã™ã‚‹å ´åˆã®æ³¨æ„**

ä¸‹è¨˜ã§ã¯å¤‰æ•°ã«ã„ã‚ŒãŸçµæœã‚’`Write-Output`ã‚’ä½¿ã„è¡¨ç¤ºã•ã›ã¦ã„ã¾ã™ã€‚
ã‹ã‚Šã«`Write-Output`ã§ã¯ãªã`Write-Host`ã§è¡¨ç¤ºã™ã‚‹ã¨ã€ã‚³ãƒãƒ³ãƒ‰çµæœã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ãŒæ­£ã—ãè§£é‡ˆã•ã‚Œã¾ã›ã‚“ã€‚

`Write-Host`ã§ã‚ã‚‹ã¨æœ¬æ¥ã€è¤‡æ•°è¡Œã‚ã‚‹`winget upgrade`ã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒ1è¡Œã®ã¿ã§è¡¨ç¤ºã•ã‚Œã¦ã—ã¾ã†ã®ã§ã”æ³¨æ„ã‚’ã€‚
:::

```powershell:6.0ä»¥é™ã®ç’°å¢ƒï¼ˆ5.1ã§ã‚‚åŒã˜çµæœï¼‰
# Windowsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã€wingetã‚³ãƒãƒ³ãƒ‰ã§ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆçŠ¶æ³ã®çµæœã‚’å¤‰æ•°ã«ä»£å…¥
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $result = (winget upgrade)
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">

# å¤‰æ•°ã®å†…å®¹ã‚’è¡¨ç¤ºã™ã‚‹ã¨æ–‡å­—åŒ–ã‘ç™ºç”Ÿã€‚
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-Output $result

   -
   \


   -
   \

èœ·æ¦Šç‡•                                             ID                                ç¹èˆŒãƒ»ç¹§ï½¸ç¹ï½§ç¹ï½³     è›»ï½©é€•ï½¨èœ¿ï½¯é–­ï½½       ç¹§ï½½ç¹ï½¼ç¹§ï½¹
-----------------------------------------------------------------------------------------------------------------------
draw.io 22.1.18                                  JGraph.Draw                       22.1.18        23.0.2         winget
CrystalDiskInfo 8.17.14 (64 ç¹è–™ãƒ£ç¹ãƒ»              CrystalDewWorld.CrystalDiskInfo   8.17.14        9.2.2          winget
DBeaver 23.0.2                                   dbeaver.dbeaver                   23.0.2         23.3.4         winget
Docker Desktop                                   Docker.DockerDesktop              4.18.0         4.27.2         winget
Git                                              Git.Git                           2.40.0         2.43.0         winget
Google Chrome                                    Google.Chrome                     121.0.6167.184 122.0.6261.39  winget
Kubernetes - Minikube - A Local Kubernetes Deveçª¶ï½¦ Kubernetes.minikube               1.30.1         1.32.0         winget
Microsoft Visual Studio 2010 Tools for Office Rçª¶ï½¦ Microsoft.VSTOR                   10.0.50903     10.0.60912.00  winget
Microsoft Visual C++ 2015 UWP Desktop Runtime Pçª¶ï½¦ Microsoft.VCLibs.Desktop.14       14.0.32530.0   14.0.33321.0   winget
Windows ç¹§ï½¿ç¹ï½¼ç¹æº˜ãƒªç¹ï½«                               9N0DX20HK701                      1.18.3181.0    1.19.10302.0   winget
SourceTree                                       Atlassian.Sourcetree              3.4.12         3.4.16         winget
Tera Term 4.106                                  TeraTermProject.teraterm          4.106          4.108          winget
Tesseract-OCR - open source OCR engine           UB-Mannheim.TesseractOCR          5.3.1.20230401 5.3.3.20231005 winget
VLC media player                                 VideoLAN.VLC                      3.0.18         3.0.20         winget
WinMerge 2.16.28.0 x64                           WinMerge.WinMerge                 2.16.28.0      2.16.38        winget
PowerShell 7.3.11.0-x64                          Microsoft.PowerShell              7.3.11.0       7.4.1.0        winget
Microsoft Visual C++ 2015-2022 Redistributable çª¶ï½¦ Microsoft.VCRedist.2015+.x64      14.36.32532.0  14.38.33135.0  winget
Oracle VM VirtualBox 7.0.6                       Oracle.VirtualBox                 7.0.6          7.0.14         winget
MySQL Workbench 8.0 CE                           Oracle.MySQLWorkbench             8.0.28         8.0.36         winget
Dell Display Manager                             Dell.DisplayManager               < 2.0          2.2.0.43       winget
Node.js                                          OpenJS.NodeJS.LTS                 18.16.0        20.11.0        winget
Microsoft Windows Desktop Runtime - 6.0.26 (x64) Microsoft.DotNet.DesktopRuntime.6 6.0.26         6.0.27         winget
Microsoft .NET Runtime - 6.0.26 (x64)            Microsoft.DotNet.Runtime.6        6.0.26         6.0.27         winget
Microsoft Visual C++ 2015-2022 Redistributable çª¶ï½¦ Microsoft.VCRedist.2015+.x64      14.34.31938.0  14.38.33135.0  winget
Microsoft .NET SDK 7.0.405 (x64)                 Microsoft.DotNet.SDK.7            7.0.405        7.0.406        winget
Microsoft Visual C++ 2013 Redistributable (x86)çª¶ï½¦ Microsoft.VCRedist.2013.x64       12.0.30501.0   12.0.40664.0   winget
26 ç¹§ï½¢ç¹ãƒ»ãƒ»ç¹§ï½°ç¹ï½¬ç¹ï½¼ç¹å³¨ï½’è›»ï½©é€•ï½¨ç¸ºï½§ç¸ºé˜ªâˆªç¸ºå¶Â€ãƒ»
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

ä¸€æ–¹ã§å¤‰æ•°ã«ä»£å…¥ã›ãšã«ã€ãã®ã¾ã¾`winget upgrade`ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨æ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
ã‚‚ã—ã€ã“ã®ç›´æ¥ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸçµæœã§æ–‡å­—åŒ–ã‘ã—ã¦ã„ã‚‹å ´åˆã¯æœ¬è¨˜äº‹ã€è§£æ±ºæ–¹æ³•ã®å‰ã«PowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®è¨­å®šã‚’è¦‹ç›´ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
è¦å®šå€¤ã§è¨­å®šã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚©ãƒ³ãƒˆã¯æ—¥æœ¬èªå¯¾å¿œã•ã‚Œã¦ã„ãªã„ãƒ•ã‚©ãƒ³ãƒˆãªã®ã§ã€`BIZ UDã‚´ã‚·ãƒƒã‚¯` ã‚„ `ï¼­ï¼³ ã‚´ã‚·ãƒƒã‚¯` ã«å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã¨æ€ã‚ã‚Œã¾ã™ã€‚
[ã“ã¡ã‚‰](https://jpwinsup.github.io/blog/2021/08/19/UserInterfaceAndApps/PowerShell/PowerShell-Console-characters-garbled-for-CJK-languages/)ã®å…¬å¼ãƒšãƒ¼ã‚¸ã§è§£èª¬ã•ã‚Œã¦ã„ã¾ã™ã®ã§ã€ã”å‚è€ƒã«ã©ã†ãã€‚

```powershell:6.0ä»¥é™ã®ç’°å¢ƒã§ç›´æ¥ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œï¼ˆ5.1ã§ã‚‚åŒã˜çµæœï¼‰
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> winget upgrade
åå‰                                             ID                                ãƒãƒ¼ã‚¸ãƒ§ãƒ³     åˆ©ç”¨å¯èƒ½       ã‚½ãƒ¼ã‚¹
-----------------------------------------------------------------------------------------------------------------------
draw.io 22.1.18                                  JGraph.Draw                       22.1.18        23.0.2         winget
CrystalDiskInfo 8.17.14 (64 ãƒ“ãƒƒãƒˆ)              CrystalDewWorld.CrystalDiskInfo   8.17.14        9.2.2          winget
DBeaver 23.0.2                                   dbeaver.dbeaver                   23.0.2         23.3.4         winget
Docker Desktop                                   Docker.DockerDesktop              4.18.0         4.27.2         winget
Git                                              Git.Git                           2.40.0         2.43.0         winget
Google Chrome                                    Google.Chrome                     121.0.6167.184 122.0.6261.39  winget
Kubernetes - Minikube - A Local Kubernetes Deveâ€¦ Kubernetes.minikube               1.30.1         1.32.0         winget
Microsoft Visual Studio 2010 Tools for Office Râ€¦ Microsoft.VSTOR                   10.0.50903     10.0.60912.00  winget
Microsoft Visual C++ 2015 UWP Desktop Runtime Pâ€¦ Microsoft.VCLibs.Desktop.14       14.0.32530.0   14.0.33321.0   winget
Windows ã‚¿ãƒ¼ãƒŸãƒŠãƒ«                               9N0DX20HK701                      1.18.3181.0    1.19.10302.0   winget
SourceTree                                       Atlassian.Sourcetree              3.4.12         3.4.16         winget
Tera Term 4.106                                  TeraTermProject.teraterm          4.106          4.108          winget
Tesseract-OCR - open source OCR engine           UB-Mannheim.TesseractOCR          5.3.1.20230401 5.3.3.20231005 winget
VLC media player                                 VideoLAN.VLC                      3.0.18         3.0.20         winget
WinMerge 2.16.28.0 x64                           WinMerge.WinMerge                 2.16.28.0      2.16.38        winget
PowerShell 7.3.11.0-x64                          Microsoft.PowerShell              7.3.11.0       7.4.1.0        winget
Microsoft Visual C++ 2015-2022 Redistributable â€¦ Microsoft.VCRedist.2015+.x64      14.36.32532.0  14.38.33135.0  winget
Oracle VM VirtualBox 7.0.6                       Oracle.VirtualBox                 7.0.6          7.0.14         winget
MySQL Workbench 8.0 CE                           Oracle.MySQLWorkbench             8.0.28         8.0.36         winget
Dell Display Manager                             Dell.DisplayManager               < 2.0          2.2.0.43       winget
Node.js                                          OpenJS.NodeJS.LTS                 18.16.0        20.11.0        winget
Microsoft Windows Desktop Runtime - 6.0.26 (x64) Microsoft.DotNet.DesktopRuntime.6 6.0.26         6.0.27         winget
Microsoft .NET Runtime - 6.0.26 (x64)            Microsoft.DotNet.Runtime.6        6.0.26         6.0.27         winget
Microsoft Visual C++ 2015-2022 Redistributable â€¦ Microsoft.VCRedist.2015+.x64      14.34.31938.0  14.38.33135.0  winget
Microsoft .NET SDK 7.0.405 (x64)                 Microsoft.DotNet.SDK.7            7.0.405        7.0.406        winget
Microsoft Visual C++ 2013 Redistributable (x86)â€¦ Microsoft.VCRedist.2013.x64       12.0.30501.0   12.0.40664.0   winget
26 ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã‚’åˆ©ç”¨ã§ãã¾ã™ã€‚
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

## åŸå› 

:::message
**æ³¨æ„ï¼šåŸå› ã‚’ç‰¹å®šã§ããšã€‚è§£æ±ºçµæœã‚’ãµã¾ãˆãŸæ¨æ¸¬ãƒ»æƒ³åƒã®è¦‹è§£ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚**

`[console]::OutputEncoding`å‘¨ã‚Šã®å…¬å¼æ–‡æ›¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
ä»Šå›ã€è§£æ±ºã—ãŸçµæœã‚’ãµã¾ãˆã¦æ¨æ¸¬ãƒ»æƒ³åƒã‚’å«ã‚€è¦‹è§£ã‚’è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚
:::

ã“ã®ç¾è±¡ã‚’èª¿ã¹ãŸçµæœã€PowerShellã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã™ã‚‹éš›ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®è¦å®šå€¤ï¼ˆ`[console]::OutputEncoding`ï¼‰ãŒ `Shift JIS`ã«ãªã£ã¦ã„ã‚‹äº‹ãŒåŸå› ã®ã‚ˆã†ã§ã—ãŸã€‚

å›é¿æ–¹æ³•ã¨ã—ã¦ã¯ã€ã“ã®è¨­å®šã‚’`UTF-8`ã«å¤‰æ›´ã™ã‚‹æ–¹æ³•ã§è§£æ±ºã§ãã¾ã™ã€‚

:::details æ¨æ¸¬ãƒ»æƒ³åƒã®è¦‹è§£ï¼šå¤‰æ•°ä»£å…¥ â†’ å¤‰æ•°å‡ºåŠ› â†’ æ–‡å­—åŒ–ã‘ ã®æµã‚Œ

ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰è¨­å®šã€Œ`[console]::OutputEncoding`ã€ãŒå³å¯†ã«ã©ã®ã‚ˆã†ãªãƒ­ã‚¸ãƒƒã‚¯ã§æ–‡å­—åŒ–ã‘ã™ã‚‹ã®ã‹æŠŠæ¡ã§ãã¦ã„ã¾ã›ã‚“ã€‚

ãŠãã‚‰ãã€å¤‰æ•°ã«ä»£å…¥ã•ã‚Œã‚‹ã¾ã§ã¯ä¸‹è¨˜ã®ã‚ˆã†ãªæµã‚Œã§æ–‡å­—åŒ–ã‘ãŒç™ºç”Ÿã—ãŸã®ã ã¨æ€ã„ã¾ã™ã€‚

1. ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
1. ã‚³ãƒãƒ³ãƒ‰å‡ºåŠ›çµæœãŒã‚³ãƒ³ã‚½ãƒ¼ãƒ«æ–‡å­—ã‚³ãƒ¼ãƒ‰ã«åŸºã¥ã`Shift JIS`ã§è¡¨ç¤ºã•ã‚Œã‚‹
    ï¼ˆ**ã“ã“ã§æ–‡å­—åŒ–ã‘ãŒç™ºç”Ÿ**ï¼‰
1. æ–‡å­—åŒ–ã‘ã§è¡¨ç¤ºã•ã‚ŒãŸå‡ºåŠ›çµæœã‚’å¤‰æ•°ã«ä»£å…¥
1. å¤‰æ•°ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã™ã‚‹ã¨æ–‡å­—åŒ–ã‘ç™ºç”Ÿï¼

:::

:::details ã‚ã‹ã‚‰ãªã„ç‚¹ï¼šç›´æ¥ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨æ–‡å­—åŒ–ã‘ã—ãªã„

æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒ `Shift JIS` ã®çŠ¶æ…‹ã§å¤‰æ•°ä»£å…¥ãƒ»å¤‰æ•°å‡ºåŠ›ã§æ–‡å­—åŒ–ã‘ã—ãŸã‚±ãƒ¼ã‚¹ã«é–¢ã—ã¦ã¯ã€
`[console]::OutputEncoding`ã®è¨­å®šå€¤ãŒè¦å› ã¨ãªã£ãŸã“ã¨ã§é–“é•ã„ãªã„ã¨æ€ã„ã¾ã™ã€‚

ãŸã ã€åŒã˜ `Shift JIS` ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšâ€œ**ç›´æ¥ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸã‚±ãƒ¼ã‚¹ã§ã¯ã€æ–‡å­—åŒ–ã‘ã—ãªã‹ã£ãŸ**â€ã¨ã„ã†ã‚±ãƒ¼ã‚¹ã«é–¢ã—ã¦ã¯ã€
ã©ã®ã‚ˆã†ãªãƒ­ã‚¸ãƒƒã‚¯ã§æ­£å¸¸ã«å‡ºåŠ›ã§ãã¦ã„ã‚‹ã®ã‹æŠŠæ¡ã§ãã¦ã„ã¾ã›ã‚“ã€‚

èª¿ã¹ã¦ã‚‚æƒ…å ±ãŒç„¡ãä½•ã‚‚ç¢ºè¨¼ãƒ»æ ¹æ‹ ãŒãªã„è¦‹è§£ã§ã™ãŒã€`winget`ã‚³ãƒãƒ³ãƒ‰ã‚’ç›´æ¥å®Ÿè¡Œã™ã‚‹æ™‚ã«ã ã‘ã€
ã‚³ãƒãƒ³ãƒ‰å´ã§æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®åˆ¶å¾¡ãŒåƒãã€è‡ªå‹•ã§æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›ãŒè¡Œã‚ã‚Œã¦ã„ã‚‹ã®ã§ã¯ã¨æ¨æ¸¬ã—ã¦ã„ã¾ã™ã€‚
ï¼ˆ[wingetã®ã‚½ãƒ¼ã‚¹](https://github.com/microsoft/winget-cli)ã‚’èª­ã‚ã°ä½•ã‹ã‚ã‹ã‚‹â€¦ã‹ã‚‚ï¼‰

:::

## è§£æ±ºæ–¹æ³•

è§£æ±ºæ–¹æ³•ã‚’2ã¤ç´¹ä»‹ã—ã¾ã™ã€‚ã¾ãšã¯ã€ãƒ”ãƒ³ãƒã‚¤ãƒ³ãƒˆã§å•é¡Œã®ç®‡æ‰€ã‚’å¤‰æ›´ã™ã‚‹æ–¹æ³•ã€‚

### \[console\]::OutputEncodingã‚’â€œUTF-8â€ã«ã™ã‚‹æ–¹æ³•

ä»Šå›ã€æ–‡å­—åŒ–ã‘ã—ã¦ã—ã¾ã£ãŸã‚³ãƒãƒ³ãƒ‰ã¯ã€`winget upgrade` ã€‚
ã“ã®`winget`ã‚³ãƒãƒ³ãƒ‰ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¯ã€Œ`UTF-8`ã€ã®ã‚ˆã†ã§ä¸‹è¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã§æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’ã€Œ`UTF-8`ã€ã«ã‚ã‚ã›ãŸçµæœã€æ–‡å­—åŒ–ã‘ã—ãªã„ã§æ­£å¸¸ã«è¡¨ç¤ºã§ãã¾ã—ãŸã€‚

```powershell:ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’UTF-8ã«å¤‰æ›´ã™ã‚‹æ–¹æ³•
[console]::OutputEncoding = [System.Text.Encoding]::UTF8
```

:::details è¨­å®šã§ãã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®ä¸€è¦§ < ã‚¯ãƒªãƒƒã‚¯ã§æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ã >

ä»–ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã«ã‚‚å¤‰æ›´å¯èƒ½ã§ã™ã€‚

```powershell:ã‚³ãƒ”ãƒ¼ç”¨
[console]::OutputEncoding = [System.Text.Encoding]::"è¨­å®šã—ãŸã„æ–‡å­—ã‚³ãƒ¼ãƒ‰"
```

- `System.Text.Encoding`ã§è¨­å®šã§ãã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®ä¸€è¦§
    |è¨­å®šå¯èƒ½ãªæ–‡å­—ã‚³ãƒ¼ãƒ‰|èª¬æ˜|
    |---|---|
    |ASCII|ASCII (7 ãƒ“ãƒƒãƒˆ) æ–‡å­—ã‚»ãƒƒãƒˆã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å–å¾—ã—ã¾ã™ã€‚|
    |BigEndianUnicode|ãƒ“ãƒƒã‚° ã‚¨ãƒ³ãƒ‡ã‚£ã‚¢ãƒ³ã®ãƒã‚¤ãƒˆé †ã‚’ä½¿ç”¨ã™ã‚‹ UTF-16 å½¢å¼ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å–å¾—ã—ã¾ã™ã€‚|
    |Default|ã“ã® .NET å®Ÿè£…ã®æ—¢å®šã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã—ã¾ã™ã€‚<br>* PowerShell 5.xï¼ˆDesktopï¼‰ ã ã¨ `Shift JIS`ã€‚PowerShell 7.xï¼ˆCoreï¼‰ã ã¨`UTF-8`ã€‚|
    |Latin1|Latin1 æ–‡å­—ã‚»ãƒƒãƒˆ (ISO-8859-1) ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã—ã¾ã™ã€‚|
    |Unicode|ãƒªãƒˆãƒ« ã‚¨ãƒ³ãƒ‡ã‚£ã‚¢ãƒ³ ãƒã‚¤ãƒˆé †ã‚’ä½¿ç”¨ã™ã‚‹ UTF-16 å½¢å¼ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å–å¾—ã—ã¾ã™ã€‚|
    |UTF32|ãƒªãƒˆãƒ« ã‚¨ãƒ³ãƒ‡ã‚£ã‚¢ãƒ³ ãƒã‚¤ãƒˆé †ã‚’ä½¿ç”¨ã™ã‚‹ UTF-32 å½¢å¼ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å–å¾—ã—ã¾ã™ã€‚|
    |UTF7|UTF-7 å½¢å¼ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å–å¾—ã—ã¾ã™ã€‚|
    |UTF8|UTF-8 å½¢å¼ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å–å¾—ã—ã¾ã™ã€‚|

- å‚è€ƒæƒ…å ±
    https://learn.microsoft.com/ja-jp/dotnet/api/system.text.encoding#properties

:::

:::details å®Ÿéš›ã®ã‚³ãƒãƒ³ãƒ‰çµæœï¼ˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’UTF-8ã«å¤‰æ›´ï¼‰

```powershell:6.0ä»¥é™ã®ç’°å¢ƒï¼ˆ5.1ã§ã‚‚åŒã˜çµæœï¼‰
# å¤‰æ›´å‰ãŒShift JISã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> [console]::OutputEncoding

EncodingName      : Japanese (Shift-JIS)
WebName           : shift_jis
HeaderName        : iso-2022-jp
BodyName          : iso-2022-jp
Preamble          :
WindowsCodePage   :
IsBrowserDisplay  :
IsBrowserSave     :
IsMailNewsDisplay :
IsMailNewsSave    :
IsSingleByte      : False
EncoderFallback   : System.Text.InternalEncoderBestFitFallback
DecoderFallback   : System.Text.InternalDecoderBestFitFallback
IsReadOnly        : False
CodePage          : 932


PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
# ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’UTF-8ã«å¤‰æ›´
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> [console]::OutputEncoding = [System.Text.Encoding]::UTF8
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
# è¨­å®šãŒåæ˜ ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> [console]::OutputEncoding

Preamble          :
BodyName          : utf-8
EncodingName      : Unicode (UTF-8)
HeaderName        : utf-8
WebName           : utf-8
WindowsCodePage   : 1200
IsBrowserDisplay  : True
IsBrowserSave     : True
IsMailNewsDisplay : True
IsMailNewsSave    : True
IsSingleByte      : False
EncoderFallback   : System.Text.EncoderReplacementFallback
DecoderFallback   : System.Text.DecoderReplacementFallback
IsReadOnly        : False
CodePage          : 65001


PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
# ã‚‚ã†ä¸€åº¦ã€ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã¿ã¦çµæœã€æ­£å¸¸ã«è¡¨ç¤ºã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèª
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $result = (winget upgrade)
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-Output $result

   -
   \
   |


   -
   \

åå‰                                             ID                                ãƒãƒ¼ã‚¸ãƒ§ãƒ³     åˆ©ç”¨å¯èƒ½       ã‚½ãƒ¼ã‚¹
-----------------------------------------------------------------------------------------------------------------------
draw.io 22.1.18                                  JGraph.Draw                       22.1.18        23.0.2         winget
CrystalDiskInfo 8.17.14 (64 ãƒ“ãƒƒãƒˆ)              CrystalDewWorld.CrystalDiskInfo   8.17.14        9.2.2          winget
DBeaver 23.0.2                                   dbeaver.dbeaver                   23.0.2         23.3.4         winget
Docker Desktop                                   Docker.DockerDesktop              4.18.0         4.27.2         winget
Git                                              Git.Git                           2.40.0         2.43.0         winget
Google Chrome                                    Google.Chrome                     121.0.6167.184 122.0.6261.39  winget
Kubernetes - Minikube - A Local Kubernetes Deveâ€¦ Kubernetes.minikube               1.30.1         1.32.0         winget
Microsoft Visual Studio 2010 Tools for Office Râ€¦ Microsoft.VSTOR                   10.0.50903     10.0.60912.00  winget
Microsoft Visual C++ 2015 UWP Desktop Runtime Pâ€¦ Microsoft.VCLibs.Desktop.14       14.0.32530.0   14.0.33321.0   winget
Windows ã‚¿ãƒ¼ãƒŸãƒŠãƒ«                               9N0DX20HK701                      1.18.3181.0    1.19.10302.0   winget
SourceTree                                       Atlassian.Sourcetree              3.4.12         3.4.16         winget
Tera Term 4.106                                  TeraTermProject.teraterm          4.106          4.108          winget
Tesseract-OCR - open source OCR engine           UB-Mannheim.TesseractOCR          5.3.1.20230401 5.3.3.20231005 winget
VLC media player                                 VideoLAN.VLC                      3.0.18         3.0.20         winget
WinMerge 2.16.28.0 x64                           WinMerge.WinMerge                 2.16.28.0      2.16.38        winget
PowerShell 7.3.11.0-x64                          Microsoft.PowerShell              7.3.11.0       7.4.1.0        winget
Microsoft Visual C++ 2015-2022 Redistributable â€¦ Microsoft.VCRedist.2015+.x64      14.36.32532.0  14.38.33135.0  winget
Oracle VM VirtualBox 7.0.6                       Oracle.VirtualBox                 7.0.6          7.0.14         winget
MySQL Workbench 8.0 CE                           Oracle.MySQLWorkbench             8.0.28         8.0.36         winget
Dell Display Manager                             Dell.DisplayManager               < 2.0          2.2.0.43       winget
Node.js                                          OpenJS.NodeJS.LTS                 18.16.0        20.11.0        winget
Microsoft Windows Desktop Runtime - 6.0.26 (x64) Microsoft.DotNet.DesktopRuntime.6 6.0.26         6.0.27         winget
Microsoft .NET Runtime - 6.0.26 (x64)            Microsoft.DotNet.Runtime.6        6.0.26         6.0.27         winget
Microsoft Visual C++ 2015-2022 Redistributable â€¦ Microsoft.VCRedist.2015+.x64      14.34.31938.0  14.38.33135.0  winget
Microsoft .NET SDK 7.0.405 (x64)                 Microsoft.DotNet.SDK.7            7.0.405        7.0.406        winget
Microsoft Visual C++ 2013 Redistributable (x86)â€¦ Microsoft.VCRedist.2013.x64       12.0.30501.0   12.0.40664.0   winget
26 ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã‚’åˆ©ç”¨ã§ãã¾ã™ã€‚
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

:::

### PowerShellã«ãŠã‘ã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¾ã‚ã‚Šã®è¨­å®šã‚’ä¸€æ‹¬å¤‰æ›´ã™ã‚‹Function

PowerShellã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦ãƒãƒƒãƒˆã§æ¤œç´¢ã—ãŸéš›ã€[ã“ã¡ã‚‰](https://qiita.com/e4rfx/items/3772ecb58b6918ed5348)ã®è¨˜äº‹ã§æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¾ã‚ã‚Šã‚’ä¸€æ‹¬å¤‰æ›´ã§ãã‚‹FunctionãŒç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚

è¨˜äº‹å†…ã«ã‚‚ã‚ã‚‹ã¨ãŠã‚Šã€ã“ã®Functionã¯PowerShellã®Desktop Editionï¼ˆ5.xä»¥å‰ï¼‰ã®ç’°å¢ƒã‚’æƒ³å®šã—ã¦ã„ã‚‹Functionã§ã—ãŸã€‚

#### PowerShellã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®å¤‰åŒ–ç‚¹

å…·ä½“çš„ã«èª¬æ˜ã™ã‚‹ã¨ã€PowerShell ã®Core Editionï¼ˆ6.0ä»¥é™ï¼‰ã®ç’°å¢ƒã§ã¯ã€`[System.Text.Encoding]::Default`ã®çµæœãŒ`sjis`ã§ã¯ãªã`utf8`ã¨ãªã‚‹ç‚ºã€
æ„å›³ã™ã‚‹å‹•ä½œã¨ç•°ãªã‚‹çµæœã¨ãªã‚Šã¾ã—ãŸã€‚

å…ƒè¨˜äº‹ã‚’å‚è€ƒã«ã•ã›ã¦é ‚ãã€PowerShell Coreã§ã‚‚ä½¿ç”¨ã§ãã‚‹Functionã‚’ä½œæˆã—ã¦ã¿ã¾ã—ãŸã€‚

```powershell:PowerShellã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¾ã‚ã‚Šã‚’ä¸€æ‹¬å¤‰æ›´ã™ã‚‹Function
Function SetPsOutputEncoding {
    param (
        [System.String]$charcode = 'reset_encoding'
    )

    switch ($charcode) {
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’UTF8ã«è¨­å®šã™ã‚‹
        'utf8' {
            $PSDefaultParameterValues['*:Encoding'] = 'utf8'
            $global:OutputEncoding = [System.Text.Encoding]::UTF8
            [console]::OutputEncoding = [System.Text.Encoding]::UTF8
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’Shift JISï¼ˆSJISï¼‰ã«è¨­å®šã™ã‚‹
        'sjis' {
            # $PSDefaultParameterValues['*:Encoding'] = 'default'ã«ã¤ã„ã¦
            #   ã“ã®è¨­å®šã¯Coreä»¥å¤–ï¼ˆ5.1ä»¥å‰ï¼‰ã®ç’°å¢ƒã§ã®ã¿Shift JISã§è¨­å®šã•ã‚Œã‚‹ã€‚
            #   Coreç’°å¢ƒã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯ã€UTF-8ã§ã‚ã‚ŠUTF-8ã§è¨­å®šã•ã‚Œã¦ã—ã¾ã†ã€‚
            #   ã¾ãŸã€Shift JISã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚‚å­˜åœ¨ã—ãªã„ç‚ºã€Coreç’°å¢ƒã§Shift JISã®è¨­å®šã¯ä¸å¯ã¨ãªã‚‹ã€‚
            $PSDefaultParameterValues['*:Encoding'] = 'default'
            $global:OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
            [console]::OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’ASCIIã«è¨­å®šã™ã‚‹
        'ascii' {
            $PSDefaultParameterValues.Remove('*:Encoding')
            $global:OutputEncoding = [System.Text.Encoding]::ASCII
            [console]::OutputEncoding = [System.Text.Encoding]::ASCII
        }
        # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰æŒ‡å®šã‚’è§£é™¤ã™ã‚‹
        'rm_encoding' {
            $PSDefaultParameterValues.Remove('*:Encoding')
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰è¨­å®šã‚’åˆæœŸçŠ¶æ…‹ã«æˆ»ã™
        'reset_encoding' {
            $PSDefaultParameterValues.Remove('*:Encoding')

            If ($PSVersionTable.PSEdition -eq 'Core') {
                # Core ã®å ´åˆ
                $global:OutputEncoding = [System.Text.Encoding]::UTF8
                [console]::OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
            }
            else {
                # Core ä»¥å¤–ã®å ´åˆï¼ˆPowerShell 5.1 ä»¥å‰ï¼‰
                $global:OutputEncoding = [System.Text.Encoding]::ASCII
                [console]::OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
            }
        }
    }
}

# å®Ÿè¡Œãƒ†ã‚¹ãƒˆ
SetPsOutputEncoding 'utf8'
```

:::detials å®Ÿéš›ã®ã‚³ãƒãƒ³ãƒ‰çµæœï¼ˆæ–‡å­—ã‚³ãƒ¼ãƒ‰è¨­å®šã®ä¸€æ‹¬å¤‰æ›´ï¼‰

```powershell:6.0ä»¥é™ã®ç’°å¢ƒï¼ˆ5.1ã§ã‚‚åŒã˜çµæœï¼‰
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Function SetPsOutputEncoding {
>>     param (
>>         [System.String]$charcode = 'reset_encoding'
>>     )
>>
>>     switch ($charcode) {
>>         'utf8' {
>>             $PSDefaultParameterValues['*:Encoding'] = 'utf8'
>>             $global:OutputEncoding = [System.Text.Encoding]::UTF8
>>             [console]::OutputEncoding = [System.Text.Encoding]::UTF8
>>         }
>>         'sjis' {
>>             $PSDefaultParameterValues['*:Encoding'] = 'default'
>>             $global:OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
>>             [console]::OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
>>         }
>>         'ascii' {
>>             $PSDefaultParameterValues.Remove('*:Encoding')
>>             $global:OutputEncoding = [System.Text.Encoding]::ASCII
>>             [console]::OutputEncoding = [System.Text.Encoding]::ASCII
>>         }
>>         'rm_encoding' {
>>             $PSDefaultParameterValues.Remove('*:Encoding')
>>         }
>>         'reset_encoding' {
>>             $PSDefaultParameterValues.Remove('*:Encoding')
>>
>>             If ($PSVersionTable.PSEdition -eq 'Core') {
>>                 $global:OutputEncoding = [System.Text.Encoding]::UTF8
>>                 [console]::OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
>>             }
>>             else {
>>                 $global:OutputEncoding = [System.Text.Encoding]::ASCII
>>                 [console]::OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
>>             }
>>         }
>>     }
>> }
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> SetPsOutputEncoding 'utf8'
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $result = (winget upgrade)
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-Output $result

   -
   \


   -
   \

åå‰                                             ID                                ãƒãƒ¼ã‚¸ãƒ§ãƒ³     åˆ©ç”¨å¯èƒ½       ã‚½ãƒ¼ã‚¹
-----------------------------------------------------------------------------------------------------------------------
draw.io 22.1.18                                  JGraph.Draw                       22.1.18        23.0.2         winget
CrystalDiskInfo 8.17.14 (64 ãƒ“ãƒƒãƒˆ)              CrystalDewWorld.CrystalDiskInfo   8.17.14        9.2.2          winget
DBeaver 23.0.2                                   dbeaver.dbeaver                   23.0.2         23.3.4         winget
Docker Desktop                                   Docker.DockerDesktop              4.18.0         4.27.2         winget
Git                                              Git.Git                           2.40.0         2.43.0         winget
Google Chrome                                    Google.Chrome                     121.0.6167.184 122.0.6261.39  winget
Kubernetes - Minikube - A Local Kubernetes Deveâ€¦ Kubernetes.minikube               1.30.1         1.32.0         winget
Microsoft Visual Studio 2010 Tools for Office Râ€¦ Microsoft.VSTOR                   10.0.50903     10.0.60912.00  winget
Microsoft Visual C++ 2015 UWP Desktop Runtime Pâ€¦ Microsoft.VCLibs.Desktop.14       14.0.32530.0   14.0.33321.0   winget
Windows ã‚¿ãƒ¼ãƒŸãƒŠãƒ«                               9N0DX20HK701                      1.18.3181.0    1.19.10302.0   winget
SourceTree                                       Atlassian.Sourcetree              3.4.12         3.4.16         winget
Tera Term 4.106                                  TeraTermProject.teraterm          4.106          4.108          winget
Tesseract-OCR - open source OCR engine           UB-Mannheim.TesseractOCR          5.3.1.20230401 5.3.3.20231005 winget
VLC media player                                 VideoLAN.VLC                      3.0.18         3.0.20         winget
WinMerge 2.16.28.0 x64                           WinMerge.WinMerge                 2.16.28.0      2.16.38        winget
PowerShell 7.3.11.0-x64                          Microsoft.PowerShell              7.3.11.0       7.4.1.0        winget
Microsoft Visual C++ 2015-2022 Redistributable â€¦ Microsoft.VCRedist.2015+.x64      14.36.32532.0  14.38.33135.0  winget
Oracle VM VirtualBox 7.0.6                       Oracle.VirtualBox                 7.0.6          7.0.14         winget
MySQL Workbench 8.0 CE                           Oracle.MySQLWorkbench             8.0.28         8.0.36         winget
Dell Display Manager                             Dell.DisplayManager               < 2.0          2.2.0.43       winget
Node.js                                          OpenJS.NodeJS.LTS                 18.16.0        20.11.0        winget
Microsoft Windows Desktop Runtime - 6.0.26 (x64) Microsoft.DotNet.DesktopRuntime.6 6.0.26         6.0.27         winget
Microsoft .NET Runtime - 6.0.26 (x64)            Microsoft.DotNet.Runtime.6        6.0.26         6.0.27         winget
Microsoft Visual C++ 2015-2022 Redistributable â€¦ Microsoft.VCRedist.2015+.x64      14.34.31938.0  14.38.33135.0  winget
Microsoft .NET SDK 7.0.405 (x64)                 Microsoft.DotNet.SDK.7            7.0.405        7.0.406        winget
Microsoft Visual C++ 2013 Redistributable (x86)â€¦ Microsoft.VCRedist.2013.x64       12.0.30501.0   12.0.40664.0   winget
26 ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã‚’åˆ©ç”¨ã§ãã¾ã™ã€‚
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

:::

åˆ¥ã®è¨˜äº‹ã§æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®è¨­å®šæƒ…å ±ã‚’PowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¿ã‚¤ãƒˆãƒ«ã«åæ˜ ã™ã‚‹Functionã‚‚ä½œæˆã—ã¦ã„ã¾ã™ã€‚
æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ãŸå¾Œã€è¨­å®šå†…å®¹ã‚’ã‚¿ã‚¤ãƒˆãƒ«ã«è¡¨ç¤ºã•ã›ãŸã„æ–¹ã¯ã€ä¸‹è¨˜ã‚’å‚è€ƒã«å°å…¥ã—ã¦ãã ã•ã„ã€‚
https://zenn.dev/haretokidoki/articles/67788ca9b47b27

## ã¾ã¨ã‚

- äº‹è±¡
    `winget update`ã‚³ãƒãƒ³ãƒ‰ã‚’å¤‰æ•°ã«å…¥ã‚Œã¦ã‹ã‚‰ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºã™ã‚‹ã¨æ–‡å­—åŒ–ã‘ãŒç™ºç”Ÿã€‚
- åŸå› 
    ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›æ™‚ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ï¼ˆ`[console]::OutputEncoding`ï¼‰ã®è¦å®šå€¤`Shift JIS`ã¨ãªã£ã¦ã„ã¦ã€`winget`ã‚³ãƒãƒ³ãƒ‰ã§è¡¨ç¤ºã•ã‚Œã‚‹`UTF-8`ã¨é£Ÿã„é•ã„ãŒã‚ã£ãŸã‹ã‚‰ã€‚
- è§£æ±ºæ–¹æ³•
    ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›æ™‚ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ï¼ˆ`[console]::OutputEncoding`ï¼‰ã®è¨­å®šã‚’`UTF-8`ã«å¤‰æ›´ã™ã‚‹ã€‚

    ```powershell:ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’UTF-8ã«å¤‰æ›´ã™ã‚‹æ–¹æ³•
    [console]::OutputEncoding = [System.Text.Encoding]::UTF8
    ```

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
