---
title: "[PowerShell]æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’ã‚»ãƒƒãƒˆã™ã‚‹Function"
emoji: "ğŸ‰"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: false
---

## winget upgrade ã®çµæœã‚’å¤‰æ•°ã«å…¥ã‚Œã‚‹ã¨æ–‡å­—åŒ–ã‘

PowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®åˆæœŸå€¤ãŒ[console]::OutputEncoding ã¯ Shift JIS ã§ã€$OutputEncoding ã¯ UTF8 ã¨ãªã‚Šã€
ã‚³ãƒãƒ³ãƒ‰å‡ºåŠ›ã§ã¯ã€UTF8ã€‚ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºã§ã¯ã€Shift JIS ã§é£Ÿã„é•ã„ãŒç™ºç”Ÿã—ã¦ãŠã‚Šæ–‡å­—åŒ–ã‘ã¦ã„ãŸæ¨¡æ§˜ã€‚

æ¤œç´¢ã—ãŸçµæœã€åŒæ–¹ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’åˆã‚ã›ã‚‹Functionã‚’ä½œæˆã—ã¦ã„ãŸæ–¹ãŒã„ãŸã®ã§å‚è€ƒã«ã•ã›ã¦ã„ãŸã ã„ãŸã€‚
https://qiita.com/e4rfx/items/3772ecb58b6918ed5348

```powershell:å‚è€ƒæƒ…å ±ã‚’å…ƒã«ä½œæˆã—ãŸFunction
function SetOutputEncoding {
    param (
        [System.String]$char_code = 'utf8'
    )

    switch ($char_code) {
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’UTF8ã«è¨­å®šã™ã‚‹
        'utf8' {
            $PSDefaultParameterValues['*:Encoding'] = 'utf8'
            $global:OutputEncoding = [System.Text.Encoding]::UTF8
            [console]::OutputEncoding = [System.Text.Encoding]::UTF8
            $Host.UI.RawUI.WindowTitle = "Windows PowerShell (" +  $OutputEncoding.WebName + ")"
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ(SJIS)ã«è¨­å®šã™ã‚‹
        'sjis' {
            $PSDefaultParameterValues['*:Encoding'] = 'default'
            $global:OutputEncoding = [System.Text.Encoding]::Default
            [console]::OutputEncoding = [System.Text.Encoding]::Default
            $Host.UI.RawUI.WindowTitle = "Windows PowerShell (" +  $OutputEncoding.WebName + ")"
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’ASCIIã«è¨­å®šã™ã‚‹
        'ascii' {
            $PSDefaultParameterValues.Remove('*:Encoding')
            $global:OutputEncoding = [System.Text.Encoding]::ASCII
            [console]::OutputEncoding = [System.Text.Encoding]::ASCII
            $Host.UI.RawUI.WindowTitle = "Windows PowerShell (" +  $OutputEncoding.WebName + ")"
        }
        # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰æŒ‡å®šã‚’è§£é™¤ã™ã‚‹
        'rmenc' {
            $PSDefaultParameterValues.Remove('*:Encoding')
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰è¨­å®šã‚’åˆæœŸçŠ¶æ…‹ã«æˆ»ã™
        'reset_enc' {
            $PSDefaultParameterValues.Remove('*:Encoding')
            $global:OutputEncoding = [System.Text.Encoding]::ASCII
            [console]::OutputEncoding = [System.Text.Encoding]::Default
            $Host.UI.RawUI.WindowTitle = "Windows PowerShell (INITIAL ENCODING)"
        }
    }
}

# å®Ÿè¡Œãƒ†ã‚¹ãƒˆ
SetOutputEncoding 'utf8'
```

## Bing AI

:::details Bing AI
> 
> 
> PowerShellã«ãŠã‘ã‚‹ä¸‹è¨˜ã®å¤‰æ•°ã®é•ã„
> ãƒ»$global:OutputEncoding
> ãƒ»[Console]::OutputEncoding
ã€€
> 
> 
> ã“ã‚“ã«ã¡ã¯ã€ã“ã‚Œã¯Bingã§ã™ã€‚ğŸ˜Š
> 
> PowerShellã«ãŠã‘ã‚‹ä¸‹è¨˜ã®å¤‰æ•°ã®é•ã„ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚
> 
> - `$global:OutputEncoding`ã¯ã€PowerShellãŒå¤–éƒ¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨ã®é€šä¿¡ã«ä½¿ç”¨ã™ã‚‹ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®šã™ã‚‹è‡ªå‹•å¤‰æ•°ã§ã™Â¹ã€‚ä¾‹ãˆã°ã€PowerShellã‹ã‚‰åˆ¥ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å‘¼ã³å‡ºã—ãŸã‚Šã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã—ãŸã‚Šã™ã‚‹ã¨ãã«ã€ã“ã®å¤‰æ•°ã®å€¤ã«åŸºã¥ã„ã¦ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãŒè¡Œã‚ã‚Œã¾ã™Â²ã€‚
> - `[Console]::OutputEncoding`ã¯ã€.NET Frameworkã®`System.Console`ã‚¯ãƒ©ã‚¹ã®é™çš„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®å‡ºåŠ›ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã¾ãŸã¯è¨­å®šã—ã¾ã™Â³ã€‚ä¾‹ãˆã°ã€PowerShellã‹ã‚‰ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’è¡¨ç¤ºã—ãŸã‚Šã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰ãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã¿è¾¼ã‚“ã ã‚Šã™ã‚‹ã¨ãã«ã€ã“ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å€¤ã«åŸºã¥ã„ã¦ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãŒè¡Œã‚ã‚Œã¾ã™ã€‚
> 
> ã¤ã¾ã‚Šã€`$global:OutputEncoding`ã¯å¤–éƒ¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨ã®ã‚„ã‚Šã¨ã‚Šã«é–¢ä¿‚ã™ã‚‹å¤‰æ•°ã§ã‚ã‚Šã€`[Console]::OutputEncoding`ã¯ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã¨ã®ã‚„ã‚Šã¨ã‚Šã«é–¢ä¿‚ã™ã‚‹ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ã™ã€‚ä¸¡è€…ã¯ç‹¬ç«‹ã—ã¦ãŠã‚Šã€äº’ã„ã«å½±éŸ¿ã—ã¾ã›ã‚“ã€‚
> 
> Â¹: [æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦ - PowerShell | Microsoft Learn](^3^)
> Â²: [Powershellã«ãŠã‘ã‚‹ãƒ‰ãƒ«è¨˜å· \"$\"ã®æ„å‘³ã¯ãªã«ï¼Ÿå¤‰æ•°ã«ã¤ã„ã¦èª¬æ˜ï¼ - ã‚¨ã‚¯çŸ­ï½œExtan.jp](^2^)
> Â³: [Console.OutputEncoding Property (System) | Microsoft Docs]
> : [PowerShellã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆé–¢æ•° #PowerShell - Qiita](^1^)
> : [PowerShellã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦ - Qiita]
> 
> ã‚½ãƒ¼ã‚¹: Bing ã¨ã®ä¼šè©± 2023/12/21
> (1) PowerShellã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆé–¢æ•° #PowerShell - Qiita. https://qiita.com/e4rfx/items/3772ecb58b6918ed5348.
> (2) Powershellã«ãŠã‘ã‚‹ãƒ‰ãƒ«è¨˜å· "$"ã®æ„å‘³ã¯ãªã«ï¼Ÿå¤‰æ•°ã«ã¤ã„ã¦ .... https://extan.jp/?p=11455.
> (3) æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦ - PowerShell | Microsoft Learn. https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/about/about_character_encoding?view=powershell-7.4.
> (4) æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦ - PowerShell | Microsoft Learn. https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/about/about_character_encoding?view=powershell-7.4.
> (5) Powershellã«ãŠã‘ã‚‹ãƒ‰ãƒ«è¨˜å· "$"ã®æ„å‘³ã¯ãªã«ï¼Ÿå¤‰æ•°ã«ã¤ã„ã¦ .... https://extan.jp/?p=11455.
> (6) PowerShellã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆé–¢æ•° #PowerShell - Qiita. https://qiita.com/e4rfx/items/3772ecb58b6918ed5348.
:::