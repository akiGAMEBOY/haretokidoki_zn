---
title: "[PowerShell]æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’ã‚»ãƒƒãƒˆã™ã‚‹Function"
emoji: "ğŸ‰"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: false
---

## winget upgrade ã®çµæœã‚’å¤‰æ•°ã«å…¥ã‚Œã‚‹ã¨æ–‡å­—åŒ–ã‘

PowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®åˆæœŸå€¤ãŒ[console]::OutputEncoding ã¯ Shift JIS ã§ã€$OutputEncoding ã¯ UTF8 ã¨ãªã‚Šã€
ã‚³ãƒãƒ³ãƒ‰å‡ºåŠ›ã§ã¯ã€UTF8ã€‚ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºã§ã¯ã€Shift JIS ã§é£Ÿã„é•ã„ãŒç™ºç”Ÿã—ã¦ãŠã‚Šæ–‡å­—åŒ–ã‘ã¦ã„ãŸæ¨¡æ§˜ã€‚

æ¤œç´¢ã—ãŸçµæœã€åŒæ–¹ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’åˆã‚ã›ã‚‹Functionã‚’ä½œæˆã—ã¦ã„ãŸæ–¹ãŒã„ãŸã®ã§å‚è€ƒã«ã•ã›ã¦ã„ãŸã ã„ãŸã€‚
https://qiita.com/e4rfx/items/3772ecb58b6918ed5348

```powershell:å‚è€ƒæƒ…å ±ã‚’å…ƒã«ä½œæˆã—ãŸFunction
function SetOutputEncoding {
    param (
        [System.String]$char_code = 'utf8'
    )

    switch ($char_code) {
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’UTF8ã«è¨­å®šã™ã‚‹
        'utf8' {
            $PSDefaultParameterValues['*:Encoding'] = 'utf8'
            $global:OutputEncoding = [System.Text.Encoding]::UTF8
            [console]::OutputEncoding = [System.Text.Encoding]::UTF8
            $Host.UI.RawUI.WindowTitle = "Windows PowerShell (" +  $OutputEncoding.WebName + ")"
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ(SJIS)ã«è¨­å®šã™ã‚‹
        'sjis' {
            $PSDefaultParameterValues['*:Encoding'] = 'default'
            $global:OutputEncoding = [System.Text.Encoding]::Default
            [console]::OutputEncoding = [System.Text.Encoding]::Default
            $Host.UI.RawUI.WindowTitle = "Windows PowerShell (" +  $OutputEncoding.WebName + ")"
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’ASCIIã«è¨­å®šã™ã‚‹
        'ascii' {
            $PSDefaultParameterValues.Remove('*:Encoding')
            $global:OutputEncoding = [System.Text.Encoding]::ASCII
            [console]::OutputEncoding = [System.Text.Encoding]::ASCII
            $Host.UI.RawUI.WindowTitle = "Windows PowerShell (" +  $OutputEncoding.WebName + ")"
        }
        # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰æŒ‡å®šã‚’è§£é™¤ã™ã‚‹
        'rmenc' {
            $PSDefaultParameterValues.Remove('*:Encoding')
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰è¨­å®šã‚’åˆæœŸçŠ¶æ…‹ã«æˆ»ã™
        'reset_enc' {
            $PSDefaultParameterValues.Remove('*:Encoding')
            $global:OutputEncoding = [System.Text.Encoding]::ASCII
            [console]::OutputEncoding = [System.Text.Encoding]::Default
            $Host.UI.RawUI.WindowTitle = "Windows PowerShell (INITIAL ENCODING)"
        }
    }
}

# å®Ÿè¡Œãƒ†ã‚¹ãƒˆ
SetOutputEncoding 'utf8'
```