---
title: "PowerShellã®ã‚³ãƒãƒ³ãƒ‰çµæœã‚’å¤‰æ•°ã«ä»£å…¥ã—æ–‡å­—åŒ–ã‘ã™ã‚‹å ´åˆã®è§£æ±ºæ–¹æ³•"
emoji: "ğŸ‰"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---
## æ¦‚è¦

æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒUTF-8ã§å‡ºåŠ›ã•ã‚Œã‚‹ã‚³ãƒãƒ³ãƒ‰ã€wingetã®ã‚³ãƒãƒ³ãƒ‰çµæœã‚’å¤‰æ•°ã«ä»£å…¥ã—ãŸå¾Œã€
Write-Hostã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã§å¤‰æ•°ã®ä¸­èº«ã‚’ç¢ºèªã™ã‚‹ã¨æ–‡å­—åŒ–ã‘ã§è¡¨ç¤ºã•ã‚Œã¦ã—ã¾ã„ã¾ã—ãŸã€‚

ã‚³ãƒ¼ãƒ‰ã«ã™ã‚‹ã¨ä¸‹è¨˜ã®é€šã‚Šã€‚

```powershell:ã‚³ãƒãƒ³ãƒ‰çµæœã‚’å¤‰æ•°ã«ä»£å…¥ã™ã‚‹ã¨æ–‡å­—åŒ–ã‘
# Windowsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã§ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆçŠ¶æ³ã‚’ç¢ºèªã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ï¼ˆwinget upgradeï¼‰ã‚’å¤‰æ•°ã«ä»£å…¥
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $result = (winget upgrade)
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">

# å¤‰æ•°ã®å†…å®¹ã‚’å‚ç…§
# ã€€æ–‡å­—åŒ–ã‘ãŒç™ºç”Ÿã€‚ã¾ãŸã€æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’æ­£ã—ãèªè­˜ã§ãã¦ã„ãªã„ã‚ˆã†ãªã®ã§1è¡Œã§ã‚³ãƒãƒ³ãƒ‰çµæœãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã€‚
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> Write-Host $result
    -     \                                                                                                                               -     \                                                                                                                           èœ·æ¦Šç‡•                                               ID                              ç¹èˆŒãƒ» ç¹§ï½¸ç¹ï½§ç¹ï½³     è›»ï½©é€•ï½¨èœ¿ï½¯é–­ï½½       ç¹§ï½½ç¹ï½¼ç¹§ï½¹ ----------------------------------------------------------------------------------------------------------------------- CrystalDiskInfo 8.17.14 (64 ç¹è–™ãƒ£ç¹ãƒ»                CrystalDewWorld.CrystalDiskInfo 8.17.14        9.2.1          winget DBeaver 23.0.2                                     dbeaver.dbeaver                 23.0.2         23.3.2         winget Docker Desktop                                     Docker.DockerDesktop            4.18.0         4.26.1         winget GIMP 2.10.34                                       GIMP.GIMP                       2.10.34        2.10.36        winget Git                                                Git.Git                         2.40.0         2.43.0         winget Kubernetes - Minikube - A Local Kubernetes Develoçª¶ï½¦ Kubernetes.minikube             1.30.1         1.32.0         winget Microsoft Visual Studio 2010 Tools for Office Runçª¶ï½¦ Microsoft.VSTOR                 10.0.50903     10.0.60912.00  winget SourceTree                                         Atlassian.Sourcetree            3.4.12         3.4.16         winget Tera Term 4.106                                    TeraTermProject.teraterm        4.106          4.108          winget Tesseract-OCR - open source OCR engine             UB-Mannheim.TesseractOCR        5.3.1.20230401 5.3.3.20231005 winget VLC media player                                   VideoLAN.VLC                    3.0.18         3.0.20         winget WinMerge 2.16.28.0 x64                             WinMerge.WinMerge               2.16.28.0      2.16.36        winget Microsoft Visual C++ 2015-2022 Redistributable (xçª¶ï½¦ Microsoft.VCRedist.2015+.x64    14.36.32532.0  14.38.33130.0  winget Oracle VM VirtualBox 7.0.6                         Oracle.VirtualBox               7.0.6          7.0.12         winget PowerShell 7.3.10.0-x64                            Microsoft.PowerShell            7.3.10.0       7.4.1.0        winget MySQL Workbench 8.0 CE                             Oracle.MySQLWorkbench           8.0.28         8.0.34         winget Dell Display Manager                               Dell.DisplayManager             < 2.0          2.2.0.43       winget Node.js                                            OpenJS.NodeJS.LTS               18.16.0        20.10.0        winget Microsoft Visual C++ 2015-2022 Redistributable (xçª¶ï½¦ Microsoft.VCRedist.2015+.x64    14.34.31938.0  14.38.33130.0  winget Microsoft Visual C++ 2013 Redistributable (x86) -çª¶ï½¦ Microsoft.VCRedist.2013.x64     12.0.30501.0   12.0.40664.0   winget 20 ç¹§ï½¢ç¹ãƒ»ãƒ»ç¹§ï½°ç¹ï½¬ç¹ï½¼ç¹å³¨ï½’è›»ï½©é€•ï½¨ç¸ºï½§ç¸ºé˜ªâˆªç¸ºå¶Â€ãƒ»
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

å¤‰æ•°ã«å…¥ã‚Œãšã€ãã®ã¾ã¾ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨æ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

ã“ã®ç¾è±¡ã‚’èª¿ã¹ãŸçµæœã€PowerShellã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã™ã‚‹éš›ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®è¦å®šå€¤ï¼ˆ`[console]::OutputEncoding`ï¼‰ãŒ `Shift JIS`ã«ãªã£ã¦ã„ã‚‹äº‹ãŒåŸå› ã®ã‚ˆã†ã§ã—ãŸã€‚

ã“ã®è¨­å®šã‚’UTF-8ã«å¤‰æ›´ã™ã‚‹è§£æ±ºæ–¹æ³•ã¨ã€ã¤ã„ã§ã«PowerShellã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¾ã‚ã‚Šã®è¨­å®šã‚’ä¸€æ‹¬ã§å¤‰æ›´ã§ãã‚‹Functionã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- PowerShellã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºã§æ–‡å­—åŒ–ã‘ã—ã¦ã—ã¾ã£ãŸæ–¹
- è§£æ±ºæ–¹æ³•ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’çŸ¥ã‚ŠãŸã„æ–¹
- PowerShellã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¾ã‚ã‚Šã®è¨­å®šã‚’ä¸€æ‹¬ã§å¤‰æ›´ã§ãã‚‹Functionã‚’ç¢ºèªã—ãŸã„æ–¹

## è§£æ±ºæ–¹æ³•

ä»Šå›ã€æ–‡å­—åŒ–ã‘ã—ã¦ã—ã¾ã£ãŸã‚³ãƒãƒ³ãƒ‰ã¯ã€`winget upgrade` ã§ã™ã€‚
ã“ã®`winget`ã‚³ãƒãƒ³ãƒ‰ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¯ã€ŒUTF-8ã€ã®ã‚ˆã†ã§ä¸‹è¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›æ™‚ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’ã€ŒUTF-8ã€ã«åˆã‚ã›ãŸçµæœã€è§£æ±ºã—ã¾ã—ãŸã€‚

```powershell:ã‚³ãƒ”ãƒ¼ç”¨
[console]::OutputEncoding = [System.Text.Encoding]::"è¨­å®šã—ãŸã„æ–‡å­—ã‚³ãƒ¼ãƒ‰"
```

```powershell:æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’UTF-8ã«å¤‰æ›´ã™ã‚‹å ´åˆ
[console]::OutputEncoding = [System.Text.Encoding]::UTF8
```

:::details è¨­å®šã§ãã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®ä¸€è¦§

|è¨­å®šå¯èƒ½ãªæ–‡å­—ã‚³ãƒ¼ãƒ‰|èª¬æ˜|
|---|---|
|ASCII|ASCII (7 ãƒ“ãƒƒãƒˆ) æ–‡å­—ã‚»ãƒƒãƒˆã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å–å¾—ã—ã¾ã™ã€‚|
|BigEndianUnicode|ãƒ“ãƒƒã‚° ã‚¨ãƒ³ãƒ‡ã‚£ã‚¢ãƒ³ã®ãƒã‚¤ãƒˆé †ã‚’ä½¿ç”¨ã™ã‚‹ UTF-16 å½¢å¼ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å–å¾—ã—ã¾ã™ã€‚|
|Default|ã“ã® .NET å®Ÿè£…ã®æ—¢å®šã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã—ã¾ã™ã€‚<br>* PowerShell 5.xï¼ˆDesktopï¼‰ ã ã¨ `Shift JIS`ã€‚PowerShell 7.xï¼ˆCoreï¼‰ã ã¨`UTF-8`ã€‚|
|Latin1|Latin1 æ–‡å­—ã‚»ãƒƒãƒˆ (ISO-8859-1) ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã—ã¾ã™ã€‚|
|Unicode|ãƒªãƒˆãƒ« ã‚¨ãƒ³ãƒ‡ã‚£ã‚¢ãƒ³ ãƒã‚¤ãƒˆé †ã‚’ä½¿ç”¨ã™ã‚‹ UTF-16 å½¢å¼ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å–å¾—ã—ã¾ã™ã€‚|
|UTF32|ãƒªãƒˆãƒ« ã‚¨ãƒ³ãƒ‡ã‚£ã‚¢ãƒ³ ãƒã‚¤ãƒˆé †ã‚’ä½¿ç”¨ã™ã‚‹ UTF-32 å½¢å¼ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å–å¾—ã—ã¾ã™ã€‚|
|UTF7|UTF-7 å½¢å¼ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å–å¾—ã—ã¾ã™ã€‚|
|UTF8|UTF-8 å½¢å¼ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å–å¾—ã—ã¾ã™ã€‚|
*è¡¨ï¼š`System.Text.Encoding`ã§è¨­å®šã§ãã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®ä¸€è¦§*

- å‚è€ƒæƒ…å ±
    https://learn.microsoft.com/ja-jp/dotnet/api/system.text.encoding#properties

:::

## åŸå› 

:::message
**æ³¨æ„ï¼šã“ã“ã§è¨˜è¼‰ã•ã‚Œã„ã¦ã‚‹åŸå› ã¯ã€æ¨æ¸¬ãƒ»æƒ³åƒã®ç¯„å›²å†…ã§è¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™**

è©³ã—ã„ãƒ­ã‚¸ãƒƒã‚¯ã‚’èª¬æ˜ã—ã¦ã„ã‚‹å…¬å¼æ–‡æ›¸ã‚’è¦‹ã¤ã‘ã‚‹äº‹ãŒã§ããªã‹ã£ãŸã®ã§ã€ã‚ã‚‹ç¨‹åº¦ãã‚Šã‚ã‘ã—ãŸçµæœã‚’ã¾ã¨ã‚ã¦è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚
è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹æƒ…å ±ãŒèª¤ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§æƒ…å ±ã®å–æ‰±ã„ã«ã¯ã”æ³¨æ„ãã ã•ã„ã€‚
:::

### å¤‰æ•°ã«ä»£å…¥ã—ãŸã¨ãã«æ–‡å­—åŒ–ã‘ã—ã¦ã—ã¾ã†åŸå› 

ã‚³ãƒãƒ³ãƒ‰ã§å‡ºåŠ›ã•ã‚Œã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒã€ŒUTF-8ã€ã§ã—ãŸãŒã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒã€ŒShift JISã€ã ã£ãŸç‚ºã€
å¤‰æ•°ã®ä»£å…¥æ™‚ã«æ–‡å­—åŒ–ã‘ãŒç™ºç”Ÿã—ã¦ã—ã¾ã£ãŸã‚ˆã†ã§ã™ã€‚

ãŸã ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰è¨­å®šã€Œ`[console]::OutputEncoding`ã€ãŒå³å¯†ã«ã©ã®ã‚ˆã†ãªãƒ­ã‚¸ãƒƒã‚¯ã§é–¢ã‚ã‚Šã€
å¤‰æ•°ä»£å…¥æ™‚ã«æ–‡å­—åŒ–ã‘ã™ã‚‹ã®ã‹ã€ã‚ˆãã‚ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚

ãŠãã‚‰ãã€å¤‰æ•°ã«ä»£å…¥ã•ã‚Œã‚‹ã¾ã§ã¯ä¸‹è¨˜ã®ã‚ˆã†ãªæµã‚Œã ã¨æ¨æ¸¬ã—ã¦ã„ã¾ã™ã€‚

1. ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
1. ã‚³ãƒãƒ³ãƒ‰å‡ºåŠ›çµæœãŒã‚³ãƒ³ã‚½ãƒ¼ãƒ«æ–‡å­—ã‚³ãƒ¼ãƒ‰ã«åŸºã¥ãShift JISã§è¡¨ç¤ºã•ã‚Œã‚‹
    ï¼ˆ**ã“ã“ã§æ–‡å­—åŒ–ã‘ãŒç™ºç”Ÿ**ï¼‰
1. æ–‡å­—åŒ–ã‘è¡¨ç¤ºã•ã‚ŒãŸå‡ºåŠ›çµæœã‚’ãã®ã¾ã¾å¤‰æ•°ã«ä»£å…¥
1. ä¸­èº«ãŒæ–‡å­—åŒ–ã‘ã—ã¦ã„ã‚‹å¤‰æ•°ãŒå®Œæˆ

### å¤‰æ•°ã«å…¥ã‚Œãªã„ã§ãã®ã¾ã¾å®Ÿè¡Œã™ã‚‹ã¨æ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œã‚‹ç†ç”±

å¤‰æ•°ã«ä»£å…¥ã™ã‚‹æ™‚ã¯æ–‡å­—åŒ–ã‘ã™ã‚‹ã®ã«ã€ãªãœãã®ã¾ã¾è¡¨ç¤ºã•ã‚Œã‚‹ã¨ãã‚‚æ–‡å­—åŒ–ã‘ã—ãªã„ã®ã‹ã¯ã€
ã‚ˆãã‚ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚

ã‹ãªã‚Šå½“ã¦ãšã£ã½ã†ãªè¦‹è§£ã§ã™ãŒã€ã‚‚ã—ã‹ã™ã‚‹ã¨`winget`ã‚³ãƒãƒ³ãƒ‰å´ã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãã®ã¾ã¾è¡¨ç¤ºã•ã‚Œã‚‹éš›ã€
ä½•ã‹ã—ã‚‰ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®åˆ¶å¾¡ãŒã‹ã‹ã‚Šã€æ­£å¸¸è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
ï¼ˆ[`winget`ã®ã‚½ãƒ¼ã‚¹](https://github.com/microsoft/winget-cli)ã‚’èª­ã‚ã°ä½•ã‹ã‚ã‹ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ï¼‰

## PowerShellã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¾ã‚ã‚Šã‚’ä¸€æ‹¬å¤‰æ›´ã™ã‚‹Function

ãƒãƒƒãƒˆã§æ¤œç´¢ã—ãŸçµæœã€[ã“ã¡ã‚‰](https://qiita.com/e4rfx/items/3772ecb58b6918ed5348)ã§PowerShellã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®è¨­å®šã‚’ä¸€æ‹¬ã§å¤‰æ›´ã—ã¦ãã‚Œã‚‹FunctionãŒç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚

ãŸã ã€ã“ã®Functionã¯è¨˜äº‹å†…ã«ã‚‚ã‚ã‚‹é€šã‚Šã€PowerShellã®Desktop Editionï¼ˆ5.xä»¥å‰ï¼‰ã®ç’°å¢ƒã§æƒ³å®šã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã§ã—ãŸã€‚

PowerShell ã®Core Editionï¼ˆ6.0ä»¥é™ï¼‰ã®ç’°å¢ƒã§ã¯ã€`[System.Text.Encoding]::Default`ã®çµæœãŒ`sjis`ã§ã¯ãªã`utf8`ã¨ãªã‚‹ç‚ºã€
æƒ³å®šã®å‹•ä½œã¨ç•°ãªã‚‹ã‚ˆã†ã§ã—ãŸã€‚

PowerShell Coreã§ã‚‚ä½¿ç”¨ã§ãã‚‹ã‚ˆã†è¨˜äº‹ã‚’å‚è€ƒã«å¾®ä¿®æ­£ã—ãŸã®ã§ç´¹ä»‹ã—ã¾ã™ã€‚

```powershell:ä½œæˆã—ãŸFunction
function SetPsOutputEncoding {
    param (
        [System.String]$charcode = 'reset_encoding'
    )

    switch ($charcode) {
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’UTF8ã«è¨­å®šã™ã‚‹
        'utf8' {
            $PSDefaultParameterValues['*:Encoding'] = 'utf8'
            $global:OutputEncoding = [System.Text.Encoding]::UTF8
            [console]::OutputEncoding = [System.Text.Encoding]::UTF8
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’Shift JISï¼ˆSJISï¼‰ã«è¨­å®šã™ã‚‹
        'sjis' {
            $PSDefaultParameterValues['*:Encoding'] = 'default' # ã“ã®å¤‰æ•°ã§ã¯Shift JISã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒãªãæŒ‡å®šã§ããªã„ã€‚Coreã§ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãŒUTF-8ã¨ãªã£ã¦ã—ã¾ã†ã€‚
            $global:OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
            [console]::OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’ASCIIã«è¨­å®šã™ã‚‹
        'ascii' {
            $PSDefaultParameterValues.Remove('*:Encoding')
            $global:OutputEncoding = [System.Text.Encoding]::ASCII
            [console]::OutputEncoding = [System.Text.Encoding]::ASCII
        }
        # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰æŒ‡å®šã‚’è§£é™¤ã™ã‚‹
        'rm_encoding' {
            $PSDefaultParameterValues.Remove('*:Encoding')
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰è¨­å®šã‚’åˆæœŸçŠ¶æ…‹ã«æˆ»ã™
        'reset_encoding' {
            $PSDefaultParameterValues.Remove('*:Encoding')

            If ($PSVersionTable.PSEdition -eq 'Core') {
                # Core ã®å ´åˆ
                $global:OutputEncoding = [System.Text.Encoding]::UTF8
                [console]::OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
            }
            else {
                # Core ä»¥å¤–ã®å ´åˆï¼ˆPowerShell 5.1 ä»¥å‰ï¼‰
                $global:OutputEncoding = [System.Text.Encoding]::ASCII
                [console]::OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
            }
            
            # ã‚¿ã‚¤ãƒˆãƒ«ã®è¡¨ç¤ºåˆ‡æ›¿Functionå‘¼ã³å‡ºã—ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆè§£é™¤ã¯ä»»æ„ï¼‰
            # (https://zenn.dev/haretokidoki/articles/67788ca9b47b27)
            # ChangeWindowTitle
        }
    }
}

# å®Ÿè¡Œãƒ†ã‚¹ãƒˆ
SetPsOutputEncoding 'utf8'
```

## Bing AI

:::details Bing AI
> 
> 
> powershell ã§æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’è¨­å®šã™ã‚‹éš›ã®ä¸‹è¨˜é …ç›®ã«ã¤ã„ã¦ã€èª¬æ˜ã—ã¦ãã ã•ã„ã€‚
> ãƒ»$PSDefaultParameterValues['*:Encoding']
> ãƒ»$global:OutputEncoding
> ãƒ»[console]::OutputEncoding
-----
> 
> 
> ã“ã‚“ã«ã¡ã¯ã€ã“ã‚Œã¯ Bing ã§ã™ã€‚ğŸ˜Š
> 
> powershell ã§æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’è¨­å®šã™ã‚‹éš›ã®ä¸‹è¨˜é …ç›®ã«ã¤ã„ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ã«èª¬æ˜ã§ãã¾ã™ã€‚
> 
> - `$PSDefaultParameterValues['*:Encoding']` ã¯ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã™ã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®è¦å®šå€¤ã‚’è¨­å®šã™ã‚‹ãŸã‚ã®å¤‰æ•°ã§ã™ã€‚ä¾‹ãˆã°ã€`$PSDefaultParameterValues['Out-File:Encoding'] = 'utf8'` ã¨ã™ã‚‹ã¨ã€`Out-File` ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã® `Encoding` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®æ—¢å®šå€¤ãŒ `utf8` ã«ãªã‚Šã¾ã™Â¹ã€‚
> - `$global:OutputEncoding` ã¯ã€powershell ã‹ã‚‰å¤–éƒ¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«å‡ºåŠ›ã™ã‚‹éš›ã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’è¨­å®šã™ã‚‹ãŸã‚ã®å¤‰æ•°ã§ã™ã€‚ä¾‹ãˆã°ã€`$global:OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')` ã¨ã™ã‚‹ã¨ã€å¤–éƒ¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«æ¸¡ã™å‡ºåŠ›ãŒã‚·ãƒ•ãƒˆJISã«ãªã‚Šã¾ã™Â²ã€‚
> - `[console]::OutputEncoding` ã¯ã€powershell ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã™ã‚‹éš›ã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’è¨­å®šã™ã‚‹ãŸã‚ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ã™ã€‚ä¾‹ãˆã°ã€`[console]::OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')` ã¨ã™ã‚‹ã¨ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã™ã‚‹å‡ºåŠ›ãŒã‚·ãƒ•ãƒˆJISã«ãªã‚Šã¾ã™Â³ã€‚
> 
> ã“ã‚Œã‚‰ã®é …ç›®ã¯ã€ãã‚Œãã‚Œç•°ãªã‚‹ç›®çš„ã‚„ç¯„å›²ã§æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚æ–‡å­—åŒ–ã‘ã‚’é˜²ããŸã‚ã«ã¯ã€é©åˆ‡ãªæ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’é¸æŠã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚â´
> 
> å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚ğŸ˜Š
> 
> ã‚½ãƒ¼ã‚¹: Bing ã¨ã®ä¼šè©± 2024/1/15
> (1) æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦ - PowerShell | Microsoft Learn. https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/about/about_character_encoding?view=powershell-7.4.
> (2) PowerShellã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹ #Windows - Qiita. https://qiita.com/Yorcna/items/d015ebe4fae50882e3a1.
> (3) Powershellã®æ–‡å­—åŒ–ã‘ã‚’ç›´ã™æ–¹æ³• - ãŠã‚Œã•ã¾ãƒ©ãƒœ. https://bing.com/search?q=powershell+%e6%96%87%e5%ad%97%e3%82%b3%e3%83%bc%e3%83%89+%e8%a8%ad%e5%ae%9a.
> (4) Powershellã®æ–‡å­—åŒ–ã‘ã‚’ç›´ã™æ–¹æ³• - ãŠã‚Œã•ã¾ãƒ©ãƒœ. https://www.oresamalabo.net/entry/2021/09/15/003143.
:::

:::details
> 
> 
> PowerShellã§å®Ÿè¡Œã—ãŸã‚³ãƒãƒ³ãƒ‰ã®çµæœã‚’å¤‰æ•°ã«ä»£å…¥ã™ã‚‹éš›ã€è¦å®šå€¤ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚
> ã¾ãŸã€ãã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹æ–¹æ³•ã‚‚åˆã‚ã›ã¦æ•™ãˆã¦ãã ã•ã„ã€‚
-----
> 
> 
> PowerShellã§å®Ÿè¡Œã—ãŸã‚³ãƒãƒ³ãƒ‰ã®çµæœã‚’å¤‰æ•°ã«ä»£å…¥ã™ã‚‹éš›ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¨å¤‰æ›´æ–¹æ³•ã«ã¤ã„ã¦ãŠç­”ãˆã—ã¾ã™ã€‚ğŸ˜Š
> 
> PowerShellã§ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œçµæœã‚’å¤‰æ•°ã«ä»£å…¥ã™ã‚‹ã«ã¯ã€`$()`ã‚„`$result = ã‚³ãƒãƒ³ãƒ‰`ãªã©ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚Â¹Â² ã“ã®ã¨ãã€å¤‰æ•°ã«ä»£å…¥ã•ã‚Œã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¯ã€PowerShellã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚„å®Ÿè¡Œç’°å¢ƒã«ã‚ˆã£ã¦ç•°ãªã‚Šã¾ã™ã€‚Â³
> 
> ä¸€èˆ¬çš„ã«ã¯ã€PowerShell 5.1ä»¥å‰ã§ã¯ã€å¤‰æ•°ã«ä»£å…¥ã•ã‚Œã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¯**UTF-16 LE**ã§ã™ã€‚Â³ PowerShell 6.0ä»¥é™ã§ã¯ã€å¤‰æ•°ã«ä»£å…¥ã•ã‚Œã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¯**UTF-8**ã§ã™ã€‚â´
> 
> å¤‰æ•°ã«ä»£å…¥ã•ã‚Œã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹æ–¹æ³•ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚Â³â´
> 
> - PowerShell 5.1ä»¥å‰ã§ã¯ã€`[System.Text.Encoding]::Default`ã‚„`[System.Text.Encoding]::UTF8`ãªã©ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ã£ã¦ã€å¤‰æ•°ã«ä»£å…¥ã™ã‚‹å‰ã«ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›ã‚’å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€ã‚·ã‚¹ãƒ†ãƒ ã®æ—¢å®šã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã§å¤‰æ•°ã«ä»£å…¥ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚
> ```powershell
> $result = [System.Text.Encoding]::Default.GetString([System.Text.Encoding]::Unicode.GetBytes(ã‚³ãƒãƒ³ãƒ‰))
> ```
> - PowerShell 6.0ä»¥é™ã§ã¯ã€`$OutputEncoding`å¤‰æ•°ã‚’ä½¿ã£ã¦ã€å¤‰æ•°ã«ä»£å…¥ã™ã‚‹å‰ã«ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€ã‚·ã‚¹ãƒ†ãƒ ã®æ—¢å®šã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã§å¤‰æ•°ã«ä»£å…¥ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚
> ```powershell
> $OutputEncoding = [System.Text.Encoding]::Default
> $result = ã‚³ãƒãƒ³ãƒ‰
> ```
> 
> ä»¥ä¸ŠãŒã€PowerShellã§å®Ÿè¡Œã—ãŸã‚³ãƒãƒ³ãƒ‰ã®çµæœã‚’å¤‰æ•°ã«ä»£å…¥ã™ã‚‹éš›ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¨å¤‰æ›´æ–¹æ³•ã«ã¤ã„ã¦ã®å›ç­”ã§ã™ã€‚å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚ğŸ™
> 
> Â¹: ã€PowerShellã€‘ã‚³ãƒãƒ³ãƒ‰å‡ºåŠ›çµæœã‚’å¤‰æ•°ã«å…¥åŠ›ã™ã‚‹æ–¹æ³• - Qiita
> Â²: PowerShell > å®Ÿè¡Œçµæœã®å¤‰æ•°ã¸ã®ä»£å…¥ | å‹ | å‚ç…§ - Qiita
> Â³: PowerShellã§ã‚³ãƒãƒ³ãƒ‰çµæœã‚’å¤‰æ•°ã«å…¥ã‚Œã‚‹æ–¹æ³• - teratailã€ãƒ†ãƒ©ãƒ†ã‚¤ãƒ«ã€‘
> â´: PowerShell 6.0ã§å¤‰ã‚ã£ãŸæ–‡å­—ã‚³ãƒ¼ãƒ‰é–¢é€£ã®ä»•æ§˜ - Qiita
> 
> ã‚½ãƒ¼ã‚¹: Bing ã¨ã®ä¼šè©± 2024/1/18
> (1) ã€PowerShellã€‘ã‚³ãƒãƒ³ãƒ‰å‡ºåŠ›çµæœã‚’å¤‰æ•°ã«å…¥åŠ›ã™ã‚‹æ–¹æ³• - Qiita. https://qiita.com/empty948/items/f5908a2960af46e9b793.
> (2) PowerShell > å®Ÿè¡Œçµæœã®å¤‰æ•°ã¸ã®ä»£å…¥ | å‹ | å‚ç…§ - Qiita. https://qiita.com/7of9/items/48e20f7430162c5a5883.
> (3) ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œçµæœã‚’å¤‰æ•°ã«ä»£å…¥ã™ã‚‹ - treedown .... https://blog.treedown.net/entry/2020/04/02/010000.
> (4) powershellã§ã‚³ãƒãƒ³ãƒ‰çµæœã‚’å¤‰æ•°ã«å…¥ã‚Œã‚‹æ–¹æ³• - teratailã€ãƒ†ãƒ© .... https://teratail.com/questions/73783.
> (5) ã€ç°¡å˜ã€‘ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œçµæœã‚’å¤‰æ•°ã«å…¥ã‚Œã‚‹æ–¹æ³• | ã‚†ã‚‹ .... https://hacker.trickstorm.com/?p=1252.
> (6) undefined. http://www.atmarkit.co.jp/ait/articles/0607/26/news118.html.
> (7) undefined. http://www.atmarkit.
:::
