---
title: "å‡ºåŠ›çµæžœã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’ä¸Šã’ã‚‹Function"
emoji: "ðŸ—‚"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: false
---

```powershell:
function Write-IndentedOutput {
    [CmdletBinding()]
    param (
        # ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¾ãŸã¯ç›´æŽ¥æ¸¡ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
        [Parameter(Mandatory = $true, ValueFromPipeline = $true)]
        [System.Object]$InputObject,
        
        # ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã«ä½¿ç”¨ã™ã‚‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ•° â€»ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯1ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆï¼ˆåŠè§’ã‚¹ãƒšãƒ¼ã‚¹4ã¤åˆ†ï¼‰
        [Parameter(Mandatory = $false)]
        [System.Int32]$IndentCount = 1
    )

    begin {
        # ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆ
        $indentString = New-Object System.String(" " , ($IndentCount * 4))
        # ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§å—ã‘å–ã£ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ ¼ç´ã™ã‚‹ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ–ã™ã‚‹
        $collectedObjects = @()
    }

    process {
        # å„å…¥åŠ›ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’é…åˆ—ã«è¿½åŠ ã—ã¦è“„ç©ã™ã‚‹
        $collectedObjects += $InputObject
    }

    end {
        # åŽé›†ã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ä½•ã‚‚ã—ãªã„
        if ($collectedObjects.Count -eq 0) { return }

        # ã‚‚ã—ã™ã§ã«æ–‡å­—åˆ—ï¼ˆã¾ãŸã¯å¤šæ•°ã®æ–‡å­—åˆ—ï¼‰ã®å ´åˆã¯é€£çµã™ã‚‹
        if ($collectedObjects -is [System.String[]]) {
            $outputText = $collectedObjects -join [Environment]::NewLine
        }
        else {
            # ç”Ÿã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å ´åˆã¯ã€å…¨ä½“ã‚’ä¸€æ‹¬ã—ã¦ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã§æ•´å½¢
            $outputText = $collectedObjects | Format-Table -AutoSize | Out-String
        }
        # æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã§å„è¡Œã«åˆ†å‰²
        $lines = $outputText -split "`r?`n"
        foreach ($line in $lines) {
            if ($line.Trim() -ne "") {
                Write-Host "$indentString$line"
            }
        }
    }
}
```

```powershell:
# ã‚³ãƒžãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆçµæžœã‚’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§Functionã«æ¸¡ã—ã¦ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’ã‚ã’ã‚‹
Get-Process | Write-IndentedOutput -IndentCount 1

# ã‚³ãƒžãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆçµæžœã®ã‚ã‚‹å¤‰æ•°ã‚’å¼•æ•°ã§Functionã«æ¸¡ã—ã¦ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’ã‚ã’ã‚‹
$result = Get-Process
Write-IndentedOutput -InputObject $result -IndentCount 2

```

```powershell:
PS C:\Users\XXXX> Get-Process

Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName
-------  ------    -----      -----     ------     --  -- -----------
    169       9     2152       3216              4216   0 AdminService
    136       7     2432       6572              8028   0 AggregatorHost
    277      17     8328       5080              4260   0 AGMService
    509      29    20232      23980       4.34  10104   1 ApplicationFrameHost
    133       8     1624       1988              4208   0 armsvc
    137       9     1320       2448              4224   0 bgsvcg
    468      36    16440       2268       0.22  11624   1 CalculatorApp
    145       7     1636       1880       0.30  14184   1 CompPkgSrv
    163      10     6664       1484              6452   0 conhost
    162      10     6668       1764              6840   0 conhost
    162      10     6668       1792             11256   0 conhost
    162      10     6668       1776             12624   0 conhost
    162      10     6680       1688             12812   0 conhost
    272      14     5100      17928       5.77  21136   1 conhost
   1460     128    62768      60572     153.83   3356   1 CopilotNative
    799      29     2028       4652               712   0 csrss
    909      34     3152       7040               812   1 csrss
  14719      31    23940      32804     587.03  18628   1 ctfmon
    581      23     8624      12344              2276   0 dasHost
     99       6     1020       3956              7028   0 dasHost
    211      13     5084        576       0.20  15356   1 DataExchangeHost
    265      19     4388       7784     682.44  15416   1 ddm
    180       9     1924       1536              3816   0 DDVCollectorSvcApi
PS C:\Users\XXXX>
PS C:\Users\XXXX> Get-Process | Write-IndentedOutput -IndentCount 1
    Handles NPM(K)  PM(K)  WS(K)   CPU(s)    Id SI ProcessName
    ------- ------  -----  -----   ------    -- -- -----------
        169      9   2152   2984           4216  0 AdminService
        136      7   2432   6392           8028  0 AggregatorHost
        277     17   8328   4580           4260  0 AGMService
        509     29  19500  24952     4.58 10104  1 ApplicationFrameHost
        133      8   1624   1944           4208  0 armsvc
        137      9   1320   2272           4224  0 bgsvcg
        468     36  16440   2152     0.22 11624  1 CalculatorApp
         82      6   2428   5400     0.03 13756  1 cmd
        145      7   1636   1864     0.30 14184  1 CompPkgSrv
        192     11   7388  17704     0.20  1360  1 conhost
        163     10   6664   1476           6452  0 conhost
        162     10   6668   1760           6840  0 conhost
        162     10   6668   1788          11256  0 conhost                                          
PS C:\Users\XXXX>
PS C:\Users\XXXX> $result = Get-Process
>> Write-IndentedOutput -InputObject $result -IndentCount 2
        Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                                           
        -------  ------    -----      -----     ------     --  -- -----------                                           
            169       9     2152       3216              4216   0 AdminService                                          
            136       7     2432       6572              8028   0 AggregatorHost                                        
            277      17     8328       5080              4260   0 AGMService                                            
            509      29    20232      23980       4.34  10104   1 ApplicationFrameHost                                  
            133       8     1624       1988              4208   0 armsvc                                                
            137       9     1320       2448              4224   0 bgsvcg                                                
            468      36    16440       2268       0.22  11624   1 CalculatorApp 
```
