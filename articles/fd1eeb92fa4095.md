---
title: "PSSessionã‚’ä½¿ã„ãƒªãƒ¢ãƒ¼ãƒˆæ¥ç¶šã§PowerShell CLIã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•"
emoji: "ğŸ‘"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---
## PowerShell - PSSession
```powershell
PS C:\WINDOWS\system32> New-PSSession -ComputerName XXXX
New-PSSession : [XXXX] ãƒªãƒ¢ãƒ¼ãƒˆ ã‚µãƒ¼ãƒãƒ¼ XXXX ã¸ã®æ¥ç¶šã«å¤±æ•—ã—ã€æ¬¡ã®ã‚¨ãƒ©ãƒ¼ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¿”ã•ã‚Œã¾ã—ãŸ: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³
ãƒˆã¯ã€è¦æ±‚ã§æŒ‡å®šã•ã‚ŒãŸæ¥ç¶šå…ˆã«æ¥ç¶šã§ãã¾ã›ã‚“ã€‚ æ¥ç¶šå…ˆã®ã‚µãƒ¼ãƒ“ã‚¹ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã¦ã€è¦æ±‚ã‚’å—ã‘ä»˜ã‘ã‚‰ã‚Œã‚‹çŠ¶æ…‹ã§ã‚ã‚‹ã“ã¨ã‚’ç¢º
èªã—ã¦ãã ã•ã„ã€‚ æ¥ç¶šå…ˆã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ WS-Management ã‚µãƒ¼ãƒ“ã‚¹ (é€šå¸¸ã¯ IIS ã¾ãŸã¯ WinRM) ã«é–¢ã™ã‚‹ãƒ­ã‚°ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚
ç…§ã—ã¦ãã ã•ã„ã€‚ æ¥ç¶šå…ˆãŒ WinRM ã‚µãƒ¼ãƒ“ã‚¹ã®å ´åˆã¯ã€ãƒªãƒ¢ãƒ¼ãƒˆ ãƒ›ã‚¹ãƒˆä¸Šã§æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€WinRM ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ†æãŠã‚ˆã³
æ§‹æˆã—ã¦ãã ã•ã„: "winrm quickconfig"è©³ç´°ã«ã¤ã„ã¦ã¯ã€about_Remote_Troubleshooting ã®ãƒ˜ãƒ«ãƒ— ãƒˆãƒ”ãƒƒã‚¯ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
ç™ºç”Ÿå ´æ‰€ è¡Œ:1 æ–‡å­—:1
+ New-PSSession -ComputerName XXXX
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : OpenError: (System.Manageme....RemoteRunspace:RemoteRunspace) [New-PSSession], PSRemotin
   gTransportException
    + FullyQualifiedErrorId : CannotConnect,PSSessionOpenFailed
PS C:\WINDOWS\system32>
```

### ä»–ã®PSSessioné–¢é€£ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆ
```powershell:helpã‚³ãƒãƒ³ãƒ‰ã§ä¸€è¦§ã‚’è¡¨ç¤º
PS C:\WINDOWS\system32> help *PSSession

Name                              Category  Module                    Synopsis
----                              --------  ------                    --------
Connect-PSSession                 Cmdlet    Microsoft.PowerShell.Core Reconnects to disconnected sessions.
Disconnect-PSSession              Cmdlet    Microsoft.PowerShell.Core Disconnects from a session.
Enter-PSSession                   Cmdlet    Microsoft.PowerShell.Core Starts an interactive session with a remote co...
Exit-PSSession                    Cmdlet    Microsoft.PowerShell.Core Ends an interactive session with a remote comp...
Get-PSSession                     Cmdlet    Microsoft.PowerShell.Core Gets the PowerShell sessions on local and remo...
New-PSSession                     Cmdlet    Microsoft.PowerShell.Core Creates a persistent connection to a local or ...
Receive-PSSession                 Cmdlet    Microsoft.PowerShell.Core Gets results of commands in disconnected sessions
Remove-PSSession                  Cmdlet    Microsoft.PowerShell.Core Closes one or more PowerShell sessions (PSSess...
Export-PSSession                  Cmdlet    Microsoft.PowerShell.U... Exports commands from another session and save...
Import-PSSession                  Cmdlet    Microsoft.PowerShell.U... Imports commands from another session into the...



PS C:\WINDOWS\system32>
```

## äº‹å‰ã®è¨­å®š
PSSessioné–¢é€£ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ç‚ºã«ã¯æ¥ç¶šå…ƒã¨æ¥ç¶šå…ˆã§è¨­å®šã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
1. PowerShell CLIã‚’ç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œ
1. æ¥ç¶šå…ˆã®è¨­å®š - PSRemothingã®æœ‰åŠ¹åŒ–
    ```powershell
    PS C:\WINDOWS\system32> Enable-PSRemoting -SkipNetworkProfileCheck
    WinRM ã¯è¦æ±‚ã‚’å—ä¿¡ã™ã‚‹ã‚ˆã†ã«æ›´æ–°ã•ã‚Œã¾ã—ãŸã€‚
    WinRM ã‚µãƒ¼ãƒ“ã‚¹ã®ç¨®é¡ã‚’æ­£ã—ãå¤‰æ›´ã§ãã¾ã—ãŸã€‚
    WinRM ã‚µãƒ¼ãƒ“ã‚¹ãŒé–‹å§‹ã•ã‚Œã¾ã—ãŸã€‚

    WinRM ã¯ãƒªãƒ¢ãƒ¼ãƒˆç®¡ç†ç”¨ã«æ›´æ–°ã•ã‚Œã¾ã—ãŸã€‚
    WinRM ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã®ä¾‹å¤–ã‚’æœ‰åŠ¹ã«ã—ã¾ã—ãŸã€‚
    ãƒ­ãƒ¼ã‚«ãƒ« ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒªãƒ¢ãƒ¼ãƒˆã§ç®¡ç†æ¨©é™ã‚’ä»˜ä¸ã™ã‚‹ã‚ˆã† LocalAccountTokenFilterPolicy ã‚’æ§‹æˆã—ã¾ã—ãŸã€‚

    PS C:\WINDOWS\system32>
    PS C:\WINDOWS\system32>
    ```
1. æ¥ç¶šå…ƒã®è¨­å®š - PSRemothingã®æœ‰åŠ¹åŒ–
	ä¸Šè¨˜ã®æ¥ç¶šå…ˆã¨åŒæ§˜ã€ŒEnable-PSRemotingã€ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã€‚
1. æ¥ç¶šå…ƒã®è¨­å®š - ä¿¡é ¼ã§ãã‚‹æ¥ç¶šå…ˆã‚’è¨­å®š
	1. ä½œæ¥­å‰ã®çŠ¶æ…‹
		```powershell
		PS C:\WINDOWS\system32> Get-Item WSMan:\localhost\Client\TrustedHosts


		   WSManConfig: Microsoft.WSMan.Management\WSMan::localhost\Client

		Type            Name                           SourceOfValue   Value
		----            ----                           -------------   -----
		System.String   TrustedHosts


		PS C:\WINDOWS\system32>
		```
	1. æ¥ç¶šå…ˆã‚’æŒ‡å®šã—ã¦è¨±å¯
        ã“ã®æ‰‹é †ã§ã¯ã€ã“ã¡ã‚‰ã§è¨­å®šã€‚
		- æ¥ç¶šå…ˆã‚’æŒ‡å®šã—ã¦è¨±å¯
			```powershell:æ¥ç¶šå…ˆã‚’æŒ‡å®šã—ã¦è¨±å¯
			PS C:\WINDOWS\system32> Set-Item WSMan:\localhost\Client\TrustedHosts -Value "192.168.XXX.XXX, Windows10.intra.local"

			WinRM ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®æ§‹æˆã€‚
			ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ WinRM ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã® TrustedHosts ã®ä¸€è¦§ã‚’å¤‰æ›´ã—ã¾ã™ã€‚TrustedHosts
			ã®ä¸€è¦§å†…ã«ã‚ã‚‹ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã¯èªè¨¼ã•ã‚Œãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ã“ã‚Œã‚‰ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã«è³‡æ ¼æƒ…å ±ã‚’é€ä¿¡ã™ã‚‹å¯
			èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®ä¸€è¦§ã‚’å¤‰æ›´ã—ã¾ã™ã‹?
			[Y] ã¯ã„(Y)  [N] ã„ã„ãˆ(N)  [S] ä¸­æ–­(S)  [?] ãƒ˜ãƒ«ãƒ— (æ—¢å®šå€¤ã¯ "Y"): y
			PS C:\WINDOWS\system32>
			PS C:\WINDOWS\system32>
			```

            :::details æ¥ç¶šå…ˆã™ã¹ã¦ã‚’è¨±å¯ã™ã‚‹å ´åˆ
            ç‰¹å®šã®æ¥ç¶šå…ˆã§ã¯ãªãå…¨ã¦ã®æ¥ç¶šå…ˆã‚’è¨±å¯ã™ã‚‹å ´åˆã®ã‚³ãƒãƒ³ãƒ‰ã€‚
            ```powershell:æ¥ç¶šå…ˆã™ã¹ã¦ã‚’è¨±å¯ã™ã‚‹å ´åˆ
            PS C:\WINDOWS\system32> Set-Item WSMan:\localhost\Client\TrustedHosts -Value "*"
            ```
            :::

    1. ä½œæ¥­å¾Œã®çŠ¶æ…‹ï¼ˆæ¥ç¶šå…ˆã‚’æŒ‡å®šã—ã¦è¨±å¯ã®å ´åˆï¼‰
        ```powershell
        PS C:\WINDOWS\system32> Get-Item WSMan:\localhost\Client\TrustedHosts


            WSManConfig: Microsoft.WSMan.Management\WSMan::localhost\Client

        Type            Name                           SourceOfValue   Value
        ----            ----                           -------------   -----
        System.String   TrustedHosts                                   192.168.XXX.XXX, Windows10.intra.local


        PS C:\WINDOWS\system32>
        ```
:::details è¨­å®šã‚’åˆ‡ã‚Šæˆ»ã™æ‰‹é †ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
- æ¥ç¶šå…ƒã®è¨­å®šæˆ»ã—
    1. ä½œæ¥­å‰ã®çŠ¶æ…‹
        ```powershell
        PS C:\WINDOWS\system32> Get-Item WSMan:\localhost\Client\Trustedhosts


        WSManConfig: Microsoft.WSMan.Management\WSMan::localhost\Client

        Type            Name                           SourceOfValue   Value
        ----            ----                           -------------   -----
        System.String   TrustedHosts                                   192.168.XXX.XXX, Windows10.intra.local


        PS C:\WINDOWS\system32>
        ```
    1. è¨­å®šã®ã‚¯ãƒªã‚¢ï¼ˆè¨­å®šæˆ»ã—ï¼‰
        ```powershell
        PS C:\WINDOWS\system32> Clear-Item WSMan:\localhost\Client\Trustedhosts

        WinRM ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®æ§‹æˆã€‚
        ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ WinRM ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã® TrustedHosts ã®ä¸€è¦§ã‚’å¤‰æ›´ã—ã¾ã™ã€‚TrustedHosts
        ã®ä¸€è¦§å†…ã«ã‚ã‚‹ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã¯èªè¨¼ã•ã‚Œãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ã“ã‚Œã‚‰ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã«è³‡æ ¼æƒ…å ±ã‚’é€ä¿¡ã™ã‚‹å¯
        èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®ä¸€è¦§ã‚’å¤‰æ›´ã—ã¾ã™ã‹?
        [Y] ã¯ã„(Y)  [N] ã„ã„ãˆ(N)  [S] ä¸­æ–­(S)  [?] ãƒ˜ãƒ«ãƒ— (æ—¢å®šå€¤ã¯ "Y"): y
        PS C:\WINDOWS\system32>
        ```
    1. ä½œæ¥­å¾Œã®çŠ¶æ…‹
        ```powershell
        PS C:\WINDOWS\system32> Get-Item WSMan:\localhost\Client\Trustedhosts


        WSManConfig: Microsoft.WSMan.Management\WSMan::localhost\Client

        Type            Name                           SourceOfValue   Value
        ----            ----                           -------------   -----
        System.String   TrustedHosts


        PS C:\WINDOWS\system32>
        ```
    1. PSRemotingã®ç„¡åŠ¹åŒ–
        ```powershell
        PS C:\WINDOWS\system32> Disable-PSRemoting
        è­¦å‘Š: ã‚»ãƒƒã‚·ãƒ§ãƒ³æ§‹æˆã‚’ç„¡åŠ¹ã«ã—ã¦ã‚‚ã€Enable-PSRemoting ã¾ãŸã¯ Enable-PSSessionConfiguration
        ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã«ã‚ˆã‚‹å¤‰æ›´ãŒã™ã¹ã¦å…ƒã«æˆ»ã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚æ¬¡ã®æ‰‹é †ã«å¾“ã£ã¦ã€æ‰‹å‹•ã§å¤‰æ›´ã‚’å…ƒã«æˆ»ã™å¿…è¦ãŒã‚ã‚‹å¯èƒ½æ€§ãŒã‚
        ã‚Šã¾ã™ã€‚
            1. WinRM ã‚µãƒ¼ãƒ“ã‚¹ã‚’åœæ­¢ã¾ãŸã¯ç„¡åŠ¹ã«ã—ã¾ã™ã€‚
            2. IP ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä½¿ç”¨ã—ã¦è¦æ±‚ã‚’å—ã‘ä»˜ã‘ã‚‹ãƒªã‚¹ãƒŠãƒ¼ã‚’å‰Šé™¤ã—ã¾ã™ã€‚
            3. WS-Management é€šä¿¡ç”¨ã®ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ä¾‹å¤–ã‚’ç„¡åŠ¹ã«ã—ã¾ã™ã€‚
            4. LocalAccountTokenFilterPolicy ã®å€¤ã‚’ 0 ã«æˆ»ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒªãƒ¢ãƒ¼ãƒˆ ã‚¢ã‚¯ã‚»ã‚¹ãŒã“ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã®
        Administrators ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã«åˆ¶é™ã•ã‚Œã¾ã™ã€‚
        PS C:\WINDOWS\system32>
        ```
    - å‚è€ƒæƒ…å ±
        https://4sysops.com/wiki/disable-powershell-remoting-disable-psremoting-winrm-listener-firewall-and-localaccounttokenfilterpolicy/
        https://www.ipentec.com/document/windows-windows-10-add-winrm-trasted-hosts
:::
## PSSessioné–¢é€£ã®ã‚³ãƒãƒ³ãƒ‰

| ã‚³ãƒãƒ³ãƒ‰å | ä½¿ç”¨ç”¨é€” |
| ---- | ---- |
| [Connect-PSSession](https://github.com/MicrosoftDocs/PowerShell-Docs/blob/main/reference/5.1/Microsoft.PowerShell.Core/Connect-PSSession.md) | åˆ‡æ–­ã•ã‚ŒãŸã‚»ãƒƒã‚·ãƒ§ãƒ³ã«å†æ¥ç¶šã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ |
| [Disconnect-PSSession](https://github.com/MicrosoftDocs/PowerShell-Docs/blob/main/reference/5.1/Microsoft.PowerShell.Core/Disconnect-PSSession.md) | ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‹ã‚‰åˆ‡æ–­ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ |
| [Enter-PSSession](https://github.com/MicrosoftDocs/PowerShell-Docs/blob/main/reference/5.1/Microsoft.PowerShell.Core/Enter-PSSession.md) | ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã¨å¯¾è©±å½¢å¼ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ |
| [Exit-PSSession](https://github.com/MicrosoftDocs/PowerShell-Docs/blob/main/reference/5.1/Microsoft.PowerShell.Core/Exit-PSSession.md) | ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã¨å¯¾è©±å½¢å¼ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’çµ‚äº†ã™ã‚‹ |
| [Get-PSSession](https://github.com/MicrosoftDocs/PowerShell-Docs/blob/main/reference/5.1/Microsoft.PowerShell.Core/Get-PSSession.md) | ãƒ­ãƒ¼ã‚«ãƒ«ãŠã‚ˆã³ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ä¸Šã®PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å–å¾—ã™ã‚‹ |
| [New-PSSession](https://github.com/MicrosoftDocs/PowerShell-Docs/blob/main/reference/5.1/Microsoft.PowerShell.Core/New-PSSession.md) | ãƒ­ãƒ¼ã‚«ãƒ«ã¾ãŸã¯ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã¸ã®æ°¸ç¶šçš„ãªã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ |
| [Receive-PSSession](https://github.com/MicrosoftDocs/PowerShell-Docs/blob/main/reference/5.1/Microsoft.PowerShell.Core/Receive-PSSession.md) | åˆ‡æ–­ã•ã‚ŒãŸã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚³ãƒãƒ³ãƒ‰çµæœã‚’å–å¾—ã™ã‚‹ |
| [Remove-PSSession](https://github.com/MicrosoftDocs/PowerShell-Docs/blob/main/reference/5.1/Microsoft.PowerShell.Core/Remove-PSSession.md) | 1ã¤ã¾ãŸã¯è¤‡æ•°ã®PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‰ã˜ã‚‹ |
| [Export-PSSession](https://github.com/MicrosoftDocs/PowerShell-Docs/blob/main/reference/5.1/Microsoft.PowerShell.Utility/Export-PSSession.md) | ä»–ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã€PowerShellãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ä¿å­˜ã™ã‚‹ã€‚ |
| [Import-PSSession](https://github.com/MicrosoftDocs/PowerShell-Docs/blob/main/reference/5.1/Microsoft.PowerShell.Utility/Import-PSSession.md) | ä»–ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã€‚ |

- Connect-PSSession
    åˆ‡æ–­ã•ã‚ŒãŸã‚»ãƒƒã‚·ãƒ§ãƒ³ã«å†æ¥ç¶šã™ã‚‹ã‚³ãƒãƒ³ãƒ‰
- Disconnect-PSSession
    ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‹ã‚‰åˆ‡æ–­ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰
- Enter-PSSession
    ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã¨å¯¾è©±å½¢å¼ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰
    1. æ¥ç¶šå…ˆã«ã¤ãªã’ã‚‹
        ```powershell:Enter-PSSessionã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œ
        PS C:\WINDOWS\system32> Enter-PSSession -ComputerName 192.168.XXX.XXX -Credential "ãƒ¦ãƒ¼ã‚¶ãƒ¼å"
        [192.168.XXX.XXX]: PS D:\ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ>
        ```
        ![](https://storage.googleapis.com/zenn-user-upload/a3e271b0b4ba-20230824.png =600x)
        *ç”»åƒï¼šEnter-PSSessionã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã£ãŸç›´å¾Œã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆèªè¨¼ï¼ˆè³‡æ ¼æƒ…å ±ã®è¦æ±‚ï¼‰ãŒè¡¨ç¤º*

    1. æ¥ç¶šå…ˆã§ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ
        æ¥ç¶šå…ˆã®ä»»æ„ã®å ´æ‰€ã«ç§»å‹•ã—dirã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚
        ```powershell:æ¥ç¶šå…ˆã®C:\Windows\Logsã«ç§»å‹•ï¼†dirã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ
        [192.168.XXX.XXX]: PS D:\ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ> cd C:\Windows\Logs\
        [192.168.XXX.XXX]: PS C:\Windows\Logs>
        [192.168.XXX.XXX]: PS C:\Windows\Logs> dir


            ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: C:\Windows\Logs


        Mode                 LastWriteTime         Length Name
        ----                 -------------         ------ ----
        d-----        2023/08/25     11:12                CBS
        d-----        2022/11/17     10:09                DISM
        d-----        2023/08/28      8:23                DPX
        d---s-        2023/08/10     16:44                MeasuredBoot
        d-----        2023/08/10     16:10                MoSetup
        d-----        2023/08/24     16:21                NetSetup
        d-----        2021/11/25     11:28                Paragon Software
        d-----        2023/08/28      8:23                SIH
        d-----        2023/08/24     13:28                SystemRestore
        d-----        2023/08/28     13:14                waasmedic
        d-----        2023/08/28      8:25                waasmediccapsule
        d-----        2022/09/21     13:30                WindowsBackup
        d-----        2023/08/28     13:35                WindowsUpdate
        d-----        2021/10/13      5:44                WinREAgent
        -a----        2023/08/17      8:30          90031 StorGroupPolicy.log


        [192.168.XXX.XXX]: PS C:\Windows\Logs>
        [192.168.XXX.XXX]: PS C:\Windows\Logs>
        ```

    1. æ¥ç¶šå…ˆã‹ã‚‰æŠœã‘ã‚‹
        ```powershell:exitã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œ
        [192.168.XXX.XXX]: PS C:\Windows\Logs> exit
        PS C:\WINDOWS\system32>
        ```
- Exit-PSSession
    ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã¨å¯¾è©±å½¢å¼ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’çµ‚äº†ã™ã‚‹
- Get-PSSession
    ãƒ­ãƒ¼ã‚«ãƒ«ãŠã‚ˆã³ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ä¸Šã®PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å–å¾—ã™ã‚‹
- New-PSSession
    ãƒ­ãƒ¼ã‚«ãƒ«ã¾ãŸã¯ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã¸ã®æ°¸ç¶šçš„ãªã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ã‚³ãƒãƒ³ãƒ‰
    New-PSSessionã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«ã¾ãŸã¯ãƒªãƒ¢ãƒ¼ãƒˆã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã¸ã®æ°¸ç¶šçš„ãªã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚
    ```powershell:New-PSSession â†’ Remove-PSSession
    PS C:\WINDOWS\system32> New-PSSession -ComputerName 192.168.XXX.XXX -Name TestTask

    Id Name            ComputerName    ComputerType    State         ConfigurationName     Availability
    -- ----            ------------    ------------    -----         -----------------     ------------
    6 TestTask        192.168.XXX.XXX RemoteMachine   Opened        Microsoft.PowerShell     Available


    PS C:\WINDOWS\system32>
    PS C:\WINDOWS\system32> Get-PSSession

    Id Name            ComputerName    ComputerType    State         ConfigurationName     Availability
    -- ----            ------------    ------------    -----         -----------------     ------------
    6 TestTask        192.168.XXX.XXX RemoteMachine   Opened        Microsoft.PowerShell     Available


    PS C:\WINDOWS\system32>
    PS C:\WINDOWS\system32> Remove-PSSession -Name TestTask
    PS C:\WINDOWS\system32>
    PS C:\WINDOWS\system32> Get-PSSession
    PS C:\WINDOWS\system32>
    ```
- Receive-PSSession
    åˆ‡æ–­ã•ã‚ŒãŸã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚³ãƒãƒ³ãƒ‰çµæœã‚’å–å¾—ã™ã‚‹
- Remove-PSSession
    1ã¤ã¾ãŸã¯è¤‡æ•°ã®PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‰ã˜ã‚‹ã€‚
- Export-PSSession
    ä»–ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã€PowerShellãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ä¿å­˜ã™ã‚‹ã€‚
- Import-PSSession
    ä»–ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã€‚

### å‚è€ƒæƒ…å ±
https://github.com/MicrosoftDocs/PowerShell-Docs/tree/main/reference/5.1/Microsoft.PowerShell.Core
https://github.com/MicrosoftDocs/PowerShell-Docs/blob/main/reference/5.1/Microsoft.PowerShell.Utility

## ãã®ä»–ã®å‚è€ƒæƒ…å ±
- Enter-PSSessionã‚’ä½¿ã†ã¾ã§ã®è§£èª¬
    https://www.kayura-se.com/entry/2020/03/30/004146
- Microsoftå…¬å¼ã€ŒPSSessionã«ã¤ã„ã¦ã€
    https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.core/about/about_pssessions?view=powershell-7.3
- Enter-PSSessionã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è‡ªå‹•çš„ã«å…¥åŠ›
    https://yanor.net/wiki/?PowerShell/ãƒªãƒ¢ãƒ¼ãƒˆæ¥ç¶š/Enter-PSSessionã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›ã‚’è‡ªå‹•åŒ–ã™ã‚‹

â˜…è¨­å®šã®è§£é™¤æ–¹æ³•ã‚’ã¾ã¨ã‚ã‚‹ã€‚
