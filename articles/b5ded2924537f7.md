---
title: "ç¾åœ¨ã®ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒAdministratorsã‚°ãƒ«ãƒ¼ãƒ—ã«æ‰€å±ã—ã¦ã„ã‚‹ã‹Boolï¼ˆTrue/Falseï¼‰ã§åˆ¤å®šã™ã‚‹Functionï¼ˆWindows x PowerShellï¼‰"
emoji: "ğŸ‘©â€âš–ï¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["windows", "powershell"]
published: false
---



function Test-AdminMembership {
    param (
        # ç¾åœ¨ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼åã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å–å¾—
        [System.String]$currentUser = "$($env:COMPUTERNAME)\$($env:USERNAME)"
    )
    # Administratorsã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã‚’å–å¾—
    $adminMembers = (Get-LocalGroupMember -Name 'Administrators')

    # ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒAdministratorsã‚°ãƒ«ãƒ¼ãƒ—ã«å«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
    $isAdmin = $adminMembers.Name -contains $currentUser

    return $isAdmin
}

# Functionã‚’å‘¼ã³å‡ºã—ç¾åœ¨ã®ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’åˆ¤å®š
if (Test-AdminMembership) {
    Write-Output "ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œ$($env:USERNAME)ã€ã¯ Administrators ã‚°ãƒ«ãƒ¼ãƒ—ã«æ‰€å±ã—ã¦ã„ã¾ã™ã€‚"
} else {
    Write-Output "ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œ$($env:USERNAME)ã€ã¯ Administrators ã‚°ãƒ«ãƒ¼ãƒ—ã«æ‰€å±ã—ã¦ã„ã¾ã›ã‚“ã€‚"
}

# Functionã‚’å‘¼ã³å‡ºã—æŒ‡å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’åˆ¤å®š
$userName = 'HOMEPC\Ichitaro'
if (Test-AdminMembership $userName) {
    Write-Output "ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œ$userNameã€ã¯ Administrators ã‚°ãƒ«ãƒ¼ãƒ—ã«æ‰€å±ã—ã¦ã„ã¾ã™ã€‚"
} else {
    Write-Output "ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œ$userNameã€ã¯ Administrators ã‚°ãƒ«ãƒ¼ãƒ—ã«æ‰€å±ã—ã¦ã„ã¾ã›ã‚“ã€‚"
}