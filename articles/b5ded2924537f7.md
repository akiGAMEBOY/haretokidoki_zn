---
title: "現在のログインユーザーがAdministratorsグループに所属しているかBool（True/False）で判定するFunction（Windows x PowerShell）"
emoji: "👩‍⚖️"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["windows", "powershell"]
published: false
---



function Test-AdminMembership {
    param (
        # 現在のコンピューター名とユーザー名を取得
        [System.String]$currentUser = "$($env:COMPUTERNAME)\$($env:USERNAME)"
    )
    # Administratorsグループのメンバーを取得
    $adminMembers = (Get-LocalGroupMember -Name 'Administrators')

    # 現在のユーザーがAdministratorsグループに含まれているか確認
    $isAdmin = $adminMembers.Name -contains $currentUser

    return $isAdmin
}

# Functionを呼び出し現在のログインユーザーを判定
if (Test-AdminMembership) {
    Write-Output "現在のユーザー「$($env:USERNAME)」は Administrators グループに所属しています。"
} else {
    Write-Output "現在のユーザー「$($env:USERNAME)」は Administrators グループに所属していません。"
}

# Functionを呼び出し指定のユーザーを判定
$userName = 'HOMEPC\Ichitaro'
if (Test-AdminMembership $userName) {
    Write-Output "現在のユーザー「$userName」は Administrators グループに所属しています。"
} else {
    Write-Output "現在のユーザー「$userName」は Administrators グループに所属していません。"
}