---
title: "UNIXのheadやtailコマンドと同じ事をPowerShellでも実現したい場合"
emoji: "🦖"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["windows", "powershell", "cli"]
published: false
---
## 概要
[こちら](https://zenn.dev/haretokidoki/articles/1b48ced6152648)で紹介したファイルやフォルダーの一覧を確認する際、
更新日付順（降順）に並べ替える方法を調べていたら、先頭行あたりと最終行ふきんを確認するコマンドもあったので、
別記事として投稿。

ちなみにUNIX系だと一覧表示だろうがテキストファイルの中身だろうが、パイプライン（`|`）にheadやtailで実現できますが、
Windows（PowerShell）では、テキストファイルの先頭行や最終行を確認する場合は違うコマンド（`Get-Content`コマンドのオプション）を実行する必要がありました。

https://zenn.dev/haretokidoki/articles/1b48ced6152648

## 環境
```powershell:コピー用
$PSVersionTable
```
```powershell:PowerShellのバージョン
PS C:\Users\XXXX> $PSVersionTable

Name                           Value
----                           -----
PSVersion                      7.3.8
PSEdition                      Core
GitCommitId                    7.3.8
OS                             Microsoft Windows 10.0.19045
Platform                       Win32NT
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0…}
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1
WSManStackVersion              3.0

PS C:\Users\XXXX>
```
## ファイルやフォルダーの参照で対応する方法
### UNIX系“head” = PowerShell“Select-Object -First”
```powershell:コピー用
Get-ChildItem | Select-Object -First 5
```
```powershell:“Select-Object -First”で可能
PS C:\Windows\Logs> Get-ChildItem | Select-Object -First 5

    Directory: C:\Windows\Logs

Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d----          2023/10/24    11:52                CBS
d----          2022/11/17    10:09                DISM
d----          2023/10/20    10:09                DPX
d---s          2023/10/18    15:35                MeasuredBoot
d----          2023/10/12     8:31                MoSetup

PS C:\Windows\Logs>
```

### UNIX系“tail” = PowerShell“Select-Object -Last”
```powershell:コピー用
Get-ChildItem | Select-Object -Last 5
```
```powershell:“Select-Object -Last”で可能
PS C:\Windows\Logs> Get-ChildItem | Select-Object -Last 5

    Directory: C:\Windows\Logs

Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d----          2023/10/23     8:24                waasmediccapsule
d----          2022/09/21    13:30                WindowsBackup
d----          2023/10/24    11:41                WindowsUpdate
d----          2021/10/13     5:44                WinREAgent
-a---          2023/10/18    15:54         100389 StorGroupPolicy.log

PS C:\Windows\Logs>
```
## テキスト形式のファイル内で対応する方法
### UNIX系“head” = PowerShell“-TotalCount 20”
```powershell
PS C:\Windows\Logs> Get-Content StorGroupPolicy.log -TotalCount 20
07/13/2022  0: 8:19.00000860:RegEnumKeyExW failed with (259)

07/13/2022  0: 8:19.00000860:GP object initialized successfully

07/13/2022  0: 8:19.00000891:Deny_All not set for all. Will query other 6 GUIDs

07/13/2022  0: 8:19.00000906:Policy for other GUID is not enabled, status:  1008

07/13/2022  0: 8:19.00000922:Policy for other GUID is not enabled, status:  1008

07/13/2022  0: 8:19.00000938:Policy for other GUID is not enabled, status:  1008

07/13/2022  0: 8:19.00000938:Policy for other GUID is not enabled, status:  1008

07/13/2022  0: 8:19.00000938:Policy for other GUID is not enabled, status:  1008

07/13/2022  0: 9:27.00000577:Deny_All not set for all. Will query other 6 GUIDs

PS C:\Windows\Logs>
```
### UNIX系“tail” = PowerShell“-Tail 20”
```powershell
PS C:\Windows\Logs> Get-Content StorGroupPolicy.log -Tail 20
08/16/2023 23:28:26.00000966:RegEnumKeyExW failed with (259)

08/16/2023 23:28:26.00000966:GP object initialized successfully

08/16/2023 23:28:26.00000982:Deny_All not set for all. Will query other 6 GUIDs

08/16/2023 23:28:26.00000982:Policy for other GUID is not enabled, status:  2

08/16/2023 23:28:26.00000982:Policy for other GUID is not enabled, status:  2

08/16/2023 23:28:26.00000982:Policy for other GUID is not enabled, status:  2

08/16/2023 23:28:26.00000982:Policy for other GUID is not enabled, status:  2

08/16/2023 23:28:26.00000982:Policy for other GUID is not enabled, status:  2

08/16/2023 23:28:26.00000982:Policy for other GUID is not enabled, status:  2

08/16/2023 23:30:26.00000996:Deleted GP object

PS C:\Windows\Logs>
```

## 参考情報
- ファイル・フォルダーの参照
    https://www.gamingdeputy.com/jp/windows/powershell-リスト-ファイルの日付順の並べ替え/	  
- テキストの中身を参照
    https://tex2e.github.io/blog/powershell/Get-Content-TotalCount-Tail

## まとめ
- ファイルやフォルダー参照で実現する場合
    先頭を確認する方法「`Get-ChildItem | Select-Object -First X`」
    先頭を確認する方法「`Get-ChildItem | Select-Object -Last X`」
    - UNIX系“head” = PowerShell“Select-Object -First”
    - UNIX系“tail” = PowerShell“Select-Object -Last”
## テキスト形式のファイル内で実現する場合
### UNIX系“head” = PowerShell“-TotalCount 20”
### UNIX系“tail” = PowerShell“-Tail 20”

## 関連記事
https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
