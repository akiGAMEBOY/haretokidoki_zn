---
title: "[PowerShell]è¾æ›¸ã«ç™»éŒ²ã—ã¦ã‚ã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’æ¤œç´¢ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ"
emoji: "ğŸ’­"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---
## æ¦‚è¦

[ã“ã¡ã‚‰ã®è¨˜äº‹](https://haretokidoki-blog.com/pasocon_powershell-startup/)ã§æ–‡å­—ã ã‘ã‚’è¡¨ç¤ºã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ã„ã€
PowerShellã®ã¯ã˜ã‚æ–¹ã‚’ç´¹ä»‹ã—ã¾ã—ãŸãŒã€ã‚ˆã‚Šå®Ÿè·µã«è¿‘ã„ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ï¼ˆã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼‰ã‚’ä½œæˆã—ã¾ã—ãŸã€‚

ä»Šå›ä½œæˆã—ãŸPowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯è‡ªå‹•ã§Microsoft IMEã®å˜èªè¾æ›¸ã‚’ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã§å‡ºåŠ›ã—ã€æŒ‡å®šã—ãŸã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢ï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯è¤‡æ•°æŒ‡å®šãŒå¯èƒ½ï¼‰ã€‚
ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¯ã«ãƒ’ãƒƒãƒˆã—ãŸä»¶æ•°ã‚’è¡¨ç¤ºã™ã‚‹ã¨ã„ã†å†…å®¹ã§ã™ã€‚

ä»Šå›ã®ã‚³ãƒ¼ãƒ‰ã§ãƒã‚¤ãƒ³ãƒˆã¨ãªã‚‹ã®ã¯ã€GUIã®ãƒ„ãƒ¼ãƒ«ã‚’PowerShellã§ç”»é¢æ“ä½œï¼ˆ[RPA](https://ja.wikipedia.org/wiki/ãƒ­ãƒœãƒ†ã‚£ãƒƒã‚¯ãƒ»ãƒ—ãƒ­ã‚»ã‚¹ãƒ»ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³)ï¼‰ã§ãã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€ŒUI Automationã€ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ç‚¹ã§ã™ã€‚

:::details ç”»é¢æ“ä½œãŒå¯èƒ½ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€ŒUI Automationã€ã‚’ä½¿ç”¨ã—ãŸç†ç”±
è¾æ›¸ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã§å‡ºåŠ›ã§ãã‚‹å”¯ä¸€ã®ãƒ„ãƒ¼ãƒ«ã€ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸ãƒ„ãƒ¼ãƒ«ã€ã‚’ç”»é¢æ“ä½œã™ã‚‹ç‚ºã«ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

è©³ã—ã„çŠ¶æ³ã‚’èª¬æ˜ã™ã‚‹ã¨ã€æ‹¡å¼µå­ãŒã€Œ`*.dic`ã€ã®è¾æ›¸ãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒãƒ³ãƒ‰ã§å‡ºåŠ›ã™ã‚‹æ–¹æ³•ã¯è¦‹ã¤ã‹ã‚Šã¾ã—ãŸãŒã€
dicãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒã‚¤ãƒŠãƒªå½¢å¼ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãªã‚‹ç‚ºã€ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’æ¤œç´¢ã™ã‚‹äº‹ãŒã§ãã¾ã›ã‚“ã€‚
ã•ã‚‰ã«æ·±æ˜ã‚Šã—ã¦èª¿æŸ»ã—ã¾ã—ãŸãŒã€ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡ºåŠ›ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚

ãã“ã§ä»Šå›ã€ç”»é¢æ“ä½œãŒå¯èƒ½ã¨ãªã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€ŒUI Automationã€ã‚’ä½¿ç”¨ã—ã¦â€œãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸ãƒ„ãƒ¼ãƒ«â€ã‚’æ“ä½œã—è¾æ›¸ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã§å‡ºåŠ›ã—ã¾ã—ãŸã€‚
:::

PowerShellã®å§‹ã‚æ–¹ï¼ˆã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ï¼‰ã¨ã—ã¦ã‚‚ã€ã”å‚è€ƒé ‚ã‘ã‚Œã°ã¨æ€ã„ã¾ã™ã€‚
https://haretokidoki-blog.com/pasocon_powershell-startup/

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- PowerShellãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- PowerShellã§è¾æ›¸ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã§å‡ºåŠ›ã—ãŸã„æ–¹
- PowerShellã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€ŒUI Automationã€ã‚’ä½¿ç”¨ã—ã¦ç”»é¢æ“ä½œï¼ˆRPAï¼‰ã—ãŸã„æ–¹

## ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ç´¹ä»‹

ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã‚·ãƒŠãƒªã‚ªã¯ã€å˜èªç™»éŒ²ã‚’å¤§é‡ã«ç™»éŒ²ã—ã¦ã„ã‚‹Windows OSã®ç«¯æœ«ã§æ–°ãŸãªå˜èªã‚’ç™»éŒ²ã™ã‚‹éš›ã€
ã™ã§ã«å˜èªãƒ‡ãƒ¼ã‚¿ã‚’ç™»éŒ²æ¸ˆã¿ã§ã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã—ãŸã„ã¨ãã«ä½¿ç”¨ã™ã‚‹ã¨ã„ã†ã€ã‚·ãƒŠãƒªã‚ªã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚

### ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ 

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool

### ä»•æ§˜

ãƒ—ãƒ­ã‚°ãƒ©ãƒ èµ·å‹•ç”¨ï¼šbatãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®æœ¬ä½“ï¼šps1ãƒ•ã‚¡ã‚¤ãƒ«ã€å€‹åˆ¥ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼šsetup.iniãƒ•ã‚¡ã‚¤ãƒ«ã€
ã®3ã¤ã§æ§‹æˆã•ã‚ŒãŸãƒ—ãƒ­ã‚°ãƒ©ãƒ ã€‚

ãªãŠã€ä¸‹è¨˜6ä»¶ã¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã‚Šå¤‰æ›´å¯èƒ½ã¨ã™ã‚‹

- ä½œæ¥­ç”¨ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼
- æ¤œç´¢ã™ã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰
- å¤§æ–‡å­—å°æ–‡å­—ã®åŒºåˆ¥ã®è¨­å®š
- è‡ªå‹•ãƒ¢ãƒ¼ãƒ‰ã§ã®ã‚ªãƒ³ã‚ªãƒ•
- è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®åå‰
- è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰

#### ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ

##### å‡¦ç†å…¨ä½“

ä¸‹è¨˜ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ æœ¬ä½“ã¨åŒæ§˜ã€‚

##### ãƒ—ãƒ­ã‚°ãƒ©ãƒ æœ¬ä½“

ãƒ•ã‚¡ã‚¤ãƒ«åï¼šMain.ps1

```mermaid
flowchart TB
    A(["é–‹å§‹"]) --- B{"PowerShellç’°å¢ƒãƒã‚§ãƒƒã‚¯"}
    B --> |"Core ï¼† 7.x ä»¥ä¸Š ï¼† Windows OS ã§ã‚ã‚‹"| C["è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿"]
    B --> |"Coreã§ã¯ãªã„ã€ã¾ãŸã¯PowerShell7.x æœªæº€ã€ã¾ãŸã¯Windows OSã§ã¯ãªã„"| X[["å‡¦ç†ä¸­æ–­"]]
    C --- D{"è‡ªå‹•å®Ÿè¡Œãƒ¢ãƒ¼ãƒ‰ãŒã‚ªãƒ•ã‹"}
    D --> |"Yes"| E["å…¥åŠ›å€¤ã‚’ç”»é¢ã§è¨­å®š"]
    D --> |"No"| F{"å…¥åŠ›å€¤ã®æ¤œè¨¼"}
    E --- F
    F --> |"æ¤œè¨¼çµæœï¼šOK"| G{"å®Ÿè¡Œæœ‰ç„¡ã®ç¢ºèª"}
    F --> |"æ¤œè¨¼çµæœï¼šNG"| X
    G --> |"Yesï¼šå®Ÿè¡Œã™ã‚‹"| H["è‡ªå‹•ã§ç”»é¢æ“ä½œï¼šãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã§è¾æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡ºåŠ›"]
    G --> |"No ï¼šå®Ÿè¡Œã—ãªã„"| X[["å‡¦ç†ä¸­æ–­"]]
    H --- I["ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢ã®å®Ÿè¡Œï¼†çµæœè¡¨ç¤º"]
    X --> J
    I --- J(["çµ‚äº†"])
```

#### ç”»é¢ä»•æ§˜

ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆbatãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚’ä½¿ã„PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã€‚
ã“ã®PowerShellã§ã¯[.NET Frameworkã®ãƒ•ã‚©ãƒ¼ãƒ ](https://learn.microsoft.com/ja-jp/powershell/scripting/samples/creating-a-custom-input-box?view=powershell-7.3)ï¼ˆä»¥ä¸‹ã€dotNETãƒ•ã‚©ãƒ¼ãƒ ã¨ç§°ã™ã‚‹ï¼‰ã‚’å‘¼ã³å‡ºã—ã¦ä½¿ç”¨ã—ã¦ãŠã‚Šã€
dotNETãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½¿ã£ãŸãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§æ“ä½œã™ã‚‹ã€‚
ä»–ã«ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®æ“ä½œã§ä¸€æ™‚åœæ­¢ï¼ˆPUASEï¼‰çŠ¶æ…‹ã®ç¢ºèªç”»é¢ã«å¯¾ã—ã€ŒEnterã‚­ãƒ¼ã€ã‚’æŠ¼ã™ã¨å‡¦ç†ãŒç¶šè¡Œã•ã‚Œã‚‹æ“ä½œæ–¹æ³•ãŒã‚ã‚‹ã€‚
https://learn.microsoft.com/ja-jp/powershell/scripting/samples/creating-a-custom-input-box?view=powershell-7.3

#### æ©Ÿèƒ½ä»•æ§˜

// TODO: ã“ã“ã‹ã‚‰

1. åˆæœŸè¨­å®š
    - è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
        - å¯¾è±¡PDFãƒ•ã‚¡ã‚¤ãƒ«å
        - å¯¾è±¡æ¤œç´¢æ–‡å­—åˆ—
1. å¯¾è±¡PDFãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚ˆã‚Šå–å¾—ã—ãŸå¯¾è±¡ã®PDFãƒ•ã‚¡ã‚¤ãƒ«åãŒãƒãƒƒãƒã®èµ·å‹•å ´æ‰€ã¨åŒã˜éšå±¤ã«ã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã€‚
    ãªã„å ´åˆã¯ã€å‡¦ç†ä¸­æ–­ã€‚
1. æŒ‡å®šæ–‡å­—åˆ—ã®æ¤œç´¢
    è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚ˆã‚Šå–å¾—ã—ãŸå¯¾è±¡æ¤œç´¢æ–‡å­—åˆ—ã®æœ‰ç„¡ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã€‚
    ãªã„å ´åˆã¯ã€ç•°å¸¸çµ‚äº†ã¨åˆ¤æ–­ã€‚

#### å…¥å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«

##### å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«

- iniãƒ•ã‚¡ã‚¤ãƒ«

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/setup.ini#L7-L8

##### å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«

ãªã—

### GitHub Repository

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool

#### ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼æ§‹æˆ

```
PowerShell_IMEdictionarySearchTool
â”‚  LICENSE
â”‚  PowerShell_DictionarySearchTool.bat  ãƒ»ãƒ»ãƒ»èµ·å‹•ç”¨ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«
â”‚  README.md
â”‚
â””â”€source
    â”œâ”€icon                            ãƒ»ãƒ»ãƒ»ã‚¢ã‚¤ã‚³ãƒ³ãƒ‡ãƒ¼ã‚¿
    â”‚      shell32-296.ico
    â”‚
    â””â”€powershell
            Main.ps1                    ãƒ»ãƒ»ãƒ»ãƒ—ãƒ­ã‚°ãƒ©ãƒ æœ¬ä½“
            setup.ini                   ãƒ»ãƒ»ãƒ»è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
```

### å‚è€ƒè¨˜äº‹

#### å„iTestSharpã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§å‹•ä½œç¢ºèªã—ãŸçµæœ

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å‹•ä½œæœ‰ç„¡ | å‚™è€ƒ |
| ---- | ---- | ---- |
| 5.5.10 | â—‹ |  |
| 5.5.11 | â—‹ |  |
| 5.5.12 | â—‹ |  |
| 5.5.13 | â—‹ | ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ä½¿ç”¨ |
| 5.5.13.1 | â—‹ |  |
| 5.5.13.2 | Ã— | åŸå› ä¸æ˜ã ãŒå‹•ä½œã—ãªã‹ã£ãŸã€‚ä¸å…·åˆï¼Ÿ |
| 5.5.13.3 | Ã— | åŸå› ä¸æ˜ã ãŒå‹•ä½œã—ãªã‹ã£ãŸã€‚ä¸å…·åˆï¼Ÿ |

#### æµç”¨ã—ãŸã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ 

https://zenn.dev/haretokidoki/articles/a77765dd56f202

#### ãƒ—ãƒ­ã‚°ãƒ©ãƒ ä½œæˆæ™‚ã«å‚è€ƒã«ã—ãŸè¨˜äº‹

- iTextSharp 5.5.13ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
    https://www.nuget.org/packages/iTextSharp/5.5.13
- nupkgãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šå‡ºã™æ–¹æ³•
    https://zenn.dev/haretokidoki/articles/d3ca9fe55ab0c5
- ãƒ†ã‚­ã‚¹ãƒˆåŸ‹ã‚è¾¼ã¿ã®ã‚ã‚‹PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§å‡ºåŠ›ã™ã‚‹æ–¹æ³•
    http://35huyu.seesaa.net/article/446050464.html

- iTextSharpã®æƒ…å ±ãŒã¾ã¨ã¾ã£ã¦ã„ã‚‹ã‚µã‚¤ãƒˆ
    https://codezine.jp/article/detail/462
    https://qiita.com/AWtnb/items/215f77d97b7ea069a06a

- iTextSharpã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹é–¢é€£ã®è¨˜äº‹
    https://nokoshitamono.blogspot.com/2015/09/gplagpl.html
    https://caddiary.com/?p=4426
    https://qiita.com/toshi71/items/bc05d6e15edd645c8f46

- OSSãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã«é–¢ã™ã‚‹è¨˜äº‹
    https://www.tohoho-web.com/ex/license.html
    https://future-architect.github.io/articles/20200821/
    https://coliss.com/articles/build-websites/operation/work/choose-a-license-by-github.html

- GitHubã§ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’è¿½åŠ ã™ã‚‹æ–¹æ³•
    - ãƒªãƒã‚¸ãƒˆãƒªä½œæˆæ™‚ã«ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’è¿½åŠ ã™ã‚‹æ–¹æ³•
        https://qiita.com/shibukk/items/67ad0a5eda5a94e5c032
    - ãƒªãƒã‚¸ãƒˆãƒªä½œæˆå¾Œã«ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’è¿½åŠ ã™ã‚‹æ–¹æ³•
        https://docs.github.com/ja/communities/setting-up-your-project-for-healthy-contributions/adding-a-license-to-a-repository
        https://qiita.com/medi-y-sato/items/c3d5c357ab020290dccc

- iTextSharpä»¥å¤–ã®PDFãŒç·¨é›†å¯èƒ½ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€Œpdfsharpã€ï¼ˆæœªæ¤œè¨¼ï¼‰
    https://plaza.rakuten.co.jp/satocchia/diary/202110220000/?scid=we_blg_pc_lastctgy_3_title
    https://zenn.dev/awtnb/articles/e54718efcd1b5b#pdfsharp

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960





















Select-String "æ–‡å­—åˆ—" å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«å ã«ã‚ˆã‚Šæ¤œç´¢ãã®çµæœã‚’è¡¨ç¤ºã€‚
è¤‡æ•°ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¨è¤‡æ•°ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã€ã¾ãŸã¯ãƒ•ã‚¡ã‚¤ãƒ«ã§æ¤œç´¢ã§ããŸæ–¹ãŒä¾¿åˆ©ã€‚

ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¨å¯¾è±¡ãƒªã‚½ãƒ¼ã‚¹ã‚’1å¯¾1ã§è¨­å®šã™ã‚‹ã¨ã‚ã‹ã‚Šã‚„ã™ã„ã‹ã‚‚ã€‚
å¤§æ–‡å­—å°æ–‡å­—ã®æŒ‡å®šã‚„æ­£è¦è¡¨ç¾ã®ONã‚„OFFãŒã§ãã‚‹ã¨ãŠãã‚‰ãä¾¿åˆ©ã€‚

ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ¤œç´¢ã™ã‚‹éš›ã«ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å«ã‚ã‚‹ã‹å¦ã‹ã‚’è¨­å®šã§ããŸæ–¹ãŒã‚ˆã•ãã†ã€‚
ï¼ˆå€‹äººçš„ã«ã¯ä½¿ã‚ãªã„ãŒã€ä¸€èˆ¬çš„ãªãƒ„ãƒ¼ãƒ«ã«ã¯ã‚ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰

å…ƒã€…ä½•ã‚’ç›®çš„ã¨ã—ãŸarticleã‹åˆ†ã‹ã‚‰ãªããªã£ãŸãŒã€Windowsã®è¾æ›¸ã§ç™»éŒ²æ¸ˆã¿ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹éš›ã®
ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä½œæˆã‚’æ¤œè¨ã—ã¦ã„ãŸã®ã‹ï¼Ÿ

ã‚³ãƒãƒ³ãƒ‰ã§ç™»éŒ²ã—ãŸå˜èªã‚’å‡ºåŠ›ã™ã‚‹æ–¹æ³•ï¼Ÿ

ã‚³ãƒãƒ³ãƒ‰ã§ç™»éŒ²ã™ã‚‹æ–¹æ³•ï¼Ÿ

ã‚³ãƒãƒ³ãƒ‰ã§å‰Šé™¤ã™ã‚‹æ–¹æ³•ï¼Ÿ

- å‚è€ƒæƒ…å ±ï¼šIMEè¾æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ãã®ã‚‚ã®ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã‚„ã‚Šæ–¹
    http://linux-story.seesaa.net/article/472940334.html

```powershell:IMJPUEXCã‚³ãƒãƒ³ãƒ‰
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> C:\Windows\System32\IME\IMEJP\imjpuexc.exe
Microsoft IME Property Command Line Tool (10.0.19041.3636)
Copyright (c) Microsoft Corporation.  All rights reserved.

The Syntax of this command is:

IMJPUEXC [ ADDSYSDICT | CHECKSYSDICT | REMOVESYSDICT | SETKANAINPUT | GETKANAINPUT | SETCUSTOMDICTPATH | GETCUSTOMDICTPATH | FIXCUSTOMDICT | CODEAREAFORCONVERT | SETOKURIGANAOPTION | GETOKURIGANAOPTION | SETKEYTEMPLATE | SETKUTOUTEN | RESET | LOADAUTOTUNEDATA | SAVEAUTOTUNEDATA | REMOVEAUTOTUNEDATA | SETFILTERDICT | GETFILTERDICT | REMOVEFILTERDICT | HELP ]
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

```powershell
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> C:\Windows\System32\IME\IMEJP\IMJPDCT.EXE
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

- UI Automationã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚ã‚‹ã¿ãŸã„
    https://workspacememory.hatenablog.com/entry/2017/06/04/224653

- PowerShell x UI Automationã§å‚è€ƒã«ã—ãŸè¨˜äº‹
    https://sqripts.com/2023/05/11/47993/

    https://masuo.doorblog.jp/archives/51833976.html
    â†’å‚è€ƒã«ãªã‚‹ã¨æ€ã£ã¦ã“ã‚Œã€Œ$notewndw = Get-UiaWindow -Name '*ãƒ¡ãƒ¢å¸³'ã€ã‚’è©¦ã—ãŸãŒãƒ€ãƒ¡ã ã£ãŸã€‚

- Microsoftå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ UI ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
    https://learn.microsoft.com/ja-jp/windows/win32/winauto/entry-uiauto-win32

- UI Automaitionã«ã¯å°†æ¥æ€§ãŒãªã„ã¿ãŸã„
    <https://qiita.com/maohara/items/82afbccdd3ae62c05dd9>

- UIAutomationSpy.exeã«ã¤ã„ã¦
    <http://xoxopigs.com/uiautomation-3>

    Microsoft IME - å˜èªã®ç™»éŒ² ã«ã‚ã‚‹ ã€Œ`ãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸ãƒ„ãƒ¼ãƒ«(T)`ã€ã‚’æŒ‡å®šã—ãŸéš›ã€
    UIAutomationSpy.exeã§å®Ÿéš›ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆãƒœã‚¿ãƒ³ï¼‰ã«ãµã‚Œã¦ã€
    -AutomationId '658'ã§ã‚ã‚‹äº‹ãŒã‚ã‹ã£ãŸã€‚

    ![å®Ÿéš›ã«â€œå˜èªã®ç™»éŒ²â€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ãƒœã‚¿ãƒ³ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸ãƒ„ãƒ¼ãƒ«(T)ã€ã‚’UIAutomationSpy.exeã§ç¢ºèªã—ãŸéš›ã®ç”»é¢](https://storage.googleapis.com/zenn-user-upload/d471f636e993-20231201.png)
    *ç”»åƒï¼šUIAutomationSpy.exe ã§ãƒœã‚¿ãƒ³ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸ãƒ„ãƒ¼ãƒ«ã€ã‚’ç¢ºèªã—ãŸéš›ã®ç”»é¢*

```powershell:ã‚µãƒ³ãƒ—ãƒ«
# Windows PowerShellã§ã‚¢ãƒ—ãƒªã‚’è‡ªå‹•æ“ä½œã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

# UI ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½¿ã†ãŸã‚ã®æº–å‚™
Add-Type -AssemblyName "UIAutomationClient"
Add-Type -AssemblyName "UIAutomationTypes"
$AutomationElement = [System.Windows.Automation.AutomationElement]
$TreeScope = [System.Windows.Automation.TreeScope]
$Condition = [System.Windows.Automation.Condition]
$InvokePattern = [System.Windows.Automation.InvokePattern]
$SendKeys = [System.Windows.Forms.SendKeys]
$Cursor = [System.Windows.Forms.Cursor]

# ãƒã‚¦ã‚¹ã®å·¦ã‚¯ãƒªãƒƒã‚¯æ“ä½œã‚’ãŠã“ãªã†ãŸã‚ã®æº–å‚™
$SendInputSource =@"
using System;
using System.Drawing;
using System.Runtime.InteropServices;
using System.Windows.Forms;

public class MouseClick {
    [StructLayout(LayoutKind.Sequential)]
    struct MOUSEINPUT {
        public int dx;
        public int dy;
        public int mouseData;
        public int dwFlags;
        public int time;
        public IntPtr dwExtraInfo;
    }
    
    [StructLayout(LayoutKind.Sequential)]
    struct INPUT
    {
        public int type;
        public MOUSEINPUT mi;
    }

    [System.Runtime.InteropServices.DllImport("user32.dll")]
    extern static uint SendInput(uint cInputs, INPUT[] pInputs, int cbSize);

    public static void Click() {
        INPUT[] input = new INPUT[2];
        input[0].mi.dwFlags = 0x0002;
        input[1].mi.dwFlags = 0x0004;
        SendInput(2, input, Marshal.SizeOf(input[0]));
    }
}
"@
Add-Type -TypeDefinition $SendInputSource -ReferencedAssemblies System.Windows.Forms, System.Drawing
$MouseClick = [MouseClick]

# è¦ç´ ã‚’å–å¾—ã™ã‚‹é–¢æ•°
function GetElements {
    Param($RootWindowName = $null)
    if ($RootWindowName -eq $null) {
        try {
            return $AutomationElement::RootElement.FindAll($TreeScope::Subtree, $Condition::TrueCondition)
        }
        catch {
            return $null
        }
    }
    else {
        $childrenElements = $AutomationElement::RootElement.FindAll($TreeScope::Children, $Condition::TrueCondition)
        foreach ($element in $childrenElements) {
            if ($element.GetCurrentPropertyValue($AutomationElement::NameProperty) -eq $RootWindowName) {
                return $element.FindAll($TreeScope::Subtree, $Condition::TrueCondition)
            }
        }
            Write-Host "æŒ‡å®šã•ã‚ŒãŸåå‰ '${RootWindowName}' ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚"
    }
    return $null
}

# è¦ç´ ã‚’æ¤œç´¢ã™ã‚‹é–¢æ•°
function FindElement {
    Param($RootWindowName = $null, $PropertyType, $Identifier, $Timeout)
    $startTime = (Get-Date).Ticks
    do {
        foreach ($element in GetElements -RootWindowName $RootWindowName) {
            try {
                if ($element.GetCurrentPropertyValue($AutomationElement::$PropertyType) -eq $Identifier) {
                    return $element
                }
            }
            catch {
                continue
            }
        }
    }
    while (((Get-Date).Ticks - $startTime) -le ($Timeout * 10000))
    throw "æŒ‡å®šã•ã‚ŒãŸè¦ç´  '${Identifier}' ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚"
}

# ã‚¯ãƒªãƒƒã‚¯æ“ä½œã‚’ãŠã“ãªã†é–¢æ•°
function ClickElement {
    Param($RootWindowName = $null, $PropertyType, $Identifier, $Timeout = 5000)
    $startTime = (Get-Date).Ticks
    do {
        $element = FindElement -RootWindowName $RootWindowName -PropertyType $PropertyType -Identifier $Identifier -Timeout $Timeout
        $isEnabled = $element.GetCurrentPropertyValue($AutomationElement::IsEnabledProperty)
        if ($isEnabled -eq "True") { break }
    }
    while (((Get-Date).Ticks - $startTime) -le ($Timeout * 10000))
    if ($isEnabled -ne "True") {
        throw "æŒ‡å®šã•ã‚ŒãŸè¦ç´  '${Identifier}' ãŒæœ‰åŠ¹çŠ¶æ…‹ã«ãªã‚Šã¾ã›ã‚“ã€‚"
    }

    if ($element.GetCurrentPropertyValue($AutomationElement::IsInvokePatternAvailableProperty) -eq "True") {
        $element.GetCurrentPattern($InvokePattern::Pattern).Invoke()
    }
    else {
        # IsInvokePatternAvailablePropertyãŒFalseã®æ™‚ã¯ãƒã‚¦ã‚¹ã‚«ãƒ¼ã‚½ãƒ«ã‚’è¦ç´ ã«ç§»å‹•ã—ã¦å·¦ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹
        $clickablePoint = $element.GetClickablePoint()
        $Cursor::Position = New-Object System.Drawing.Point($clickablePoint.X, $clickablePoint.Y)
        $MouseClick::Click()
    }
}

# ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œã‚’ãŠã“ãªã†é–¢æ•°
function SendKeys {
    Param($RootWindowName = $null, $PropertyType, $Idendifier = $null, $Keys, $Timeout = 5000)
    if ($Idendifier -ne $null) {
        $element = FindElement -RootWindowName $RootWindowName -PropertyType $PropertyType -Identifier $Idendifier -Timeout $Timeout
        $element.SetFocus()
    }
    $SendKeys::SendWait($Keys)
}

# Microsoft Edgeã§Webã‚­ãƒ£ãƒ—ãƒãƒ£ã®ä¿å­˜æ“ä½œã‚’ãŠã“ãªã†é–¢æ•°
function SaveWebCaptureByMicrosoftEdge {
    SendKeys -Keys "^(+S)"
    ClickElement -PropertyType "AutomationIdProperty" -Identifier "view_52561"
    ClickElement -PropertyType "AutomationIdProperty" -Identifier "save_button_id"
    Start-Sleep -Seconds 3
    SendKeys -Keys "{ESCAPE}"
}

# â†“â†“â†“â†“â†“ ã“ã®è¡Œä»¥é™ã«ã‚¢ãƒ—ãƒªã‚’è‡ªå‹•æ“ä½œã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ã â†“â†“â†“â†“â†“
################################################################################
# é›»å“ã‚’è‡ªå‹•æ“ä½œã™ã‚‹
################################################################################

# è¶³ã—ç®—ã™ã‚‹å€¤ã®ç¯„å›²ã‚’è¨­å®šã™ã‚‹
$start = 1
$end = 10

# ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸå¾Œã®å¾…æ©ŸãƒŸãƒªç§’ã‚’è¨­å®šã™ã‚‹
$waitMilliseconds = 300

# é›»å“ã‚¢ãƒ—ãƒªã‚’é–‹å§‹ã™ã‚‹
Start-Process calc -Wait

# é›»å“ã‚¢ãƒ—ãƒªã‚’æ“ä½œã™ã‚‹
foreach ($count in $start..$end) {
    # æ•°å€¤ã‚’1æ¡ãšã¤ã«åˆ†å‰²ã™ã‚‹
    $array = $count.ToString().ToCharArray()

    # é›»å“ã‚¢ãƒ—ãƒªã®æ•°å€¤ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹
    foreach ($number in $array) {
        ClickElement -RootWindowName "é›»å“" -PropertyType "AutomationIdProperty" -Identifier "num${number}Button"
        Start-Sleep -Milliseconds $waitMilliseconds
    }

    # ç¾åœ¨ã®ã‚«ã‚¦ãƒ³ãƒˆã§å‡¦ç†ã‚’åˆ†å²ã™ã‚‹
    if ($count -ne $end) {
        # ç¯„å›²ã®çµ‚ã‚ã‚Šä»¥å¤–ã®æ™‚ã¯[ï¼‹]ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹
        ClickElement -RootWindowName "é›»å“" -PropertyType "AutomationIdProperty" -Identifier "plusButton"
        Start-Sleep -Milliseconds $waitMilliseconds
    }
    else {
        # ç¯„å›²ã®çµ‚ã‚ã‚Šã®æ™‚ã¯[ï¼]ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹
        ClickElement -RootWindowName "é›»å“" -PropertyType "AutomationIdProperty" -Identifier "equalButton"
        Start-Sleep -Milliseconds $waitMilliseconds
    }
}
```

```powershell:è¾æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ã‚’ç¢ºèª
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> C:\Windows\System32\IME\IMEJP\imjpuexc.exe GETCUSTOMDICTPATH
Microsoft IME Property Command Line Tool (10.0.19041.3636)
Copyright (c) Microsoft Corporation.  All rights reserved.

C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"\AppData\Roaming\Microsoft\IME\15.0\IMEJP\UserDict\imjp15cu.dic
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```

PowerShell_DictionarySearchTool

## å‚è€ƒæƒ…å ±

### PowerShellã§TryParseã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•

https://postgresweb.com/powershell-numeric-check