---
title: "PowerShellã®ã‚¸ãƒ£ã‚°é…åˆ—ã¨å¤šæ¬¡å…ƒé…åˆ—ã§ç›¸äº’å¤‰æ›ã™ã‚‹Function"
emoji: "ğŸ”"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

PowerShellã§ã‚¸ãƒ£ã‚°é…åˆ—ã‹ã‚‰å¤šæ¬¡å…ƒé…åˆ—ã«å¤‰æ›ã™ã‚‹Functionã¨ã€ãã®é€†ã®Functionã‚’ä½œæˆã™ã‚‹ã“ã¨ã¯ã€å°‘ã—è¤‡é›‘ã§ã™ãŒã€ä»¥ä¸‹ã®ä¾‹ã‚’å‚è€ƒã«ã—ã¦ã¿ã¦ãã ã•ã„ã€‚

ã¾ãšã€ã‚¸ãƒ£ã‚°é…åˆ—ã‹ã‚‰å¤šæ¬¡å…ƒé…åˆ—ã«å¤‰æ›ã™ã‚‹Functionã§ã™ã€‚

```powershell
Function Convert-JaggedToMultiDimensional($jaggedArray) {
    $maxSubArrayLength = ($jaggedArray | Measure-Object -Property Length -Maximum).Maximum
    $multiDimArray = New-Object 'object[,]' $jaggedArray.Length, $maxSubArrayLength

    for ($i = 0; $i -lt $jaggedArray.Length; $i++) {
        for ($j = 0; $j -lt $jaggedArray[$i].Length; $j++) {
            $multiDimArray[$i, $j] = $jaggedArray[$i][$j]
        }
    }

    return $multiDimArray
}
```

æ¬¡ã«ã€å¤šæ¬¡å…ƒé…åˆ—ã‹ã‚‰ã‚¸ãƒ£ã‚°é…åˆ—ã«å¤‰æ›ã™ã‚‹Functionã§ã™ã€‚

```powershell
Function Convert-MultiDimensionalToJagged($multiDimArray) {
    $jaggedArray = New-Object 'object[]' $multiDimArray.GetLength(0)

    for ($i = 0; $i -lt $multiDimArray.GetLength(0); $i++) {
        $subArray = New-Object 'object[]' $multiDimArray.GetLength(1)
        for ($j = 0; $j -lt $multiDimArray.GetLength(1); $j++) {
            $subArray[$j] = $multiDimArray[$i, $j]
        }
        $jaggedArray[$i] = $subArray -ne $null
    }

    return $jaggedArray
}
```

ã“ã‚Œã‚‰ã®Functionã¯åŸºæœ¬çš„ãªå¤‰æ›ã‚’è¡Œã„ã¾ã™ãŒã€å¤šæ¬¡å…ƒé…åˆ—ã®å„æ¬¡å…ƒã®é•·ã•ãŒç•°ãªã‚‹å ´åˆã‚„ã€nullå€¤ã‚’å«ã‚€å ´åˆãªã©ã€ç‰¹å®šã®ã‚·ãƒŠãƒªã‚ªã«å¿œã˜ã¦èª¿æ•´ãŒå¿…è¦ã«ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ã¾ãŸã€ã“ã‚Œã‚‰ã®ã‚³ãƒ¼ãƒ‰ã¯PowerShellã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚„å®Ÿè¡Œç’°å¢ƒã«ã‚ˆã£ã¦ã¯å‹•ä½œãŒç•°ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€å®Ÿéš›ã®ä½¿ç”¨ç’°å¢ƒã§ã®ãƒ†ã‚¹ãƒˆãŒé‡è¦ã§ã™ã€‚ä½•ã‹ä»–ã«ãŠæ‰‹ä¼ã„ã§ãã‚‹ã“ã¨ãŒã‚ã‚Œã°ã€ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚ğŸ™‚

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
https://zenn.dev/haretokidoki/articles/fb6830f9155de5
