---
title: "PowerShellã®ã‚¸ãƒ£ã‚°é…åˆ—ï¼ˆå¤šæ¬¡å…ƒé…åˆ—ï¼‰ã¨ãƒªãƒ†ãƒ©ãƒ«é…åˆ—ï¼ˆå˜ä¸€æ¬¡å…ƒé…åˆ—ï¼‰ã‚’ç›¸äº’å¤‰æ›ã™ã‚‹Function"
emoji: "ğŸ“‘"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

PowerShellã§ã‚¸ãƒ£ã‚°é…åˆ—ã‚’ãƒªãƒ†ãƒ©ãƒ«é…åˆ—ã«å¤‰æ›ã™ã‚‹Functionã¨ã€ãƒªãƒ†ãƒ©ãƒ«é…åˆ—ã‚’ã‚¸ãƒ£ã‚°é…åˆ—ã«å¤‰æ›ã™ã‚‹Functionã®ã‚³ãƒ¼ãƒ‰ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚

ã¾ãšã€ã‚¸ãƒ£ã‚°é…åˆ—ã‚’ãƒªãƒ†ãƒ©ãƒ«é…åˆ—ã«å¤‰æ›ã™ã‚‹Functionã§ã™ã€‚ã“ã®Functionã¯ã€ã‚¸ãƒ£ã‚°é…åˆ—ã®å„è¦ç´ ãŒé…åˆ—ã§ã‚ã‚‹ã¨ä»®å®šã—ã€ãã‚Œã‚‰ã‚’å˜ä¸€ã®ãƒªãƒ†ãƒ©ãƒ«é…åˆ—ã«çµåˆã—ã¾ã™ã€‚

```powershell
function Convert-JaggedToLiteral {
    param([object[]]$jaggedArray)
    $literalArray = @()
    foreach ($subArray in $jaggedArray) {
        if ($subArray -is [array]) {
            $literalArray += $subArray
        }
    }
    return $literalArray
}
```

æ¬¡ã«ã€ãƒªãƒ†ãƒ©ãƒ«é…åˆ—ã‚’ã‚¸ãƒ£ã‚°é…åˆ—ã«å¤‰æ›ã™ã‚‹Functionã§ã™ã€‚ã“ã®Functionã¯ã€ãƒªãƒ†ãƒ©ãƒ«é…åˆ—ã‚’æŒ‡å®šã•ã‚ŒãŸã‚µã‚¤ã‚ºã®ã‚µãƒ–é…åˆ—ã«åˆ†å‰²ã—ã¦ã‚¸ãƒ£ã‚°é…åˆ—ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã“ã§ã¯ã€ã‚µãƒ–é…åˆ—ã®ã‚µã‚¤ã‚ºã‚’2ã¨ã—ã¦ã„ã¾ã™ãŒã€å¿…è¦ã«å¿œã˜ã¦å¤‰æ›´ã§ãã¾ã™ã€‚

```powershell
function Convert-LiteralToJagged {
    param([object[]]$literalArray, [int]$subArraySize)
    $jaggedArray = @()
    for ($i = 0; $i -lt $literalArray.Length; $i += $subArraySize) {
        $jaggedArray += ,@($literalArray[$i..($i+$subArraySize-1)])
    }
    return $jaggedArray
}
```

ã“ã‚Œã‚‰ã®Functionã¯ã€PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã§é…åˆ—ã®å¤‰æ›ã‚’è¡Œã†éš›ã«å½¹ç«‹ã¡ã¾ã™ã€‚é…åˆ—ã®å†…å®¹ã‚„ã‚µã‚¤ã‚ºã«å¿œã˜ã¦ã€ã“ã‚Œã‚‰ã®ã‚³ãƒ¼ãƒ‰ã‚’é©å®œèª¿æ•´ã—ã¦ãã ã•ã„ã€‚ã¾ãŸã€é…åˆ—æ“ä½œã«é–¢ã™ã‚‹è©³ç´°ãªæƒ…å ±ã¯ã€[Microsoftã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](^2^)ã§ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã•ã‚‰ã«ã€[Stack Overflow](^1^)ã«ã¯ã€å®Ÿéš›ã®å•é¡Œè§£æ±ºã®ä¾‹ãŒå¤šæ•°æŠ•ç¨¿ã•ã‚Œã¦ãŠã‚Šã€å‚è€ƒã«ãªã‚‹ã§ã—ã‚‡ã†ã€‚

ã‚½ãƒ¼ã‚¹: Copilot ã¨ã®ä¼šè©±ã€ 2024/6/11
(1) é…åˆ—ã«ã¤ã„ã¦çŸ¥ã‚ŠãŸã‹ã£ãŸã“ã¨ã®ã™ã¹ã¦ - PowerShell | Microsoft .... https://learn.microsoft.com/ja-jp/powershell/scripting/learn/deep-dives/everything-about-arrays?view=powershell-7.4.
(2) Powershell Multidimensional Arrays - Stack Overflow. https://stackoverflow.com/questions/9397137/powershell-multidimensional-arrays.
(3) Convert string to int array in PowerShell - Stack Overflow. https://stackoverflow.com/questions/22925598/convert-string-to-int-array-in-powershell.
(4) PowerShell: How do I convert an array object to a string in .... https://stackoverflow.com/questions/7723584/powershell-how-do-i-convert-an-array-object-to-a-string-in-powershell.
(5) powershell - Creating a Jagged\Multidimensional array with a .... https://stackoverflow.com/questions/39799562/creating-a-jagged-multidimensional-array-with-a-single-array-inside-of-it.
(6) Create a Jagged or Multidimensional Array - PowerShell .... http://www.powershellcookbook.com/recipe/dzYA/create-a-jagged-or-multidimensional-array.
