---
title: "PowerShellのジャグ配列（多次元配列）とリテラル配列（単一次元配列）を相互変換するFunction"
emoji: "📑"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["powershell"]
published: false
---

PowerShellでジャグ配列をリテラル配列に変換するFunctionと、リテラル配列をジャグ配列に変換するFunctionのコード例を以下に示します。

まず、ジャグ配列をリテラル配列に変換するFunctionです。このFunctionは、ジャグ配列の各要素が配列であると仮定し、それらを単一のリテラル配列に結合します。

```powershell
function Convert-JaggedToLiteral {
    param([object[]]$jaggedArray)
    $literalArray = @()
    foreach ($subArray in $jaggedArray) {
        if ($subArray -is [array]) {
            $literalArray += $subArray
        }
    }
    return $literalArray
}
```

次に、リテラル配列をジャグ配列に変換するFunctionです。このFunctionは、リテラル配列を指定されたサイズのサブ配列に分割してジャグ配列を作成します。ここでは、サブ配列のサイズを2としていますが、必要に応じて変更できます。

```powershell
function Convert-LiteralToJagged {
    param([object[]]$literalArray, [int]$subArraySize)
    $jaggedArray = @()
    for ($i = 0; $i -lt $literalArray.Length; $i += $subArraySize) {
        $jaggedArray += ,@($literalArray[$i..($i+$subArraySize-1)])
    }
    return $jaggedArray
}
```

これらのFunctionは、PowerShellスクリプト内で配列の変換を行う際に役立ちます。配列の内容やサイズに応じて、これらのコードを適宜調整してください。また、配列操作に関する詳細な情報は、[Microsoftの公式ドキュメント](^2^)で確認することができます。さらに、[Stack Overflow](^1^)には、実際の問題解決の例が多数投稿されており、参考になるでしょう。

ソース: Copilot との会話、 2024/6/11
(1) 配列について知りたかったことのすべて - PowerShell | Microsoft .... https://learn.microsoft.com/ja-jp/powershell/scripting/learn/deep-dives/everything-about-arrays?view=powershell-7.4.
(2) Powershell Multidimensional Arrays - Stack Overflow. https://stackoverflow.com/questions/9397137/powershell-multidimensional-arrays.
(3) Convert string to int array in PowerShell - Stack Overflow. https://stackoverflow.com/questions/22925598/convert-string-to-int-array-in-powershell.
(4) PowerShell: How do I convert an array object to a string in .... https://stackoverflow.com/questions/7723584/powershell-how-do-i-convert-an-array-object-to-a-string-in-powershell.
(5) powershell - Creating a Jagged\Multidimensional array with a .... https://stackoverflow.com/questions/39799562/creating-a-jagged-multidimensional-array-with-a-single-array-inside-of-it.
(6) Create a Jagged or Multidimensional Array - PowerShell .... http://www.powershellcookbook.com/recipe/dzYA/create-a-jagged-or-multidimensional-array.
