---
title: "PowerShellã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®ãƒ‘ã‚¹ã‚’å–å¾—ã™ã‚‹æ–¹æ³•"
emoji: "ğŸ“‚"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: true
---
## æ¦‚è¦
ã€Œ[PowerShell + ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ + ãƒ‘ã‚¹ + å–å¾—](https://www.google.com/search?q=PowerShell+ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰+ãƒ‘ã‚¹+å–å¾—&oq=PowerShell+ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰+ãƒ‘ã‚¹+å–å¾—&aqs=edge..69i57j0i546l2j69i60.5481j0j1&sourceid=chrome&ie=UTF-8)ã€ã§æ¤œç´¢ã—ã¦ã€
ä¸Šä½ã«è¡¨ç¤ºã•ã‚ŒãŸ[ã“ã¡ã‚‰ã®è¨˜äº‹](https://mtgpowershell.blogspot.com/2014/02/blog-post.html)ã§ã™ãŒã€
2023å¹´3æœˆç¾åœ¨ã€ç§ã®ç’°å¢ƒã§ã¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®ãƒ‘ã‚¹ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚

æ·±æ˜ã‚Šã—ãŸçµæœã€**å–å¾—ã§ãã‚‹æ–¹æ³•ã‚’è¦‹ã¤ã‘ãŸ**ã®ã§ç´¹ä»‹ã—ã¾ã™ã€‚
### å‚è€ƒè¨˜äº‹ï¼šå–å¾—ã§ããªã‹ã£ãŸæ–¹æ³•
https://mtgpowershell.blogspot.com/2014/02/blog-post.html
:::details å–å¾—ã§ããªã‹ã£ãŸæ–¹æ³•ã®ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
IEï¼ˆInternet Explorerï¼‰ã®ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚’ä½¿ã„å–å¾—ã§ãã¦ã„ãŸã‚ˆã†ã§ã™ãŒã€
ç¾åœ¨ã¯ã‚µãƒãƒ¼ãƒˆå¯¾è±¡å¤–ã¨ãªã£ãŸç‚ºã‹å–å¾—ã§ããªããªã£ã¦ã„ã¾ã™ã€‚
```powershell:è¨˜äº‹ã®æ–¹æ³•ã ã¨å–å¾—ä¸å¯
PS C:\Windows> $ieRegKey = "hkcu:\Software\Microsoft\Internet Explorer\Main"
PS C:\Windows> (get-itemproperty $ieRegKey)."Default Download Directory"
PS C:\Windows>
```
```powershell:get-itempropertyã‚³ãƒãƒ³ãƒ‰ã§å…¨ã¦è¡¨ç¤ºã™ã‚‹ã‚‚"Default Download Directory"ãŒãªã„
PS C:\Windows> $ieRegKey = "hkcu:\Software\Microsoft\Internet Explorer\Main"
PS C:\Windows> get-itemproperty $ieRegKey


Anchor Underline                                                                                 : yes
Cache_Update_Frequency                                                                           : yes
Disable Script Debugger                                                                          : yes
DisableScriptDebuggerIE                                                                          : yes
Display Inline Images                                                                            : yes
Do404Search                                                                                      : {1, 0, 0, 0}
Local Page                                                                                       : %11%\blank.htm
Save_Session_History_On_Exit                                                                     : no
Search Page                                                                                      : http://go.microsoft.
                                                                                                   com/fwlink/?LinkId=5
                                                                                                   4896
Show_FullURL                                                                                     : no
Show_StatusBar                                                                                   : yes
Show_ToolBar                                                                                     : yes
Show_URLinStatusBar                                                                              : yes
Show_URLToolBar                                                                                  : yes
Use_DlgBox_Colors                                                                                : yes
UseClearType                                                                                     : no
XMLHTTP                                                                                          : 1
Enable Browser Extensions                                                                        : yes
Play_Background_Sounds                                                                           : yes
Play_Animations                                                                                  : yes
Start Page                                                                                       : http://192.168.130.3
                                                                                                   4/wordpress/
Default_Page_URL                                                                                 : http://dell17win10.m
                                                                                                   sn.com/?pc=DCTE
OperationalData                                                                                  : 525
CompatibilityFlags                                                                               : 0
SearchBandMigrationVersion                                                                       : 1
FullScreen                                                                                       : no
Window_Placement                                                                                 : {44, 0, 0, 0...}
ImageStoreRandomFolder                                                                           : 6j0ghie
Start Page_TIMESTAMP                                                                             : {226, 50, 203, 192..
                                                                                                   .}
SyncHomePage Protected - It is a violation of Windows Policy to modify. See aka.ms/browserpolicy : {1, 0, 0, 0...}
IE10RunOnceLastShown                                                                             : 1
IE10RunOnceLastShown_TIMESTAMP                                                                   : {23, 69, 93, 161...}
DownloadWindowPlacement                                                                          : {44, 0, 0, 0...}
UseSWRender                                                                                      : 1
IE10RunOncePerInstallCompleted                                                                   : 1
IE10RunOnceCompletionTime                                                                        : {46, 141, 103, 100..
                                                                                                   .}
News Feed First Run Experience                                                                   : 0
SuppressScriptDebuggerDialog                                                                     : 0
AutoHide                                                                                         : yes
Use FormSuggest                                                                                  : no
IE10TourShown                                                                                    : 1
IE10TourShownTime                                                                                : {46, 141, 103, 100..
                                                                                                   .}
IE11EdgeNotifyTime                                                                               : {253, 131, 118, 252.
                                                                                                   ..}
EdgeReminderRemainingCount                                                                       : 1
IE11DefaultsFREConfigUpdateTimestamp                                                             : {46, 161, 54, 25...}
IE11DefaultsFRECompletionTime                                                                    : {46, 161, 54, 25...}
IE11DefaultsFREGPOFileOptions                                                                    : 0
IE11DefaultsFREGPOFileCheck                                                                      : 1
IE11DefaultsFREGPOCheckTimestamp                                                                 : {232, 166, 246, 137.
                                                                                                   ..}
IE11DefaultsFREOfferInterval                                                                     : 365
IE11DefaultsFREOfferType                                                                         : 1
IE11DefaultsFREMaxOfferShowCount                                                                 : 1
IE11DefaultsFRECurrentOfferShowCount                                                             : 0
IEAppEolNotificationLastShownTimeStamp                                                           : {235, 183, 128, 139.
                                                                                                   ..}
PSPath                                                                                           : Microsoft.PowerShell
                                                                                                   .Core\Registry::HKEY
                                                                                                   _CURRENT_USER\Softwa
                                                                                                   re\Microsoft\Interne
                                                                                                   t Explorer\Main
PSParentPath                                                                                     : Microsoft.PowerShell
                                                                                                   .Core\Registry::HKEY
                                                                                                   _CURRENT_USER\Softwa
                                                                                                   re\Microsoft\Interne
                                                                                                   t Explorer
PSChildName                                                                                      : Main
PSDrive                                                                                          : HKCU
PSProvider                                                                                       : Microsoft.PowerShell
                                                                                                   .Core\Registry



PS C:\Windows>
```
:::
## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
- PowerShellã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ«ãƒ€â€•ã®ãƒ‘ã‚¹ã‚’å–å¾—ã—ãŸã„æ–¹
## å®Ÿè¡Œç’°å¢ƒ
### Windowsç’°å¢ƒ
Windows 10 Pro ç’°å¢ƒ
```powershell:Get-WmiObjectã‚³ãƒãƒ³ãƒ‰
PS C:\Windows> Get-WmiObject Win32_OperatingSystem


SystemDirectory : C:\WINDOWS\system32
Organization    :
BuildNumber     : 19045
RegisteredUser  : XXXXX                     # ãƒã‚¹ã‚¯
SerialNumber    : 00000-00000-00000-AAAAA   # ãƒã‚¹ã‚¯
Version         : 10.0.19045
```
#### å‚è€ƒè¨˜äº‹ï¼šPowerShellã§Windowsãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•
https://macruby.info/powershell/powershell-os-version.html
### PowerShellç’°å¢ƒ
```powershell:$PSVersionTableã‚³ãƒãƒ³ãƒ‰
PS C:\Windows> $PSVersionTable

Name                           Value
----                           -----
PSVersion                      5.1.19041.2673
PSEdition                      Desktop
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}
BuildVersion                   10.0.19041.2673
CLRVersion                     4.0.30319.42000
WSManStackVersion              3.0
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1
```
## å¯¾å¿œæ–¹æ³•
Shell.Applicationã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å‚ç…§ã—ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®ãƒ‘ã‚¹ãŒå–å¾—ã§ãã¾ã—ãŸã€‚
ã¡ãªã¿ã«New-Object -ComObjectã¯ã€ŒNew-Object -Comã€ã‚„ã€Œnew-object -comã€ãªã©ã§ã‚‚OKã€‚
```powershell:å–å¾—ã§ããŸæ–¹æ³•
PS C:\Windows> $shellapp = New-Object -ComObject Shell.Application
PS C:\Windows> $shellapp.Namespace("shell:Downloads").Self.Path
D:\Downloads
PS C:\Windows>
```
### å‚è€ƒè¨˜äº‹
ä¸‹è¨˜ã®2ã¤ã®è¨˜äº‹ã‚’çµ„ã¿åˆã‚ã›ã‚‹äº‹ã§å®Ÿç¾ã§ããŸã€‚
https://newpops.hatenadiary.org/entry/20060118/p1
https://www.ka-net.org/blog/?p=10473

### ãã®ä»–ã®å–å¾—å¯èƒ½ãªãƒ‘ã‚¹ä¸€è¦§
:::details Shellã‚³ãƒãƒ³ãƒ‰ä¸€è¦§ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
ã‚³ãƒãƒ³ãƒ‰çµæœã®ä¾‹ã§ã¯ã€ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ`Administrator`ã§ã‚ã‚‹å ´åˆã‚’æƒ³å®šã—ãŸå†…å®¹ã¨ãªã‚‹ã€‚
| å–å¾—ã§ãã‚‹å†…å®¹ | å¼•æ•° | ã‚³ãƒãƒ³ãƒ‰çµæœã®ä¾‹ |
| ---- | ---- | ---- |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ Captures | `shell:Captures` | C:\Users\Administrator\Videos\Captures |
| ãƒ‘ãƒ–ãƒªãƒƒã‚¯ AppData | `shell:Common AppData` | C:\ProgramData |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ AppData | `shell:AppData` | C:\Users\Administrator\AppData\Roaming |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ Local AppData | `shell:Local AppData` | C:\Users\Administrator\AppData\Local |
| ãƒ‘ãƒ–ãƒªãƒƒã‚¯ Desktop | `shell:Common Desktop` | C:\Users\Public\Desktop |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ Desktop | `shell:Desktop` or `shell:ThisPCDesktopFolder` | C:\Users\Administrator\Desktop |
| ãƒ‘ãƒ–ãƒªãƒƒã‚¯ Documents | `shell:Common Documents` | C:\Users\Public\Documents |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ Documents | `shell:Local Documents` or `shell:Personal` | C:\Users\Administrator\Documents |
| ãƒ‘ãƒ–ãƒªãƒƒã‚¯ Programs | `shell:Common Programs` | C:\ProgramData\Microsoft\Windows\Start Menu\Programs |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ Programs | `shell:Programs` | C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs |
| ãƒ‘ãƒ–ãƒªãƒƒã‚¯ Start Menu | `shell:Common Start Menu` | C:\ProgramData\Microsoft\Windows\Start Menu |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ Start Menu | `shell:Start Menu` | C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu |
| ãƒ‘ãƒ–ãƒªãƒƒã‚¯ Startup | `shell:Common Startup` | C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ Startup | `shell:Startup` | C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup |
| ãƒ‘ãƒ–ãƒªãƒƒã‚¯ Templates | `shell:Common Templates` | C:\ProgramData\Microsoft\Windows\Templates |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ Templates | `shell:Templates` | C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Templates |
| ãƒ‘ãƒ–ãƒªãƒƒã‚¯ Downloads | `shell:CommonDownloads` | C:\Users\Public\Downloads |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ Downloads | `shell:Downloads` or `shell:Local Downloads` | C:\Users\Administrator\Downloads |
| ãƒ‘ãƒ–ãƒªãƒƒã‚¯ Music | `shell:CommonMusic` | C:\Users\Public\Music |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ Music | `shell:Local Music` or `shell:My Music` | C:\Users\Administrator\Music |
| ãƒ‘ãƒ–ãƒªãƒƒã‚¯ Pictures | `shell:CommonPictures` | C:\Users\Public\Pictures |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ Pictures | `shell:Local Pictures` or `shell:My Pictures` | C:\Users\Administrator\Pictures |
| ãƒ‘ãƒ–ãƒªãƒƒã‚¯ Video | `shell:CommonVideo` | C:\Users\Public\Videos |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ Video | `shell:Local Videos` or `shell:My Video` | C:\Users\Administrator\Videos |
| Contacts | `shell:Contacts` | C:\Users\Administrator\Contacts |
| Cookie | `shell:Cookies` | C:\Users\Administrator\AppData\Local\Microsoft\Windows\INetCookies |
| Credentials | `shell:CredentialManager` | C:\Users\Administrator\AppData\Roaming\Microsoft\Credentials |
| Crypto | `shell:CryptoKeys` | C:\Users\Administrator\AppData\Roaming\Microsoft\Crypto |
| Favorites | `shell:Favorites` | C:\Users\Administrator\Favorites |
| Fonts | `shell:Fonts` | C:\Windows\Fonts |
| History | `shell:History` | C:\Users\Administrator\AppData\Local\Microsoft\Windows\History |
| Links | `shell:Links` | C:\Users\Administrator\Links |
| LocalAppDataLow | `shell:LocalAppDataLow` | C:\Users\Administrator\AppData\LocalLow |
| OneDrive | `shell:OneDrive` | C:\Users\Administrator\OneDrive |
| ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚©ãƒ«ãƒ€ | `shell:Profile` or `shell:UsersFilesFolder` | C:\Users\Administrator |
| ProgramFiles(64bit) | `shell:ProgramFiles` | C:\Program Files |
| ProgramFiles(32bit) | `shell:ProgramFilesX86` | C:\Program Files (x86) |
| Common Files(64bit) | `shell:ProgramFilesCommon` | C:\Program Files\Common Files |
| Common Files(32bit) | `shell:ProgramFilesCommonX86` | C:\Program Files (x86)\Common Files |
| Public | `shell:Public` | C:\Users\Public |
| ãƒ‘ãƒ–ãƒªãƒƒã‚¯ Libraries | `shell:PublicLibraries` | C:\Users\Public\Libraries |
| Recent | `shell:Recent` | C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Recent |
| Resources | `shell:ResourceDir` | C:\Windows\Resources |
| SavedGames | `shell:SavedGames` | C:\Users\Administrator\Saved Games |
| SavedPictures | `shell:SavedPictures` | C:\Users\Administrator\Pictures\Saved Pictures |
| Searches | `shell:Searches` | C:\Users\Administrator\Searches |
| SearchHistoryFolder | `shell:SearchHistoryFolder` | C:\Users\Administrator\AppData\Local\Microsoft\Windows\ConnectedSearch\History |
| SendTo | `shell:SendTo` | C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\SendTo |
| System32 | `shell:System` | C:\Windows\System32 |
| SystemCertificates | `shell:SystemCertificates` | C:\Users\Administrator\AppData\Roaming\Microsoft\SystemCertificates |
| SystemX86 | `shell:SystemX86` | C:\Windows\SysWOW64 |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ«ãƒ€ | `shell:UserProfiles` | C:\Users |
| UserProgramFiles | `shell:UserProgramFiles` | C:\Users\Administrator\AppData\Local\Programs |
| UserProgramFilesCommon | `shell:UserProgramFilesCommon` | C:\Users\Administrator\AppData\Local\Programs\Common |
| Windowsãƒ•ã‚©ãƒ«ãƒ€ | `shell:Windows` | C:\Windows |
- å‚è€ƒè¨˜äº‹
    https://www.ka-net.org/blog/?p=8432
:::
## ã¾ã¨ã‚
- Windows OSã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ(Shell.Application)ã‚’ä½¿ã†äº‹ã§PowerShellã§ã‚‚å–å¾—ã§ããŸã€‚
