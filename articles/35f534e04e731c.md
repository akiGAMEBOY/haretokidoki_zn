---
title: "Markdown-ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ ã¨ Excelãƒ•ã‚¡ã‚¤ãƒ« ã‚’ç›¸äº’å¤‰æ›ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ"
emoji: "ğŸ‰"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---
èª¿ã¹ãŸé™ã‚Šã€Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã§å®Ÿç¾ã§ããã†ã ãŒã€PowerShellã®ã¿ã§å®Ÿç¾ã§ãã‚‹ã‚“ã ã£ãŸã‚‰ã€
è‡ªä½œFunctionã‚’ä½œæˆã™ã‚‹ã¨ä¾¿åˆ©ãã†ã€‚

Markdownã®è¡¨ã‚’è§£æã—ã¦Excelã«å¤‰æ›ã™ã‚‹ãŸã‚ã®PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€Markdownãƒ•ã‚¡ã‚¤ãƒ«å†…ã®è¡¨ã‚’æ¤œå‡ºã—ã€ãã‚Œã‚’Excelãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›ã—ã¾ã™ã€‚`ImportExcel`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€Excelãƒ•ã‚¡ã‚¤ãƒ«ã®ç”Ÿæˆã‚’è¡Œã„ã¾ã™ã€‚

```powershell
[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12

Find-Module -Name PowerShellGet | Install-Module
Find-Module -Name ImportExcel | Install-Module

# å¿…è¦ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™
Install-Module -Name ImportExcel -Scope CurrentUser

# Markdownãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
$markdownPath = "D:\Downloads\inputMarkdownTable.md"

# Excelãƒ•ã‚¡ã‚¤ãƒ«ã®å‡ºåŠ›ãƒ‘ã‚¹
$excelPath = "D:\Downloads\outputExcelData.xlsx"

# Markdownãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã¾ã™
$markdownContent = Get-Content $markdownPath -Raw

# è¡¨ã‚’è§£æã™ã‚‹é–¢æ•°ã‚’å®šç¾©ã—ã¾ã™
Function Convert-MarkdownTableToExcel {
    param(
        [Parameter(Mandatory=$true)]
        [string]$markdownContent
    )

    # è¡¨ã®é–‹å§‹ã¨çµ‚äº†ã‚’æ¤œå‡ºã™ã‚‹æ­£è¦è¡¨ç¾
    $tableRegex = '(?smi)(^\|.*\|$)+'
    $headerSplitRegex = '^\|?(.*?)\|$'
    $rowSplitRegex = '^\|(.*)\|$'

    # è¡¨ã®å†…å®¹ã‚’æŠ½å‡ºã—ã¾ã™
    $tables = @()
    [regex]::Matches($markdownContent, $tableRegex) | ForEach-Object {
        $tableText = $_.Value

        # ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è§£æã—ã¾ã™
        $header = $null
        $rows = @()

        $tableText -split "`n" | ForEach-Object {
            if ($null -eq $header) {
                $header = $_ -replace $headerSplitRegex, '$1' -split '\|'
            }
            else {
                $row = $_ -replace $rowSplitRegex, '$1' -split '\|'
                if ($row.Count -eq $header.Count) {
                    $rows += ,$row
                }
            }
        }

        # å„è¡Œã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã—ã¾ã™
        $rows | ForEach-Object {
            $rowObject = New-Object psobject
            for ($i = 0; $i -lt $header.Count; $i++) {
                $rowObject | Add-Member -MemberType NoteProperty -Name $header[$i].Trim() -Value $_[$i].Trim()
            }
            $tables += ,$rowObject
        }
    }

    return $tables
}

# è¡¨ã‚’è§£æã—ã¾ã™
$tables = Convert-MarkdownTableToExcel -markdownContent $markdownContent

# Excelãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãå‡ºã—ã¾ã™
$tables | Export-Excel -Path $excelPath
```

ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€Markdownãƒ•ã‚¡ã‚¤ãƒ«å†…ã®è¡¨ã‚’æ¤œå‡ºã—ã€ãã‚Œãã‚Œã®è¡¨ã‚’Excelãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚è¡¨ã®è§£æã¯æ­£è¦è¡¨ç¾ã‚’ä½¿ç”¨ã—ã¦è¡Œã‚ã‚Œã€å„è¡Œã¯é…åˆ—ã«å¤‰æ›ã•ã‚Œã¾ã™ã€‚ãã®å¾Œã€`Export-Excel` ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ã€è§£æã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’Excelãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã—ã¾ã™ã€‚

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹å‰ã«ã€`ImportExcel`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ã¾ãŸã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã¯é©å®œå¤‰æ›´ã—ã¦ãã ã•ã„ã€‚ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯åŸºæœ¬çš„ãªä¾‹ã§ã‚ã‚Šã€å®Ÿéš›ã®Markdownãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹é€ ã«å¿œã˜ã¦ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒå¿…è¦ã«ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ğŸ”§
