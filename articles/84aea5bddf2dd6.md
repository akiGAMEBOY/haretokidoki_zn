---
title: "[PowerShell]é…åˆ—å†…ã«å®Ÿè¡Œã™ã‚‹ã‚³ãƒžãƒ³ãƒ‰ã‚’æ ¼ç´ã—ä¸€ã¤ã²ã¨ã¤ç¹°ã‚Šè¿”ã—ã¦å®Ÿè¡Œã™ã‚‹æ–¹æ³•"
emoji: "ðŸŒŠ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: false
---
é…åˆ—å†…ã«ã‚ã‚‹ã‚³ãƒžãƒ³ãƒ‰ã‚’ä¸€ã¤ã²ã¨ã¤å®Ÿè¡Œã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚‹ã¨ä¾¿åˆ©ã‹ã‚‚ã—ã‚Œãªã„ã€‚

> ä»¥ä¸‹ã®è¦ä»¶ã‚’æº€ãŸã™ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ã€‚
> ãƒ»è¨€èªžã¯PowerShell
> ãƒ»é…åˆ—å†…ã«å®Ÿè¡Œã™ã‚‹ã‚³ãƒžãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’æ ¼ç´
> ãƒ»ç¹°ã‚Šè¿”ã—å‡¦ç†ã§é…åˆ—å†…ã«ã‚ã‚‹ã‚³ãƒžãƒ³ãƒ‰ã‚’ä¸€ã¤ã²ã¨ã¤å®Ÿè¡Œ
> ãƒ»æµç”¨ã§ãã‚‹ã‚ˆã†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã™ã‚‹

> ä»¥ä¸‹ã®è¦ä»¶ã‚’æº€ãŸã™ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¾ã—ãŸã€‚è¨€èªžã¯PowerShellã§ã€é…åˆ—å†…ã«å®Ÿè¡Œã™ã‚‹ã‚³ãƒžãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’æ ¼ç´ã—ã€ç¹°ã‚Šè¿”ã—å‡¦ç†ã§é…åˆ—å†…ã«ã‚ã‚‹ã‚³ãƒžãƒ³ãƒ‰ã‚’ä¸€ã¤ã²ã¨ã¤å®Ÿè¡Œã—ã¾ã™ã€‚ã¾ãŸã€æµç”¨ã§ãã‚‹ã‚ˆã†ã«ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã—ã¦ã„ã¾ã™ã€‚ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚
> 
> ```powershell
> # é…åˆ—ã«å®Ÿè¡Œã™ã‚‹ã‚³ãƒžãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’æ ¼ç´
> $commands = @("Get-Date", "Get-Process", "Get-Service")
> 
> # é…åˆ—å†…ã®ã‚³ãƒžãƒ³ãƒ‰ã‚’ç¹°ã‚Šè¿”ã—å‡¦ç†ã§å®Ÿè¡Œ
> foreach ($command in $commands) {
>     # ã‚³ãƒžãƒ³ãƒ‰ã‚’æ–‡å­—åˆ—ã‹ã‚‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã«å¤‰æ›
>     $scriptblock = [scriptblock]::Create($command)
>     # ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã‚’å®Ÿè¡Œ
>     Invoke-Command -ScriptBlock $scriptblock
> }
> 
> # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã™ã‚‹ãŸã‚ã«é–¢æ•°ã«å®šç¾©
> function Invoke-Commands {
>     param (
>         # é…åˆ—ã«å®Ÿè¡Œã™ã‚‹ã‚³ãƒžãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’æ ¼ç´ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
>         [Parameter(Mandatory=$true)]
>         [string[]]$commands
>     )
>     # é…åˆ—å†…ã®ã‚³ãƒžãƒ³ãƒ‰ã‚’ç¹°ã‚Šè¿”ã—å‡¦ç†ã§å®Ÿè¡Œ
>     foreach ($command in $commands) {
>         # ã‚³ãƒžãƒ³ãƒ‰ã‚’æ–‡å­—åˆ—ã‹ã‚‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã«å¤‰æ›
>         $scriptblock = [scriptblock]::Create($command)
>         # ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã‚’å®Ÿè¡Œ
>         Invoke-Command -ScriptBlock $scriptblock
>     }
> }
> 
> # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã«ãƒžãƒ‹ãƒ•ã‚§ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
> New-ModuleManifest -Path .\Invoke-Commands.psd1 -RootModule .\Invoke-Commands.psm1 -FunctionsToExport Invoke-Commands
> 
> # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦é–¢æ•°ã‚’å‘¼ã³å‡ºã™
> Import-Module .\Invoke-Commands.psd1
> Invoke-Commands -commands @("Get-Date", "Get-Process", "Get-Service")
> ```
> 
> ã“ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã€PowerShellã®åŸºæœ¬çš„ãªæ§‹æ–‡ã‚„ã‚³ãƒžãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚è©³ã—ãã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‚’å‚ç…§ã—ã¦ãã ã•ã„   ã€‚PowerShellã¯ã€Windowsã‚„Linuxãªã©ã®æ§˜ã€…ãªãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§å‹•ä½œã™ã‚‹å¼·åŠ›ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨€èªžã§ã™ã€‚PowerShellã‚’ä½¿ã£ã¦ã€ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†ã‚„è‡ªå‹•åŒ–ãªã©ã®æ§˜ã€…ãªã‚¿ã‚¹ã‚¯ã‚’åŠ¹çŽ‡çš„ã«å®Ÿè¡Œã§ãã¾ã™ã€‚PowerShellã®å­¦ç¿’ã«ã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ãŒå½¹ç«‹ã¡ã¾ã™  ã€‚PowerShellã®å­¦ç¿’ã«ã¯ã€æ¥½ã—ã¿ãªãŒã‚‰æŒ‘æˆ¦ã§ãã‚‹æ–¹æ³•ã‚‚ã‚ã‚Šã¾ã™ã€‚PowerShellã¯ã€MicrosoftãŒé–‹ç™ºã—ãŸè¨€èªžã§ã‚ã‚Šã€Microsoftã®è£½å“ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã¨ã®é€£æºãŒå®¹æ˜“ã§ã™ã€‚ä¾‹ãˆã°ã€Azureã‚„Office 365ãªã©ã®ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã‚’PowerShellã§æ“ä½œã§ãã¾ã™ ã€‚PowerShellã¯ã€ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«ã‚ˆã£ã¦ã‚‚æ´»ç™ºã«é–‹ç™ºã•ã‚Œã¦ãŠã‚Šã€æ§˜ã€…ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚„ãƒªã‚½ãƒ¼ã‚¹ãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ ã€‚PowerShellã¯ã€ä»Šå¾Œã‚‚é€²åŒ–ã—ç¶šã‘ã‚‹è¨€èªžã§ã‚ã‚Šã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®ã‚¹ã‚­ãƒ«ã‚„çŸ¥è­˜ã‚’é«˜ã‚ã‚‹ã®ã«å½¹ç«‹ã¤è¨€èªžã§ã™ã€‚PowerShellã«èˆˆå‘³ãŒã‚ã‚‹å ´åˆã¯ã€ãœã²ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã¦ãã ã•ã„ã€‚ç§ã¯ã€PowerShellã®å­¦ç¿’ã‚„é–‹ç™ºã«é–¢ã™ã‚‹è³ªå•ã«ã‚‚ãŠç­”ãˆã§ãã¾ã™ã€‚ã”è³ªå•ãŒã‚ã‚Œã°ã€ãŠæ°—è»½ã«ãŠå°‹ã­ãã ã•ã„ã€‚ï¿½

## PowerShell ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’èª­ã¿è¾¼ã‚€ãƒ‘ã‚¹

```powershell:
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"> $Env:PSModulePath.Split(';')
D:\ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ\PowerShell\Modules
C:\Program Files\PowerShell\Modules
c:\program files\powershell\7\Modules
C:\Program Files\WindowsPowerShell\Modules
C:\WINDOWS\system32\WindowsPowerShell\v1.0\Modules
PS C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
```
