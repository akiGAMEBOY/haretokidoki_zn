---
title: "[æ—¥æœ¬èªè¨³]Making Wrong Code Look Wrongï¼ˆé–“é•ã£ãŸã‚³ãƒ¼ãƒ‰ã‚’é–“é•ã£ã¦è¦‹ã›ã‚‹ï¼‰- Joel Spolskyæ°"
emoji: "ğŸ£"
type: "idea" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["æ—¥æœ¬èªè¨³", "ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•", "ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³", "ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³"]
published: true
---
ä»¥å‰ã‹ã‚‰[å…ƒè¨˜äº‹](https://www.joelonsoftware.com/2005/05/11/making-wrong-code-look-wrong/)ã‚’ã”å­˜ã˜ã®æ–¹ã‚„ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã«ã¤ã„ã¦å†ä¸‰ã€è­°è«–ã—ãŸæ–¹ãªã©ã¯ã€ä½•ã‚’ã„ã¾ã•ã‚‰ã¨ã„ã†è©±é¡Œã ã¨æ€ã„ã¾ã™ãŒã€
ç§ã¯å…ƒè¨˜äº‹ã‚„ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã«ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ã¨ã„ã†ã‚‚ã®ãŒã‚ã£ãŸã¨ã„ã†äº‹ã‚’æœ€è¿‘ã€çŸ¥ã‚Šã¾ã—ãŸã€‚

åŸæ–‡ã‚’ã—ã£ã‹ã‚Šã¨å­¦ç¿’ã™ã‚‹ç‚ºã€è‰¯ã„æ—¥æœ¬èªè¨³ã®è¨˜äº‹ã‚’æ¢ã—ã¾ã—ãŸãŒã€é ­ã«ã™ã‚“ãªã‚Šå…¥ã£ã¦ãã‚‹ã‚ˆã†ãªè¨˜äº‹ã‚’è¦‹ã¤ã‘ã‚‹äº‹ãŒã§ããªã‹ã£ãŸã®ã§ã€
è‹±èªã®å‹‰å¼·ã‚‚ã‹ã­ã¦è‡ªåˆ†ãªã‚Šã«æ—¥æœ¬èªã«ç¿»è¨³ã—ã¦ã¿ã¾ã—ãŸã€‚

ãªãŠã€æœ¬è¨˜äº‹ã§ç™»å ´ã™ã‚‹Amazonã«é–¢é€£ã™ã‚‹æ›¸ç±ã®ãƒªãƒ³ã‚¯ã¯ã€ã™ã¹ã¦Amazonã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒˆ[^1]ã®ãƒªãƒ³ã‚¯ã¨ãªã‚Šã¾ã™ã€‚
[^1]: Amazonã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒˆã¨ã¯ã€[æˆåŠŸå ±é…¬å‹åºƒå‘Š](https://ja.wikipedia.org/wiki/æˆåŠŸå ±é…¬å‹åºƒå‘Š)ã§ã™ã€‚Amazonã®ã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒˆã¨ã—ã¦ã€å½“ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ(https://zenn.dev/haretokidoki)ã¯ é©æ ¼è²©å£²ã«ã‚ˆã‚Šåå…¥ã‚’å¾—ã¦ã„ã¾ã™ã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
- ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã«ã¤ã„ã¦ã€è©³ã—ãçŸ¥ã‚ŠãŸã„æ–¹
- â€œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³â€ã¨â€œã‚·ã‚¹ãƒ†ãƒ ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³â€ã®é•ã„ã‚’ã—ã£ã‹ã‚Šç†è§£ã—ãŸã„æ–¹
- ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã‚’èª¤ã£ãŸè§£é‡ˆã§æ‚ªã„ã¨æ±ºã‚ã¤ã‘ã¦ã„ã‚‹æ–¹

:::message
**èª­ã‚€å‰ã®æ³¨æ„äº‹é …**

- ç§ã¯è‹±èªã®ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
- èª¤è¨³ã—ãŸå†…å®¹ãŒå«ã¾ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
- å¤§é›‘æŠŠã«ç¿»è¨³ã—ãŸå†…å®¹ã®ç‚ºã€å–ã‚Šæ‰±ã„ã«ã¯ã”æ³¨æ„ãã ã•ã„ã€‚
    ç¿»è¨³æ–¹æ³•ã¯ã€åŸºæœ¬çš„ã«æ©Ÿæ¢°ç¿»è¨³ï¼ˆ[DeepLç¿»è¨³](https://www.deepl.com/translator)ï¼‰ã‚’ä½¿ã„ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ã‚’æ±²ã¿å–ã£ãŸä¸Šã§ã€
    æ–‡ç« ã‚’æ ¡æ­£ã—ã¦ã„ã¾ã™ã€‚
    å‰è¿°ã®ã¨ãŠã‚Šè‹±èªã®ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆã§ã¯ãªãã€ã©ã¡ã‚‰ã‹ã¨ã„ã†ã¨ä¸å¾—æ„ãªç§ãŒé›°å›²æ°—ã§ç¿»è¨³ã—ã¦ã„ã¾ã™ã€‚
    é«˜ã„ç¢ºç‡ã§èª¤è¨³ãŒã‚ã‚‹ã¨æ€ã„ã¾ã™ã®ã§ç¿»è¨³å†…å®¹ã®å–ã‚Šæ‰±ã„ã«ã¯ã”æ³¨æ„ãã ã•ã„ã€‚
- åŸæ–‡ã¨ã¯ç•°ãªã‚‹è¦‹å‡ºã—æ§‹æˆã§ã™ã€‚
    æ—¥æœ¬èªã«ç¿»è¨³ã—ãŸå†…å®¹ã¨åŸæ–‡ã‚’æ¥µåŠ›ã€1ç”»é¢ã«åã‚ãŸã‹ã£ãŸã®ã§ã€ã€Œç¿»è¨³å†…å®¹ã‚’è¨˜è¼‰ â†’ åŸæ–‡ã‚’è¡¨ç¤º â†’ ç¿»è¨³å†…å®¹ã‚’è¨˜è¼‰ â†’ ...ã€ã¨ã„ã†ã‚ˆã†ã«å†…å®¹ã‚’ç¹°ã‚Šè¿”ã™è¨˜äº‹ã®æ§‹æˆã§ã€
    ç¿»è¨³ã—ãŸå†…å®¹ãŒå°é–“åˆ‡ã‚Œã¨ãªã£ã¦ã„ã¾ã™ã€‚ä¾¿å®œä¸Šã€åŸæ–‡ã«ã¯ãªã„ç‹¬è‡ªã®è¦‹å‡ºã—ã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚

:::
## æ¦‚å¿µã‚’å­¦ã¶ã¨ã„ã†ã“ã¨
1983å¹´9æœˆã€ç§ã¯åˆã‚ã¦æœ¬æ ¼çš„ãªä»•äº‹ã«å°±ã„ãŸã€‚ã‚ªãƒ©ãƒ‹ãƒ ã¨ã„ã†ã‚¤ã‚¹ãƒ©ã‚¨ãƒ«ã«ã‚ã‚‹å¤§ããªãƒ‘ãƒ³å·¥å ´ã§åƒãã€èˆªç©ºæ¯è‰¦ã»ã©ã‚‚ã‚ã‚‹å·¨å¤§ãª6ã¤ã®ã‚ªãƒ¼ãƒ–ãƒ³ã§æ¯æ™©10ä¸‡å€‹ã‚‚ã®ãƒ‘ãƒ³ã‚’ä½œã£ã¦ã„ãŸã€‚

åˆã‚ã¦ãƒ‘ãƒ³å·¥å ´ã«å…¥ã£ãŸã¨ãã¯ã€ãã®æƒ¨çŠ¶ãŒä¿¡ã˜ã‚‰ã‚Œãªã‹ã£ãŸã€‚ã‚ªãƒ¼ãƒ–ãƒ³ã®å´é¢ã¯é»„ã°ã¿ã€æ©Ÿæ¢°ã¯éŒ†ã³ã¤ãã€æ²¹ã ã‚‰ã‘ã ã£ãŸã€‚

ã€Œã„ã¤ã‚‚ã“ã‚“ãªã«æ•£ã‚‰ã‹ã£ã¦ã„ã‚‹ã®ã§ã™ã‹ï¼Ÿã€ã¨ç§ã¯å°‹ã­ãŸã€‚

ã€Œãˆï¼Ÿä½•ã®ã“ã¨ã ï¼Ÿã€ã€Œã¡ã‚‡ã†ã©æƒé™¤ãŒçµ‚ã‚ã£ãŸã¨ã“ã‚ã ã€‚ã“ã“æ•°é€±é–“ã§ä¸€ç•ªãã‚Œã„ã ã‚ˆã€‚ã€ã¨ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã¯è¨€ã£ãŸã€‚

ãªã‚“ã¦ã“ã£ãŸã€‚

ãã®æ„å‘³ãŒã‚ã‹ã‚‹ã¾ã§ã€æ¯æœãƒ‘ãƒ³å·¥å ´ã‚’æƒé™¤ã™ã‚‹ã“ã¨æ•°ãƒ¶æœˆã‹ã‹ã£ãŸã€‚ãƒ‘ãƒ³å·¥å ´ã§ã¯ã€æ¸…æ½”ã¨ã¯æ©Ÿæ¢°ã«ç”Ÿåœ°ãŒã¤ã„ã¦ã„ãªã„ã¨ã„ã†ã“ã¨ã€ã‚´ãƒŸç®±ã«ç™ºé…µä¸­ã®ç”Ÿåœ°ãŒãªã„ã“ã¨ã€åºŠã«ç”Ÿåœ°ãŒè½ã¡ã¦ã„ãªã„ã“ã¨ã‚’æ„å‘³ã—ã¦ã„ãŸã€‚

æ¸…æ½”ã¨ã¯ã€ã‚ªãƒ¼ãƒ–ãƒ³ãŒç™½ããã‚Œã„ã§ã‚ã‚‹ã¨ã„ã†æ„å‘³ã§ã¯ãªã‹ã£ãŸã€‚ã‚ªãƒ¼ãƒ–ãƒ³ã«ãƒšãƒ³ã‚­ã‚’å¡—ã‚‹ã®ã¯10å¹´ã”ã¨ã«ã™ã‚‹ã“ã¨ã§ã€æ¯æ—¥ã™ã‚‹ã“ã¨ã§ã¯ãªã„ã€‚æ¸…æ½”ã ã‹ã‚‰ã¨ã„ã£ã¦æ²¹æ±šã‚ŒãŒãªã„ã‚ã‘ã§ã¯ãªã„ã€‚å®Ÿéš›ã€å®šæœŸçš„ã«æ²¹ã‚’å·®ã™å¿…è¦ã®ã‚ã‚‹æ©Ÿæ¢°ã¯ãŸãã•ã‚“ã‚ã‚Šã€è–„ã„ãã‚Œã„ãªæ²¹ã®å±¤ãŒã‚ã‚Œã°ã€ãŸã„ã¦ã„ã¯æ´—æµ„ã•ã‚ŒãŸã°ã‹ã‚Šã®æ©Ÿæ¢°ã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ãŸã€‚

ãƒ‘ãƒ³å·¥å ´ã«ãŠã‘ã‚‹æ¸…æ½”ã¨ã„ã†æ¦‚å¿µã¯ã€å­¦ã°ãªã‘ã‚Œã°ãªã‚‰ãªã„ã‚‚ã®ã ã£ãŸã€‚éƒ¨å¤–è€…ã‹ã‚‰è¦‹ã‚Œã°ã€ãã®åº—ã«å…¥ã£ã¦æ¸…æ½”ã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã™ã‚‹ã“ã¨ã¯ä¸å¯èƒ½ã ã£ãŸã€‚ãƒ‰ã‚¦ãƒ©ã‚¦ãƒ³ãƒ€ãƒ¼ï¼ˆå››è§’ã„ãƒ–ãƒ­ãƒƒã‚¯ã‚’ãƒœãƒ¼ãƒ«çŠ¶ã«ä¸¸ã‚ã‚‹æ©Ÿæ¢°ã€ä¸‹è¨˜ã®å†™çœŸï¼‰ã®å†…é¢ãŒãã‚Œã„ã«å‰Šã‚‰ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã€éƒ¨å¤–è€…ãŒè¦‹ã‚ˆã†ã¨ã¯æ€ã‚ãªã„ã ã‚ã†ã€‚éƒ¨å¤–è€…ãªã‚‰ã€å¤ã„ã‚ªãƒ¼ãƒ–ãƒ³ã®ãƒ‘ãƒãƒ«ãŒå¤‰è‰²ã—ã¦ã„ã‚‹ã“ã¨ã«ã“ã ã‚ã‚‹ã ã‚ã†ã€‚ã—ã‹ã—ã€ãƒ‘ãƒ³è·äººã«ã¨ã£ã¦ã¯ã€ã‚ªãƒ¼ãƒ–ãƒ³ã®å¤–å´ã®å¡—è£…ãŒå°‘ã—é»„è‰²ãå¤‰è‰²ã—å§‹ã‚ã¦ã„ã‚ˆã†ãŒã€æ°—ã«ã™ã‚‹ã“ã¨ã¯ãªã„ã€‚ãƒ‘ãƒ³ã®å‘³ã¯å¤‰ã‚ã‚‰ãªã„ã®ã ã‹ã‚‰ã€‚
![](https://storage.googleapis.com/zenn-user-upload/230a05253f31-20230818.webp)
*å¼•ç”¨ã—ãŸç”»åƒï¼šThis is what a dough rounder looks like.*

ãƒ‘ãƒ³å±‹ã§2ã‚«æœˆã‚‚åƒã‘ã°ã€ãã‚Œã„ã« "è¦‹ã‚‹"æ–¹æ³•ã‚’å­¦ã¶ã“ã¨ãŒã§ããŸã€‚

ã‚³ãƒ¼ãƒ‰ã‚‚åŒã˜ã ã€‚

:::details åŸæ–‡ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
```
Way back in September 1983, I started my first real job, working at Oranim, a big bread factory in Israel that made something like 100,000 loaves of bread every night in six giant ovens the size of aircraft carriers.

The first time I walked into the bakery I couldn't believe what a mess it was. The sides of the ovens were yellowing, machines were rusting, there was grease everywhere.

â€œIs it always this messy?â€ I asked.

â€œWhat? What are you talking about?â€ the manager said. â€œWe just finished cleaning. This is the cleanest it's been in weeks.â€

Oh boy.

It took me a couple of months of cleaning the bakery every morning before I realized what they meant. In the bakery, clean meant no dough on the machines. Clean meant no fermenting dough in the trash. Clean meant no dough on the floors.

Clean did not mean the paint on the ovens was nice and white. Painting the ovens was something you did every decade, not every day. Clean did not mean no grease. In fact there were a lot of machines that needed to be greased or oiled regularly and a thin layer of clean oil was usually a sign of a machine that had just been cleaned.

This is what a dough rounder looks like.The whole concept of clean in the bakery was something you had to learn. To an outsider, it was impossible to walk in and judge whether the place was clean or not. An outsider would never think of looking at the inside surfaces of the dough rounder (a machine that rolls square blocks of dough into balls, shown in the picture at right) to see if they had been scraped clean. An outsider would obsess over the fact that the old oven had discolored panels, because those panels were huge. But a baker couldn't care less whether the paint on the outside of their oven was starting to turn a little yellow. The bread still tasted just as good.

After two months in the bakery, you learned how to â€œseeâ€ clean.

Code is the same way.
```
:::

## ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã®ãã®å…ˆã¸
ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã«ãªã‚ŠãŸã¦ã®é ƒã€ã‚ã‚‹ã„ã¯æ–°ã—ã„è¨€èªã®ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚‚ã†ã¨ã—ãŸã¨ãã€ã™ã¹ã¦ãŒåŒã˜ã‚ˆã†ã«ä¸å¯è§£ã«è¦‹ãˆã‚‹ã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªãã®ã‚‚ã®ã‚’ç†è§£ã™ã‚‹ã¾ã§ã¯ã€æ˜ã‚‰ã‹ãªæ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã§ã•ãˆæ°—ã¥ãã“ã¨ãŒã§ããªã„ã€‚

å­¦ç¿’ã®æœ€åˆã®æ®µéšã§ã¯ã€ç§ãŸã¡ãŒé€šå¸¸â€œã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ»ã‚¹ã‚¿ã‚¤ãƒ«â€ã¨å‘¼ã¶ã‚‚ã®ã‚’èªè­˜ã—å§‹ã‚ã‚‹ã€‚ã¤ã¾ã‚Šã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã®æ¨™æº–ã«æº–æ‹ ã—ã¦ã„ãªã„ã‚³ãƒ¼ãƒ‰ã‚„ã€å¤§æ–‡å­—ã§è¡¨è¨˜ã•ã‚ŒãŸå¤‰ãªå¤‰æ•°ã«æ°—ã¥ãã‚ˆã†ã«ãªã‚‹ã€‚

ã“ã®ã¨ãã‚ãªãŸã¯ã€ã€Œã“ã®ãƒ•ã‚¸ãƒ„ãƒœé‡éƒ[^2]ã€‚ã“ã‚Œã‹ã‚‰ã¯ã€ä¸€è²«ã—ãŸã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ãŒå¿…è¦ã ï¼ã€ã¨è¨€ã„ã€ç¿Œæ—¥ã¯ãƒãƒ¼ãƒ ã®ãŸã‚ã«ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã‚’æ›¸ãä¸Šã’ã€æ¬¡ã®6æ—¥é–“ã¯â€œçœŸã®ä¸­æ‹¬å¼§ã‚¹ã‚¿ã‚¤ãƒ«[^3]â€ã«ã¤ã„ã¦è­°è«–ã€æ¬¡ã®3é€±é–“ã¯å¤ã„ã‚³ãƒ¼ãƒ‰ã‚’â€œçœŸã®ä¸­æ‹¬å¼§ã‚¹ã‚¿ã‚¤ãƒ«â€ã¨ãªã‚‹ã‚ˆã†æ›¸ãç›´ã™ã¨ã€ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã«è¦‹ã¤ã‹ã£ã¦ã—ã¾ã„ã€Œé‡‘ã‚’ç¨¼ã’ãªã„ã“ã¨ã«æ™‚é–“ã‚’è²»ã‚„ã™ãªã€ã¨æ€’é³´ã‚‰ã‚Œã‚‹ã€‚ ãã—ã¦ã€ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ç›´ã™ã¨ãã ã‘å†ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã™ã‚‹ã®ã¯æ‚ªã„ã“ã¨ã§ã¯ãªã„ã¨åˆ¤æ–­ã—ã€â€œçœŸã®ä¸­æ‹¬å¼§ã‚¹ã‚¿ã‚¤ãƒ«â€ãŒç´„åŠåˆ†ã»ã©é€²è¡Œã—ãŸã‚ãŸã‚Šã§ã€ãã‚Œã„ã•ã£ã±ã‚Šç›®çš„ã‚’å¿˜ã‚Œã¦ã—ã¾ã„ã€ã‚ã‚‹æ–‡å­—åˆ—ã‚¯ãƒ©ã‚¹ã‚’åˆ¥ã®æ–‡å­—åˆ—ã‚¯ãƒ©ã‚¹ã«ç½®ãæ›ãˆã‚‹ã‚ˆã†ãªã€é‡‘å„²ã‘ã¨ã¯ã¾ã£ãŸãé–¢ä¿‚ã®ãªã„ã“ã¨ã«å¤¢ä¸­ã«ãªã‚Šå§‹ã‚ã‚‹ã€‚
[^2]: åŸæ–‡ã¯`Blistering Barnacles`ã¨ã‚ã‚Šã‚¸ãƒ§ãƒ¼ã‚¯ã®é¡ã ã¨æ€ã†ãŒæ„å‘³ãŒã‚ã‹ã‚‰ãªã‹ã£ãŸã€‚[ã‚¿ãƒ³ã‚¿ãƒ³ã®å†’é™º - ã‚ã–ã™ã¯æœˆ](https://en.wikipedia.org/wiki/Destination_Moon_(comics))ãŒå…ƒãƒã‚¿ã‹ï¼Ÿï¼ˆ[å‚è€ƒè¨˜äº‹](https://pinomondo.com/tintin-destination-moon/)ï¼‰
[^3]: çœŸã®ä¸­æ‹¬å¼§ã‚¹ã‚¿ã‚¤ãƒ«ã¨ã¯ã€å­—ä¸‹ã’ã‚¹ã‚¿ã‚¤ãƒ«ã®ä¸€ç¨®ã€‚è‹±èªã ã¨[The One True Brace Styleï¼ˆç•¥ã€1TBSï¼‰](https://ja.wikipedia.org/wiki/å­—ä¸‹ã’ã‚¹ã‚¿ã‚¤ãƒ«#1TBS(OTBS))ã€‚

ç‰¹å®šã®ç’°å¢ƒã§ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã“ã¨ã«ç†Ÿç·´ã—ã¦ãã‚‹ã¨ã€ä»–ã®ã“ã¨ãŒè¦‹ãˆã‚‹ã‚ˆã†ã«ãªã£ã¦ãã‚‹ã€‚ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã§ã¯ã€ã¾ã£ãŸãå•é¡Œãªã„ã‚ˆã†ãªã“ã¨ã§ã‚‚ã€ãã‚Œã¯ã‚ãªãŸã‚’ä¸å®‰ã«ã•ã›ã‚‹ã€‚

:::details åŸæ–‡ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
```
When you start out as a beginning programmer or you try to read code in a new language it all looks equally inscrutable. Until you understand the programming language itself you can't even see obvious syntactic errors.

During the first phase of learning, you start to recognize the things that we usually refer to as â€œcoding style.â€ So you start to notice code that doesn't conform to indentation standards and Oddly-Capitalized variables.

It's at this point you typically say, â€œBlistering Barnacles, we've got to get some consistent coding conventions around here!â€ and you spend the next day writing up coding conventions for your team and the next six days arguing about the One True Brace Style and the next three weeks rewriting old code to conform to the One True Brace Style until a manager catches you and screams at you for wasting time on something that can never make money, and you decide that it's not really a bad thing to only reformat code when you revisit it, so you have about half of a True Brace Style and pretty soon you forget all about that and then you can start obsessing about something else irrelevant to making money like replacing one kind of string class with another kind of string class.

As you get more proficient at writing code in a particular environment, you start to learn to see other things. Things that may be perfectly legal and perfectly OK according to the coding convention, but which make you worry.
```
:::

### Cè¨€èªã‚’ä½¿ã£ãŸä¾‹
```c
char* dest, src;
```

ã“ã‚Œã¯é©åˆ‡ãªã‚³ãƒ¼ãƒ‰ã§ã‚ã‚Šã€ã‚ãªãŸã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã«å¾“ã£ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã—ã€æ„å›³ã•ã‚ŒãŸã‚‚ã®ã‹ã‚‚ã—ã‚Œãªã„ã€‚ã—ã‹ã—ã€Cè¨€èªã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã®ã«ååˆ†ãªçµŒé¨“ã‚’ç©ã‚ã°ã€`dest`ã‚’`char`ãƒã‚¤ãƒ³ã‚¿ã¨ã—ã¦å®£è¨€ã—ã¦ã„ã‚‹ä¸€æ–¹ã§ã€`src`ã‚’å˜ãªã‚‹`char`ã¨ã—ã¦å®£è¨€ã—ã¦ã„ã‚‹ã“ã¨ã«æ°—ã¥ãã ã‚ã†ã€‚ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã¡ã‚‡ã£ã¨æ±šã„æ„Ÿã˜ãŒã™ã‚‹ã€‚

:::details åŸæ–‡ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
```
For example, in C:

> char* dest, src;

This is legal code; it may conform to your coding convention, and it may even be what was intended, but when you've had enough experience writing C code, you'll notice that this declares dest as a char pointer while declaring src as merely a char, and even if this might be what you wanted, it probably isn't. That code smells a little bit dirty.
```
:::

### ã•ã‚‰ã«å¾®å¦™ãªä¾‹
```c
if (i != 0)
    foo(i);
```

ä¸Šè¨˜ã®ã‚ˆã†ãªå ´åˆã€ã‚³ãƒ¼ãƒ‰ã¯100ï¼…æ­£ã—ã„ã€‚ã»ã¨ã‚“ã©ã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã«å¾“ã£ã¦ã„ã‚‹ã—ã€ä½•ã®å•é¡Œã‚‚ãªã„ã€‚ã—ã‹ã—ã€ifæ–‡ã®å˜ä¸€ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆæœ¬ä½“ãŒä¸­æ‹¬å¼§ã§å›²ã¾ã‚Œã¦ã„ãªã„ã¨ã„ã†äº‹å®ŸãŒã€ã‚ãªãŸã‚’æ‚©ã¾ã›ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã€‚

```c
if (i != 0)
    bar(i);
    foo(i);
```

ã“ã®ã‚ˆã†ã«ä¸­æ‹¬å¼§ã‚’ä»˜ã‘å¿˜ã‚Œã‚‹ã¨ã€æ„å›³ã›ãš`foo(i)`ã‚’ç„¡æ¡ä»¶ã¨ãªã‚‹ï¼ãã®ãŸã‚ã€ã‚ãªãŸã¯ä¸­æ‹¬å¼§ã§å›²ã¾ã‚Œã¦ã„ãªã„ã‚³ãƒ¼ãƒ‰ã‚„ãƒ–ãƒ­ãƒƒã‚¯ã‚’è¦‹ã‚‹ã¨ã€ã»ã‚“ã¨ã”ãåƒ…ã‹ãªæ°—æŒã¡æ‚ªã•ã‚’æ„Ÿã˜ä¸å®‰å®šã«ãªã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã€‚

:::details åŸæ–‡ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
```
Even more subtle:

> if (i != 0)
>     foo(i);

In this case the code is 100% correct; it conforms to most coding conventions and there's nothing wrong with it, but the fact that the single-statement body of the ifstatement is not enclosed in braces may be bugging you, because you might be thinking in the back of your head, gosh, somebody might insert another line of code there

> if (i != 0)
>     bar(i);
>     foo(i);

â€¦ and forget to add the braces, and thus accidentally make foo(i)unconditional! So when you see blocks of code that aren't in braces, you might sense just a tiny, wee, soupÃ§on of uncleanliness which makes you uneasy.
```
:::

## å•é¡Œã‚’è¦‹ã¤ã‘ã‚„ã™ãã™ã‚‹ç‚ºã®ã‚³ãƒ¼ãƒ‰ã‚’æ„å›³çš„ã«ä½œã‚Šè¾¼ã‚€
ã•ã¦ã€ã“ã“ã¾ã§ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã¨ã—ã¦ã®é”æˆåº¦ã‚’3æ®µéšã«åˆ†ã‘ã¦è¿°ã¹ã¦ããŸã€‚

1. ã‚­ãƒ¬ã‚¤ãªã‚³ãƒ¼ãƒ‰ã¨æ±šã„ã‚³ãƒ¼ãƒ‰ã®åŒºåˆ¥ãŒã¤ã‹ãªã„

2. è¡¨é¢çš„ãªã‚³ãƒ¼ãƒ‰ã®ã‚­ãƒ¬ã‚¤ã•ã‚’è€ƒãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã€ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã«æº–æ‹ ã™ã‚‹ãƒ¬ãƒ™ãƒ«

3. å¥¥åº•ã®å•é¡Œã‚’ã‚ãšã‹ã«æ„Ÿã˜ã‚‹ã‚ˆã†ã«ãªã‚Šã€è©¦è¡ŒéŒ¯èª¤ã—ã¦ã‚³ãƒ¼ãƒ‰ã‚’ç›´ãã†ã¨è©¦ã™

ç§ãŒæœ¬å½“ã«ä¼ãˆãŸã„ã¨æ€ã£ã¦ã„ã‚‹ã®ã¯ã€ã“ã‚Œã‚‰ã‚ˆã‚Šæ›´ã«ã†ãˆã®ãƒ¬ãƒ™ãƒ«ã§ã€

4. å•é¡Œã‚’è¦‹ã¤ã‘ã‚„ã™ãã™ã‚‹ç‚ºã®ã‚³ãƒ¼ãƒ‰ã‚’æ„å›³çš„ã«ä½œã‚Šè¾¼ã‚€äº‹ã§ã€ã‚­ãƒ¬ã‚¤ãªã‚³ãƒ¼ãƒ‰ã¨ãªã‚‹å¯èƒ½æ€§ã‚’é«˜ã‚ã‚‹ã€‚

ã“ã‚Œã“ããŒæœ¬å½“ã®ãƒ—ãƒ­ã€‚å•é¡Œã‚’è¦‹ã¤ã‘ã‚„ã™ãã™ã‚‹ã‚ˆã†ãªè¦ç´„ã‚’ç”Ÿã¿å‡ºã™ã“ã¨ã§ã€å¼·å›ºãªã‚³ãƒ¼ãƒ‰ã‚’ä½œã‚‹ã¨ã„ã†ã“ã¨ã ã€‚

ãã‚Œã§ã¯ã€ã¡ã‚‡ã£ã¨ã—ãŸä¾‹ã‚’ç´¹ä»‹ã—ã¾ã—ã‚‡ã†ã€‚ä¾‹ã§ã¯å¼·å›ºãªã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿã¿å‡ºã™éš›ã«ä½¿ç”¨ã™ã‚‹ä¸€èˆ¬çš„ãªãƒ«ãƒ¼ãƒ«ã§ã™ã€‚
ãŠãã‚‰ãå«Œæ‚ªæ„Ÿã‚’ä¸ãˆã‚‹é¡ã®å†…å®¹ã§ã¯ãªã„ã¨æ€ã„ã¾ã™ãŒã€æœ€çµ‚çš„ã«ã¯ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã®æ“è­·ã«ã¤ãªãŒã‚‹ã§ã—ã‚‡ã†ã€‚
ãã‚Œã¨ã€ç‰¹å®šã®æ¡ä»¶ä¸‹ã«ãŠã‘ã‚‹ä¾‹å¤–ã«å¯¾ã—æ‰¹åˆ¤ãŒã‚ã‚Šã¾ã™ãŒã€ãŠãã‚‰ãã€ã‚ãªãŸã®ç½®ã‹ã‚Œã¦ã„ã‚‹çŠ¶æ³ã¨ã¯ç•°ãªã‚‹ã§ã—ã‚‡ã†ã€‚

ã—ã‹ã—ã€ã‚‚ã—ã‚ãªãŸãŒãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã¯æ‚ªã„ã‚‚ã®ã¨èª¤ä¿¡ã—ã€ä»–ã®æ„è¦‹ãªã©èããŸãã‚‚ãªã„ã¨è€ƒãˆã¦ã„ã‚‹ã®ãªã‚‰ã€
ãƒ­ãƒ¼ãƒªãƒ¼ã®ã¨ã“ã‚ã«ã‚ã‚‹[ç´ æ™´ã‚‰ã—ã„ã‚³ãƒŸãƒƒã‚¯](https://www.neopoleon.com/blog/excel-as-a-database/)ã‚’èª­ã‚ã°ã„ã„ã€‚
ãã“ã§å¤±ã†äº‹ã¯å°‘ãªã„ã§ã—ã‚‡ã†ã€‚

ã‚ãªãŸãŒæ€’ã‚‹å‰ã«çœ ããªã‚Šãã†ãªã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ãŠè¦‹ã›ã—ã‚ˆã†ã€‚
ãã®é€šã‚Šã€‚ã‚ãªãŸãŒã»ã¼çœ ã£ã¦ã„ã‚‹çŠ¶æ…‹ã§ã€ã‚ã¾ã‚ŠæŠµæŠ—ã§ããªã„æ™‚ã«â€œãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•=è‰¯ã„ã€ä¾‹å¤–=æ‚ªã„â€ã¨ã„ã†ã“ã¨ã‚’ã“ã£ãã‚Šã¨æ•™ãˆã‚‹ã‚ˆã€‚

:::details åŸæ–‡ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
```
OK, so far I've mentioned three levels of achievement as a programmer:

1. You don't know clean from unclean.

2. You have a superficial idea of cleanliness, mostly at the level of conformance to coding conventions.

3. You start to smell subtle hints of uncleanliness beneath the surface and they bug you enough to reach out and fix the code.

There's an even higher level, though, which is what I really want to talk about:

4. You deliberately architect your code in such a way that your nose for uncleanliness makes your code more likely to be correct.

This is the real art: making robust code by literally inventing conventions that make errors stand out on the screen.

So now I'll walk you through a little example, and then I'll show you a general rule you can use for inventing these code-robustness conventions, and in the end it will lead to a defense of a certain type of Hungarian Notation, probably not the type that makes people carsick, though, and a criticism of exceptions in certain circumstances, though probably not the kind of circumstances you find yourself in most of the time.

But if you're so convinced that Hungarian Notation is a Bad Thing and that exceptions are the best invention since the chocolate milkshake and you don't even want to hear any other opinions, well, head on over to Rory's and read the excellent comix instead; you probably won't be missing much here anyway; in fact in a minute I'm going to have actual code samples which are likely to put you to sleep even before they get a chance to make you angry. Yep. I think the plan will be to lull you almost completely to sleep and then to sneak the Hungarian=good, Exceptions=bad thing on you when you're sleepy and not really putting up much of a fight.
```
:::

## ä¾‹é¡Œï¼ˆå•é¡Œã‚’è¦‹ã¤ã‘ã‚„ã™ãã™ã‚‹ç‚ºã®ã‚³ãƒ¼ãƒ‰ã‚’æ„å›³çš„ã«ä½œã‚Šè¾¼ã‚€ï¼‰
![](https://storage.googleapis.com/zenn-user-upload/5433d07b8303-20230818.webp)
*å¼•ç”¨ã—ãŸç”»åƒï¼šSomewhere in Umbria*
ã‚ˆã—ã€‚ãã‚Œã§ã¯ä¾‹é¡Œã«å…¥ã‚ã†ã€‚æœ€è¿‘ã€è‹¥è€…ã«æµè¡Œã£ã¦ã„ã‚‹ã‚ˆã†ã ã‹ã‚‰ã€ã¨ã‚ã‚‹ã‚¦ã‚§ãƒ–ãƒ™ãƒ¼ã‚¹ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã—ã¦ã„ã‚‹ã¨ä»®å®šã—ã¾ã—ã‚‡ã†ã€‚

ã‚¯ãƒ­ã‚¹ã‚µã‚¤ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒ†ã‚£ãƒ³ã‚°è„†å¼±æ€§ã€é€šç§°[XSS](https://resources.sei.cmu.edu/library/asset-view.cfm?assetID=496186)ã¨å‘¼ã°ã‚Œã‚‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§ãŒã‚ã‚‹ã€‚ã“ã“ã§ã¯è©³ç´°ã«ã¤ã„ã¦è§¦ã‚Œãªã„ãŒã€ã‚¦ã‚§ãƒ–ãƒ»ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã™ã‚‹éš›ã«çŸ¥ã£ã¦ãŠã‹ãªã‘ã‚Œã°ãªã‚‰ãªã„ã®ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ•ã‚©ãƒ¼ãƒ ã«å…¥åŠ›ã—ãŸæ–‡å­—åˆ—ã‚’ãã®ã¾ã¾åŒã˜å€¤ã§è¿”ã•ãªã„ã‚ˆã†æ³¨æ„ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†ç‚¹ã ã€‚

ä¾‹ãˆã°ã€â€œWhat is your name?â€ã¨ã„ã†ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã‚’æŒã¤ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ãŒã‚ã‚Šã€ãã®ãƒšãƒ¼ã‚¸ã‚’é€ä¿¡ã™ã‚‹ã¨åˆ¥ãƒšãƒ¼ã‚¸ã§â€œHello, Elmer!â€ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã¨ã—ã¾ã™ã€‚ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’â€œElmerâ€ã¨ä»®å®šã—ãŸå ´åˆï¼‰
ã“ã‚Œã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®è„†å¼±æ€§ã¨ãªã‚‹ã€ãªãœãªã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯â€œElmerâ€ã®ä»£ã‚ã‚Šã«ã‚ã‚‰ã‚†ã‚‹æ‚ªæ„ã®ã‚ã‚‹HTMLã‚„JavaScriptã‚’å…¥åŠ›ã™ã‚‹ã“ã¨ã§ã€ãã®JavaScriptãŒæ‚ªã•ã‚’ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã‹ã‚‰ã ã€‚ãã‚Œã§å½¼ã‚‰ï¼ˆå½¼å¥³ã‚‰ï¼‰ã¯ã€Cookieæƒ…å ±ã‚’ç›—ã¿å–ã‚Šâ€œDr. Evil'sâ€[^4]ã®é—‡ã‚µã‚¤ãƒˆã«é€ä¿¡ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
[^4]: ãŠãã‚‰ã[ã‚ªãƒ¼ã‚¹ãƒ†ã‚£ãƒ³ãƒ‘ãƒ¯ãƒ¼ã‚º](https://ja.wikipedia.org/wiki/ã‚ªãƒ¼ã‚¹ãƒ†ã‚£ãƒ³ãƒ»ãƒ‘ãƒ¯ãƒ¼ã‚º)ã«ç™»å ´ã™ã‚‹[Dr.ã‚¤ãƒ¼ãƒ–ãƒ«](https://ja.wikipedia.org/wiki/Dr.ã‚¤ãƒ¼ãƒ–ãƒ«)ã®ã“ã¨ã€‚

### è£œè¶³èª¬æ˜ï¼šXSSã«ã¤ã„ã¦
https://lpeg.info/security/xss.html

:::details åŸæ–‡ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
```
An Example

Right. On with the example. Let's pretend that you're building some kind of a web-based application, since those seem to be all the rage with the kids these days.

Now, there's a security vulnerability called the Cross Site Scripting Vulnerability, a.k.a. XSS. I won't go into the details here: all you have to know is that when you build a web application you have to be careful never to repeat back any strings that the user types into forms.

So for example if you have a web page that says â€œWhat is your name?â€ with an edit box and then submitting that page takes you to another page that says, Hello, Elmer! (assuming the user's name is Elmer), well, that's a security vulnerability, because the user could type in all kinds of weird HTML and JavaScript instead of â€œElmerâ€ and their weird JavaScript could do narsty things, and now those narsty things appear to come from you, so for example they can read cookies that you put there and forward them on to Dr. Evil's evil site.
```
:::
### ç–‘ä¼¼ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹èª¬æ˜
æ“¬ä¼¼ã‚³ãƒ¼ãƒ‰ã§èª¬æ˜ã—ã‚ˆã†ã€‚æƒ³åƒã—ã¦ãã ã•ã„ã€‚

```javascript
s = Request("name")
```

ä¸Šè¨˜ã¯HTMLãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰å…¥åŠ›æƒ…å ±ï¼ˆPOSTå¼•æ•°ï¼‰ã‚’èª­ã¿å–ã‚Šã¾ã™ã€‚ã‚‚ã—ã“ã‚“ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ãŸã®ãªã‚‰ã€

```javascript
Write "Hello, " & Request("name")
```

ä¸Šè¨˜ã®å ´åˆã€ã‚ãªãŸã®ã‚µã‚¤ãƒˆã¯ã™ã§ã«XSSæ”»æ’ƒã«å¯¾ã—ã¦è„†å¼±ã§ã™ã€‚ã“ã‚Œã ã‘ã§åˆè‡´ã—ã¾ã™ã€‚

ã‚³ãƒ”ãƒ¼ã—ãŸæ–‡å­—åˆ—ã‚’HTMLã«è¿”ã™å‰ã«ã€ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã¨ã¯`"`ï¼ˆãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã‚’ `&quot;` ã‚„
`>`ï¼ˆå¤§ãªã‚Šï¼‰ã‚’ `&gt;` ã«ç½®ãæ›ãˆãŸã‚Šã™ã‚‹äº‹ãªã©ã‚’æŒ‡ã—ã¾ã™ã€‚
ã¤ã¾ã‚Šã€

```javascript
Write "Hello, " & Encode(Request("name"))
```

ä¸Šè¨˜ã¯ã€ã¾ã£ãŸãå•é¡ŒãŒã‚ã‚Šã¾ã›ã‚“ã€‚

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰é€ä¿¡ã•ã‚Œã‚‹ã€ã‚ã‚‰ã‚†ã‚‹æ–‡å­—åˆ—ã¯å®‰å…¨ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚å®‰å…¨ã§ã¯ãªã„æ–‡å­—åˆ—ã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ç„¡ã—ã§å‡ºåŠ›ã—ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€‚
ã“ã®ã‚ˆã†ãªé–“é•ã„ã‚’ãŒã‚ã£ãŸå ´åˆã€ã‚³ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã‚ˆã†ã«è¦‹ãˆã‚‹ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã‚’è€ƒãˆå‡ºã—ã¦ã¿ã‚ˆã†ã€‚
é–“é•ã£ã¦ã„ã‚‹ã‚³ãƒ¼ãƒ‰ãŒã€é–“é•ã£ã¦è¦‹ãˆã‚‹ã®ãªã‚‰ã€ãã®ã‚³ãƒ¼ãƒ‰ã«å–ã‚Šçµ„ã‚“ã§ã„ã‚‹äººã‚„ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹äººãŒè¦‹ã¤ã‘ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã§ã—ã‚‡ã†ã€‚

:::details åŸæ–‡ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
```
Let's put it in pseudocode. Imagine that

> s = Request("name")

reads input (a POST argument) from the HTML form. If you ever write this code:

> Write "Hello, " & Request("name")

your site is already vulnerable to XSS attacks. That's all it takes.

Instead you have to encode it before you copy it back into the HTML. Encoding it means replacing " with &quot;, replacing > with &gt;, and so forth. So

> Write "Hello, " & Encode(Request("name"))

is perfectly safe.

All strings that originate from the user are unsafe. Any unsafe string must not be output without encoding it.

Let's try to come up with a coding convention that will ensure that if you ever make this mistake, the code will just look wrong. If wrong code, at least, looks wrong, then it has a fighting chance of getting caught by someone working on that code or reviewing that code.
```
:::

### è€ƒãˆã‚‰ã‚Œã‚‹è§£æ±ºç­– - ãã®1
ä¸€ã¤ç›®ã®è§£æ±ºç­–ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰é€ä¿¡ã•ã‚Œã¦ããŸæ™‚ç‚¹ã§ã€ã™ã¹ã¦ã®æ–‡å­—åˆ—ã‚’ã™ãã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã€‚
```javascript
s = Encode(Request("name"))
```

`Encode`ã§å›²ã¾ã‚Œã¦ã„ãªã„`Request`ã‚’è¦‹ã‹ã‘ãŸã‚‰ã€ãã®ã‚³ãƒ¼ãƒ‰ã¯é–“é•ã£ã¦ã„ã‚‹ã«é•ã„ãªã„ã€‚

è¦ç´„ã«åã—ã¦ã„ã‚‹å›²ã‚ã‚Œã¦ã„ãªã„`Request`ã‚’ç›®ã§è¿½ã„å§‹ã‚ã‚‹ã‚ˆã†ã«ãªã‚‹ã§ã—ã‚‡ã†ã€‚

ã“ã®è¦ç´„ã«å¾“ã†ã“ã¨ã§ã€XSSã®ãƒã‚°ã‚’å›é¿ã™ã‚‹ã¨ã„ã†ç‚¹ã§ã¯ã†ã¾ãæ©Ÿèƒ½ã™ã‚‹ãŒã€
ã“ã®æ–¹æ³•ã¯å¿…ãšã—ã‚‚æœ€é©ãªæ‰‹æ³•ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

ä¾‹ãˆã°ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®æ–‡å­—åˆ—ã‚’ã€ã©ã“ã‹ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ ¼ç´ã—ãŸã„ã¨ã—ã¾ã™ã€
ãã®éš›ã€HTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸæ–‡å­—åˆ—ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ ¼ç´ã™ã‚‹æ„å‘³ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
ãªãœã‹ã¨ã„ã†ã¨ã€æ ¼ç´ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒHTMLãƒšãƒ¼ã‚¸ä»¥å¤–ã§å‡¦ç†ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã‹ã‚‰ã§ã™ã€‚
ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã®æ±ºæ¸ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å ´åˆã€HTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ã¨æ··ä¹±ã—ã¾ã™ã€‚

å¤šãã®ã®ã‚¦ã‚§ãƒ–ãƒ»ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€HTMLãƒšãƒ¼ã‚¸ã«é€ã‚‹ç›´å‰ã¾ã§å†…éƒ¨çš„ã«æ–‡å­—åˆ—ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã¯è¡Œã‚ãªã„ã¨ã„ã†åŸå‰‡ã«åŸºã¥ãé–‹ç™ºã•ã‚Œã¦ã„ã¾ã™ã€‚

ç§ãŸã¡ã¯ã€ã—ã°ã‚‰ãã®é–“ã€å®‰å…¨ã§ã¯ãªã„ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®ã§ä½¿ã„ç¶šã‘ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚

ã‚ªãƒ¼ã‚±ãƒ¼ã€‚ã‚‚ã†ä¸€åº¦ãƒˆãƒ©ã‚¤ã—ã‚ˆã†ã€‚

### è€ƒãˆã‚‰ã‚Œã‚‹è§£æ±ºç­– - ãã®2
æ–‡å­—åˆ—ã‚’æ›¸ãå‡ºã™éš›ã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãŒå¿…è¦ã¨ã„ã†ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã‚’ä½œã‚‹ã¨ã©ã†ã ã‚ã†ï¼Ÿ

```javascript
s = Request("name")

// much later:
Write Encode(s)
```

`Encode`ã§å›²ã£ã¦ã„ãªã„`Write`ã‚’è¦‹ã‚‹ãŸã³ã«ã€ä½•ã‹é–“é•ã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚
ã§ã‚‚ã¾ãã€ã“ã‚Œã§ã¯ã€ã†ã¾ãã„ã‹ãªã„ã‚±ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™...ã‚³ãƒ¼ãƒ‰å†…ã«å°‘ã—ã§ã‚‚HTMLã®æ–­ç‰‡ãŒã‚ã‚Šã€ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãŒã§ããªã„ã§ã—ã‚‡ã†ã€‚

```javascript
If mode = "linebreak" Then prefix = "<br>"

// ã‹ãªã‚Šå¾Œã«
Write prefix
```

ä¸Šè¨˜ã§ã¯ã€æ–‡å­—åˆ—ã‚’å‡ºå£ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦æ€§ãŒã‚ã‚‹æˆ‘ã€…ã®è¦ç´„ã«å‰‡ã‚‹ã¨ã€é–“é•ã£ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆã‚‹ã€‚

```javascript
Write Encode(prefix)
```

ä¸Šè¨˜ã®ã‚ˆã†ã«ã—ã¦ã—ã¾ã†ã¨ã€`<br>`ã¨ãªã‚Šã€æ”¹è¡Œã‚’æŒ¿å…¥ã™ã‚‹ã“ã¨ã«ãªã£ã¦ã„ã‚‹ã€‚

ã—ã‹ã—ç¾åœ¨ã€æ”¹è¡Œã‚’é–‹å§‹ã™ã‚‹ã¯ãšã®`<br>`ã¯`&lt;br&gt;`ã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚Œã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯æ–‡å­—é€šã‚Š`<br>`ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹ã€‚ã“ã‚Œã‚‚æ­£ã—ããªã„ã€‚

ã¤ã¾ã‚Šã€æ–‡å­—åˆ—ã‚’èª­ã¿è¾¼ã‚€ã¨ãã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã§ããªã„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚‚ã‚ã‚Œã°ã€æ›¸ãè¾¼ã‚€ã¨ãã«ã§ããªã„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚‚ã‚ã‚‹ç‚ºã€ã©ã¡ã‚‰ã®æ¡ˆã‚‚ã†ã¾ãã„ã‹ãªã„ã€‚
ã¾ãŸã€è¦ç´„ãŒãªã„ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒªã‚¹ã‚¯ãŒã‚ã‚‹ã€‚

```javascript
s = Request("name")

...æ•°ãƒšãƒ¼ã‚¸å¾Œ...
name = s

...æ•°ãƒšãƒ¼ã‚¸å¾Œ...
recordset("name") = name // name ã‚’ ãƒ‡ãƒ¼ã‚¿ãƒ¼ãƒ™ãƒ¼ã‚¹ã®é …ç›®ã€name ã«æ ¼ç´

...æ•°æ—¥å¾Œ...
theName = recordset("name")

...æ•°ãƒšãƒ¼ã‚¸ ã‚ã‚‹ã„ã¯ æ•°ã‹æœˆå¾Œ...
Write theName
```

æ–‡å­—åˆ—ã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ãŸã‹è¦šãˆã¦ã„ã‚‹ã ã‚ã†ã‹ï¼Ÿãƒã‚°ã‚’è¦‹ã¤ã‘ã‚‹äº‹ãŒã§ãã‚‹å ´æ‰€ã¯ä¸€ã¤ã‚‚ãªã„ã€‚æ¢ã‚‹å ´æ‰€ãŒã©ã“ã«ã‚‚ãªã„ã€‚
ã“ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ãŒãŸãã•ã‚“ã‚ã‚‹ã¨ã€å…¨æ–‡å­—åˆ—ã®å‡ºæ‰€ã‚’è¾¿ã‚Šã€å°šä¸”ã¤ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹äº‹ã‚’ç¢ºèªã™ã‚‹ã«ã¯ã€è†¨å¤§ãªé›£å•ã®è§£æ±ºãŒå¿…è¦ã¨ã‚ã‚‹ã€‚

:::details åŸæ–‡ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
```
Possible Solution #1

One solution is to encode all strings right away, the minute they come in from the user:

> s = Encode(Request("name"))

So our convention says this: if you ever see Request that is not surrounded by Encode, the code must be wrong.

You start to train your eyes to look for naked Requests, because they violate the convention.

That works, in the sense that if you follow this convention you'll never have a XSS bug, but that's not necessarily the best architecture. For example maybe you want to store these user strings in a database somewhere, and it doesn't make sense to have them stored HTML-encoded in the database, because they might have to go somewhere that is not an HTML page, like to a credit card processing application that will get confused if they are HTML-encoded. Most web applications are developed under the principle that all strings internally are not encoded until the very last moment before they are sent to an HTML page, and that's probably the right architecture.

We really need to be able to keep things around in unsafe format for a while.

OK. I'll try again.

Possible Solution #2

What if we made a coding convention that said that when you write out any string you have to encode it?

> s = Request("name")
> 
> // much later:
> Write Encode(s)

Now whenever you see a naked Write without the Encode you know something is amiss.

Well, that doesn't quite workâ€¦ sometimes you have little bits of HTML around in your code and you can't encode them:

> If mode = "linebreak" Then prefix = "<br>"
> 
> // much later:
> Write prefix

This looks wrong according to our convention, which requires us to encode strings on the way out:

> Write Encode(prefix)

But now the "<br>", which is supposed to start a new line, gets encoded to &lt;br&gt; and appears to the user as a literal < b r >. That's not right either.

So, sometimes you can't encode a string when you read it in, and sometimes you can't encode it when you write it out, so neither of these proposals works. And without a convention, we're still running the risk that you do this:

> s = Request("name")
> 
> ...pages later...
> name = s
> 
> ...pages later...
> recordset("name") = name // store name in db in a column "name"
> 
> ...days later...
> theName = recordset("name")
> 
> ...pages or even months later...
> Write theName

Did we remember to encode the string? There's no single place where you can look to see the bug. There's no place to sniff. If you have a lot of code like this, it takes a ton of detective work to trace the origin of every string that is ever written out to make sure it has been encoded.
```
:::

### çœŸã®è§£æ±ºç­–
ã§ã¯ã€ã†ã¾ãã„ãã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã‚’ææ¡ˆã—ã‚ˆã†ã€‚ãƒ«ãƒ¼ãƒ«ã¯ã²ã¨ã¤ã ã‘ã€‚

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰æ¥ãŸæ–‡å­—åˆ—ã¯ã™ã¹ã¦ã€ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼ˆæ¥é ­è¾ï¼‰ãŒâ€œusâ€ï¼ˆå®‰å…¨ã§ãªã„æ–‡å­—åˆ—ï¼‰ã§å§‹ã¾ã‚‹åå‰ã®å¤‰æ•°ï¼ˆã¾ãŸã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®é …ç›®ï¼‰ã«æ ¼ç´ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚


HTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸæ–‡å­—åˆ—ã‚„ã€æ—¢çŸ¥ã®å®‰å…¨ãªå ´æ‰€ã‹ã‚‰æ¥ãŸæ–‡å­—åˆ—ã¯ã™ã¹ã¦ã€ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹â€œsâ€ï¼ˆå®‰å…¨ãªæ–‡å­—åˆ—ï¼‰ã§å§‹ã¾ã‚‹åå‰ã®å¤‰æ•°ã«æ ¼ç´ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚

åŒã˜ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãç›´ã—ã¦ã¿ã‚ˆã†ã€‚å¤‰æ•°åä»¥å¤–ã¯ä½•ã‚‚å¤‰ãˆãšã€æ–°ã—ã„è¦ç´„ã«åˆã‚ã›ã¦ã¿ã‚‹ã€‚

```javascript
us = Request("name")

...æ•°ãƒšãƒ¼ã‚¸å¾Œ...
usName = us

...æ•°ãƒšãƒ¼ã‚¸å¾Œ...
recordset("usName") = usName

...æ•°æ—¥å¾Œ...
sName = Encode(recordset("usName"))

...æ•°ãƒšãƒ¼ã‚¸ ã‚ã‚‹ã„ã¯ æ•°ã‹æœˆå¾Œ...
Write sName
```

æ–°ã—ã„è¦ç´„ã§æ³¨ç›®ã—ã¦ã»ã—ã„ã®ã¯ã€ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ãŒå®ˆã‚‰ã‚Œã¦ã„ã‚‹é™ã‚Šã€å®‰å…¨ã§ãªã„æ–‡å­—åˆ—ã§ãƒŸã‚¹ã‚’çŠ¯ã—ã¦ã‚‚1è¡Œã®ã‚³ãƒ¼ãƒ‰ã§è¦‹ã¤ã‘ã‚‹äº‹ãŒã§ãã‚‹ã¨ã„ã†ã“ã¨ã€‚

```javascript
s = Request("name")
```

ä¸Šè¨˜ã¯ãƒ«ãƒ¼ãƒ«é•åã ã€‚ãªãœãªã‚‰ã€`Request`ã®çµæœãŒ`s`ã§å§‹ã¾ã‚‹å¤‰æ•°ã«ä»£å…¥ã•ã‚Œã¦ã„ã‚‹ã¨ã„ã†å†…å®¹ã‚’è¦‹ã¦ã€ã“ã‚Œã¯ãƒ«ãƒ¼ãƒ«é•åã ã¨ã‚ã‹ã‚‹ã€‚`Request`ã®çµæœã¯å¸¸ã«å®‰å…¨ã§ã¯ãªã„ãŸã‚ã€å¸¸ã«åå‰ãŒ "us "ã§å§‹ã¾ã‚‹å¤‰æ•°ã«ä»£å…¥ã•ã‚Œãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚

```javascript
us = Request("name")
```

ä¸Šè¨˜ã¯OKã ã€‚

```javascript
usName = us
```

ä¸Šè¨˜ã‚‚OKã€‚

```javascript
sName = us
```

ä¸Šè¨˜ã¯ã€ã‚‚ã¡ã‚ã‚“é–“é•ãˆã¦ã„ã‚‹ã€‚

```javascript
sName = Encode(us)
```

ä¸Šè¨˜ã¯ã€æ­£ã«ãã®é€šã‚Šã€‚

```javascript
Write usName
```

ä¸Šè¨˜ã¯ã€ç¢ºå®Ÿã«é–“é•ã£ã¦ã„ã‚‹ã€‚

```javascript
Write sName
```

ä¸Šè¨˜ã¯OKã ã€‚

```javascript
Write Encode(usName)
```

ä¸Šè¨˜ã‚‚åŒæ§˜ã«OKã€‚

ã‚³ãƒ¼ãƒ‰å…¨ã¦ã®è¡Œã‚’å˜ç‹¬ã§èª¿ã¹ã‚‹äº‹ãŒã§ãã€ã™ã¹ã¦ã®è¡ŒãŒæ­£ã—ã‘ã‚Œã°ã€ã‚³ãƒ¼ãƒ‰å…¨ä½“ãŒæ­£ã—ã„äº‹ã¨ãªã‚‹ã€‚

ã“ã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã«ã‚ˆã‚Šã€ã‚ãªãŸã®ç›®ã¯`Write usXXX`ã‚’è¦‹ã¦ã€ãã‚ŒãŒé–“é•ã£ã¦ã„ã‚‹äº‹ãŒçŸ¥ã‚‹ã€‚ãã—ã¦ã€ãã‚Œã‚’ã©ã†ä¿®æ­£ã™ã‚Œã°ã‚ˆã„ã‹å³åº§ã«ã‚ã‹ã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚

æœ€åˆã®ã†ã¡ã¯ã€é–“é•ã£ãŸã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã‚‹ã®ã¯ã€å°‘ã—é›£ã—ã„ãŒã€3é€±é–“ç¶šã‘ã‚‹ã¨ç›®ãŒæ¬¡ç¬¬ã«é †å¿œã—ã¦ãã‚‹ã€‚å·¨å¤§ãªãƒ‘ãƒ³å·¥å ´ã‚’è¦‹ãŸãƒ‘ãƒ³å±‹ã®å¾“æ¥­å“¡ã®ã‚ˆã†ã«ã€å³åº§ã«ã“ã†è¨€ã†ã§ã—ã‚‡ã†ã€‚ã€Œã‚¸ã‚§ã‚¤ãƒ»ã‚ºãƒ¼ã‚¹ã€èª°ã‚‚æƒé™¤ã—ã¦ã­ã‡ã˜ã‚ƒã­ã‹ï¼ãŠã„ã€ãŠå‰ã‚‰ã€ã„ã£ãŸã„ä½•ã‚’ã‚„ã£ã¦ãŸã‚“ã ï¼Ÿã€

ã“ã®ãƒ«ãƒ¼ãƒ«ã‚’å°‘ã—æ‹¡å¼µã—ã€`Request`é–¢æ•°ã¨`Encode`é–¢æ•°ã®åå‰ã‚’`UsRequest`ã¨`SEncode`ã«å¤‰æ›´ï¼ˆã‚‚ã—ãã¯åŒ…æ‹¬ï¼‰ã™ã‚‹ãªã©ã€å®‰å…¨ã§ã¯ãªã„æ–‡å­—åˆ—ã€ã¾ãŸã¯å®‰å…¨ãªæ–‡å­—åˆ—ã‚’è¿”ã™é–¢æ•°ã¯ã€`Us`ã¨`S`ã§å§‹ã‚ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚å¤‰æ•°ã«å¯¾ã—ã¦ã‚‚åŒã˜ã‚ˆã†ã«ã€‚

:::details åŸæ–‡ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
```
The Real Solution

So let me suggest a coding convention that works. We'll have just one rule:

All strings that come from the user must be stored in variables (or database columns) with a name starting with the prefix â€œusâ€ (for Unsafe String). All strings that have been HTML encoded or which came from a known-safe location must be stored in variables with a name starting with the prefix â€œsâ€ (for Safe string).

Let me rewrite that same code, changing nothing but the variable names to match our new convention.

> us = Request("name")
> 
> ...pages later...
> usName = us
> 
> ...pages later...
> recordset("usName") = usName
> 
> ...days later...
> sName = Encode(recordset("usName"))
> 
> ...pages or even months later...
> Write sName

The thing I want you to notice about the new convention is that now, if you make a mistake with an unsafe string, you can always see it on some single line of code, as long as the coding convention is adhered to:

> s = Request("name")

is a priori wrong, because you see the result of Request being assigned to a variable whose name begins with s, which is against the rules. The result of Request is always unsafe so it must always be assigned to a variable whose name begins with â€œusâ€.

> us = Request("name")

is always OK.

> usName = us

is always OK.

> sName = us

is certainly wrong.

> sName = Encode(us)

is certainly correct.

> Write usName

is certainly wrong.

> Write sName

is OK, as is

> Write Encode(usName)

Every line of code can be inspected by itself, and if every line of code is correct, the entire body of code is correct.

Eventually, with this coding convention, your eyes learn to see the Write usXXX and know that it's wrong, and you instantly know how to fix it, too. I know, it's a little bit hard to see the wrong code at first, but do this for three weeks, and your eyes will adapt, just like the bakery workers who learned to look at a giant bread factory and instantly say, â€œjay-zuss, nobody cleaned insahd rounduh fo-ah! What the hayl kine a opparashun y'awls runnin' heey-uh?â€

In fact we can extend the rule a bit, and rename (or wrap) the Request and Encodefunctions to be UsRequest and SEncodeâ€¦ in other words, functions that return an unsafe string or a safe string will start with Us and S, just like variables.
```
:::

### çœŸã®è§£æ±ºç­– - ãƒ«ãƒ¼ãƒ«ã‚’å°‘ã—æ‹¡å¼µã—ãŸä¾‹
ã•ã¦ã€ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã¿ã‚ˆã†ã€‚

```javascript
us = UsRequest("name")
usName = us
recordset("usName") = usName
sName = SEncode(recordset("usName"))
Write sName
```

ä¸Šè¨˜ã¯ä½•ã‚’ã—ãŸã®ã‹ã‚ã‹ã‚‹ï¼Ÿã“ã‚Œã«ã‚ˆã‚Šã€ã‚¤ã‚³ãƒ¼ãƒ«ï¼ˆ=ï¼‰ã®ä¸¡è¾ºãŒåŒã˜ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã§å§‹ã¾ã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã€é–“é•ã„ãŒã‚ã‹ã‚‹ã ã‚ã†ã€‚

```javascript
us = UsRequest("name") // OKã€ä¸¡è¾ºã¨ã‚‚USã¨ãªã£ã¦ã„ã‚‹ã€‚
^^   ^^
s = UsRequest("name") // ãƒã‚°
^   ^^
usName = us // OK
^^       ^^
sName = us // ã‚‚ã¡ã‚ã‚“é–“é•ã„ã€‚
^       ^^
sName = SEncode(us) // æ­£ã«ãã®é€šã‚Šã€‚
^       ^
```

`Write`ã®åå‰ã‚’`WriteS`ã«ã€ãã‚Œã¨`SEncode`ã®åå‰ã‚’`SFromUs`ã«å¤‰æ›´ã™ã‚‹äº‹ã§ã€ã•ã‚‰ã«ä¸€æ­©é€²ã‚€ã“ã¨ãŒã§ãã‚‹ã€‚
ä¸‹è¨˜ã§å¤‰æ›´ã€‚

```javascript
us = UsRequest("name")
^^   ^^
usName = us
^^       ^^
recordset("usName") = usName
           ^^         ^^
sName = SFromUs(recordset("usName"))
^       ^    ^^            ^^
WriteS sName
     ^ ^
```

ä¸Šè¨˜ã®é€šã‚Šã€é–“é•ãˆãŒã‚ˆã‚Šè¦‹ãˆã‚„ã™ããªã‚‹ã€‚ã‚ãªãŸã®ç›®ã¯ã€æ€ªã—ã„ã‚³ãƒ¼ãƒ‰ã‚’ã€Œè¦‹ã‚‹ã€ã“ã¨ã‚’å­¦ã¶ã§ã—ã‚‡ã†ã€‚ãã†ã™ã‚‹ã“ã¨ã§ã€ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ãŸã‚Šã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚“ã ã‚Šã™ã‚‹é€šå¸¸ã®å·¥ç¨‹ã ã‘ã§ã€ã‚ã‹ã‚Šã«ãã„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ãƒã‚°ã‚’è¦‹ã¤ã‘ã‚‹äº‹ãŒã§ãã‚‹ã€‚

é–“é•ã£ãŸã‚³ãƒ¼ãƒ‰ã‚’é–“é•ã£ã¦è¦‹ã›ã‚‹ã“ã¨ã¯è‰¯ã„ã“ã¨ã ãŒã€å¿…ãšã—ã‚‚å…¨ã¦ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å•é¡Œã«å¯¾ã™ã‚‹æœ€é©è§£ã§ã¯ãªã„ã€‚èµ·ã“ã‚Šã†ã‚‹å…¨ã¦ã®ãƒã‚°ã‚„ãƒŸã‚¹ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ã¯ã§ããªã„ã€‚ã§ã‚‚ã€ä½•ã‚‚ãªã„ã‚ˆã‚Šã‚ã£ãŸæ–¹ãŒè‰¯ã„ã®ã¯ç¢ºã‹ã§ã€é–“é•ã£ãŸã‚³ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦è¦‹ãˆã‚‹ã‚ˆã†ãªã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã®æ–¹ãŒè‰¯ã„ã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ãŒã‚³ãƒ¼ãƒ‰ã«ç›®ã‚’é€šã™åº¦ã«ã€ç‰¹å®šã®ãƒã‚°ãŒãƒã‚§ãƒƒã‚¯ã•ã‚Œæœªç„¶ã«é˜²ãã¨ã„ã£ãŸã‚ˆã†ãªå¢—åˆ†çš„ãªåˆ©ç‚¹ãŒå¾—ã‚‰ã‚Œã‚‹ã€‚

:::details åŸæ–‡ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
```
Now look at the code:

> us = UsRequest("name")
> usName = us
> recordset("usName") = usName
> sName = SEncode(recordset("usName"))
> Write sName

See what I did? Now you can look to see that both sides of the equal sign start with the same prefix to see mistakes.

> us = UsRequest("name") // ok, both sides start with US
> s = UsRequest("name") // bug
> usName = us // ok
> sName = us // certainly wrong.
> sName = SEncode(us) // certainly correct.

Heck, I can take it one step further, by naming Write to WriteS and renaming SEncode to SFromUs:

> us = UsRequest("name")
> usName = us
> recordset("usName") = usName
> sName = SFromUs(recordset("usName"))
> WriteS sName

This makes mistakes even more visible. Your eyes will learn to â€œseeâ€ smelly code, and this will help you find obscure security bugs just through the normal process of writing code and reading code.

Making wrong code look wrong is nice, but it's not necessarily the best possible solution to every security problem. It doesn't catch every possible bug or mistake, because you might not look at every line of code. But it's sure a heck of a lot better than nothing, and I'd much rather have a coding convention where wrong code, at least, looked wrong. You instantly gain the incremental benefit that every time a programmer's eyes pass over a line of code, that particular bug is checked for and prevented.
```
:::
## ä¸€èˆ¬çš„ãªãƒ«ãƒ¼ãƒ«ã«ã¤ã„ã¦
ã“ã®é–“é•ã£ãŸã‚³ãƒ¼ãƒ‰ã‚’é–“é•ã£ã¦è¦‹ã›ã‚‹ã¨ã„ã†ç”¨ä»¶ã¯ã€ç”»é¢ã®1ã‹æ‰€ã«æ­£ã—ã„æƒ…å ±ã‚’ä¸€ç·’ã«ã¾ã¨ã‚ã‚‹ã“ã¨ãŒå¤§åˆ‡ã§ã‚ã‚‹ã€‚
æ–‡å­—ã‚’è¦‹ã‚‹æ™‚ã«ã€ãã®æ–‡å­—åˆ—ãŒå®‰å…¨ã‹å®‰å…¨ã§ã¯ãªã„ã‹çŸ¥ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ç§ã¯ã€ãã®æƒ…å ±ã‚’åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãŒå¿…è¦ãªæ‰€ã€åˆ¥ãƒšãƒ¼ã‚¸ã®ã‚ˆã†ãªå ´æ‰€ã«é…ç½®ã—ãŸããªã„ã€‚ãã‚Œã«ã¯ã€å¤‰æ•°ã®å‘½åè¦å‰‡ãŒå¿…è¦ã ã€‚

ä»–ã«ã‚‚ä¸€ç·’ã®å ´æ‰€ã«é…ç½®ã™ã‚‹äº‹ã§ã‚³ãƒ¼ãƒ‰ã‚’æ”¹å–„ã§ãã‚‹ä¾‹ãŒãŸãã•ã‚“ã‚ã‚‹ã€‚å¤§æŠµã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã«ã¯æ¬¡ã®ã‚ˆã†ãªãƒ«ãƒ¼ãƒ«ãŒã‚ã‚‹ã€‚

- é–¢æ•°ï¼ˆFunctionï¼‰ã¯çŸ­ãã™ã‚‹
- å¤‰æ•°ã‚’ä½¿ã„æ™‚ã€ã§ãã‚‹ã ã‘è¿‘ãã§å®£è¨€ã™ã‚‹
- ãƒã‚¯ãƒ­ã‚’ä½¿ã£ã¦è‡ªåˆ†ã ã‘ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã‚’ä½œã‚‰ãªã„
- `goto`ã‚’ä½¿ã‚ãªã„
- é–‰ã˜ä¸­æ‹¬å¼§ï¼ˆ`}`ï¼‰ã¯ã€å¯¾å¿œã™ã‚‹é–‹ãä¸­æ‹¬å¼§ï¼ˆ`{`ï¼‰ã‹ã‚‰1ç”»é¢ä»¥ä¸Šé›¢ã•ãªã„

ã“ã‚Œã‚‰ã®ãƒ«ãƒ¼ãƒ«ã«å…±é€šã—ã¦ã„ã‚‹ã®ã¯ã€ã‚³ãƒ¼ãƒ‰ãŒå®Ÿéš›ã«è¡Œã†ã“ã¨ã‚’å¯èƒ½ãªé™ã‚Šä¸€ã‹æ‰€ã«é›†ã‚ã€é–¢é€£ã™ã‚‹æƒ…å ±ã‚’å¾—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ç‚¹ã ã€‚ã“ã†ã™ã‚‹äº‹ã§ã€ã‚ãªãŸã®ç›®ã®ç‰ãŒèµ·ãã¦ã„ã‚‹äº‹ã‚’æŠŠæ¡ã§ãã‚‹å¯èƒ½æ€§ãŒé«˜ã¾ã‚‹ã§ã—ã‚‡ã†ã€‚

ä¸€èˆ¬è«–ã¨ã—ã¦ã€ç‰©äº‹ã‚’éš ã—ã¦ã—ã¾ã†ã‚ˆã†ãªè¨€èªæ©Ÿèƒ½ã«ã¯å°‘ã—ææ€–ã‚’æ„Ÿã˜ã¦ã„ã‚‹ã€‚ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã‚‹ã¨

```c
i = j * 5;
```

...Cã§ã¯ã€å°‘ãªãã¨ã‚‚jãŒ5å€ã•ã‚Œã€ãã®çµæœãŒiã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã¯ã‚ã‹ã‚‹ã€‚

ã—ã‹ã—ã€C++ã§åŒã˜ã‚³ãƒ¼ãƒ‰ã®éƒ¨åˆ†ã ã‘è¦‹ãŸå ´åˆã€ä½•ã‚‚ã‚ã‹ã‚‰ãªã„ã€‚ã¾ã£ãŸããªã„ã€‚C++ã§å®Ÿéš›ã«ä½•ãŒèµ·ã“ã£ã¦ã„ã‚‹ã®ã‹ã‚’çŸ¥ã‚‹å”¯ä¸€ã®æ–¹æ³•ã¯ã€`i`ã¨`j`ãŒã©ã‚“ãªå‹ãªã®ã‹ã‚’çŸ¥ã‚‹ã“ã¨ã ã€‚ã¨ã„ã†ã®ã‚‚ã€`j`ã¯`operator*`ãŒã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸå‹ã‹ã‚‚ã—ã‚Œãªã„ã€ä¹—ç®—ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã‚‚ã®å‡„ã„æ°—ã®åˆ©ã„ãŸã“ã¨ã‚’ã™ã‚‹ã‹ã‚‰ã ã€‚ãã—ã¦`i`ã¯`operator=`ãŒã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸå‹ã‹ã‚‚ã—ã‚Œãªã„ã€å‹ã«äº’æ›æ€§ãŒãªã„ã®ã§æš—é»™çš„ãªè‡ªå‹•ã®å‹å¤‰æ›é–¢æ•°ï¼ˆ[å‹å¼·åˆ¶](https://developer.mozilla.org/ja/docs/Glossary/Type_coercion)ï¼‰ãŒå‘¼ã³å‡ºã•ã‚Œã¦ã—ã¾ã†ã‹ã‚‚ã—ã‚Œãªã„ã€‚ãã‚Œã‚’è¦‹ã¤ã‘ã‚‹å”¯ä¸€ã®æ–¹æ³•ã¯ã€å¤‰æ•°ã®å‹ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã ã‘ã§ãªãã€ãã®å‹ã‚’å®Ÿè£…ã—ã¦ã„ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ã ã€‚ã‚‚ã—ã©ã“ã‹ã«ç¶™æ‰¿ãŒã‚ã‚Œã°ã€ç¥ãŒã‚ãªãŸã‚’åŠ©ã‘ã¦ãã‚Œã‚‹ã ã‚ã†ã€ãã®ã‚³ãƒ¼ãƒ‰ãŒå®Ÿéš›ã«ã©ã“ã«ã‚ã‚‹ã‹è¦‹ã¤ã‘ã‚‹ç‚ºã«ã€ã‚¯ãƒ©ã‚¹éšå±¤ã‚’ä¸€äººã§æ¢ã‚‹å¿…è¦ã¯ã‚ã‚‹ã€‚ã‚‚ã—ã©ã“ã‹ã«ãƒãƒªãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ ãŒã‚ã‚Œã°ã€æœ¬å½“ã«å›°ã£ãŸã“ã¨ã«ãªã‚‹ã€‚ãªãœãªã‚‰ã€`i`ã¨`j`ãŒã©ã‚“ãªå‹ã¨ã—ã¦å®£è¨€ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’çŸ¥ã‚‹ã ã‘ã§ã¯ä¸ååˆ†ã§ã€ãã‚Œã‚‰ãŒä»Šã©ã‚“ãªå‹ãªã®ã‹ã‚’çŸ¥ã‚‰ãªã‘ã‚Œã°ãªã‚‰ãªã„ã‹ã‚‰ã ã€‚ï¼ˆãµã…ï¼ï¼‰

:::details å‚è€ƒè¨˜äº‹ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
https://monozukuri-c.com/langcpp-operator-overload/
https://medium-company.com/ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘/
https://medium-company.com/ãƒãƒªãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ /
https://medium-company.com/ç¶™æ‰¿/
https://medium-company.com/ã‚«ãƒ—ã‚»ãƒ«åŒ–/
:::

C++ã§`i=j*5`ã‚’è¦‹ãŸã¨ãã€ã‚ãªãŸã¯è‡ªåŠ›ã§ã©ã†ã«ã‹ã™ã‚‹ã—ã‹ãªã„ã€‚ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€è¦‹ãŸã ã‘ã§èµ·ã“ã‚Šã†ã‚‹å•é¡Œã‚’ç™ºè¦‹ã™ã‚‹èƒ½åŠ›ã‚’ä¸‹ã’ã‚‹ã¨è€ƒãˆã¦ã„ã‚‹ã€‚

ã‚‚ã¡ã‚ã‚“ã€ã“ã‚“ãªã“ã¨ã¯ã©ã†ã§ã‚‚ã„ã„ã“ã¨ã ã€‚`operator*`ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã™ã‚‹ã‚ˆã†ãªè³¢ã„ã‚¹ã‚¯ãƒ¼ãƒ«ãƒœãƒ¼ã‚¤çš„ãªã“ã¨ã‚’ã™ã‚‹å ´åˆã€ç´ æ•µã§æ¼ã‚Œã®ãªã„æŠ½è±¡åŒ–ã‚’æä¾›ã‚’ç›®çš„ã¨ã—ãŸã‚‚ã®ã ã€‚`j`ã¯`Unicode String`å‹ã§ã€`Unicode String`ã«æ•´æ•°ã‚’ä¹—ç®—ã™ã‚‹ã“ã¨ã¯ã€ç¹ä½“å­—ä¸­å›½èªã‚’æ¨™æº–ä¸­å›½èªã«å¤‰æ›ã™ã‚‹ãŸã‚ã®è‰¯ã„æŠ½è±¡åŒ–ã§ã‚ã‚‹ã“ã¨ã¯æ˜ã‚‰ã‹ã€‚ãã†ã ã‚ˆã­ï¼Ÿ

å•é¡Œã¯ã€ãŠå¯Ÿã—ã®é€šã‚Šæ¼ã‚Œã®ãªã„æŠ½è±¡åŒ–ã¯å­˜åœ¨ã—ãªã„ã¨ã„ã†ã“ã¨ã ã€‚ã“ã®ä»¶ã«ã¤ã„ã¦ã¯ã€[æ¼ã‚Œã‚‹æŠ½è±¡åŒ–ã®æ³•å‰‡ï¼ˆThe Law of Leaky Abstractionsï¼‰](https://www.joelonsoftware.com/2002/11/11/the-law-of-leaky-abstractions/)ã§åºƒã„ç¯„å›²ã§ã™ã§ã«èªã£ã¦ã„ã‚‹ã®ã§ã€ã“ã“ã§ã¯ç¹°ã‚Šè¿”ã•ãªã„ã€‚

[ã‚¹ã‚³ãƒƒãƒˆãƒ»ãƒã‚¤ãƒ¤ãƒ¼ã‚ºï¼ˆScott Meyersï¼‰](https://en.wikipedia.org/wiki/Scott_Meyers)ã¯ã€å°‘ãªãã¨ã‚‚C++ã«ãŠã„ã¦ã¯ã€C++ã®å¤±æ•—ã‚„å›°é›£ãªäº‹ä¾‹ãªã©ã€ã‚ã‚‰ã‚†ã‚‹ã“ã¨ã‚’ç´¹ä»‹ã™ã‚‹ã“ã¨ã§ã‚­ãƒ£ãƒªã‚¢ã‚’ç©ã‚“ã§ããŸã€‚ï¼ˆã¡ãªã¿ã«ã€ã‚¹ã‚³ãƒƒãƒˆã®è‘—æ›¸ [Effective C++](https://amzn.to/47FBeMS)ã®ç¬¬3ç‰ˆãŒå‡ºãŸã°ã‹ã‚Šã§ã€å®Œå…¨ã«æ›¸ãç›´ã•ã‚Œã¦ã„ã‚‹ã€‚ä»Šã™ãæ‰‹ã«å…¥ã‚Œã‚ˆã†ï¼ï¼‰

### è¦ç´„ã™ã‚‹ã¨
ã‚ªãƒ¼ã‚±ãƒ¼ã€‚

ã‹ãªã‚Šè„±ç·šã—ã¦ã—ã¾ã£ãŸã€‚ä»Šã¾ã§ã®çµŒç·¯ã‚’è¦ç´„ã—ã‚ˆã†ã€‚

> è¦ç´„ï¼š
> 
> é–“é•ã£ãŸã‚³ãƒ¼ãƒ‰ã‚’é–“é•ã£ã¦è¦‹ã›ã‚‹ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã‚’æ¢ã™ã€‚é–¢é€£ã™ã‚‹æƒ…å ±ã‚’ç”»é¢ä¸Šã®åŒã˜å ´æ‰€ã«ã¾ã¨ã‚ã¦é…ç½®ã™ã‚‹ã“ã¨ã§ã€ç‰¹å®šã®ç¨®é¡ã®å•é¡Œã‚’ç™ºè¦‹ã—ã€ã™ãã«ä¿®æ­£ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

:::details åŸæ–‡ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
```
A General Rule

This business of making wrong code look wrong depends on getting the right things close together in one place on the screen. When I'm looking at a string, in order to get the code right, I need to know, everywhere I see that string, whether it's safe or unsafe. I don't want that information to be in another file or on another page that I would have to scroll to. I have to be able to see it right there and that means a variable naming convention.

There are a lot of other examples where you can improve code by moving things next to each other. Most coding conventions include rules like:

Keep functions short.
Declare your variables as close as possible to the place where you will use them.
Don't use macros to create your own personal programming language.
Don't use goto.
Don't put closing braces more than one screen away from the matching opening brace.
What all these rules have in common is that they are trying to get the relevant information about what a line of code really does physically as close together as possible. This improves the chances that your eyeballs will be able to figure out everything that's going on.

In general, I have to admit that I'm a little bit scared of language features that hide things. When you see the code

> i = j * 5;

â€¦ in C you know, at least, that j is being multiplied by five and the results stored in i.

But if you see that same snippet of code in C++, you don't know anything. Nothing. The only way to know what's really happening in C++ is to find out what types i and j are, something which might be declared somewhere altogether else. That's because j might be of a type that has operator* overloaded and it does something terribly witty when you try to multiply it. And i might be of a type that has operator= overloaded, and the types might not be compatible so an automatic type coercion function might end up being called. And the only way to find out is not only to check the type of the variables, but to find the code that implements that type, and God help you if there's inheritance somewhere, because now you have to traipse all the way up the class hierarchy all by yourself trying to find where that code really is, and if there's polymorphism somewhere, you're really in trouble because it's not enough to know what type i and j are declared, you have to know what type they are right now, which might involve inspecting an arbitrary amount of code and you can never really be sure if you've looked everywhere thanks to the halting problem (phew!).

When you see i=j*5 in C++ you are really on your own, bubby, and that, in my mind, reduces the ability to detect possible problems just by looking at code.

None of this was supposed to matter, of course. When you do clever-schoolboy things like override operator*, this is meant to be to help you provide a nice waterproof abstraction. Golly, j is a Unicode String type, and multiplying a Unicode String by an integer is obviously a good abstraction for converting Traditional Chinese to Standard Chinese, right?

The trouble is, of course, that waterproof abstractions aren't. I've already talked about this extensively in The Law of Leaky Abstractions so I won't repeat myself here.

Scott Meyers has made a whole career out of showing you all the ways they fail and bite you, in C++ at least. (By the way, the third edition of Scott's book Effective C++ just came out; it's completely rewritten; get your copy today!)

Okay.

I'm losing track. I better summarize The Story Until Now:

Look for coding conventions that make wrong code look wrong. Getting the right information collocated all together in the same place on screen in your code lets you see certain types of problems and fix them right away.
```
:::
## ç§ã¯ãƒãƒ³ã‚¬ãƒªãƒ¼ï¼ˆãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³• = è‰¯ã„ï¼‰
![](https://storage.googleapis.com/zenn-user-upload/0cc80d5bd04d-20230818.webp)
*å¼•ç”¨ã—ãŸç”»åƒï¼šLugnano, Umbria, Italy*
ã•ã¦ã€æ‚ªåé«˜ã„ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã®è©±ã«æˆ»ãã†ã€‚

ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã¯ãƒã‚¤ã‚¯ãƒ­ã‚½ãƒ•ãƒˆã®ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã€[ãƒãƒ£ãƒ¼ãƒ«ã‚ºãƒ»ã‚·ãƒ¢ãƒ‹ãƒ¼ï¼ˆCharles Simonyiï¼‰](https://ja.wikipedia.org/wiki/ãƒãƒ£ãƒ¼ãƒ«ã‚ºãƒ»ã‚·ãƒ¢ãƒ‹ãƒ¼)ã«ã‚ˆã£ã¦è€ƒæ¡ˆã•ã‚ŒãŸã€‚ã‚·ãƒ¢ãƒ‹ãƒ¼ãŒãƒã‚¤ã‚¯ãƒ­ã‚½ãƒ•ãƒˆã§æ‰‹æ›ã‘ãŸä¸»è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã²ã¨ã¤ãŒã€Wordã ã£ãŸã€‚å®Ÿéš›ã€å½¼ã¯ã‚¼ãƒ­ãƒƒã‚¯ã‚¹ãƒ»ãƒ‘ãƒ«ã‚¯ï¼ˆXerox PARCï¼‰ã§ãƒ–ãƒ©ãƒœãƒ¼ï¼ˆBravoï¼‰ã¨ã„ã†ä¸–ç•Œåˆã®[WYSIWYG](https://ja.wikipedia.org/wiki/WYSIWYG)ãƒ¯ãƒ¼ãƒ—ãƒ­ã‚’ä½œã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’æŒ‡æ®ã—ãŸã€‚

WYSIWYGãƒ¯ãƒ¼ãƒ—ãƒ­ã§ã¯ã€ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ãªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒã‚ã‚‹ãŸã‚ã€ã™ã¹ã¦ã®åº§æ¨™ã‚’ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‹ã‚‰ã®ç›¸å¯¾åº§æ¨™ã‹ã€ãƒšãƒ¼ã‚¸ã‹ã‚‰ã®ç›¸å¯¾åº§æ¨™ã‹ã§ã€è§£é‡ˆãŒå¿…è¦ã¨ãªã‚‹ã€‚

ã‚·ãƒ¢ãƒ‹ãƒ¼ãŒãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã¨å‘¼ã°ã‚Œã‚‹ã‚‚ã®ã‚’ä½¿ã„å§‹ã‚ãŸã®ã¯ã€ãã‚ŒãŒå¤šãã®ç†ç”±ã®å†…ã®ä¸€ã¤ã ã¨ã€ç§ã¯æ¨æ¸¬ã—ã¦ã„ã‚‹ã€‚ãã®è¨˜æ³•ã¯ãƒãƒ³ã‚¬ãƒªãƒ¼èªã®ã‚ˆã†ã«è¦‹ãˆã€ã‚·ãƒ¢ãƒ‹ãƒ¼ã¯ãƒãƒ³ã‚¬ãƒªãƒ¼å‡ºèº«ã ã£ãŸã®ã§ã€ã“ã®åå‰ãŒä»˜ã„ãŸã€‚ã‚·ãƒ¢ãƒ‹ãƒ¼ç‰ˆã®ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã§ã¯ã€ã™ã¹ã¦ã®å¤‰æ•°ã®é ­ã«ã€ãã®å¤‰æ•°ãŒå«ã‚€ç¨®é¡ï¼ˆkindï¼‰ã‚’ç¤ºã™å°æ–‡å­—ã®ã‚¿ã‚°ãŒä»˜ã‘ã‚‰ã‚Œã¦ã„ãŸã€‚
<!-- $\text{rwMax}$ -->
<!-- ${\text{\textasciicircum\textasciicircum------} \atop \text{prefix}}$ -->

![](https://storage.googleapis.com/zenn-user-upload/6a4bc5436e9c-20230818.webp)
*å¼•ç”¨ã—ãŸç”»åƒï¼šFor example, if the variable name is rwCol, rw is the prefix.*

ç§ã¯æ„å›³çš„ã«ç¨®é¡ï¼ˆkindï¼‰ã¨ã„ã†è¨€è‘‰ã‚’ä½¿ã£ã¦ã„ã‚‹ã€‚ã¨ã„ã†ã®ã‚‚ã€ã‚·ãƒ¢ãƒ‹ãƒ¼ã¯è«–æ–‡ã§ç¨®é¡ï¼ˆtypeï¼‰ã¨ã„ã†é–“é•ã£ãŸè¨€è‘‰ã‚’ä½¿ã£ã¦ã—ã¾ã„ã€ä½•ä¸–ä»£ã‚‚ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ¼ãƒâ€•é”ãŒæ„å›³ã‚’èª¤è§£ã—ã¦ã—ã¾ã£ãŸã‹ã‚‰ã ã€‚

ã‚·ãƒ¢ãƒ‹ãƒ¼ã®è«–æ–‡ã‚’ã‚ˆãèª­ã‚€ã¨ã€å½¼ãŒè¨€ã„ãŸã‹ã£ãŸã®ã¯ã€ç§ãŒå‰è¿°ã—ã¦ã„ã‚‹ä¾‹ã®é€šã‚Šã®å‘½åè¦å‰‡ã€usã¯â€œå®‰å…¨ã§ãªã„æ–‡å­—åˆ—â€ã€sã¯â€œå®‰å…¨ãªæ–‡å­—åˆ—â€ã¨ã„ã†æ„å‘³ã ã£ãŸã€‚ã©ã¡ã‚‰ã‚‚ç¨®é¡ï¼ˆtypeï¼‰ã¯æ–‡å­—åˆ—å‹ã ã€‚ä¸€æ–¹ã‚’ã‚‚ã†ç‰‡æ–¹ã«ä»£å…¥ã—ã¦ã‚‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ¼ã¯åŠ©ã‘ã¦ãã‚Œãªã„ã—ã€åˆ¤æ–­ã‚„æ„æ€æ±ºå®šã«å¿…è¦ãªçŸ¥è¦‹ã‚‚æ•™ãˆã¦ãã‚Œãªã„ã€‚ã“ã‚Œã‚‰ã¯ã€ç•°ãªã‚‹ã‚ˆã†ã«æ‰±ã‚ã‚Œã¦ã€è§£é‡ˆã•ã‚Œã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã¾ãŸã€ã‚‚ã†ä¸€æ–¹ã«ä»£å…¥ã™ã‚‹æ™‚ã«ã¯ä½•ã‚‰ã‹ã®ç¨®é¡ï¼ˆkindï¼‰ã®å¤‰æ›é–¢æ•°ã‚’å‘¼ã³å‡ºã•ãªã„ã¨ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒã‚°ãŒç™ºç”Ÿã—ã¦ã—ã¾ã†ã€‚ã‚ãªãŸã®é‹ãŒè‰¯ã‘ã‚Œã°ã€‚

:::details åŸæ–‡ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
~~~
I'm Hungary

So now we get back to the infamous Hungarian notation.

Hungarian notation was invented by Microsoft programmer Charles Simonyi. One of the major projects Simonyi worked on at Microsoft was Word; in fact he led the project to create the world's first WYSIWYG word processor, something called Bravo at Xerox Parc.

In WYSIWYG word processing, you have scrollable windows, so every coordinate has to be interpreted as either relative to the window or relative to the page, and that makes a big difference, and keeping them straight is pretty important.

Which, I surmise, is one of the many good reasons Simonyi started using something that came to be called Hungarian notation. It looked like Hungarian, and Simonyi was from Hungary, thus the name. In Simonyi's version of Hungarian notation, every variable was prefixed with a lower case tag that indicated the kind of thing that the variable contained.

For example, if the variable name is rwCol, rw is the prefix.

I'm using the word kind on purpose, there, because Simonyi mistakenly used the word type in his paper, and generations of programmers misunderstood what he meant.

If you read Simonyi's paper closely, what he was getting at was the same kind of naming convention as I used in my example above where we decided that us meant â€œunsafe stringâ€ and s meant â€œsafe string.â€ They're both of type string. The compiler won't help you if you assign one to the other and Intellisense won't tell you bupkis. But they are semantically different; they need to be interpreted differently and treated differently and some kind of conversion function will need to be called if you assign one to the other or you will have a runtime bug. If you're lucky.
~~~
:::

### ã‚·ãƒ¢ãƒ‹ãƒ¼ç‰ˆãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã®ã‚³ãƒ³ã‚»ãƒ—ãƒˆã¨ã¯
ã‚ªãƒªã‚¸ãƒŠãƒ«ã®ã‚·ãƒ¢ãƒ‹ãƒ¼ç‰ˆãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã®ã‚³ãƒ³ã‚»ãƒ—ãƒˆã¯ã€ãƒã‚¤ã‚¯ãƒ­ã‚½ãƒ•ãƒˆç¤¾å†…ã§ã¯â€œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ï¼ˆApps Hungarianï¼‰â€ã¨å‘¼ã°ã‚Œã¦ã„ãŸã€‚Excelã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã¯ã€æ•°å¤šãã®`rw`ã¨`col`ãŒç™»å ´ã™ã‚‹ã€‚ãã†ã€ã©ã¡ã‚‰ã‚‚æ•´æ•°ã ãŒã€ãã‚Œã‚‰ã‚’ä»£å…¥ã—åˆã£ã¦ã‚‚æ„å‘³ãŒãªã„ã€‚Wordã§ã¯ã€`xl`ã¨`xw`ã‚’ã‚ˆãè¦‹ã‹ã‘ã‚‹ã¨æ€ã†ãŒã€`xl`ã¯â€œãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«å¯¾ã™ã‚‹æ°´å¹³åº§æ¨™â€ã‚’æ„å‘³ã—ã€`xw`ã¯â€œã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«å¯¾ã™ã‚‹æ°´å¹³åº§æ¨™â€ã‚’æ„å‘³ã™ã‚‹ã€‚ã©ã¡ã‚‰ã‚‚intå‹ã€‚äº’æ›æ€§ã¯ãªã„ã€‚ã©ã¡ã‚‰ã®ã‚¢ãƒ—ãƒªã§ã‚‚ã€â€œãƒã‚¤ãƒˆæ•°â€ã‚’æ„å‘³ã™ã‚‹`cb`ãŒå¤šãä½¿ã‚ã‚Œã¦ã„ã‚‹ã€‚ãã†ã€ã“ã‚Œã‚‚intå‹ã ãŒã€å¤‰æ•°åã‚’è¦‹ã‚‹ã ã‘ã§ã‚ˆãã‚ã‹ã‚‹ã€‚ã“ã‚Œã¯ãƒã‚¤ãƒˆæ•°ã€ã¤ã¾ã‚Šãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºã ã€‚`xl` = `cb`ã‚’è¦‹ãŸã‚‰ã€ãã†ã ã€ãƒãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰ã®ãƒ›ã‚¤ãƒƒã‚¹ãƒ«ã‚’é³´ã‚‰ãã†ã€‚`xl`ã‚‚`cb`ã‚‚æ•´æ•°ã§ã‚ã‚‹ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ãƒ”ã‚¯ã‚»ãƒ«å˜ä½ã®æ°´å¹³ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’ãƒã‚¤ãƒˆæ•°ã«è¨­å®šã™ã‚‹ã®ã¯å®Œå…¨ã«ã‚¤ã‚«ã‚Œã¦ã„ã‚‹ã‹ã‚‰ã ã€‚

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã¯å¤‰æ•°ã ã‘ã§ãªãé–¢æ•°ã«ã‚‚ä½¿ã‚ã‚Œã‚‹ã€‚å®Ÿã‚’è¨€ã†ã¨ã€ç§ã¯Wordã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ãŸã“ã¨ãŒãªã„ã®ã ãŒã€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ç¸¦åº§æ¨™ã‹ã‚‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®ç¸¦åº§æ¨™ã«å¤‰æ›ã™ã‚‹`YlFromYw`ã¨ã„ã†é–¢æ•°ãŒå­˜åœ¨ã™ã‚‹äº‹ã«ã¯è³­ã‘ã¦ã‚‚ã„ã„ã€‚å‰è¿°ã®ä¾‹ã§`Encode`ã‹ã‚‰`SFromUS`ã«åå‰ã‚’å¤‰ãˆãŸé€šã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ã§ã¯ã€ä¼çµ±çš„ãª`TypeToType`ã®ä»£ã‚ã‚Šã«`TypeFromType`ã¨ã„ã†è¡¨è¨˜ãŒå¿…è¦ã§ã‚ã‚Šã€ã™ã¹ã¦ã®é–¢æ•°åã‚’è¿”ã‚Šå€¤ã®ç¨®é¡ã§å§‹ã¾ã‚‹ã‚ˆã†ã«ã—ãŸã€‚äº‹å®Ÿã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ã§ã¯ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰é–¢æ•°ã¯`SFromUs`ã¨ã„ã†åå‰ã§ã‚ã‚‹äº‹ã¯å¿…é ˆã ã€‚é–¢æ•°åã¯ã€ã“ã‚Œä»¥å¤–ã€é¸æŠè‚¢ã®ä½™åœ°ã¯ãªã„ã€‚ã“ã‚Œã¯ã€ã„ã„ã“ã¨ã ã€‚è¦šãˆã‚‹ã“ã¨ãŒã²ã¨ã¤æ¸›ã‚‹ã—ã€`Encode`ã¨ã„ã†å˜èªãŒã©ã‚“ãªã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’æŒ‡ã—ã¦ã„ã‚‹ã®ã‹ç–‘å•ã«æ€ã†å¿…è¦ã‚‚ãªã„ã€‚

ç‰¹ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©å„ªã‚Œã¦ã„ãªã‹ã£ãŸCè¨€èªã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®æ™‚ä»£ã«ãŠã„ã¦ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ã¯éå¸¸ã«è²´é‡ã ã£ãŸã€‚

:::details åŸæ–‡ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
```
Simonyi's original concept for Hungarian notation was called, inside Microsoft, Apps Hungarian, because it was used in the Applications Division, to wit, Word and Excel. In Excel's source code you see a lot of rw and col and when you see those you know that they refer to rows and columns. Yep, they're both integers, but it never makes sense to assign between them. In Word, I'm told, you see a lot of xl and xw, where xl means â€œhorizontal coordinates relative to the layoutâ€ and xw means â€œhorizontal coordinates relative to the window.â€ Both ints. Not interchangeable. In both apps you see a lot of cb meaning â€œcount of bytes.â€ Yep, it's an int again, but you know so much more about it just by looking at the variable name. It's a count of bytes: a buffer size. And if you see xl = cb, well, blow the Bad Code Whistle, that is obviously wrong code, because even though xl and cb are both integers, it's completely crazy to set a horizontal offset in pixels to a count of bytes.

In Apps Hungarian prefixes are used for functions, as well as variables. So, to tell you the truth, I've never seen the Word source code, but I'll bet you dollars to donuts there's a function called YlFromYw which converts from vertical window coordinates to vertical layout coordinates. Apps Hungarian requires the notation TypeFromType instead of the more traditional TypeToType so that every function name could begin with the type of thing that it was returning, just like I did earlier in the example when I renamed Encode SFromUs. In fact in proper Apps Hungarian the Encode function would have to be named SFromUs. Apps Hungarian wouldn't really give you a choice in how to name this function. That's a good thing, because it's one less thing you need to remember, and you don't have to wonder what kind of encoding is being referred to by the word Encode: you have something much more precise.

Apps Hungarian was extremely valuable, especially in the days of C programming where the compiler didn't provide a very useful type system.
```
:::
### ãƒ€ãƒ¼ã‚¯ã‚µã‚¤ãƒ‰ï¼ˆæš—é»’é¢ï¼‰ãŒãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã‚’æ”¯é…ã—ãŸ
ã—ã‹ã—ãã®å¾Œã€ã‚ã‚‹ç•°å¤‰ãŒèµ·ããŸã€‚

ãƒ€ãƒ¼ã‚¯ã‚µã‚¤ãƒ‰ãŒãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã‚’æ”¯é…ã—ãŸã€‚

èª°ã‚‚ãã®ç†ç”±ã‚„çµŒç·¯ã‚’çŸ¥ã‚‰ãªã„ã‚ˆã†ã ãŒã€ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ã¨å‘¼ã°ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸã‚‚ã®ã‚’Windowsãƒãƒ¼ãƒ ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ©ã‚¤ã‚¿ãƒ¼é”ãŒã€ã†ã‹ã¤ã«ã‚‚è€ƒæ¡ˆã—ã¦ã—ã¾ã£ãŸã‚ˆã†ã ã€‚

èª°ã‹ãŒã€ã©ã“ã§ã‚·ãƒ¢ãƒ‹ãƒ¼ã®è«–æ–‡ã‚’èª­ã¿ã€è«–æ–‡ã§â€œå‹ï¼ˆtypeï¼‰â€ã¨ã„ã†è¨€è‘‰ã‚’ä½¿ã£ã¦ã„ãŸã®ã§ã€ã‚¯ãƒ©ã‚¹ã¾ãŸã¯å‹ã‚·ã‚¹ãƒ†ãƒ ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒã™ã‚‹å‹ãƒã‚§ãƒƒã‚¯ã®ã‚ˆã†ãªã€å‹ï¼ˆtypeï¼‰ã‚’æŒ‡ã—ã¦ã„ã‚‹ã‚‚ã®ã¨æ€ã£ãŸã€‚ã‚·ãƒ¢ãƒ‹ãƒ¼ã®æ„å›³ã¯ãã†ã§ã¯ãªã‹ã£ãŸã€‚å½¼ã¯â€œã‚¿ã‚¤ãƒ—ï¼ˆtypeï¼‰â€ã¨ã„ã†è¨€è‘‰ãŒä½•ã‚’æ„å‘³ã™ã‚‹ã®ã‹ã€éå¸¸ã«æ³¨æ„æ·±ãæ­£ç¢ºã«èª¬æ˜ã—ãŸãŒã€æ„å‘³ã‚’æˆã•ãªã‹ã£ãŸã€‚å¤§ããªç—›æ‰‹ã¨ãªã£ãŸã€‚

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ã¯éå¸¸ã«åˆ©ä¾¿æ€§ã®é«˜ãã€é…åˆ—ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æ„å‘³ã™ã‚‹â€œixâ€ã®ã‚ˆã†ãªãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ãŒã‚ã£ãŸã‚Šã€ã‚«ã‚¦ãƒ³ãƒˆã‚’æ„å‘³ã™ã‚‹â€œcâ€ã€2ã¤ã®æ•°å€¤ã®å·®ã‚’æ„å‘³ã™ã‚‹ â€œdâ€ï¼»ä¾‹ã¨ã—ã¦â€œdxâ€ã¯å¹…ï¼ˆwidthï¼‰ã®å·®ï¼½ãªã©ãŒã‚ã‚‹ã€‚

ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ã¯ã€ã‹ãªã‚Šåˆ©ä¾¿æ€§ãŒä½ã„ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã§ã€`long`ã‚’æ„å‘³ã™ã‚‹â€œlâ€ã‚„`unsigned long`ã‚’æ„å‘³ã™ã‚‹â€œulâ€ã€`double word`ã‚’æ„å‘³ã™ã‚‹â€œdwâ€ã€`double word`ã“ã‚Œã¯å®Ÿéš›ã€ãˆã£ã¨`unsigned long`ã¨ä¸€ç·’ã [^5]ã€‚ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ãŒç¤ºã™ã®ã¯å¤‰æ•°ã«ãŠã‘ã‚‹å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿å‹ã®ã¿ã ã€‚
[^5]: ã“ã“ã®æ„å›³ãŒã‚ã¾ã‚Šç†è§£ã§ãã¦ã„ãªã„ãŒã€Cè¨€èªã®`unsigned long`ï¼ˆç¬¦å·ãªã—longå‹ï¼‰ã¨`double word`ã®ãƒ“ãƒƒãƒˆæ•°ãŒ32bitã§åŒã˜ã¨ã„ã†äº‹ã‚’æ€ã„å‡ºã—èª¬æ˜ã—ã¦ã„ã‚‹æå†™ã‹ï¼Ÿ


ã“ã‚Œã¯åƒ…ã‹ãªé•ã„ã ãŒã€ã‚·ãƒ¢ãƒ‹ãƒ¼ã®æ„å›³ã¨å®Ÿè·µã«å¯¾ã—ã¦å®Œå…¨ã«å±¥ãé•ãˆã¦ã—ã¾ã£ã¦ã„ã‚‹ã€‚è¤‡é›‘ãªå­¦è¡“çš„æ–‡ç« ã‚’æ›¸ã„ã¦ã‚‚èª°ã‚‚ç†è§£ã•ã‚Œãšã€èª¤ã£ã¦è§£é‡ˆã•ã‚Œã‚‹ã€‚ãã—ã¦ã€ãã®èª¤è§£ã•ã‚ŒãŸè§£é‡ˆã®ã‚¢ã‚¤ãƒ‡ã‚¢ãŒã€ã‚·ãƒ¢ãƒ‹ãƒ¼ã®è€ƒãˆã§ãªãã¦ã‚‚ã‚ã–ç¬‘ã‚ã‚Œã¦ã—ã¾ã†ã€‚ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ã§ã¯ã€â€œdouble word foo,â€ã‚’æ„å‘³ã™ã‚‹`dwFoo`ãŒæ•°å¤šãä½¿ã‚ã‚ŒãŸã€ãƒã‚¸ã‹ã‚ˆã£ã¦æ„Ÿã˜ã ã€å¤‰æ•°ãŒ`double word`ã¨ã„ã†æƒ…å ±ã¯ã€ã»ã¨ã‚“ã©å½¹ã«ç«‹ãŸãªã„ã€‚ã ã‹ã‚‰ã€ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ã«å¯¾ã—ã¦åæ„ŸãŒã‚ã£ã¦ã‚‚ç„¡ç†ã¯ãªã„ã€‚

ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ã¯ã€Windowsãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ¨™æº–ã¨ãªã‚Šã€Windowsãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°å­¦ç¿’ã®ãƒã‚¤ãƒ–ãƒ«ã¨ãªã£ãŸ[ãƒãƒ£ãƒ¼ãƒ«ã‚ºãƒ»ãƒšã‚¾ãƒ«ãƒ‰ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°Windows](http://www.charlespetzold.com/pw5/)ã®ã‚ˆã†ãªæ›¸ç±ï¼ˆ[æ›¸ç±ã®ãƒªãƒ³ã‚¯](https://amzn.to/3qtpBYF)ï¼‰ã§åºƒã¾ã‚Šã€ãŸã¡ã¾ã¡ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã®ä¸»æµã¨ãªã£ãŸã€ãƒã‚¤ã‚¯ãƒ­ã‚½ãƒ•ãƒˆç¤¾å†…ã§ã•ãˆã‚‚ã€Wordã¨Excelã‚’é™¤ã„ãŸãƒãƒ¼ãƒ ã§è‡ªåˆ†ãŸã¡ã®é–“é•ã„ã‚’ç†è§£ã—ã¦ã„ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã¯ã€æ¥µã‚ã¦å°‘ãªã‹ã£ãŸã€‚

:::details åŸæ–‡ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
```
But then something kind of wrong happened.

The dark side took over Hungarian Notation.

Nobody seems to know why or how, but it appears that the documentation writers on the Windows team inadvertently invented what came to be known as Systems Hungarian.

Somebody, somewhere, read Simonyi's paper, where he used the word â€œtype,â€ and thought he meant type, like class, like in a type system, like the type checking that the compiler does. He did not. He explained very carefully exactly what he meant by the word â€œtype,â€ but it didn't help. The damage was done.

Apps Hungarian had very useful, meaningful prefixes like â€œixâ€ to mean an index into an array, â€œcâ€ to mean a count, â€œdâ€ to mean the difference between two numbers (for example â€œdxâ€ meant â€œwidthâ€), and so forth.

Systems Hungarian had far less useful prefixes like â€œlâ€ for long and â€œulâ€ for â€œunsigned longâ€ and â€œdwâ€ for double word, which is, actually, uh, an unsigned long. In Systems Hungarian, the only thing that the prefix told you was the actual data type of the variable.

This was a subtle but complete misunderstanding of Simonyi's intention and practice, and it just goes to show you that if you write convoluted, dense academic prose nobody will understand it and your ideas will be misinterpreted and then the misinterpreted ideas will be ridiculed even when they weren't your ideas. So in Systems Hungarian you got a lot of dwFoo meaning â€œdouble word foo,â€ and doggone it, the fact that a variable is a double word tells you darn near nothing useful at all. So it's no wonder people rebelled against Systems Hungarian.

Systems Hungarian was promulgated far and wide; it is the standard throughout the Windows programming documentation; it was spread extensively by books like Charles Petzold's Programming Windows, the bible for learning Windows programming, and it rapidly became the dominant form of Hungarian, even inside Microsoft, where very few programmers outside the Word and Excel teams understood just what a mistake they had made.
```
:::
### é–“é•ãˆã«æ°—ä»˜ã„ãŸMicrosoft
ãã—ã¦å¤§åä¹±ãŒèµ·ã“ã£ãŸã€‚ã¤ã„ã«ã€ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã‚’ç†è§£ã—ã¦ã„ãªã‹ã£ãŸãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼é”ã¯ã€è‡ªåˆ†ãŸã¡ãŒä½¿ã£ã¦ã„ã‚‹èª¤è§£ã•ã‚ŒãŸ[ã‚µãƒ–ã‚»ãƒƒãƒˆ](https://wa3.i-3-i.info/word15233.html)ãŒã€ã‹ãªã‚Šã‚ãšã‚‰ã‚ã—ãã€ã»ã¨ã‚“ã©å½¹ã«ç«‹ãŸãªã„ã“ã¨ã«æ°—ã¥ãã€åæ——ã‚’ã²ã‚‹ãŒãˆã—ãŸã€‚ã¨ã‚‚ã‚ã‚Œã€ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ã«ã¯ã€ãƒã‚°ã‚’ç™ºè¦‹ã™ã‚‹ã®ã«ã€ã„ã„ã¨ã“ã‚ã‚‚ã‚ã‚‹ã€‚ã‚·ã‚¹ãƒ†ãƒ ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ã‚’ä½¿ã£ã¦ã„ã‚‹ã¨ã€å¤‰æ•°ã®å‹ãŒã‚ã‹ã‚‹ã¨ã„ã†ç‚¹ã ã€‚ã ãŒã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ã»ã©ã®ä¾¡å€¤ã¯ãªã„ã€‚

å¤§åä¹±ã¯.NETã§ã®ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆãƒªãƒªãƒ¼ã‚¹ã®æ™‚ã«ãƒ”ãƒ¼ã‚¯ã‚’ã‚€ã‹ãˆãŸã€‚Microsoftã¯ã¤ã„ã«ã€Œãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã¯æ¨å¥¨ã•ã‚Œãªã„ã€ã¨è¨€ã„å§‹ã‚ãŸã€‚å¤§å–œã³ã ã£ãŸã€‚ã‚ã–ã‚ã–ç†ç”±ã‚’è¨€ã‚ãªã‹ã£ãŸã¨æ€ã†ã€‚å½¼ã‚‰ï¼ˆå½¼å¥³ã‚‰ï¼‰ã¯æ–‡æ›¸ã®å‘½åã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’èª¿ã¹ã€ã™ã¹ã¦ã®é …ç›®ã«ã€Œãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã‚’ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€ã¨æ›¸ã„ãŸã ã‘ã ã£ãŸã€‚[^6]ã“ã®æ™‚ç‚¹ã§ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³è¨˜æ³•ã¯ã¨ã¦ã‚‚ä¸äººæ°—ã§ã€èª°ã‚‚æ–‡å¥ã‚’è¨€ã‚ãªã‹ã£ãŸã—ã€Excelã¨Wordä»¥å¤–ã®ä¸–ç•Œã®èª°ã‚‚ãŒã€å¼·åŠ›ãªå‹ãƒã‚§ãƒƒã‚¯ã¨[ã‚¤ãƒ³ãƒ†ãƒªã‚»ãƒ³ã‚¹](https://ja.wikipedia.org/wiki/ã‚¤ãƒ³ãƒ†ãƒªã‚»ãƒ³ã‚¹)ã®æ™‚ä»£ã«ã¯ä¸å¿…è¦ã¨ãªã£ãŸæ‰±ã„ã«ãã„å‘½åè¦å‰‡ã‚’ä½¿ã†å¿…è¦ãŒãªã„äº‹ã«å®‰å µã—ã¦ã„ãŸã€‚
[^6]: [Microsoft Learn - .NET - .NET ã®åŸºç¤ - ä¸€èˆ¬çš„ãªåå‰ä»˜ã‘è¦å‰‡](https://learn.microsoft.com/ja-jp/dotnet/standard/design-guidelines/general-naming-conventions)

ã ãŒã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ³ã‚¬ãƒªã‚¢ãƒ³ã«ã¯ã€éå¸¸ã«å¤§ããªä¾¡å€¤ãŒã‚ã‚Šã€[ã‚³ãƒ¼ãƒ‰ã®ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³](https://til.toshimaru.net/2023-07-30)ãŒå¢—ãˆã‚‹ã“ã¨ã§ã€ã‚³ãƒ¼ãƒ‰ã®èª­ã¿æ›¸ããŒå®¹æ˜“ã¨ãªã‚‹äº‹ã‚„ãƒ‡ãƒãƒƒã‚°ã‚„ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãŒã—ã‚„ã™ããªã‚‹äº‹ã€ãã—ã¦æœ€é‡è¦ãªã®ãŒã€**é–“é•ã£ãŸã‚³ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã¿ãˆã‚‹ã‚ˆã†ã«ãªã‚‹**ã¨ã„ã†ã“ã¨ã ã€‚

çµ‚ã‚ã‚Šã«ã€ã‚‚ã†ã²ã¨ã¤ç´„æŸã—ãŸã“ã¨ãŒã‚ã‚‹ã€‚ãã‚Œã¯ã€ã‚‚ã†ä¸€åº¦ã€ä¾‹å¤–ã«å¯¾ã—æ‰¹åˆ¤ã™ã‚‹ã¨ã„ã†ã“ã¨ã ã€‚å‰å›ã€æ‰¹åˆ¤ã—ãŸã¨ãã¯å¤§å¤‰ãªç›®ã«é­ã£ãŸã€‚Joel on Softwareã®ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã§ä¾‹å¤–ã¯äº‹å®Ÿä¸Šã€ç›®ã«è¦‹ãˆãªã„gotoã§ç›®ã«è¦‹ãˆã‚‹gotoã‚ˆã‚Šã‚‚ã€ã•ã‚‰ã«æ‚ªã„äº‹ã¨ä¸»å¼µã—[ä¾‹å¤–ã¯å«Œã„ã ã€‚ã¨æ›¸ã„ãŸã€‚](https://www.joelonsoftware.com/2003/10/13/13/)ç„¡è«–ã€ä½•ç™¾ä¸‡äººã‚‚ã®äººã€…ãŒç§ã®å–‰å…ƒã«é£›ã³ã‹ã‹ã£ã¦ããŸã€‚ç§ã®æ“è­·ã«å›ã£ãŸã®ã¯ã€è¨€ã‚ãšã‚‚ãŒãª[ãƒ¬ã‚¤ãƒ¢ãƒ³ãƒ‰ãƒ»ãƒã‚§ãƒ³](https://devblogs.microsoft.com/oldnewthing/author/oldnewthing)ã ã‘ã ã£ãŸã€ã¡ãªã¿ã«å½¼ã¯ä¸–ç•Œæœ€é«˜ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã§ã‚ã‚‹ã€ã ã‹ã‚‰ã“ãä½•ã‹ã‚’è¨€ã‚ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ã§ã—ã‚‡ï¼Ÿ

:::details åŸæ–‡ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
```
And then came The Great Rebellion. Eventually, programmers who never understood Hungarian in the first place noticed that the misunderstood subset they were using was Pretty Dang Annoying and Well-Nigh Useless, and they revolted against it. Now, there are still some nice qualities in Systems Hungarian, which help you see bugs. At the very least, if you use Systems Hungarian, you'll know the type of a variable at the spot where you're using it. But it's not nearly as valuable as Apps Hungarian.

The Great Rebellion hit its peak with the first release of .NET. Microsoft finally started telling people, â€œHungarian Notation Is Not Recommended.â€ There was much rejoicing. I don't even think they bothered saying why. They just went through the naming guidelines section of the document and wrote, â€œDo Not Use Hungarian Notationâ€ in every entry. Hungarian Notation was so doggone unpopular by this point that nobody really complained, and everybody in the world outside of Excel and Word were relieved at no longer having to use an awkward naming convention that, they thought, was unnecessary in the days of strong type checking and Intellisense.

But there's still a tremendous amount of value to Apps Hungarian, in that it increases collocation in code, which makes the code easier to read, write, debug, and maintain, and, most importantly, it makes wrong code look wrong.

Before we go, there's one more thing I promised to do, which is to bash exceptions one more time. The last time I did that I got in a lot of trouble. In an off-the-cuff remark on the Joel on Software homepage, I wrote that I don't like exceptions because they are, effectively, an invisible goto, which, I reasoned, is even worse than a goto you can see. Of course millions of people jumped down my throat. The only person in the world who leapt to my defense was, of course, Raymond Chen, who is, by the way, the best programmer in the world, so that has to say something, right?
```
:::
## ã•ã„ã”ã«ï¼ˆä¾‹å¤– = æ‚ªã„ï¼‰
ã“ã®è¨˜äº‹ã®æ–‡è„ˆã§ã€ä¾‹å¤–ã«ã¤ã„ã¦èª¬æ˜ã—ã‚ˆã†ã€‚ã‚ãªãŸã®ç›®ã¯ã€è¦‹ãˆã‚‹ã‚‚ã®ãŒã‚ã‚‹é™ã‚Šã€é–“é•ã£ãŸã‚‚ã®ã‚’è¦‹ã¦å­¦ã¶äº‹ã§ãƒã‚°ã‚’æœªç„¶ã«é˜²ã’ã‚‹ã€‚ã‚³ãƒ¼ãƒ‰ã‚’æœ¬å½“ã«ã—ã£ã‹ã‚Šã¨å¼·å›ºãªã‚‚ã®ã«ã™ã‚‹ãŸã‚ã«ã¯ã€ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹éš›ã«ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å¯èƒ½ã¨ã™ã‚‹ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ãŒå¿…è¦ã ã€‚è¨€ã„æ›ãˆã‚‹ã¨ã€ã‚³ãƒ¼ãƒ‰ãŒä½•ã‚’ã—ã¦ã„ã‚‹ã‹ã¨ã„ã†æƒ…å ±ãŒç›®ã®å‰ã«ã‚ã‚Œã°ã‚ã‚‹ã»ã©ã€é–“é•ã„ãŒè¦‹ã¤ã‘ã‚„ã™ããªã‚Šã€ã‚ˆã‚Šè‰¯ã„ä»•äº‹ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚æ¬¡ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ãŒã‚ã£ãŸã‚‰

```c
dosomething();
cleanup();
```

...ã‚ãªãŸã®ç›®ãŒæ•™ãˆã¦ãã‚Œã‚‹ã€ã“ã‚Œã®ã©ã“ãŒæ‚ªã„ã‚“ã ï¼Ÿå¸¸ã«ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã—ã¦ã„ã‚‹ï¼ã§ã‚‚ã€`dosomething`ãŒä¾‹å¤–ã‚’æŠ•ã’ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã¨ã„ã†ã“ã¨ã¯ã€`cleanup`ãŒå‘¼ã°ã‚Œãªã„å ´åˆãŒã‚ã‚‹ã¨ã„ã†ã“ã¨ã€‚`finally`ãªã©ã‚’ä½¿ãˆã°ã€ãã‚Œã¯ç°¡å˜ã«ä¿®æ­£ãŒã§ãã‚‹ãŒã€ç§ã®è¨€ã„ãŸã„ã“ã¨ã¯ã€`cleanup`ãŒç¢ºå®Ÿã«å‘¼ã³å‡ºã•ã‚Œã‚‹ã“ã¨ã‚’çŸ¥ã‚‹ç‚ºã®å”¯ä¸€ã®æ–¹æ³•ãŒã€`dosomething`ã®ã‚³ãƒ¼ãƒ«ãƒ„ãƒªãƒ¼å…¨ä½“ã‚’èª¿æŸ»ã—ã¦ã€ä¾‹å¤–ã‚’æŠ•ã’ã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹ã‚‚ã®ãŒã©ã“ã‹ã«ãªã„ã‹ç¢ºèªã™ã‚‹ã“ã¨ã ã€‚ã©ã“ã‹ã«ä¾‹å¤–ã‚’æŠ•ã’ã‚Œã°è§£æ±ºã§ãã€è‹¦åŠ´ã¯å°‘ãªã„ãŒã€æœ¬å½“ã«é‡è¦ãªã®ã¯ã€ä¾‹å¤–ã¯ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒç„¡ããªã£ã¦ã—ã¾ã†ã¨ã„ã†ç‚¹ã ã€‚ã‚³ãƒ¼ãƒ‰ãŒæ­£ã—ã„ã“ã¨ã‚’ã—ã¦ã„ã‚‹ã‹ã¨ã„ã†ç–‘å•ã«ç­”ãˆã‚‹ã«ã¯ã€ã©ã“ã‹åˆ¥ã®å ´æ‰€ã‚’æ¢ã™å¿…è¦ãŒã‚ã‚‹ã€ã¤ã¾ã‚Šã€ãã“ã«è¦‹ã‚‹ã‚‚ã®ãŒãªãã€é–“é•ã£ãŸã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦å­¦ç¿’ã™ã‚‹ç›®ã®èƒ½åŠ›ã‚’æ´»ç”¨ã§ããªã„ã¨ã„ã†ã“ã¨ã ã€‚

1æ—¥ã«1åº¦ã€å¤§é‡ã®ãƒ‡ãƒ¼ã‚¿ã‚’é›†ã‚ã¦å°åˆ·ã™ã‚‹ã‚ˆã†ãªã€ã¡ã£ã½ã‘ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ã„ã¦ã„ã‚‹æ™‚ã¯ã€ãã‚Šã‚ƒä¾‹å¤–ã¯ã™ã°ã‚‰ã—ã„ã€‚èµ·ã“ã‚Šã†ã‚‹é–“é•ãˆã‚’ã€ãŸã ãƒ—ãƒ­ã‚°ãƒ©ãƒ å…¨ä½“ã«try/catchã§å›²ã‚€ã“ã¨ã§å…¨ã¦ã‚’ç„¡è¦–ã—ã€ä½•ã‹å•é¡ŒãŒèµ·ããŸå ´åˆã«ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã™ã‚‹æ™‚ã»ã©ã«å¥½ããªäº‹ã¯ãªã„ã€‚ä¾‹å¤–ã¯ã€æ¥µã‚ã¦é‡è¦ãªæ¥­å‹™ã§ã‚‚ãªãç”Ÿå‘½ã‚’ç¶­æŒã™ã‚‹ç‚ºã§ã‚‚ãªãã€ã‚„ã£ã¤ã‘ä»•äº‹ã®ã‚³ãƒ¼ãƒ‰ã‚„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã¯é©ã—ã¦ã„ã‚‹ã€‚ã—ã‹ã—ã€ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ»ã‚·ã‚¹ãƒ†ãƒ ã‚„åŸå­åŠ›ç™ºé›»æ‰€ã€ã‚ã‚‹ã„ã¯é–‹è…¹æ‰‹è¡“ã«ä½¿ã‚ã‚Œã‚‹é«˜é€Ÿãªä¸¸é‹¸ã‚’åˆ¶å¾¡ã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’æ›¸ãã®ã§ã‚ã‚Œã°ã€ä¾‹å¤–ã¯éå¸¸ã«å±é™ºã ã€‚

ä¾‹å¤–ã‚’æ­£ã—ãåˆ¶å¾¡ã™ã‚‹æ–¹æ³•ã‚’ç†è§£ã—ã¦ãŠã‚‰ãšã€ã¾ãŸä¾‹å¤–ã‚’ç†è§£ã—ã¦ã„ãªãã¨ã‚‚å¿ƒã®ä¸­ã«é–‰ã¾ãˆã°ç§ç”Ÿæ´»ãŒè‰¯ããªã‚‹ã“ã¨ã™ã‚‰ç†è§£ã§ãã¦ã„ãªã„ã€ç§ã‚’ãƒ˜ãƒœã„ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã ã¨æ±ºã‚ã¤ã‘ã‚‹ã ã‚ã†ãŒã€ãã‚Œã¯æ®‹å¿µãªã“ã¨ã ã€‚æœ¬å½“ã«ä¿¡é ¼ã§ãã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãæ–¹æ³•ã¯ã€èª¤ã‚Šã®ãªã„å®Œç’§ãªãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã‚’æƒ³å®šã—ã€éš ã‚ŒãŸå‰¯ä½œç”¨ã‚„æ¼ã‚ŒãŒã‚ã‚‹æŠ½è±¡çš„ã§è¤‡é›‘ãªé“å…·ã‚’ä½¿ã†äº‹ã§ã¯ãªãã€ã‚ˆãã‚ã‚‹äººçš„ãªè„†å¼±æ€§ã‚’è€ƒæ…®ã—ãŸã‚·ãƒ³ãƒ—ãƒ«ãªé“å…·ã‚’ä½¿ã†ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§ã‚ã‚‹ã€‚

:::details åŸæ–‡ï¼ˆã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠã™ã‚‹ã¨æŠ˜ã‚ŠãŸãŸã¿ãŒé–‹ãï¼‰
```
Here's the thing with exceptions, in the context of this article. Your eyes learn to see wrong things, as long as there is something to see, and this prevents bugs. In order to make code really, really robust, when you code-review it, you need to have coding conventions that allow collocation. In other words, the more information about what code is doing is located right in front of your eyes, the better a job you'll do at finding the mistakes. When you have code that says

> dosomething();
> cleanup();

â€¦ your eyes tell you, what's wrong with that? We always clean up! But the possibility that dosomething might throw an exception means that cleanupmight not get called. And that's easily fixable, using finally or whatnot, but that's not my point: my point is that the only way to know that cleanup is definitely called is to investigate the entire call tree of dosomething to see if there's anything in there, anywhere, which can throw an exception, and that's ok, and there are things like checked exceptions to make it less painful, but the real point is that exceptions eliminate collocation. You have to look somewhere else to answer a question of whether code is doing the right thing, so you're not able to take advantage of your eye's built-in ability to learn to see wrong code, because there's nothing to see.

Now, when I'm writing a dinky script to gather up a bunch of data and print it once a day, heck yeah, exceptions are great. I like nothing more than to ignore all possible wrong things that can happen and just wrap up the whole damn program in a big ol'try/catch that emails me if anything ever goes wrong. Exceptions are fine for quick-and-dirty code, for scripts, and for code that is neither mission critical nor life-sustaining. But if you're writing an operating system, or a nuclear power plant, or the software to control a high speed circular saw used in open heart surgery, exceptions are extremely dangerous.

I know people will assume that I'm a lame programmer for failing to understand exceptions properly and failing to understand all the ways they can improve my life if only I was willing to let exceptions into my heart, but, too bad. The way to write really reliable code is to try to use simple tools that take into account typical human frailty, not complex tools with hidden side effects and leaky abstractions that assume an infallible programmer.
```
:::

## å‚è€ƒè¨˜äº‹
- æ¢ã™ã‚­ãƒƒã‚«ã‚±ã®è¨˜äº‹
    https://qiita.com/yuu_j/items/d6e6fc4476ab1dc35cdc

- å…ƒè¨˜äº‹ã®ç­†è€…ã®æƒ…å ±
    https://ja.wikipedia.org/wiki/ã‚¸ãƒ§ã‚¨ãƒ«ãƒ»ã‚¹ãƒãƒ«ã‚¹ã‚­

- å…ƒè¨˜äº‹
    https://www.joelonsoftware.com/2005/05/11/making-wrong-code-look-wrong/
- æ—¥æœ¬èªè¨³ã—ã¦ã„ã‚‹åˆ¥ã®è¨˜äº‹
    https://web.archive.org/web/20190418033007/http://local.joelonsoftware.com/mediawiki/index.php/é–“é•ã£ãŸã‚³ãƒ¼ãƒ‰ã¯é–“é•ã£ã¦è¦‹ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹
- CodeZineè¨˜äº‹ - Joelã«èãã€Œå„ªã‚ŒãŸé–‹ç™ºè€…ã€ã®è¦ä»¶ãƒ»å¿ƒæ§‹ãˆãƒ»åŠªåŠ›ã™ã¹ãã“ã¨
    https://codezine.jp/article/detail/2292
    â€»2ãƒšãƒ¼ã‚¸ç›®ä»¥é™ã€ç¶šãã‚’èª­ã‚€ç‚ºã«ã¯CodeZineã®ä¼šå“¡ç™»éŒ²ãŒå¿…è¦ã€‚
    - [æ—¥æœ¬èªè¨³ç‰ˆ]ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºè€…æ¡ç”¨ã‚¬ã‚¤ãƒ‰
        https://amzn.to/3YVbIPL
    - [è‹±èªç‰ˆ]Smart and Gets Things Done: Joel Spolsky's Concise Guide to Finding the Best Technical Talent
        https://amzn.to/3P3XEQB
