---
title: "PowerShellでPauseする方法"
emoji: "⏸"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["powershell"]
published: false
---

## 早見表

| コマンド | 発行元 | 解説 | 使用例 |
| --- | --- | --- | --- |
| `Pause` | コマンドプロンプト | PowerShellでもコマンドプロンプトのコマンドが使用できる。<br>ただ、PowerShellで実行するのでコマンドが統一されていないとソースコードの可読性が悪くなる。<br>また、ISEで`cmd /c pause > $null` や`pause > $null`を実行してもエラーとなる。  | `pause`<br>上記のようにそのまま実行すると“続行するには何かキーを押してください . . .”と表示される。<br>この表示を消す場合は、`pause > $null` など標準出力を無視する方法で対応可能。<br>[参考情報：標準出力を無視する方法を紹介](https://zenn.dev/haretokidoki/articles/24ac3ba42d8050) |
| `Read-Host` | PowerShell | コンソールからテキスト入力を読み取る為のコマンドだが、一時停止としても使用可能。<br>PowerShellのコマンドレットで統一できる為、個人的にはこれを採用したい。<br>ただ、Read-Hostは文字の入力を受け付けるコマンドレットのため、Enterキー以外を押した場合は続行せずに文字が入力・表示されてしまう。 | 1行目：`Write-Host '一時停止中。Enterキーで続行してください。'`<br>2行目：`Read-Host > $null`<br><br>1行目でコンソール上にメッセージを表示。2行目は`Read-Host`で一時停止。標準出力は、`$null`にリダイレクトすることで無視する。 |
| `[Console]::ReadKey()` | \.NET Framework | キーボードの入力情報を取得するメソッド。コマンドプロンプトのPauseコマンド同様、何かキーを押すと次に進む。<br>ただ、Enterキー・Backspaceキー以外の文字入力するキーを押した場合、コンソール上にその文字が入力・表示された状態で続行される。<br>また、Windows PowerShell ISEでは実行できずにエラーとなる。 | 1行目：`Write-Host '一時停止中。いずれかのキーを押し続行してください。'`<br>2行目：`[Console]::ReadKey() > $null`<br><br>処理内容は`Write-Host`コマンドレットの使用例と同様。 |
| `$host.UI.RawUI.ReadKey()` | PowerShell | `[Console]::ReadKey()`と同様の機能を呼び出しているため、同じ動作となるが、PowerShellのホストオブジェクト経由で使用する。 | 1行目：`Write-Host '一時停止中。いずれかのキーを押し続行してください。'`<br>2行目：`$host.UI.RawUI.ReadKey() > $null`<br><br>処理内容は`Write-Host`コマンドレットの使用例と同様。 |
| `[System.Windows.Forms.MessageBox]::Show()` | \.NET Framework | GUIのメッセージボックスが表示される。OKボタンをクリックすると続行。<br>正直、PowerShellは基本的にCUIベースで実行される為、一時停止の時にだけメッセージボックスを使用すると統一感がなくなったしまうと感じる。<br>GUIベースで作成している場合、違和感は少ないと思うが、PowerShellではなくC#で開発した方がよさそう。 | `[System.Windows.Forms.MessageBox]::Show("一時停止中`r`nOKボタンを押し再開してください。")`<br><br>メッセージ内を`` `r`n ``で改行している。 |

## 参考情報

https://www.fenet.jp/infla/column/technology/powershellでpauseを実現するには？pauseの代用方法も紹介！/

https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/read-host

https://learn.microsoft.com/ja-jp/dotnet/api/system.console.readkey

https://learn.microsoft.com/ja-jp/dotnet/api/system.windows.messagebox.show