---
title: "VS Codeを使ってソースコードを比較する方法"
emoji: "🗂"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["vscode", "compare", "diff"]
published: false
---
## 概要
コードやファイルを比較する際は、今まで[WinMerge（ウィンマージ）](https://winmerge.org/?lang=ja)を使用していましたが、
Visual Studio Code（以下、VS Code）でも比較するコマンド、「 `compare` 」がありました。

簡易なファイル比較したい場合には、おすすめです。

## この記事のターゲット
- VS Codeユーザーの方
- VS Codeで簡単にファイルを比較したい方

## 対応方法
コマンドパレット（ `Ctrl + Shift + P` or `F1` ）でVS Codeの比較機能を呼び出して使用します。
下記が詳細な手順です。

1. VS Codeでショートカットキーでコマンドパレットを表示する
    ![](https://storage.googleapis.com/zenn-user-upload/4016979ba7b2-20230907.png)
    *画像：VS Codeでコマンドパレットを表示している状態*

1. コマンドパレットの入力欄で「 `compare` or `比較` 」を入力する
    - `compare`と入力した場合
        ![](https://storage.googleapis.com/zenn-user-upload/4bcd529d2477-20230907.png)
        *画像：コマンドパレットで「 `compare` 」を入力した状態*

    - `比較`と入力した場合
        ![](https://storage.googleapis.com/zenn-user-upload/e0e5c1bba7e0-20230907.png)
        *画像：コマンドパレットで「 `比較` 」を入力した状態*

1. 目的に合わせて比較するモードを選択する
    | No. | 比較モード | 比較モード | 用途 |
    | ---- | ---- | ---- | ---- |
    | 1 | ファイル: アクティブ ファイルを比較しています...<br>File: Compare Active File With... | 現在のアクティブファイル と 指定したファイル を比較する。 |
    | 2 | ファイル: クリップボードとアクティブ ファイルを比較<br>File: Compare Active File with Clipboard | `Ctrl + C`でクリップボードに保存された文字列 と 現在のアクティブファイル を比較する。 |
    | 3 | ファイル: 新しい無題のテキスト ファイルの比較<br>File: Compare New Untitled Text Files | 比較モードで新規テキストファイルを2つ開いた状態となる。 |
    | 4 | ファイル: 保存済みファイルと作業中のファイルを比較<br>File: Compare Active File with Saved | 未編集状態のアクティブファイル と 直近で保存しているアクティブファイル を比較する。 |
    | 5 | マージの場合: 現在の競合を比較<br>Merge Conflict: Compare Current Conflict | Git環境でブランチをマージした時にコンリクト（競合）が発生していないか比較する。 |
    
    今回は「 No.1 の アクティブファイル と 指定したファイル」で比較してみます。

1. 比較モードの一覧から「 ファイル: アクティブ ファイルを比較しています... 」を選択しEnter
1. 最近開いたもの一覧から“比較したいファイル”を選択
1. 比較モードが起動

### 比較モードで便利なショートカットキー
| ショートカットキー | 動作するアクション |
| ---- | ---- |
| `Alt + F5` | 次の差異 |
| `Shift + Alt + F5` | 前の差異 |
| `Ctrl + M` | “タブによるフォーカス移動”モードがオン<br>もう一度、入力するとモード解除。 |
| “タブによるフォーカス移動”モード中 `Tab` | 次のコントロールにフォーカスを移動<br>比較元のテキスト と 比較先のテキスト 間を移動する際に便利。 |
| “タブによるフォーカス移動”モード中 `Shift + Tab` | 前のコントロールにフォーカスを移動<br>比較元のテキスト と 比較先のテキスト 間を移動する際に便利。 |

## できること・できないこと
### できること
あまりいらないがレポート。イントラネットだと

一方、WinMergeなどの従来の比較ツールもしっかりと証跡（エビデンス）を残したい場合にレポートを出力できる為、
WinMergeだとHTML出力可能で表形式にする際に便利。

https://atmarkit.itmedia.co.jp/ait/articles/1806/08/news028.html

https://pokuwagata.hatenablog.com/entry/2018/12/09/145821

VS Codeだと比較結果のファイル出力ができない為、PowerShellを使って実行する。
下記の2点を組み合わせるとエビデンスになりそう。
https://feeld-uni.com/?p=1086

https://qiita.com/ktrarai/items/8bbc7566c82a3fc6d063

Compareの時にフォーカスを移動したい時、Ctrl + Mでタブで移動可能になる。
もう一度、押すとモード解除。
