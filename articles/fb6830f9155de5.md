---
title: "[PowerShell]å…±é€šåŒ–ã—ãŸFunctionã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ç´¹ä»‹"
emoji: "ğŸ‘´"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell", "ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰", "ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ "]
published: true
---
## æ¦‚è¦

ä¸»ã«Zennã®è¨˜äº‹ã§è‡ªä½œã—ãŸFunctionã‚„ã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç´¹ä»‹ã—ã¦ãã¾ã—ãŸã€‚
ãã‚Œã‚‰è¨˜äº‹ã®ä¸­ã§å…±é€šåŒ–ï¼ˆæ±ç”¨çš„ã«ä½¿ç”¨ï¼‰ã—ãŸFunctionã‚’ã“ã®è¨˜äº‹ã«é›†ç´„ã€‚

PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã™ã‚‹éš›ã®å‚è€ƒã«ã©ã†ãï¼

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- PowerShellãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- é »ç¹ã«æ›¸ãå‡¦ç†ã‚’å…±é€šåŒ–ã—ãŸã„æ–¹
- å…±é€šåŒ–ã—ãŸFunctionã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’å‚è€ƒã«ã—ãŸã„æ–¹

## Functionä¸€è¦§

:::message
**å…ƒè¨˜äº‹ã®ã‚³ãƒ¼ãƒ‰ã‹ã‚‰å°‘ã—æ‰‹ã‚’åŠ ãˆã¦ã„ã¾ã™**

è‡ªä½œã—ãŸFunctionã‚’å€‹ã€…ã®è¨˜äº‹ã§ã‚‚ç´¹ä»‹ã—ã¦ã„ã¾ã™ãŒã€ãã‚Œã‚‰è¨˜äº‹ã§ã¯çµæœã‚’è¦–è¦šçš„ã«è¦‹ã›ã‚‹ç‚ºã€
ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ï¼ˆ`Write-Host`ãªã©ï¼‰ã‚’å¤šç”¨ã—ã¦ã„ã¾ã™ã€‚

æœ¬æ¥ã€å®Ÿè£…ã™ã‚‹ä¸Šã§ã¯ä¸è¦ãªã‚³ãƒ¼ãƒ‰ã¨ãªã‚‹ç‚ºã€ã“ã“ã§ç´¹ä»‹ã™ã‚‹éš›ã¯æœ€é©åŒ–ã—ãŸã‚³ãƒ¼ãƒ‰ã‚’ç´¹ä»‹ã€‚
è©³ç´°ãªæ¤œè¨¼çµæœã¯ã€ãã‚Œãã‚Œã®è¨˜äº‹ã‚’ã”å‚ç…§ãã ã•ã„ã€‚
:::

### å€‹åˆ¥ã®è¨˜äº‹ã§ç´¹ä»‹ã—ãŸFunction

#### \[PowerShell\]è¤‡æ•°ã®ã‚µãƒ¼ãƒãƒ¼ã«å¯¾ã—æŒ‡å®šã—ãŸãƒãƒ¼ãƒˆã§ç–é€šç¢ºèªã™ã‚‹æ–¹æ³•

https://zenn.dev/haretokidoki/articles/1c671247e9523c

```powershell:ã‚¸ãƒ£ã‚°é…åˆ—ã®ãƒ‡ãƒ¼ã‚¿ã‚’å…ƒã«ãƒãƒ¼ãƒˆç–é€šã‚’ç¢ºèª
# Function å®šç¾©
function Check-PortMultipleServers {
    param (
        [Parameter(Mandatory=$true)][System.String[][]]$ServerPortPairs
    )
    $tempStrings=New-Object System.Text.StringBuilder

    for($i = 0; $i -lt $ServerPortPairs.Length; $i++) {
        $currentPair = $ServerPortPairs[$i]
        
        try {
            Test-NetConnection $currentPair[0] -Port $currentPair[1]
        }
        catch {
            $tempStrings=New-Object System.Text.StringBuilder
            @("Test-NetConnectionã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚`r`n",`
              "ã‚¨ãƒ©ãƒ¼ã¨ãªã£ãŸã‚³ãƒãƒ³ãƒ‰ï¼š[Test-NetConnection $($currentPair[0]) -Port $($currentPair[1])]")|
            ForEach-Object{[void]$tempStrings.Append($_)}
            [System.String]$messageError = $tempStrings.ToString()
            Write-Error $messageError
        }
    }
}
```

```powershell:Functionå®Ÿè¡Œ
# Function å®Ÿè¡Œ
[System.String[][]]$ServerPortPairs = @(
    @('localhost','8080'),
    @('localhost','8000'),
    @('google.com','443'),
    @('smtp.google.com','25')
)
Check-PortMultipleServers $ServerPortPairs

# å®Ÿè¡Œçµæœ
è­¦å‘Š: TCP connect to (::1 : 8080) failed
è­¦å‘Š: TCP connect to (127.0.0.1 : 8080) failed


ComputerName           : localhost
RemoteAddress          : ::1
RemotePort             : 8080
InterfaceAlias         : Loopback Pseudo-Interface 1
SourceAddress          : ::1
PingSucceeded          : True
PingReplyDetails (RTT) : 0 ms
TcpTestSucceeded       : False

ComputerName     : localhost
RemoteAddress    : ::1
RemotePort       : 8000
InterfaceAlias   : Loopback Pseudo-Interface 1
SourceAddress    : ::1
TcpTestSucceeded : True

ComputerName     : google.com
RemoteAddress    : 142.251.42.142
RemotePort       : 443
InterfaceAlias   : ã‚¤ãƒ¼ã‚µãƒãƒƒãƒˆ
SourceAddress    : XXX.XXX.XXX.XXX
TcpTestSucceeded : True

ComputerName     : smtp.google.com
RemoteAddress    : 64.233.187.27
RemotePort       : 25
InterfaceAlias   : ã‚¤ãƒ¼ã‚µãƒãƒƒãƒˆ
SourceAddress    : XXX.XXX.XXX.XXX
TcpTestSucceeded : True
```

#### \[PowerShell\]æŒ¿å…¥ã™ã‚‹ã‚¿ãƒ–æ•°ã‚’åˆ¶å¾¡ã—ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’åˆã‚ã›é…åˆ—ã‚’ä¸€æ‹¬å‡ºåŠ›ã™ã‚‹æ–¹æ³•

https://zenn.dev/haretokidoki/articles/2d0b0dcd503c2e

```powershell:é…åˆ—ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã™ã‚‹éš›ã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’åˆã‚ã›ã¦å‡ºåŠ›
function Show-StringsWithByteCount {
    param (
        [Parameter(Mandatory=$true)][System.Object[]]$StringArray
    )
    
    [System.Object[]]$byteCounts = $StringArray.Clone()
    [System.Int32]$i = 0
    [System.Int32]$maxLength = 0
    for ($i = 0; $i -lt $byteCounts.Count; $i++) {
        $byteCounts[$i] = [System.Text.Encoding]::GetEncoding("shift_jis").GetByteCount($byteCounts[$i])
        if ($maxLength -lt $byteCounts[$i]) {
            $maxLength = $byteCounts[$i]
        }
    }

    # ã‚¿ãƒ–æ•°ã®è¨ˆç®— ã¨ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›
    [System.Int32]$tabCount = 0
    [System.Int32]$tabWidth = 8
    Write-Host ''
    Write-Host ' ============ å‡ºåŠ›çµæœ ============ '
    Write-Host ''
    for ($i = 0; $i -lt $byteCounts.Count; $i++) {
        # ã‚¿ãƒ–ã®æ•°ã‚’è¨ˆç®—ã—ã¾ã™
        # æœ€é•·ã®æ–‡å­—åˆ—ã¨ã®å·®åˆ†ã‚’ã‚¿ãƒ–ã®å¹…ã§å‰²ã‚Šã€åˆ‡ã‚Šä¸Šã’ã¾ã™
        $tabCount = [Math]::Ceiling(($maxLength - [System.Int32]$byteCounts[$i]) / $tabWidth)
        # æœ€ä½1ã¤ã¯ã‚¿ãƒ–ã‚’æŒ¿å…¥ã™ã‚‹ã‚ˆã†è¨­å®š
        if ($tabCount -eq 0) {
            $tabCount = 1
        }

        # æœ€çµ‚æ¡ã«æ”¹è¡Œãªã—ã§å…ˆé ­éƒ¨ã®æ–‡å­—åˆ—ã‚’å‡ºåŠ›
        Write-Host "æ–‡å­—åˆ— [$($StringArray[$i])]" -NoNewline
        Write-Host ("`t" * $tabCount) -NoNewline
        # æœ€çµ‚æ¡ã«æ”¹è¡Œã‚ã‚Šã§ç¶šãæ–‡å­—åˆ—ã‚’å‡ºåŠ›
        Write-Host "ã€ãƒã‚¤ãƒˆæ•°ï¼ˆShift-JISï¼‰[$($byteCounts[$i])] byte"
    }
    Write-Host ''
    Write-Host ' ================================ '
    Write-Host ''
    Write-Host ''
}
```

```powershell:Functionå®Ÿè¡Œ
# Functionå®Ÿè¡Œ
$stringLists = @("1234567890", "ã‚", "ï½±", "123456789012345678901234567890", "abcdefg")
Show-StringsWithByteCount $stringLists

# å®Ÿè¡Œçµæœ
 ============ å‡ºåŠ›çµæœ ============

æ–‡å­—åˆ— [1234567890]                     ã€ãƒã‚¤ãƒˆæ•°ï¼ˆShift-JISï¼‰[10] byte
æ–‡å­—åˆ— [ã‚]                             ã€ãƒã‚¤ãƒˆæ•°ï¼ˆShift-JISï¼‰[2] byte
æ–‡å­—åˆ— [ï½±]                              ã€ãƒã‚¤ãƒˆæ•°ï¼ˆShift-JISï¼‰[1] byte
æ–‡å­—åˆ— [123456789012345678901234567890] ã€ãƒã‚¤ãƒˆæ•°ï¼ˆShift-JISï¼‰[30] byte
æ–‡å­—åˆ— [abcdefg]                        ã€ãƒã‚¤ãƒˆæ•°ï¼ˆShift-JISï¼‰[7] byte

 ================================
```

#### PowerShellã§æ–‡å­—åˆ—ã®ãƒã‚¤ãƒˆæ•°ã‚’å–å¾—ã™ã‚‹æ–¹æ³•ï¼ˆæ–‡å­—åˆ—æŠ½å‡ºã™ã‚‹Functionã‚‚ç´¹ä»‹ï¼‰

https://zenn.dev/haretokidoki/articles/3df8f03faeac28

```powershell:å¯¾è±¡æ–‡å­—åˆ—ã®ãƒã‚¤ãƒˆæ•°ï¼ˆShift JISï¼‰ã‚’å–å¾—
#################################################################################
# å‡¦ç†åã€€ | Get-SjisByteCount
# æ©Ÿèƒ½ã€€ã€€ | æ–‡å­—åˆ—å…¨ä½“ã®ãƒã‚¤ãƒˆæ•°ã‚’Shift JISã§å–å¾—
#--------------------------------------------------------------------------------
# æˆ»ã‚Šå€¤ã€€ | Int32ï¼ˆæ–‡å­—åˆ—ã®ãƒã‚¤ãƒˆæ•°ï¼‰
# å¼•æ•°ã€€ã€€ | TargetString: å¯¾è±¡æ–‡å­—åˆ—
#################################################################################
function Get-SjisByteCount {
    param (
        [Parameter(Mandatory=$true)][System.String]$TargetString
    )

    # æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’SJISã§è¨­å®š
    $sjisEncoding = [System.Text.Encoding]::GetEncoding("Shift_JIS")

    # æ–‡å­—åˆ—ã®ãƒã‚¤ãƒˆæ•°ã‚’è¿”ã™
    return $sjisEncoding.GetByteCount($TargetString)
}
```

```powershell:Functiionå®Ÿè¡Œ
# Functionå®Ÿè¡Œ
Get-SjisByteCount 'é …ç›®0001  '

# å®Ÿè¡Œçµæœ
10
```

```powershell:ãƒã‚¤ãƒˆæ•°ã‚’æŒ‡å®šã—ã¦æ–‡å­—åˆ—æŠ½å‡º
#################################################################################
# å‡¦ç†åã€€ | Get-SubstringByByte
# æ©Ÿèƒ½ã€€ã€€ | ãƒã‚¤ãƒˆæ•°ã§æ–‡å­—åˆ—ã‚’æŠ½å‡º
#--------------------------------------------------------------------------------
# æˆ»ã‚Šå€¤ã€€ | Stringï¼ˆæŠ½å‡ºã—ãŸæ–‡å­—åˆ—ï¼‰
# å¼•æ•°ã€€ã€€ | TargetString: å¯¾è±¡æ–‡å­—åˆ—
# ã€€ã€€ã€€ã€€ | ByteStart   : æŠ½å‡ºé–‹å§‹ã™ã‚‹ãƒã‚¤ãƒˆä½ç½®
# ã€€ã€€ã€€ã€€ | ByteLength  : æŒ‡å®šãƒã‚¤ãƒˆæ•°
#################################################################################
function Get-SubstringByByte {
    param (
        [Parameter(Mandatory=$true)][System.String]$TargetString,
        [Parameter(Mandatory=$true)][System.Int32]$ByteStart,
        [Parameter(Mandatory=$true)][System.Int32]$ByteLength
    )

    $sjisEncoding = [System.Text.Encoding]::GetEncoding("Shift_JIS")

    # æ–‡å­—åˆ—ã‚’ãƒã‚¤ãƒˆé…åˆ—ã«å¤‰æ›
    [System.Byte[]]$stringBytes = $sjisEncoding.GetBytes($TargetString)

    # æŠ½å‡ºã™ã‚‹ãƒã‚¤ãƒˆé…åˆ—ã‚’åˆæœŸåŒ–
    $substringBytes = New-Object Byte[] $ByteLength

    # æŒ‡å®šã•ã‚ŒãŸãƒã‚¤ãƒˆä½ç½®ã‹ã‚‰ãƒã‚¤ãƒˆé…åˆ—ã‚’æŠ½å‡º
    [System.Array]::Copy($stringBytes, $ByteStart, $substringBytes, 0, $ByteLength)

    # æŠ½å‡ºã—ãŸãƒã‚¤ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’æ–‡å­—åˆ—ã¨ã—ã¦è¿”ã™
    return $sjisEncoding.GetString($substringBytes)
}
```

```powershell:Functionå®Ÿè¡Œ
# Functionå®Ÿè¡Œ
# 4ãƒã‚¤ãƒˆç›®ã¨5ãƒã‚¤ãƒˆç›®ã®é–“ï¼ˆ$start = 4ï¼‰ã‚’é–‹å§‹ä½ç½®ã¨ã—ã¦4ãƒã‚¤ãƒˆåˆ†ï¼ˆ$length = 4ï¼‰ã®æ–‡å­—åˆ—ã‚’æŠ½å‡º
Get-SubstringByByte '1234ã‚ã‹' 4 4
# çµæœã€Œã‚ã‹ã€
```

#### â€œping -tâ€ã®ã‚ˆã†ã«PowerShellã§ã‚‚é€£ç¶šã—ã¦pingç–é€šã™ã‚‹æ–¹æ³•

https://zenn.dev/haretokidoki/articles/31ad6dfc204e38

```powershell:PowerShellã§é€£ç¶šPingç–é€šã‚’å®Ÿè¡Œ
# Functionã®å®šç¾©
function Invoke-ContinuousPing{
    param(
        [System.String]$TargetHost = 'localhost',
        [System.Int32]$PingInterval = 1000
    )
    # ãƒ–ãƒ¬ãƒ¼ã‚¯é€ä¿¡ã•ã‚Œã‚‹ã¾ã§ç¹°ã‚Šè¿”ã—
    while ($true) {
        try {
            # pingå®Ÿè¡Œ
            # [Microsoft.PowerShell.Commands.TestConnectionCommand+PingStatus]
            $pingResult = Test-Connection $TargetHost -Count 1 -ErrorAction Stop
            # ç”»é¢ã«çµæœè¡¨ç¤º
            [System.String]$currentDatetime = (Get-Date -Format "yyyy/MM/dd HH:mm:ss.fff")
            # ResponseTimeãŒ0ã®å ´åˆã€nullã«ãªã‚‹ãŸã‚åˆ¤å®šã™ã‚‹
            if ($null -eq $pingResult.ResponseTime) {
                # ResponseTImeãŒnullã®å ´åˆã¯ã€å›ºå®šå€¤"0 ms"
                Write-Output "$currentDatetime, $TargetHost, 0 ms"
            }
            else {
                # nullã§ã¯ãªã„å ´åˆã€å–å¾—ã—ãŸå€¤ã‚’è¨­å®š
                Write-Output "$currentDatetime, $TargetHost, $($pingResult.ResponseTime) ms"
            }
        }
        catch {
            Write-Host "ã‚¨ãƒ©ãƒ¼ï¼š$($_.Exception.Message)" -ForegroundColor Red
            # ã€Œping -tã€ã®æŒ™å‹•ã«åˆã‚ã›ã€pingç–é€šãŒå–ã‚Œãªãã¦ã‚‚å‡¦ç†ã‚’ç¶šè¡Œã™ã‚‹ã€‚
            # ã‚‚ã—ã€NGã¨ãªã£ãŸå ´åˆã«å‡¦ç†ã‚’ä¸­æ–­ã—ãŸã„å ´åˆã¯ã€ã“ã“ã§ã€Œbreakã€ã‚’å®Ÿè¡Œã€‚
            # break
        }
        # é–“éš”ã‚’ã‚ã‘ã‚‹
        Start-Sleep -Milliseconds $PingInterval
    }
}
```

```powershell:Functionå®Ÿè¡Œ
# Functionå®Ÿè¡Œ
Invoke-ContinuousPing www.bing.com

# å®Ÿè¡Œçµæœ
2024/05/17 12:21:53.557, www.bing.com, 28 ms
2024/05/17 12:21:54.643, www.bing.com, 21 ms
2024/05/17 12:21:55.703, www.bing.com, 21 ms
2024/05/17 12:21:56.821, www.bing.com, 78 ms
2024/05/17 12:21:57.884, www.bing.com, 21 ms
2024/05/17 12:21:58.949, www.bing.com, 22 ms
2024/05/17 12:22:00.019, www.bing.com, 21 ms
2024/05/17 12:22:01.143, www.bing.com, 92 ms
2024/05/17 12:22:02.212, www.bing.com, 21 ms
2024/05/17 12:22:03.289, www.bing.com, 21 ms
2024/05/17 12:22:04.342, www.bing.com, 21 ms
```

#### \[PowerShell\]è¤‡æ•°ã‚³ãƒãƒ³ãƒ‰æ ¼ç´ã—ãŸæ–‡å­—åˆ—é…åˆ—ã‚’ä¸€ã¤ã²ã¨ã¤å®Ÿè¡Œã™ã‚‹æ–¹æ³•

https://zenn.dev/haretokidoki/articles/84aea5bddf2dd6

```powershell:å¼•æ•°ã§æŒ‡å®šã—ãŸæ–‡å­—åˆ—é…åˆ—å†…ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ
# é–¢æ•°ã¨ã—ã¦å®šç¾©
function Invoke-MultipleCommands {
    param (
        # å¿…é ˆé …ç›®ï¼šå®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆãŒã‚ã‚‹æ–‡å­—åˆ—é…åˆ—ç”¨ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼
        [Parameter(Mandatory=$true)][System.String[]]$CommandList
    )
    # é…åˆ—å†…ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ç¹°ã‚Šè¿”ã—å‡¦ç†ã§å®Ÿè¡Œ
    foreach ($stringCommand in $CommandList) {
        # æ–‡å­—åˆ—ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã«å¤‰æ›
        $scriptblockCommand = [ScriptBlock]::Create($stringCommand)
        # ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã‚’å®Ÿè¡Œ
        Invoke-Command -ScriptBlock $scriptblockCommand
    }
}
```

```powershell:Functionå®Ÿè¡Œ
# Functionå®Ÿè¡Œ
Invoke-MultipleCommands -CommandList @('Get-Date', 'Get-Item .\', 'Get-PSDrive C')

# å®Ÿè¡Œæ‚”é
2024å¹´5æœˆ17æ—¥ 13:33:34

PSPath            : Microsoft.PowerShell.Core\FileSystem::C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"
PSParentPath      : Microsoft.PowerShell.Core\FileSystem::C:\Users
PSChildName       : "ãƒ¦ãƒ¼ã‚¶ãƒ¼å"
PSDrive           : C
PSProvider        : Microsoft.PowerShell.Core\FileSystem
PSIsContainer     : True
Name              : "ãƒ¦ãƒ¼ã‚¶ãƒ¼å"
FullName          : C:\Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"
Parent            : Users
Exists            : True
Root              : C:\
Extension         :
CreationTime      : 2024/03/13 10:05:45
CreationTimeUtc   : 2024/03/13 1:05:45
LastAccessTime    : 2024/05/17 13:33:25
LastAccessTimeUtc : 2024/05/17 4:33:25
LastWriteTime     : 2024/05/16 16:43:59
LastWriteTimeUtc  : 2024/05/16 7:43:59
Attributes        : Directory
Mode              : d-----
BaseName          : "ãƒ¦ãƒ¼ã‚¶ãƒ¼å"
Target            : {}
LinkType          :


CurrentLocation : Users\"ãƒ¦ãƒ¼ã‚¶ãƒ¼å"
Name            : C
Provider        : Microsoft.PowerShell.Core\FileSystem
Root            : C:\
Description     : OS
MaximumSize     :
Credential      : System.Management.Automation.PSCredential
DisplayRoot     :
Used            : 113491873792
Free            : 26460512256
```

#### PowerShellã§ æ–‡å­—ã‚³ãƒ¼ãƒ‰ ãŠã‚ˆã³ BOMä»˜ã ã‚’åˆ¤å®šã™ã‚‹Function

https://zenn.dev/haretokidoki/articles/962a7fc6c51b47

```powershell:PowerShellã§ç¾åœ¨ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª
# æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®åˆ¤å®š
function Get-PsEncoding {
    param (
        [Parameter(Mandatory=$true)][System.String]$TargetFile
    )

    $streamReader = New-Object System.IO.StreamReader (Convert-Path $TargetFile)
    $profileEncoding = $streamReader.CurrentEncoding
    $streamReader.Close()

    Write-Host "EncodingName: [$($profileEncoding.EncodingName)]"
}
```

```powershell:Functionå®Ÿè¡Œ
# Functionå®Ÿè¡Œ
Get-PsEncoding .\utf8.txt

# å®Ÿè¡Œçµæœ
EncodingName: [Unicode (UTF-8)]
```

```powershell:UTFã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒBOMä»˜ãã‹åˆ¤å®š
function Check-BOMStatus {
    param (
        [Parameter(Mandatory=$true)][System.String]$TargetFile
    )

    # ç„¡åŠ¹ãªãƒ•ã‚¡ã‚¤ãƒ«ã ã£ãŸå ´åˆ
    if (-Not (Test-Path $TargetFile)) {
        Write-Warning 'The target file does not exist.' -ForegroundColor Red
        return
    }
    
    # BOMã®ãƒã‚¤ãƒˆã‚·ãƒ¼ã‚±ãƒ³ã‚¹
    $UTF7_BOM1 = [System.Byte[]](0x2B,0x2F,0x76,0x38)
    $UTF7_BOM2 = [System.Byte[]](0x2B,0x2F,0x76,0x39)
    $UTF7_BOM3 = [System.Byte[]](0x2B,0x2F,0x76,0x2B)
    $UTF7_BOM4 = [System.Byte[]](0x2B,0x2F,0x76,0x2F)
    $UTF8_BOM = [System.Byte[]](0xEF,0xBB,0xBF)
    $UTF16BE_BOM = [System.Byte[]](0xFE,0xFF)
    $UTF16LE_BOM = [System.Byte[]](0xFF,0xFE)
    $UTF32BE_BOM = [System.Byte[]](0x00,0x00,0xFE,0xFF)
    $UTF32LE_BOM = [System.Byte[]](0xFF,0xFE,0x00,0x00)
    
    # å…ˆé ­è¡Œã‚’ãƒã‚¤ãƒˆã§èª­ã¿è¾¼ã¿å…ˆé ­ã‹ã‚‰3ãƒã‚¤ãƒˆåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
    [System.Byte[]]$first4Bytes = (Get-Content -Path $TargetFile -Encoding Byte -TotalCount 4)
    [System.Byte[]]$first3Bytes = $first4Bytes[0..2]
    [System.Byte[]]$first2Bytes = $first4Bytes[0..1]
    
    # å…ˆé ­ãƒã‚¤ãƒˆã§BOMä»˜ãã‹åˆ¤å®š
    # UTF-7
    if (($null -eq (Compare-Object $first4Bytes $UTF7_BOM1 -SyncWindow 0)) -Or
        ($null -eq (Compare-Object $first4Bytes $UTF7_BOM2 -SyncWindow 0)) -Or
        ($null -eq (Compare-Object $first4Bytes $UTF7_BOM3 -SyncWindow 0)) -Or
        ($null -eq (Compare-Object $first4Bytes $UTF7_BOM4 -SyncWindow 0))) {
        Write-Host "[$($TargetFile)] is UTF-7 BOM."
    }
    # UTF-8
    elseif ($null -eq (Compare-Object $first3Bytes $UTF8_BOM -SyncWindow 0)) {
        Write-Host "[$($TargetFile)] is UTF-8 BOM."
    }
    # UTF-16 BE
    elseif ($null -eq (Compare-Object $$first2Bytes $UTF16BE_BOM -SyncWindow 0)) {
        Write-Host "[$($TargetFile)] is UTF-16 BE BOM."
    }
    # UTF-16 LE
    elseif ($null -eq (Compare-Object $$first2Bytes $UTF16LE_BOM -SyncWindow 0)) {
        Write-Host "[$($TargetFile)] is UTF-16 LE BOM."
    }
    # UTF-32 BE
    elseif ($null -eq (Compare-Object $first4Bytes $UTF32BE_BOM -SyncWindow 0)) {
        Write-Host "[$($TargetFile)] is UTF-32 BE BOM."
    }
    # UTF-32 LE
    elseif ($null -eq (Compare-Object $first4Bytes $UTF32LE_BOM -SyncWindow 0)) {
        Write-Host "[$($TargetFile)] is UTF-32 LE BOM."
    }
    else {
        Write-Host "[$($TargetFile)] is not BOM." -ForegroundColor Red
    }
}
```

```powershell:Functionå®Ÿè¡Œ
# Functionå®Ÿè¡Œ
Check-BOMStatus .\utf8_bom.txt

# å®Ÿè¡Œçµæœ
[.\utf8_bom.txt] is UTF-8 BOM.
```

#### \[PowerShell\]å¤‰æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’ç°¡å˜ã«ç¢ºèªã§ãã‚‹Function

https://zenn.dev/haretokidoki/articles/1632e92c37ea98

```powershell:å¤‰æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’ç¢ºèª
function Get-Datatype {
    param (
        [Parameter(Mandatory=$true)]$Variable
    )

    # æ–‡å­—åˆ—é…åˆ—ã‚’å®£è¨€
    [System.String[]]$rowData = @(
        $Variable.GetType().BaseType.FullName,      # å¤‰æ•°ã®ãƒ™ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—
        $Variable.GetType().FullName                # å¤‰æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹
    )
    
    # PSCustomObjectã§é …ç›®åã‚’è¨­å®š
    $typesTable = [PSCustomObject]@{
        BaseType = $rowData[0]
        DataType = $rowData[1]
    }

    # ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§è¡¨ç¤º
    $typesTable | Format-Table -Property BaseType, DataType -AutoSize -Wrap
}
```

```powershell:Functionå®Ÿè¡Œ
$lists = @(
    @('AAAA',1),
    @('BBBB',2),
    @('CCCC',3)
)
# Functionå®Ÿè¡Œ
Get-Datatype $lists

# å®Ÿè¡Œçµæœ
BaseType     DataType
--------     --------
System.Array System.Object[]
```

#### \[PowerShell\]æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¨ç®¡ç†è€…æ¨©é™ã‚’åˆ¤å®šã—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚¿ã‚¤ãƒˆãƒ«ã‚’å¤‰æ›´

https://zenn.dev/haretokidoki/articles/67788ca9b47b27

```powershell:PowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¿ã‚¤ãƒˆãƒ«ã«â€œæ–‡å­—ã‚³ãƒ¼ãƒ‰â€ã¨â€œç®¡ç†è€…æ¨©é™ã®æœ‰ç„¡â€ã‚’è¿½åŠ 
# ç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œã—ã¦ã„ã‚‹ã‹ç¢ºèªï¼ˆTrueã®å ´åˆã€â€œç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œâ€ã—ã¦ã„ã‚‹ã¨åˆ¤æ–­ï¼‰
function Is-AdminPowerShell {
    $winId = [System.Security.Principal.WindowsIdentity]::GetCurrent()
    $winPrincipal = new-object System.Security.Principal.WindowsPrincipal($winId)
    $adminPermission = [System.Security.Principal.WindowsBuiltInRole]::Administrator
    return $winPrincipal.IsInRole($adminPermission)
}
# ç¾åœ¨ã€è¨­å®šã—ã¦ã„ã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—
function Get-PsCharcode {
    [System.String[]]$psCharcode = @(
        # ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã™ã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®è¦å®šå€¤
        ($PSDefaultParameterValues['*:Encoding']),
        # PowerShellã‹ã‚‰å¤–éƒ¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«æ¸¡ã™æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã®è¨­å®š
        ($global:OutputEncoding).WebName,
        # PowerShellã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã™ã‚‹æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã®è¨­å®š
        ([console]::OutputEncoding).WebName
    )

    return $psCharcode
}
# PowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¿ã‚¤ãƒˆãƒ«å¤‰æ›´
function Change-WindowTitle {
    # åŒºåˆ‡ã‚Šæ–‡å­—ã®è¨­å®š
    [System.String]$separator1 = '|'
    [System.String]$separator2 = ';'

    # ç¾åœ¨ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å–å¾—

    [System.String]$title = $Host.UI.RawUI.WindowTitle
    [System.String]$baseTitle = $title

    # ã™ã§ã«ã“ã®Functionã§ã‚¿ã‚¤ãƒˆãƒ«å¤‰æ›´ã—ã¦ã„ã‚‹å ´åˆã€ä¸€ç•ªå·¦ã«ã‚ã‚‹å…ƒã®ã‚¿ã‚¤ãƒˆãƒ«åã®ã¿æŠ½å‡º
    [System.String[]]$titleArray = $title.Split($separator1)
    if ($titleArray.Length -ne 0) {
        $baseTitle = ($titleArray[0]).TrimEnd()
    }

    # ç¾åœ¨ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—
    [System.String[]]$psCharcode = Get-PsCharcode

    # ç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œã—ã¦ã„ã‚‹ã‹ã«ã‚ˆã‚Šè¨­å®šã™ã‚‹ã‚¿ã‚¤ãƒˆãƒ«åã‚’åˆ†å²
    [System.String]$changeTitle = $baseTitle
    if (Is-AdminPowerShell) {
        # PowerShellã‚’ç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œã—ã¦ã„ã‚‹å ´åˆ
        $changeTitle = "$baseTitle $separator1 " +
                       "DefaultParameter=[$($psCharcode[0])] $separator2 " +
                       "GlobalEncoding=[$($psCharcode[1])] $separator2 " +
                       "ConsoleEncoding=[$($psCharcode[2])] $separator2 " +
                       "#Administrator"
    }
    else {
        # ã—ã¦ã„ãªã„å ´åˆ
        $changeTitle = "$baseTitle $separator1 " +
                       "DefaultParameter=[$($psCharcode[0])] $separator2 " +
                       "GlobalEncoding=[$($psCharcode[1])] $separator2 " +
                       "ConsoleEncoding=[$($psCharcode[2])] $separator2 " +
                       "#Administrator"
    }
    $Host.UI.RawUI.WindowTitle = $changeTitle
}
```

```powershell:Functionå®Ÿè¡Œ
# Functionå®Ÿè¡Œ
Change-WindowTitle
# å®Ÿè¡Œçµæœï¼ˆPowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’ç¢ºèªï¼‰
Windows PowerShell | DefaultParameter=[] ; GlobalEncoding=[us-ascii] ; ConsoleEncoding=[shift_jis] ; #Administrator
```

#### \[PowerShell\]wingetã®çµæœã‚’å¤‰æ•°ã«ä»£å…¥ã—å‡ºåŠ›ã™ã‚‹ã¨æ–‡å­—åŒ–ã‘ãŒç™ºç”Ÿ

https://zenn.dev/haretokidoki/articles/8946231076f129

```powershell:PowerShellã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’è¨­å®š
function Set-PsOutputEncoding {
    param (
        [System.String]$CharCode = 'reset_encoding'
    )

    switch ($CharCode) {
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’UTF8ã«è¨­å®šã™ã‚‹
        'utf8' {
            $PSDefaultParameterValues['*:Encoding'] = 'utf8'
            $global:OutputEncoding = [System.Text.Encoding]::UTF8
            [console]::OutputEncoding = [System.Text.Encoding]::UTF8
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’Shift JISï¼ˆSJISï¼‰ã«è¨­å®šã™ã‚‹
        'sjis' {
            # $PSDefaultParameterValues['*:Encoding'] = 'default'ã«ã¤ã„ã¦
            #   ã“ã®è¨­å®šã¯Coreä»¥å¤–ï¼ˆ5.1ä»¥å‰ï¼‰ã®ç’°å¢ƒã§ã®ã¿Shift JISã§è¨­å®šã•ã‚Œã‚‹ã€‚
            #   Coreç’°å¢ƒã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯ã€UTF-8ã§ã‚ã‚ŠUTF-8ã§è¨­å®šã•ã‚Œã¦ã—ã¾ã†ã€‚
            #   ã¾ãŸã€Shift JISã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚‚å­˜åœ¨ã—ãªã„ç‚ºã€Coreç’°å¢ƒã§Shift JISã®è¨­å®šã¯ä¸å¯ã¨ãªã‚‹ã€‚
            $PSDefaultParameterValues['*:Encoding'] = 'default'
            $global:OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
            [console]::OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’ASCIIã«è¨­å®šã™ã‚‹
        'ascii' {
            $PSDefaultParameterValues.Remove('*:Encoding')
            $global:OutputEncoding = [System.Text.Encoding]::ASCII
            [console]::OutputEncoding = [System.Text.Encoding]::ASCII
        }
        # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰æŒ‡å®šã‚’è§£é™¤ã™ã‚‹
        'rm_encoding' {
            $PSDefaultParameterValues.Remove('*:Encoding')
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰è¨­å®šã‚’åˆæœŸçŠ¶æ…‹ã«æˆ»ã™
        'reset_encoding' {
            $PSDefaultParameterValues.Remove('*:Encoding')

            if ($PSVersionTable.PSEdition -eq 'Core') {
                # Core ã®å ´åˆ
                $global:OutputEncoding = [System.Text.Encoding]::UTF8
                [console]::OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
            }
            else {
                # Core ä»¥å¤–ã®å ´åˆï¼ˆPowerShell 5.1 ä»¥å‰ï¼‰
                $global:OutputEncoding = [System.Text.Encoding]::ASCII
                [console]::OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
            }
        }
    }
}
```

```powershell:Functionå®Ÿè¡Œ
# Functionå®Ÿè¡Œ
Set-PsOutputEncoding 'utf8'
# å®Ÿè¡Œçµæœï¼ˆChange-WindowTitleã§ã‚¿ã‚¤ãƒˆãƒ«ã‚’ç¢ºèªï¼‰
Windows PowerShell | DefaultParameter=[utf8] ; GlobalEncoding=[utf-8] ; ConsoleEncoding=[utf-8] ; #Administrator
```

#### PowerShellã‹ã‚‰Pythonã®chardetã‚’ä½¿ã£ã¦æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’åˆ¤å®š

https://zenn.dev/haretokidoki/articles/aea5b45679d966

```powershell:æ–‡å­—åˆ—åˆ¤å®šå¯èƒ½ãªPythonã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€Œchardetã€ã‚’PowerShellã‹ã‚‰å‘¼ã³å‡ºã™
function Get-PyEncoding {
    param (
        [Parameter(Mandatory=$true)][System.String]$TargetFile
    )

    # python ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
    if (-Not(Get-Command 'python' -ErrorAction SilentlyContinue)) {
        Write-Host 'Python is not install.' -ForegroundColor Red
        return
    }

    # å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    if (-Not(Test-Path $TargetFile)) {
        Write-Host "[$TargetFile] does not exist." -ForegroundColor Red
        return
    }

    # çµ¶å¯¾ãƒ‘ã‚¹ã«å¤‰æ›
    [System.String]$fullPath = (Convert-Path $TargetFile)
    
    # ãƒ‡ãƒ¼ã‚¿ç¨®é¡ã®ãƒã‚§ãƒƒã‚¯
    if (-Not(Test-Path $fullPath -PathType Leaf)) {
        Write-Host "[$fullPath] is not a file." -ForegroundColor Red
        return
    }

    # Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ã‚³ãƒ¼ãƒ‰
    [System.String[]]$pySource = 
@"
import subprocess
import sys

# chardet ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
try:
    import chardet
except ImportError:
    subprocess.check_call([sys.executable, '-m', 'pip', 'install', 'chardet', '--user'])
    import chardet

# æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’åˆ¤å®šã™ã‚‹Function
def determine_encoding(file_path):
    with open(file_path, 'rb') as file:
        raw_data = file.read()
        result = chardet.detect(raw_data)
        print(f"Detected encoding for [{file_path}] is {result['encoding']} with {result['confidence']*100}% confidence.")

# ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã®å¼•æ•°ã‚’å–å¾—
file_path = sys.argv[1]

# å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®æ–‡å­—åˆ—ã‚’åˆ¤å®š
determine_encoding(file_path)

"@ -split "`r`n"

    # Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æº–å‚™
    #   Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ ¼ç´ã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯ã€æ–°è¦ä½œæˆ
    [System.String]$pyFolderPath = "$PROFILE\..\user-defined-py"
    if (-Not(Test-Path $pyFolderPath)) {
        New-Item -Path $pyFolderPath -ItemType 'directory' -Force > $null
    }
    $pyFolderPath = (Convert-Path $pyFolderPath)
    #   ä»Šå›å®Ÿè¡Œã™ã‚‹Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒãªã„å ´åˆã¯ã€æ–°è¦ä½œæˆ
    [System.String]$pyScriptPath = "$pyFolderPath\chardet_runner.py"
    if (-Not(Test-Path $pyScriptPath)) {
        $utf8Encoding = New-Object System.Text.UTF8Encoding
        [System.IO.File]::WriteAllText($pyScriptPath, $pySource, $utf8Encoding)
    }

    # Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œ
    try {
        & python $pyScriptPath $fullPath
    }
    catch {
        Write-Warning 'Python script execution error.'
        return
    }
}
```

```powershell:Functionå®Ÿè¡Œ
# Functionå®Ÿè¡Œ
Get-PyEncoding .\utf16.txt

# å®Ÿè¡Œçµæœ
Detected encoding for [D:\Downloads\utf16.txt] is ascii with 100.0% confidence.
```

#### PowerShellã§ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’ä¸€æ‹¬å¤‰æ›ã™ã‚‹Function

https://zenn.dev/haretokidoki/articles/cdaf8a77dfc892

```powershell:ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’ä¸€æ‹¬å¤‰æ›
# æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’å¯è¦–åŒ–ã™ã‚‹Function
function Show-Returncode {
    param (
        [Parameter(Mandatory=$true)][System.String]$TargetFile,
        [ValidateSet('CRLF', 'LF')][System.String]$Returncode = 'CRLF'
    )

    [System.Collections.Hashtable]$ReturncodeRegex = @{
        'CR'   = "`r"
        'LF'   = "`n"
        'CRLF' = "`r`n"
    }

    [System.Collections.Hashtable]$ReturncodeMark = @{
        'CR'   = '<CR>'
        'LF'   = '<LF>'
        'CRLF' = '<CRLF>'
    }

    # ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã™ã‚‹éš›ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã€‚æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã¯å¼•æ•°ã§æŒ‡å®šã—ãŸ CRLF ã‹ LF ãŒå…¥ã‚‹ã€‚
    [System.Collections.Hashtable]$ReturncodeVisualize = @{
        'CR'   = "<CR>$($ReturncodeRegex[$Returncode])"
        'LF'   = "<LF>$($ReturncodeRegex[$Returncode])"
        'CRLF' = "<CRLF>$($ReturncodeRegex[$Returncode])"
    }

    # æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’ãƒãƒ¼ã‚¯ã«å¤‰æ›
    [System.String]$targetData = (Get-Content -Path $TargetFile -Raw)
    $targetData = $targetData -Replace $ReturncodeRegex['CRLF'], $ReturncodeMark['CRLF']
    $targetData = $targetData -Replace $ReturncodeRegex['LF'], $ReturncodeMark['LF']
    $targetData = $targetData -Replace $ReturncodeRegex['CR'], $ReturncodeMark['CR']

    # ãƒãƒ¼ã‚¯ã‹ã‚‰ãƒãƒ¼ã‚¯ï¼‹æ”¹è¡Œã‚³ãƒ¼ãƒ‰ï¼ˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºç”¨ï¼‰ã«å¤‰æ›
    $targetData = $targetData -Replace $ReturncodeMark['CRLF'], $ReturncodeVisualize['CRLF']
    $targetData = $targetData -Replace $ReturncodeMark['LF'], $ReturncodeVisualize['LF']
    $targetData = $targetData -Replace $ReturncodeMark['CR'], $ReturncodeVisualize['CR']

    Write-Host ''
    Write-Host ' *-- Result: Show-Returncode ---------------------------------------------* '
    Write-Host $targetData
    Write-Host ' *----------------------------------------------------------------------------* '
    Write-Host ''
    Write-Host ''
}

# æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›ã™ã‚‹Function
function Replace-Returncode {
    param (
        # å¿…é ˆï¼šå¤‰æ›å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®š
        [Parameter(Mandatory=$true)][System.String]$TargetFile,
        # å¿…é ˆï¼šå¤‰æ›ã™ã‚‹å‰å¾Œã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®š
        [Parameter(Mandatory=$true)][ValidateSet('CR', 'LF', 'CRLF')][System.String]$BeforeReturncode,
        [Parameter(Mandatory=$true)][ValidateSet('CR', 'LF', 'CRLF', 'NONE')][System.String]$AfterReturncode,
        # ä»»æ„ï¼šå¤‰æ›å¾Œã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã§ä¿å­˜ã—ãŸã„å ´åˆã«ä¿å­˜å…ˆã‚’æŒ‡å®š
        [System.String]$Destination='',
        # ä»»æ„ï¼šå¤‰æ›å¾Œã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¯è¦–åŒ–ã—ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºã—ãŸã„å ´åˆã«æŒ‡å®š
        [System.Boolean]$Show=$false
    )

    # Beforeãƒ»AfterãŒç•°ãªã‚‹æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    if ($BeforeReturncode -eq $AfterReturncode) {
        Write-Warning 'å¼•æ•°ã§æŒ‡å®šã•ã‚ŒãŸ å¤‰æ›å‰ ã¨ å¤‰æ›å¾Œ ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ãŒåŒä¸€ã§ã™ã€‚å¼•æ•°ã‚’è¦‹ç›´ã—ã¦ãã ã•ã„ã€‚'
        return
    }

    # ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆ
    if (-Not(Test-Path $TargetFile)) {
        Write-Warning 'å¤‰æ›å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã™ã€‚'
        return
    }

    # ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒãªã„å ´åˆ
    [System.String]$beforeData = (Get-Content -Path $TargetFile -Raw)
    if ($null -eq $beforeData) {
        Write-Warning 'å¤‰æ›å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ãŒç©ºã§ã™ã€‚å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã™ã€‚'
        return
    }

    # æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã®ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
    [System.Collections.Hashtable]$ReturncodeRegex = @{
        'CR'   = "`r"
        'LF'   = "`n"
        'CRLF' = "`r`n"
        'NONE' = ''
    }

    # æŒ‡å®šã—ãŸå¤‰æ›å‰å¾Œã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’æ­£è¦è¡¨ç¾ã®è¡¨è¨˜ã«å¤‰æ›´
    [System.String]$beforeReturncodeRegex = $ReturncodeRegex[$BeforeReturncode]
    [System.String]$afterReturncodeRegex = $ReturncodeRegex[$AfterReturncode]

    # å¤‰æ›å‡¦ç†
    [System.String]$afterData = ($beforeData -Replace $beforeReturncodeRegex, $afterReturncodeRegex)
    
    # å¤‰æ›ã•ã‚Œãªã‹ã£ãŸå ´åˆ
    if ($null -eq (Compare-Object $beforeData $afterData -SyncWindow 0)) {
        Write-Warning 'å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã—ãŸãŒã€å¯¾è±¡ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ãŒãªãå¤‰æ›ã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚å‡¦ç†ã‚’çµ‚äº†ã—ã¾ã™ã€‚'
        return
    }
    # ä¿å­˜å…ˆã®æŒ‡å®šãŒãªã„å ´åˆã€ä¸Šæ›¸ãä¿å­˜
    if ($Destination -eq '') {
        $Destination = $TargetFile
        Write-Host ''
        Write-Host 'ä¸Šæ›¸ãä¿å­˜ã—ã¾ã™ã€‚'
    }
    # ä¿å­˜å…ˆãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã§ä¿å­˜ï¼ˆåå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ï¼‰
    else {
        if (Test-Path $Destination -PathType Leaf) {
            Write-Warning 'æŒ‡å®šã®ä¿å­˜å ´æ‰€ã«ã¯ã€ã™ã§ã«ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã™ã€‚å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã™ã€‚'
            return
        }
        if (-Not(Test-Path "$Destination\.." -PathType Container)) {
            Write-Warning 'ä¿å­˜å ´æ‰€ã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã™ã€‚'
            return
        }
        Write-Host ''
        Write-Host 'åå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ã—ã¾ã™ã€‚'
    }
    # ä¿å­˜
    Try {
        Set-Content -Path $Destination -Value $afterData -NoNewline
    }
    catch {
        Write-Error 'Replace-Returncodeã®ä¿å­˜å‡¦ç†ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã™ã€‚'
        return
    }
    [System.String]$savepath_full = Convert-Path $Destination
    Write-Host "ã€€ä¿å­˜å…ˆ: [$savepath_full]"
    Write-Host ''
    Write-Host ''
    
    # è¡¨ç¤º
    if ($Show) {
        Show-Returncode($Destination)
    }
}
```

`D:\Downloads\utf8.txt` ã‚’å¯¾è±¡ã«æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’ CRLF ã‹ã‚‰ LF ã«å¤‰æ›ã—ã¾ã™ã€‚
ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€Œ-Showã€ã‚’ `$True` ã§ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã—ã¦ã„ã‚‹ç‚ºã€è‡ªå‹•çš„ã«Function `Show-Returncode`ãŒå‘¼ã³å‡ºã•ã‚Œã¦ã€
å¤‰æ›ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’å¯è¦–åŒ–ã—ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell:Functionå®Ÿè¡Œ
PS D:\Downloads> Show-Returncode .\utf8.txt

 *-- Result: Show-Returncode ---------------------------------------------*
test<CRLF>

 *----------------------------------------------------------------------------*


PS D:\Downloads>
PS D:\Downloads> Replace-Returncode .\utf8.txt CRLF LF .\utf8_lf.txt $true

åå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ã—ã¾ã™ã€‚
ã€€ä¿å­˜å…ˆ: [D:\Downloads\utf8_lf.txt]



 *-- Result: Show-Returncode ---------------------------------------------*
test<LF>

 *----------------------------------------------------------------------------*


PS D:\Downloads>
```

#### è¤‡æ•°IDã‚’æ¤œç´¢ã‚­ãƒ¼ã«winget showã®çµæœã‚’æŠ½å‡ºã—è¡¨ç¤ºã™ã‚‹Function

https://zenn.dev/haretokidoki/articles/d2c98229b3ca95

```powershell:ã€Œwinget showã€ã®çµæœã‹ã‚‰å¯¾è±¡IDã®æƒ…å ±ã‚’æŠ½å‡º
# Function
function Write-WingetShow {
    param (
        [System.String[]]$TargetIDs
    )
    # æŠ½å‡ºå¯¾è±¡ã®æ–‡å­—åˆ—ã‚’æŒ‡å®š
    [System.String]$hitMessage = 'è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ '
    [System.String]$installerType = '  ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã®ç¨®é¡: '

    # æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’UTF-8ã«å¤‰æ›´
    [console]::OutputEncoding = [System.Text.Encoding]::UTF8

    # ã‚³ãƒãƒ³ãƒ‰çµæœã‹ã‚‰æŠ½å‡ºã—ã‚¢ãƒ—ãƒªåãƒ»IDãƒ»ã‚½ãƒ¼ã‚¹ã®ã¿ã‚’è¡¨ç¤º
    foreach ($id in $TargetIDs) {
        [System.String[]]$appInfo = (winget show --id $id)
        # æ¤œç´¢çµæœã‚ã‚Š
        if ($appInfo -match $hitMessage) {
            $appNameAndId = $appInfo | Select-String "$hitMessage.*" | ForEach-Object {
                $_.Matches[0].Value -replace "$hitMessage", ''
            }
            $appSource = $appInfo | Select-String "$installerType.*" | ForEach-Object {
                $_.Matches[0].Value -replace "$installerType", ''
            }
            Write-Host "$appNameAndId [$appSource]"
        }
        # æ¤œç´¢çµæœãªã—
        else {
            Write-Warning "è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ID: [$id]"
            # ä¸­æ–­ã™ã‚‹å ´åˆã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆè§£é™¤
            #return
        }
    }
}
```

```powershell:Functionå®Ÿè¡Œ
# æ¤œç´¢å¯¾è±¡ã®IDã‚’é…åˆ—ã§æŒ‡å®š
$searchIDs = @(
    'Microsoft.Edge',
    '1234567890AB',
    'XPFFZHVGQWWLHB',
    'Microsoft.VCLibs.Desktop.14'
)

# Function ã®å®Ÿè¡Œ
Write-WingetShow $searchIDs

# å®Ÿè¡Œçµæœ
Microsoft Edge [Microsoft.Edge] [msi]
è­¦å‘Š: è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ID: [1234567890AB]
OneNote [XPFFZHVGQWWLHB] [exe]
Microsoft Visual C++ 2015 UWP Desktop Runtime Package [Microsoft.VCLibs.Desktop.14] [msix]
```

#### PowerShell 6.0ä»¥é™ï¼ˆCoreï¼‰ã§OSç’°å¢ƒã‚’ç¢ºèªã§ãã‚‹è‡ªå‹•å¤‰æ•°

https://zenn.dev/haretokidoki/articles/fac8e50fbe9dcd

```powershell:PowerShellå®Ÿè¡Œç’°å¢ƒã‚’ãƒã‚§ãƒƒã‚¯
# ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ enumè¨­å®š
Add-Type -TypeDefinition @"
    public enum MESSAGECODE {
        Successful = 0,
        Error_NotCore,
        Error_NotSupportedVersion,
        Error_NotWindows
    }
"@
#################################################################################
# å‡¦ç†åã€€ | Check-PsEnv
# æ©Ÿèƒ½ã€€ã€€ | PowerShellç’°å¢ƒãƒã‚§ãƒƒã‚¯
#--------------------------------------------------------------------------------
# æˆ»ã‚Šå€¤ã€€ | MESSAGECODEï¼ˆenumï¼‰
# å¼•æ•°ã€€ã€€ | ãªã—
#################################################################################
function Check-PsEnv {
    [MESSAGECODE]$returncode = [MESSAGECODE]::Successful

    # ç’°å¢ƒæƒ…å ±ã‚’å–å¾—
    [System.Collections.Hashtable]$psVersion = $PSVersionTable

    # ç’°å¢ƒã®åˆ¤å®šï¼šCoreã§ã¯ãªã„å ´åˆï¼ˆ5.1ã ã¨'Desktop'ã¨ãªã‚‹ï¼‰
    if ($psVersion.PSEdition -ne 'Core') {
        $returncode = [MESSAGECODE]::Error_NotCore
        Write-Host 'Coreï¼ˆ6.0ä»¥é™ï¼‰ã®ç’°å¢ƒã§ã¯ãªã„' -ForegroundColor Red
    }
    # ç’°å¢ƒã®åˆ¤å®šï¼šãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ7ã‚ˆã‚Šå°ã•ã„å ´åˆ
    elseif ($psVersion.PSVersion.Major -lt 7) {
        $returncode = [MESSAGECODE]::Error_NotSupportedVersion
        Write-Host 'Coreï¼ˆ6.0ä»¥é™ï¼‰ã®ç’°å¢ƒã ãŒã€7ä»¥ä¸Š ã®ç’°å¢ƒã§ã¯ãªã„' -ForegroundColor Red
    }
    # ç’°å¢ƒã®åˆ¤å®šï¼šWindows OSã§ã¯ãªã„å ´åˆï¼ˆPowerShell Coreã®ã¿ä½¿ç”¨ã§ãã‚‹è‡ªå‹•å¤‰æ•°ï¼‰
    elseif (-Not($IsWindows)) {
        $returncode = [MESSAGECODE]::Error_NotWindows
        Write-Host 'Coreï¼ˆ6.0ä»¥é™ï¼‰ã®ç’°å¢ƒã§ã€ã‹ã¤ 7ä»¥ä¸Š ã®ç’°å¢ƒã ãŒã€Windows OS ã®ç’°å¢ƒã§ã¯ãªã„' -ForegroundColor Red
    }
    else {
        Write-Host 'Coreï¼ˆ6.0ä»¥é™ï¼‰ã®ç’°å¢ƒã§ã€ã‹ã¤ 7ä»¥ä¸Š ã®ç’°å¢ƒã€Windows OS ã®ç’°å¢ƒã§ã‚ã‚‹'
    }

    return $returncode
}
```

#### \[PowerShell\]é…åˆ—ã®ç¨®é¡ï¼ˆã‚¸ãƒ£ã‚°é…åˆ— or å¤šæ¬¡å…ƒé…åˆ—ï¼‰ã‚’åˆ¤å®šã™ã‚‹Function"

2024.6.13 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/45c5af7cbf7eb8

```powershell:å¼•æ•°ã®é…åˆ—ã®ç¨®é¡ã‚’åˆ¤å®šã™ã‚‹Function
function Get-ArrayType {
    param(
        $InputObject
    )
    
    [System.Collections.Hashtable]$arrayTypes = @{
        "OtherTypes" = -1
        "SingleArray" = 0
        "MultiLevel" = 1
        "MultiDimensional" = 2
    }

    # ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆ
    if ($null -eq $InputObject) {
        return $arrayTypes["OtherTypes"]
    }

    # ä¸€ç•ªå¤–æ ãŒé…åˆ—ã§ã¯ãªã„å ´åˆ
    if ($InputObject -isnot [System.Array]) {
        return $arrayTypes["OtherTypes"]
    }

    # ã‚¸ãƒ£ã‚°é…åˆ—ï¼ˆå¤šæ®µéšé…åˆ—ï¼‰ã‹åˆ¤å®š
    $isMultiLevel = $false
    foreach ($element in $InputObject) {
        if ($element -is [System.Array]) {
            # é…åˆ—ã®ä¸­ã‚‚é…åˆ—ã§å¤šæ®µé…åˆ—
            $isMultiLevel = $true
            break
        }
    }
    if ($isMultiLevel) {
        return $arrayTypes["MultiLevel"]
    }    
    
    # å¤šæ¬¡å…ƒé…åˆ—ã‹åˆ¤å®š
    if ($InputObject.Rank -ge 2) {
        # 2æ¬¡å…ƒä»¥ä¸Šã®å ´åˆ
        return $arrayTypes["MultiDimensional"]
    }
    else {
        # 1æ¬¡å…ƒã®å ´åˆ
        return $arrayTypes["SingleArray"]
    }
}
```

```powershell:Functionå®Ÿè¡Œ
# ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®æº–å‚™

#   å˜ä¸€ã®é…åˆ—
$singleArray = @('ã‚', 'ã„', 'ã†')

#   å¤šæ®µéšé…åˆ—
$multiLevel = @(@(1, 2, 3), @(4, 5), @(6, 7, 8, 9))

#   Stringå‹ã®1x2 å¤šæ¬¡å…ƒé…åˆ—
$stringMultiDim1x2 = New-Object 'System.String[,]' 1,2
$stringMultiDim1x2[0,0] = 'Hello'
$stringMultiDim1x2[0,1] = 'World'

#   Int32å‹ã®3x2 å¤šæ¬¡å…ƒé…åˆ—
$intMultiDim3x2 = New-Object 'System.Int32[,]' 3,2
$intMultiDim3x2[0,0] = 1
$intMultiDim3x2[0,1] = 2
$intMultiDim3x2[1,0] = 3
$intMultiDim3x2[1,1] = 4
$intMultiDim3x2[2,0] = 5
$intMultiDim3x2[2,1] = 6

#   Objectå‹ã®3x1 å¤šæ¬¡å…ƒé…åˆ—
$objectMultiDim3x1 = New-Object 'System.Object[,]' 3,1
$objectMultiDim3x1[0,0] = 'I am String.'
$objectMultiDim3x1[1,0] = 1
$objectMultiDim3x1[2,0] = 10.5

#   ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’é›†ç´„
$testData = @(
    @{ "Description" = "å˜ä¸€é…åˆ—"; "InputObject" = $singleArray },
    @{ "Description" = "å¤šæ®µéšé…åˆ—"; "InputObject" = $multiLevel },
    @{ "Description" = "Stringå‹1x2å¤šæ¬¡å…ƒé…åˆ—"; "InputObject" = $stringMultiDim1x2 },
    @{ "Description" = "Int32å‹3x2å¤šæ¬¡å…ƒé…åˆ—"; "InputObject" = $intMultiDim3x2 }
    @{ "Description" = "Objectå‹3x1å¤šæ¬¡å…ƒé…åˆ—"; "InputObject" = $objectMultiDim3x1 }
)

# Functionã‚’å®Ÿè¡Œ
foreach ($data in $testData) {
    $result = Get-ArrayType -InputObject $data["InputObject"]
    Write-Host "$($data["Description"])ã®çµæœ: $result"
}

# å®Ÿè¡Œçµæœ
å˜ä¸€é…åˆ—ã®çµæœ: 0
å¤šæ®µéšé…åˆ—ã®çµæœ: 1
Stringå‹1x2å¤šæ¬¡å…ƒé…åˆ—ã®çµæœ: 2
Int32å‹3x2å¤šæ¬¡å…ƒé…åˆ—ã®çµæœ: 2
Objectå‹3x1å¤šæ¬¡å…ƒé…åˆ—ã®çµæœ: 2
```

#### PowerShellã®ã‚ã‹ã‚Šã«ãã„æ¯”è¼ƒæ¼”ç®—å­ã‚’è¨˜å·ã§åˆ¤å®šã§ãã‚‹Function

2024.6.14 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/5d6510d33198ef

```powershell:è¨˜å·ã®æ¯”è¼ƒæ¼”ç®—å­ã§æ¯”è¼ƒãŒã§ãã‚‹Funciton
function Test-Comparison {
    param(
        [Parameter(Mandatory=$true)][System.Object]$Value1,

        [Parameter(Mandatory=$true)]
        [System.String]$Operator,

        [Parameter(Mandatory=$true)]
        [System.Object]$Value2
    )

    switch ($Operator) {
        # é€šå¸¸ã®æ¯”è¼ƒæ¼”ç®—å­
        '=='            { return $Value1 -eq $Value2 }
        '!='            { return $Value1 -ne $Value2 }
        '<'             { return $Value1 -lt $Value2 }
        '<='            { return $Value1 -le $Value2 }
        '>'             { return $Value1 -gt $Value2 }
        '>='            { return $Value1 -ge $Value2 }
        default         { throw "Invalid operator: $Operator" }
    }
}
```

```powershell:Functionå®Ÿè¡Œ
# ä¾‹: 10 ã¨ 20 ã‚’æ¯”è¼ƒã—ã¦ã€10 ãŒ 20 ã‚ˆã‚Šå°ã•ã„ã‹ã©ã†ã‹ã‚’åˆ¤å®š
$standardValue = 10
$comparedValue = 20

# ãã®ã¾ã¾å®Ÿè¡Œ
Write-Host '--- ãã®ã¾ã¾Functionã‚’å®Ÿè¡Œã—ãŸçµæœ ---'
Test-Comparison -Value1 $standardValue -Operator '<' -Value2 $comparedValue
Write-Host ''

# ifæ–‡ã§å®Ÿè¡Œ
Write-Host '--- ifæ–‡ã§Functionã‚’å®Ÿè¡Œã—ãŸçµæœ ---'
if (Test-Comparison $standardValue '<' $comparedValue) {
    Write-Host "Trueåˆ¤å®šï¼š$standardValue ã¯ $comparedValue ã‚ˆã‚Šå°ã•ã„"
    Write-Host ''
}
else {
    Write-Host "Falseåˆ¤å®šï¼š$comparedValue ã¯ $comparedValue ã‚ˆã‚Šå°ã•ããªã„"
    Write-Host ''
}

# å®Ÿè¡Œçµæœ
--- ãã®ã¾ã¾Functionã‚’å®Ÿè¡Œã—ãŸçµæœ ---
True

--- ifæ–‡ã§Functionã‚’å®Ÿè¡Œã—ãŸçµæœ ---
Trueåˆ¤å®šï¼š10 ã¯ 20 ã‚ˆã‚Šå°ã•ã„

```

### ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚ˆã‚ŠæŠœç²‹

#### \[PowerShell\]CDãªã©è¨˜æ†¶åª’ä½“ã«ã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®æ–‡å­—åˆ—ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ãƒ„ãƒ¼ãƒ«

https://zenn.dev/haretokidoki/articles/f1634c386ffc1d
https://github.com/akiGAMEBOY/PowerShell_CD-DetermineStringTool

##### CEãƒˆãƒ¬ã‚¤ï¼ˆãƒ¡ãƒ‡ã‚£ã‚¢ãƒˆãƒ¬ã‚¤ï¼‰ã‚’è‡ªå‹•ã§ã‚ªãƒ¼ãƒ—ãƒ³

https://github.com/akiGAMEBOY/PowerShell_CD-DetermineStringTool/blob/master/Main.ps1#L46-L74

##### CLIæ“ä½œã§Yes/Noã®å…¥åŠ›å¾…ã¡

https://github.com/akiGAMEBOY/PowerShell_CD-DetermineStringTool/blob/master/Main.ps1#L108-L160

##### CDãƒ‰ãƒ©ã‚¤ãƒ–ï¼ˆãƒ¡ãƒ‡ã‚£ã‚¢ãƒ‰ãƒ©ã‚¤ãƒ–ï¼‰ãŒèªè­˜ã•ã‚Œã¦ã„ã‚‹ã‹æ¤œè¨¼

https://github.com/akiGAMEBOY/PowerShell_CD-DetermineStringTool/blob/master/Main.ps1#L161-L228

##### ãƒ•ã‚¡ã‚¤ãƒ«åã¨æ‹¡å¼µå­ã®æ¤œè¨¼

https://github.com/akiGAMEBOY/PowerShell_CD-DetermineStringTool/blob/master/Main.ps1#L229-L263

#### \[PowerShell\]ã‚³ãƒ”ãƒ¼ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼†ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®æ–¹æ³• - Local to NAS

https://zenn.dev/haretokidoki/articles/d93f7608754bff
https://github.com/akiGAMEBOY/PowerShell_FileCopybackupTool

##### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

https://github.com/akiGAMEBOY/PowerShell_FileCopybackupTool/blob/master/source/powershell/Main.ps1#L124-L232

##### ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚³ãƒ”ãƒ¼ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

https://github.com/akiGAMEBOY/PowerShell_FileCopybackupTool/blob/master/source/powershell/Main.ps1#L233-L321

#### \[PowerShell\]â€œRPAç”»é¢æ“ä½œ:IMEè¾æ›¸ã‚’ãƒ†ã‚­ã‚¹ãƒˆå‡ºåŠ›â€ã¨â€œå˜èªç™»éŒ²æ¸ˆã¿ã‹ãƒã‚§ãƒƒã‚¯â€ã‚’è‡ªå‹•å®Ÿè¡Œã™ã‚‹æ–¹æ³•

https://zenn.dev/haretokidoki/articles/a1a89282137299
https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool

##### ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å›²ã¿ã‚’å‰Šé™¤

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L91-L128

##### åˆ©ç”¨ä¸­ã®ãƒ¢ãƒ‹ã‚¿ãƒ¼ã‚µã‚¤ã‚ºã‹ã‚‰æŒ‡å®šã®æ•°å€¤ã§é™¤ç®—ã—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚ºã‚’å–å¾—

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L177-L214

##### GUIæ“ä½œï¼ˆWindowsãƒ•ã‚©ãƒ¼ãƒ ï¼‰ã§Yes/Noã®å…¥åŠ›å¾…ã¡

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L215-L300

##### ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ¼ãƒ‰ï¼ˆenumï¼‰ã‚’æ¤œç´¢ã‚­ãƒ¼ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L66-L85

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L553-L608

##### ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ã®è¡¨ç¤º

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L609-L640

##### ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢å¯¾è±¡ã«è¤‡æ•°ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã”ã¨ã«ã‚«ã‚¦ãƒ³ãƒˆ

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L641-L710

##### ä¸Šè¨˜ã§å–å¾—ã—ãŸé…åˆ—ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã«è¡¨ç¤º

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L711-L783

##### ä¸€æ™‚çš„ã«ä¿å­˜ã™ã‚‹å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ ¼ç´ã™ã‚‹ãŸã‚ã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L834-L895

#### \[PowerShell\]MySQLãƒ‡ãƒ¼ã‚¿ã‚’CSVãƒ•ã‚¡ã‚¤ãƒ«ã§å–å¾—ã™ã‚‹æ–¹æ³• - DB to CSV

https://zenn.dev/haretokidoki/articles/28a7467dedabfc
https://github.com/akiGAMEBOY/PowerShell_mysql-to-csv

##### æ–‡å­—åˆ—å½¢å¼ã®æ—¥ä»˜ï¼ˆyyyymmddï¼‰ãŒæ­£ã—ã„å€¤ã‹æ¤œè¨¼


https://github.com/akiGAMEBOY/PowerShell_mysql-to-csv/blob/master/source/Main.ps1#L39-L80

##### é–‹å§‹æ—¥ä»˜ã¨çµ‚äº†æ—¥ä»˜ãŒæ—¥ä»˜ã®æœŸé–“ã¨ã—ã¦æ­£ã—ã„ã‹æ¤œè¨¼

https://github.com/akiGAMEBOY/PowerShell_mysql-to-csv/blob/master/source/Main.ps1#L81-L100

##### MySQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®æ¥ç¶šå‡¦ç†

https://github.com/akiGAMEBOY/PowerShell_mysql-to-csv/blob/master/source/Main.ps1#L101-L133

##### MySQLã®SQLã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ

https://github.com/akiGAMEBOY/PowerShell_mysql-to-csv/blob/master/source/Main.ps1#L134-L164

#### ç”»åƒã‚’ãƒªã‚µã‚¤ã‚ºã—ã¦WebPå½¢å¼ã«å¤‰æ›ã™ã‚‹PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆ

ã¾ã è¨˜äº‹ã¨ã—ã¦å…¬é–‹ã—ã¦ã„ãªã„PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã€‚
https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool

##### æ–‡å­—åˆ—ãŒASCIIæ–‡å­—ã ã‘ã§æ§‹æˆï¼ˆè‹±æ•°å­—ã ã‘ã§ãƒãƒ«ãƒãƒã‚¤ãƒˆæ–‡å­—ãŒãªã„ï¼‰ã‹ã®æœ‰ç„¡

https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool/blob/master/source/powershell/Main.ps1#L845-L859

##### ä½¿ç”¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—

https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool/blob/master/source/powershell/Main.ps1#L860-L917

##### ä½¿ç”¨ã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼åã‚’å–å¾—

https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool/blob/master/source/powershell/Main.ps1#L1161-L1222

##### OCRï¼ˆTesseractOCRï¼‰ã§å‡ºåŠ›ã—ãŸãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢ã—ã‚«ã‚¦ãƒ³ãƒˆ

https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool/blob/master/source/powershell/Main.ps1#L918-L1018

https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool/blob/master/source/powershell/Main.ps1#L1019-L1160

##### æŒ‡å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æ‹¡å¼µå­ã‚’å¤‰æ›´

https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool/blob/master/source/powershell/Main.ps1#L1223-L1266

##### æŒ‡å®šã•ã‚ŒãŸç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã‚’WebPå½¢å¼ã«å¤‰æ›

https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool/blob/master/source/powershell/Main.ps1#L1267-L1361

##### æŒ‡å®šã•ã‚ŒãŸç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒªã‚µã‚¤ã‚ºå‡¦ç†

https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool/blob/master/source/powershell/Main.ps1#L1362-L1555

#### \[PowerShell\]PDFãƒ•ã‚¡ã‚¤ãƒ«å†…ã®æ–‡å­—åˆ—ã‚’æ¤œç´¢ã—å­˜å¦ã‚’åˆ¤å®šã™ã‚‹ãƒ„ãƒ¼ãƒ«

https://zenn.dev/haretokidoki/articles/cad8b141202136
https://github.com/akiGAMEBOY/PowerShell_SearchForPdffileStrings

**æ³¨æ„äº‹é …ï¼šä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªâ€œiTextSharp 5â€ã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯ã€Œ[AGPLv3](https://github.com/itext/itextsharp/blob/develop/LICENSE.md)ã€**

https://github.com/akiGAMEBOY/PowerShell_SearchForPdffileStrings/blob/master/source/powershell/Main.ps1#L13-L15

##### æŒ‡å®šã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§PDFãƒ•ã‚¡ã‚¤ãƒ«å†…ã‚’æ¤œç´¢

https://github.com/akiGAMEBOY/PowerShell_SearchForPdffileStrings/blob/master/source/powershell/Main.ps1#L161-L207

#### \[PowerShell\]XMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´å½¢ï¼ˆåŠ å·¥ï¼‰ã™ã‚‹ãƒ„ãƒ¼ãƒ«

https://zenn.dev/haretokidoki/articles/a77765dd56f202
https://github.com/akiGAMEBOY/PowerShell_ShapingXMLfileTool

##### XMLãƒ•ã‚¡ã‚¤ãƒ«ã®å±æ€§ã‚’ä¸€æ‹¬ãƒã‚§ãƒƒã‚¯

https://github.com/akiGAMEBOY/PowerShell_ShapingXMLfileTool/blob/master/source/powershell/Main.ps1#L32-L64

https://github.com/akiGAMEBOY/PowerShell_ShapingXMLfileTool/blob/master/source/powershell/Main.ps1#L207-L234

##### XMLå±æ€§ã®ä¸¦ã³æ›¿ãˆå‡¦ç†

https://github.com/akiGAMEBOY/PowerShell_ShapingXMLfileTool/blob/master/source/powershell/Main.ps1#L235-L270

##### XMLã§ä¸è¦ãªå±æ€§ã®å‰Šé™¤

https://github.com/akiGAMEBOY/PowerShell_ShapingXMLfileTool/blob/master/source/powershell/Main.ps1#L271-L293

##### 2ã¤ã®ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¯”è¼ƒã—ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã«å‡ºåŠ›

https://github.com/akiGAMEBOY/PowerShell_ShapingXMLfileTool/blob/master/source/powershell/Main.ps1#L294-L354

##### XMLãƒ•ã‚¡ã‚¤ãƒ«å†…ã®æ–‡å­—åˆ—ç½®æ›

https://github.com/akiGAMEBOY/PowerShell_ShapingXMLfileTool/blob/master/source/powershell/Main.ps1#L355-L393

#### Windows OSã§ä¸€æ‹¬ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹PSã‚¹ã‚¯ãƒªãƒ—ãƒˆ(Win Update/MS Defender/ã‚¢ãƒ—ãƒª)

https://zenn.dev/haretokidoki/articles/a5d1a471a5699a
https://github.com/akiGAMEBOY/PowerShell_WindowsUpdateTool

##### ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®åˆ‡ã‚Šæ›¿ãˆ

https://github.com/akiGAMEBOY/PowerShell_WindowsUpdateTool/blob/master/source/powershell/Main.ps1#L432-L458

https://github.com/akiGAMEBOY/PowerShell_WindowsUpdateTool/blob/master/source/csharp/ActiveWindow.cs#L1-L136

##### å¼•æ•°ã§æŒ‡å®šã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

https://github.com/akiGAMEBOY/PowerShell_WindowsUpdateTool/blob/master/source/powershell/Main.ps1#L878-L933

## ã¾ã¨ã‚

ã‚ãŸã—è‡ªèº«ãŒæ–°è¦ã§PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã™ã‚‹éš›ã«ä¾¿åˆ©ãã†ãªã®ã§ã€ã“ã®è¨˜äº‹ã«ã¾ã¨ã‚ã¦ã¿ã¾ã—ãŸã€‚
ã“ã‚Œã‚‰Functionã‚’[ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã«ç™»éŒ²](https://zenn.dev/haretokidoki/articles/4da393f1f8d49d)ã™ã‚‹ã¨ã‚ˆã‚Šä¾¿åˆ©ã‹ã‚‚ã€‚

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
