---
title: "[PowerShell]å…±é€šåŒ–ã—ãŸFunctionã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ç´¹ä»‹"
emoji: "ğŸ‘´"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell", "ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰", "ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ "]
published: true
---
## æ¦‚è¦

ä¸»ã«Zennã®è¨˜äº‹ã§è‡ªä½œã—ãŸFunctionã‚„ã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç´¹ä»‹ã—ã¦ãã¾ã—ãŸã€‚
ãã‚Œã‚‰è¨˜äº‹ã®ä¸­ã§å…±é€šåŒ–ï¼ˆæ±ç”¨çš„ã«ä½¿ç”¨ï¼‰ã—ãŸFunctionã‚’ã“ã®è¨˜äº‹ã«é›†ç´„ã€‚

PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã™ã‚‹éš›ã®å‚è€ƒã«ã©ã†ãï¼

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- PowerShellãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹
- é »ç¹ã«æ›¸ãå‡¦ç†ã‚’å…±é€šåŒ–ã—ãŸã„æ–¹
- å…±é€šåŒ–ã—ãŸFunctionã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’å‚è€ƒã«ã—ãŸã„æ–¹

## Functionä¸€è¦§

:::message
**å…ƒè¨˜äº‹ã®ã‚³ãƒ¼ãƒ‰ã‹ã‚‰å°‘ã—æ‰‹ã‚’åŠ ãˆã¦ã„ã¾ã™**

è‡ªä½œã—ãŸFunctionã‚’å€‹ã€…ã®è¨˜äº‹ã§ã‚‚ç´¹ä»‹ã—ã¦ã„ã¾ã™ãŒã€ãã‚Œã‚‰è¨˜äº‹ã§ã¯çµæœã‚’è¦–è¦šçš„ã«è¦‹ã›ã‚‹ç‚ºã€
ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ï¼ˆ`Write-Host`ãªã©ï¼‰ã‚’å¤šç”¨ã—ã¦ã„ã¾ã™ã€‚

æœ¬æ¥ã€å®Ÿè£…ã™ã‚‹ä¸Šã§ã¯ä¸è¦ãªã‚³ãƒ¼ãƒ‰ã¨ãªã‚‹ç‚ºã€ã“ã“ã§ç´¹ä»‹ã™ã‚‹éš›ã¯æœ€é©åŒ–ã—ãŸã‚³ãƒ¼ãƒ‰ã‚’ç´¹ä»‹ã€‚
è©³ç´°ãªæ¤œè¨¼çµæœã¯ã€ãã‚Œãã‚Œã®è¨˜äº‹ã‚’ã”å‚ç…§ãã ã•ã„ã€‚
:::

### å€‹åˆ¥ã®è¨˜äº‹ã§ç´¹ä»‹ã—ãŸFunction

#### \[PowerShell\]æŒ¿å…¥ã™ã‚‹ã‚¿ãƒ–æ•°ã‚’åˆ¶å¾¡ã—ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’åˆã‚ã›é…åˆ—ã‚’ä¸€æ‹¬å‡ºåŠ›ã™ã‚‹æ–¹æ³•

https://zenn.dev/haretokidoki/articles/2d0b0dcd503c2e

```powershell:é…åˆ—ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã™ã‚‹éš›ã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’åˆã‚ã›ã¦å‡ºåŠ›
<#
.SYNOPSIS
    æ–‡å­—åˆ—é…åˆ—ã®å„è¦ç´ ã«ã¤ã„ã¦ã€Shift-JISã§ã®ãƒã‚¤ãƒˆæ•°ã‚’è¨ˆç®—ã—ã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’æƒãˆã¦ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€StringArray ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸæ–‡å­—åˆ—é…åˆ—ã‚’å‡¦ç†ã—ã¾ã™ã€‚
    é…åˆ—å†…ã®å„æ–‡å­—åˆ—ã«ã¤ã„ã¦ã€Shift-JIS ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã§ã®ãƒã‚¤ãƒˆæ•°ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
    æ¬¡ã«ã€é…åˆ—å†…ã§æœ€ã‚‚ãƒã‚¤ãƒˆæ•°ãŒå¤§ãã„æ–‡å­—åˆ—ã®ãƒã‚¤ãƒˆé•·ã‚’åŸºæº–ã¨ã—ã¦ã€å„è¡Œã®å‡ºåŠ›ã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’ã‚¿ãƒ–æ–‡å­—ã§èª¿æ•´ã—ã¾ã™ã€‚
    ã“ã‚Œã«ã‚ˆã‚Šã€ã€Œã€ãƒã‚¤ãƒˆæ•°ï¼ˆShift-JISï¼‰[...]ã€ã®éƒ¨åˆ†ãŒæ•´åˆ—ã•ã‚Œã€è¦–è¦šçš„ã«æ¯”è¼ƒã—ã‚„ã™ããªã‚Šã¾ã™ã€‚

.PARAMETER StringArray
    ãƒã‚¤ãƒˆæ•°ã‚’è¨ˆç®—ã—ã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’æƒãˆã¦è¡¨ç¤ºã—ãŸã„æ–‡å­—åˆ—ã®é…åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚
    ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    PS C:\> $stringLists = @("1234567890", "ã‚", "ï½±", "123456789012345678901234567890", "abcdefg")
    PS C:\> Show-StringsWithByteCount $stringLists

    ============ å‡ºåŠ›çµæœ ============

    æ–‡å­—åˆ— [1234567890]                     ã€ãƒã‚¤ãƒˆæ•°ï¼ˆShift-JISï¼‰[10] byte
    æ–‡å­—åˆ— [ã‚]                             ã€ãƒã‚¤ãƒˆæ•°ï¼ˆShift-JISï¼‰[2] byte
    æ–‡å­—åˆ— [ï½±]                              ã€ãƒã‚¤ãƒˆæ•°ï¼ˆShift-JISï¼‰[1] byte
    æ–‡å­—åˆ— [123456789012345678901234567890] ã€ãƒã‚¤ãƒˆæ•°ï¼ˆShift-JISï¼‰[30] byte
    æ–‡å­—åˆ— [abcdefg]                        ã€ãƒã‚¤ãƒˆæ•°ï¼ˆShift-JISï¼‰[7] byte

    ================================

    ã“ã®ä¾‹ã§ã¯ã€è¤‡æ•°ã®æ–‡å­—åˆ—ã‚’å«ã‚€é…åˆ—ã‚’é–¢æ•°ã«æ¸¡ã—ã¾ã™ã€‚
    é–¢æ•°ã¯å„æ–‡å­—åˆ—ã®Shift-JISã§ã®ãƒã‚¤ãƒˆæ•°ã‚’è¨ˆç®—ã—ã€æœ€ã‚‚é•·ã„ãƒã‚¤ãƒˆæ•°ï¼ˆã“ã®å ´åˆã¯30ï¼‰ã«åˆã‚ã›ã¦ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’èª¿æ•´ã—ã¦çµæœã‚’å‡ºåŠ›ã—ã¾ã™ã€‚

.NOTES
    - ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã®è¨ˆç®—ã«ä½¿ç”¨ã™ã‚‹ã‚¿ãƒ–å¹…ã¯ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã§8æ–‡å­—ã¨ã—ã¦ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚Œã¦ã„ã¾ã™ã€‚
      ãŠä½¿ã„ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚„ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ã‚¿ãƒ–è¨­å®šã«ã‚ˆã£ã¦ã¯ã€è¡¨ç¤ºãŒæœŸå¾…é€šã‚Šã«æƒã‚ãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
    - ãƒã‚¤ãƒˆæ•°ã®è¨ˆç®—ã«ä½¿ç”¨ã™ã‚‹ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¯ "shift_jis" ã«å›ºå®šã•ã‚Œã¦ã„ã¾ã™ã€‚
    - å‡ºåŠ›ã«ã¯ `Write-Host` ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€çµæœã‚’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ä»–ã®ã‚³ãƒãƒ³ãƒ‰ã«æ¸¡ã™ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚
#>
Function Show-StringsWithByteCount {
    param (
        [Parameter(Mandatory=$true)]
        [System.Object[]]$StringArray
    )
    
    [System.Object[]]$byteCounts = $StringArray.Clone()
    [System.Int32]$i = 0
    [System.Int32]$maxLength = 0
    for ($i = 0; $i -lt $byteCounts.Count; $i++) {
        $byteCounts[$i] = [System.Text.Encoding]::GetEncoding("shift_jis").GetByteCount($byteCounts[$i])
        if ($maxLength -lt $byteCounts[$i]) {
            $maxLength = $byteCounts[$i]
        }
    }

    # ã‚¿ãƒ–æ•°ã®è¨ˆç®— ã¨ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›
    [System.Int32]$tabCount = 0
    [System.Int32]$tabWidth = 8
    Write-Host ''
    Write-Host ' ============ å‡ºåŠ›çµæœ ============ '
    Write-Host ''
    for ($i = 0; $i -lt $byteCounts.Count; $i++) {
        # ã‚¿ãƒ–ã®æ•°ã‚’è¨ˆç®—ã—ã¾ã™
        # æœ€é•·ã®æ–‡å­—åˆ—ã¨ã®å·®åˆ†ã‚’ã‚¿ãƒ–ã®å¹…ã§å‰²ã‚Šã€åˆ‡ã‚Šä¸Šã’ã¾ã™
        $tabCount = [Math]::Ceiling(($maxLength - [System.Int32]$byteCounts[$i]) / $tabWidth)
        # æœ€ä½1ã¤ã¯ã‚¿ãƒ–ã‚’æŒ¿å…¥ã™ã‚‹ã‚ˆã†è¨­å®š
        if ($tabCount -eq 0) {
            $tabCount = 1
        }

        # æœ€çµ‚æ¡ã«æ”¹è¡Œãªã—ã§å…ˆé ­éƒ¨ã®æ–‡å­—åˆ—ã‚’å‡ºåŠ›
        Write-Host "æ–‡å­—åˆ— [$($StringArray[$i])]" -NoNewline
        Write-Host ("`t" * $tabCount) -NoNewline
        # æœ€çµ‚æ¡ã«æ”¹è¡Œã‚ã‚Šã§ç¶šãæ–‡å­—åˆ—ã‚’å‡ºåŠ›
        Write-Host "ã€ãƒã‚¤ãƒˆæ•°ï¼ˆShift-JISï¼‰[$($byteCounts[$i])] byte"
    }
    Write-Host ''
    Write-Host ' ================================ '
    Write-Host ''
    Write-Host ''
}
```

#### \[PowerShell\]è¤‡æ•°ã‚³ãƒãƒ³ãƒ‰æ ¼ç´ã—ãŸæ–‡å­—åˆ—é…åˆ—ã‚’ä¸€ã¤ã²ã¨ã¤å®Ÿè¡Œã™ã‚‹æ–¹æ³•

https://zenn.dev/haretokidoki/articles/84aea5bddf2dd6

```powershell:å¼•æ•°ã§æŒ‡å®šã—ãŸæ–‡å­—åˆ—é…åˆ—å†…ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ
<#
.SYNOPSIS
    æ–‡å­—åˆ—ã¨ã—ã¦æ ¼ç´ã•ã‚ŒãŸè¤‡æ•°ã®ã‚³ãƒãƒ³ãƒ‰ã‚’é †æ¬¡å®Ÿè¡Œã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€commands ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸæ–‡å­—åˆ—ã®é…åˆ—ã‚’å—ã‘å–ã‚Šã¾ã™ã€‚
    é…åˆ—å†…ã®å„æ–‡å­—åˆ—ã‚’å€‹åˆ¥ã®ã‚³ãƒãƒ³ãƒ‰ã¨ã—ã¦è§£é‡ˆã—ã€[ScriptBlock]::Create() ãƒ¡ã‚½ãƒƒãƒ‰ã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã«å¤‰æ›ã—ãŸå¾Œã€Invoke-Command ã‚’ç”¨ã„ã¦ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§å®Ÿè¡Œã—ã¾ã™ã€‚
    ã“ã‚Œã«ã‚ˆã‚Šã€å‹•çš„ã«ç”Ÿæˆã•ã‚ŒãŸã‚Šã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰èª­ã¿è¾¼ã‚“ã ã‚Šã—ãŸã‚³ãƒãƒ³ãƒ‰ã®ãƒªã‚¹ãƒˆã‚’ç°¡å˜ã«å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

.PARAMETER commands
    å®Ÿè¡Œã—ãŸã„ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ ¼ç´ã—ãŸæ–‡å­—åˆ—ã®é…åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚
    ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    PS C:\> Invoke-MultipleCommands -commands @('Get-Date', 'Get-Item .', 'Get-PSDrive C')

    # å®Ÿè¡Œçµæœï¼ˆä¾‹ï¼‰
    
    2023å¹´10æœˆ27æ—¥é‡‘æ›œæ—¥ 10:30:00
    
        ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: C:\Users\YourUser\Documents
    
    Mode                 LastWriteTime         Length Name
    ----                 -------------         ------ ----
    d-----        2023/10/26     11:00                ProjectA
    -a----        2023/10/27     09:45           1234 somefile.txt
    
    Name           Used (GB)     Free (GB) Provider      Root
    ----           ---------     --------- --------      ----
    C                 120.50        135.50 FileSystem    C:\

    ã“ã®ä¾‹ã§ã¯ã€'Get-Date'ã€'Get-Item .'ã€'Get-PSDrive C' ã®3ã¤ã®ã‚³ãƒãƒ³ãƒ‰ã‚’é †ç•ªã«å®Ÿè¡Œã—ã¾ã™ã€‚
    å„ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›ãŒã€å®Ÿè¡Œã•ã‚Œã‚‹ãŸã³ã«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

.INPUTS
    ãªã—
    ã“ã®é–¢æ•°ã¯ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å…¥åŠ›ã‚’å—ã‘ä»˜ã‘ã¾ã›ã‚“ã€‚

.OUTPUTS
    System.Object
    å®Ÿè¡Œã•ã‚ŒãŸå„ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆãŒå‡ºåŠ›ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒã€ãã®ã¾ã¾å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚å‡ºåŠ›ã•ã‚Œã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å‹ã¯ã€å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒãƒ³ãƒ‰ã«ä¾å­˜ã—ã¾ã™ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯æ–‡å­—åˆ—ã‚’ã‚³ãƒãƒ³ãƒ‰ã¨ã—ã¦å®Ÿè¡Œã™ã‚‹ãŸã‚ã€ä¿¡é ¼ã§ããªã„ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã®å…¥åŠ›ã‚’æ¸¡ã™ã¨ã€æ„å›³ã—ãªã„ã€ã‚ã‚‹ã„ã¯æ‚ªæ„ã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ä½¿ç”¨ã™ã‚‹éš›ã¯ã€å…¥åŠ›ã•ã‚Œã‚‹ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ãŒå®‰å…¨ã§ã‚ã‚‹ã“ã¨ã‚’ååˆ†ã«ç¢ºèªã—ã¦ãã ã•ã„ã€‚
    - ã‚³ãƒãƒ³ãƒ‰ã¯ç¾åœ¨ã®PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
    - ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã€ãã®ã‚¨ãƒ©ãƒ¼ã¯ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã•ã‚Œã¾ã™ãŒã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯åœæ­¢ã›ãšå¾Œç¶šã®ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œã‚’è©¦ã¿ã¾ã™ã€‚
#>
# é–¢æ•°ã¨ã—ã¦å®šç¾©
Function Invoke-MultipleCommands {
    Param (
        # å¿…é ˆé …ç›®ï¼šå®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆãŒã‚ã‚‹æ–‡å­—åˆ—é…åˆ—ç”¨ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼
        [Parameter(Mandatory=$true)]
        [System.String[]]$commands
    )
    # é…åˆ—å†…ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ç¹°ã‚Šè¿”ã—å‡¦ç†ã§å®Ÿè¡Œ
    foreach ($command in $commands) {
        # æ–‡å­—åˆ—ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã«å¤‰æ›
        [System.Management.Automation.ScriptBlock]$scriptblock = [ScriptBlock]::Create($command)
        # ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã‚’å®Ÿè¡Œ
        Invoke-Command -ScriptBlock $scriptblock
    }
}
```

#### \[PowerShell\]è¤‡æ•°ã®ã‚µãƒ¼ãƒãƒ¼ã«å¯¾ã—æŒ‡å®šã—ãŸãƒãƒ¼ãƒˆã§ç–é€šç¢ºèªã™ã‚‹æ–¹æ³•

https://zenn.dev/haretokidoki/articles/1c671247e9523c

```powershell:è¤‡æ•°ã®ã‚µãƒ¼ãƒãƒ¼ã«å¯¾ã—æŒ‡å®šã—ãŸãƒãƒ¼ãƒˆã§ç–é€šç¢ºèª
<#
.SYNOPSIS
    è¤‡æ•°ã®ã‚µãƒ¼ãƒãƒ¼ã¨ãƒãƒ¼ãƒˆã®ãƒšã‚¢ã«å¯¾ã—ã¦ãƒãƒ¼ãƒˆç–é€šç¢ºèªï¼ˆTest-NetConnectionï¼‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€ã‚µãƒ¼ãƒãƒ¼åï¼ˆã¾ãŸã¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰ã¨ãƒãƒ¼ãƒˆç•ªå·ã®ãƒšã‚¢ã‚’æ ¼ç´ã—ãŸã‚¸ãƒ£ã‚°é…åˆ—ã‚’å¼•æ•°ã¨ã—ã¦å—ã‘å–ã‚Šã¾ã™ã€‚
    é…åˆ—å†…ã®å„ãƒšã‚¢ã«å¯¾ã—ã¦ Test-NetConnection ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’é †ã«å®Ÿè¡Œã—ã€ãƒãƒ¼ãƒˆã®ç–é€šæ€§ã‚’ç¢ºèªã—ã¾ã™ã€‚
    Test-NetConnection ãŒæ­£å¸¸ã«å®Ÿè¡Œã•ã‚Œã‚Œã°ã€ãã®çµæœãŒã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ç›´æ¥è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
    ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®å®Ÿè¡Œä¸­ã«ä¾‹å¤–ãŒç™ºç”Ÿã—ãŸå ´åˆï¼ˆä¾‹: åå‰è§£æ±ºã®å¤±æ•—ãªã©ï¼‰ã¯ã€catch ãƒ–ãƒ­ãƒƒã‚¯ã§ã‚¨ãƒ©ãƒ¼ã‚’æ•æ‰ã—ã€ã©ã®ã‚µãƒ¼ãƒãƒ¼ã¨ãƒãƒ¼ãƒˆã®çµ„ã¿åˆã‚ã›ã§å•é¡ŒãŒç™ºç”Ÿã—ãŸã‹ã‚’ç¤ºã™ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ Write-Error ã‚’ç”¨ã„ã¦å‡ºåŠ›ã—ã¾ã™ã€‚

.PARAMETER ServerPortPairs
    ãƒãƒ¼ãƒˆç–é€šã‚’ç¢ºèªã—ãŸã„ã‚µãƒ¼ãƒãƒ¼ã¨ãƒãƒ¼ãƒˆã®ãƒšã‚¢ã‚’æ ¼ç´ã—ãŸã‚¸ãƒ£ã‚°é…åˆ—ï¼ˆé…åˆ—ã®é…åˆ—ï¼‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚
    å„å†…éƒ¨é…åˆ—ã¯ã€è¦ç´ 0ã«ã‚µãƒ¼ãƒãƒ¼åã¾ãŸã¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ã€è¦ç´ 1ã«ãƒãƒ¼ãƒˆç•ªå·ã‚’æ–‡å­—åˆ—ã¨ã—ã¦æ ¼ç´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
    ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    PS C:\> [System.String[][]]$ServerPortPairs = @(
    >>     @('localhost','8080'),
    >>     @('localhost','8000'),
    >>     @('google.com','443'),
    >>     @('smtp.google.com','25')
    >> )
    PS C:\> Check-PortMultipleServers $ServerPortPairs

    # å®Ÿè¡Œçµæœï¼ˆä¸€éƒ¨æŠœç²‹ï¼‰
    è­¦å‘Š: TCP connect to (::1 : 8080) failed
    è­¦å‘Š: TCP connect to (127.0.0.1 : 8080) failed

    ComputerName           : localhost
    RemoteAddress          : ::1
    RemotePort             : 8080
    TcpTestSucceeded       : False

    ComputerName     : localhost
    RemoteAddress    : ::1
    RemotePort       : 8000
    TcpTestSucceeded : True

    ComputerName     : google.com
    RemoteAddress    : 142.251.42.142
    RemotePort       : 443
    TcpTestSucceeded : True
    ...

    ã“ã®ä¾‹ã§ã¯ã€localhostã®8080ãƒãƒ¼ãƒˆã¨8000ãƒãƒ¼ãƒˆã€google.comã®443ãƒãƒ¼ãƒˆã€smtp.google.comã®25ãƒãƒ¼ãƒˆã¸ã®æ¥ç¶šã‚’è©¦ã¿ã¾ã™ã€‚
    Test-NetConnection ã®çµæœãŒãã‚Œãã‚Œã®ãƒšã‚¢ã«å¯¾ã—ã¦é †ã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€localhost:8080ã¸ã®æ¥ç¶šãŒå¤±æ•—ã—ã€ä»–ã¯æˆåŠŸã—ã¦ã„ã‚‹æ§˜å­ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯å†…éƒ¨ã§ `Test-NetConnection` ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ Windows PowerShell 4.0 ä»¥é™ã€ã¾ãŸã¯ PowerShell Core 6.1 ä»¥é™ã§åˆ©ç”¨å¯èƒ½ã§ã™ã€‚
    - ãƒãƒ¼ãƒˆãŒé–‰ã˜ã¦ã„ã‚‹å ´åˆã€`Test-NetConnection` ã¯ä¾‹å¤–ã‚’ç™ºç”Ÿã•ã›ãšã€`TcpTestSucceeded` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒ `False` ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã—ã¾ã™ã€‚`try-catch` ãƒ–ãƒ­ãƒƒã‚¯ã¯ã€ãƒ›ã‚¹ãƒˆåã®åå‰è§£æ±ºã®å¤±æ•—ãªã©ã€ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆè‡ªä½“ã®å®Ÿè¡Œã«å¤±æ•—ã—ãŸå ´åˆã®ä¾‹å¤–ã‚’æ•æ‰ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚
    - æˆåŠŸã—ãŸæ¥ç¶šã®çµæœã¯æˆåŠŸã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ã€`catch` ãƒ–ãƒ­ãƒƒã‚¯ã§æ•æ‰ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼ã¯ã‚¨ãƒ©ãƒ¼ ã‚¹ãƒˆãƒªãƒ¼ãƒ ã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚
#>
# Function å®šç¾©
Function Check-PortMultipleServers {
    param (
        [Parameter(Mandatory=$true)]
        [System.String[][]]$ServerPortPairs
    )
    $tempStrings=New-Object System.Text.StringBuilder

    for($i = 0; $i -lt $ServerPortPairs.Length; $i++) {
        $currentPair = $ServerPortPairs[$i]
        
        try {
            Test-NetConnection $currentPair[0] -Port $currentPair[1]
        }
        catch {
            $tempStrings=New-Object System.Text.StringBuilder
            @("Test-NetConnectionã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚`r`n",`
              "ã‚¨ãƒ©ãƒ¼ã¨ãªã£ãŸã‚³ãƒãƒ³ãƒ‰ï¼š[Test-NetConnection $($currentPair[0]) -Port $($currentPair[1])]")|
            ForEach-Object{[void]$tempStrings.Append($_)}
            [System.String]$messageError = $tempStrings.ToString()
            Write-Error $messageError
        }
    }
}
```

#### \[PowerShell\]æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¨ç®¡ç†è€…æ¨©é™ã‚’åˆ¤å®šã—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚¿ã‚¤ãƒˆãƒ«ã‚’å¤‰æ›´

https://zenn.dev/haretokidoki/articles/67788ca9b47b27

```powershell:PowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¿ã‚¤ãƒˆãƒ«ã«â€œæ–‡å­—ã‚³ãƒ¼ãƒ‰â€ã¨â€œç®¡ç†è€…æ¨©é™ã®æœ‰ç„¡â€ã‚’è¿½åŠ 
<#
.SYNOPSIS
    ç¾åœ¨ã®PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒç®¡ç†è€…æ¨©é™ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€[System.Security.Principal.WindowsPrincipal] ã‚¯ãƒ©ã‚¹ã‚’åˆ©ç”¨ã—ã¦ã€ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒçµ„ã¿è¾¼ã¿ã® "Administrator" ãƒ­ãƒ¼ãƒ«ã«å±ã—ã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒæ˜‡æ ¼ã•ã‚ŒãŸæ¨©é™ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç°¡å˜ã«ãƒã‚§ãƒƒã‚¯ã§ãã¾ã™ã€‚

.EXAMPLE
    PS C:\> if (Test-IsAdmin) {
    >>     Write-Host "ã“ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯ç®¡ç†è€…æ¨©é™ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã™ã€‚"
    >> } else {
    >>     Write-Host "ã“ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯ç®¡ç†è€…æ¨©é™ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚"
    >> }
    ã“ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯ç®¡ç†è€…æ¨©é™ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã™ã€‚

    ã“ã®ä¾‹ã§ã¯ã€é–¢æ•°ã®æˆ»ã‚Šå€¤ï¼ˆ$trueã¾ãŸã¯$falseï¼‰ã‚’ä½¿ã£ã¦ã€ç¾åœ¨ã®æ¨©é™çŠ¶æ…‹ã«å¿œã˜ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

.OUTPUTS
    System.Boolean
    ç®¡ç†è€…æ¨©é™ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ $true ã‚’ã€ãã†ã§ãªã„å ´åˆã¯ $false ã‚’è¿”ã—ã¾ã™ã€‚
#>
# ç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œã—ã¦ã„ã‚‹ã‹ç¢ºèªï¼ˆTrueã®å ´åˆã€â€œç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œâ€ã—ã¦ã„ã‚‹ã¨åˆ¤æ–­ï¼‰
Function Test-IsAdmin {
    $winId = [System.Security.Principal.WindowsIdentity]::GetCurrent()
    $winPrincipal = new-object System.Security.Principal.WindowsPrincipal($winId)
    $adminPermission = [System.Security.Principal.WindowsBuiltInRole]::Administrator
    return $winPrincipal.IsInRole($adminPermission)
}

<#
.SYNOPSIS
    PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ä¸»è¦ãª3ã¤ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰è¨­å®šã‚’å–å¾—ã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€PowerShellã®å‹•ä½œã«å½±éŸ¿ã‚’ä¸ãˆã‚‹3ã¤ã®ä¸»è¦ãªã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¨­å®šã‚’èª¿æŸ»ã—ã€ãã‚Œã‚‰ã®WebNameï¼ˆä¾‹: "utf-8", "shift_jis"ï¼‰ã‚’æ–‡å­—åˆ—é…åˆ—ã¨ã—ã¦è¿”ã—ã¾ã™ã€‚
    å–å¾—ã™ã‚‹è¨­å®šã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚
    1. $PSDefaultParameterValues['*:Encoding']: ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®-Encodingãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ—¢å®šå€¤ã€‚
    2. $global:OutputEncoding: PowerShellã‹ã‚‰å¤–éƒ¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¸ãƒ‘ã‚¤ãƒ—ã§æ¸¡ã™éš›ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€‚
    3. [console]::OutputEncoding: PowerShellã‚³ãƒ³ã‚½ãƒ¼ãƒ«è‡ªä½“ã®å‡ºåŠ›ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€‚

.EXAMPLE
    PS C:\> $charcodes = Get-PsCharcode
    PS C:\> "DefaultParameter: $($charcodes[0])"
    PS C:\> "GlobalEncoding: $($charcodes[1])"
    PS C:\> "ConsoleEncoding: $($charcodes[2])"
    DefaultParameter:
    GlobalEncoding: us-ascii
    ConsoleEncoding: shift_jis

    ã“ã®ä¾‹ã§ã¯ã€é–¢æ•°ã‚’å®Ÿè¡Œã—ã¦è¿”ã•ã‚ŒãŸé…åˆ—ã‚’å¤‰æ•°ã«æ ¼ç´ã—ã€å„ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¨­å®šã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚

.OUTPUTS
    System.String[]
    3ã¤ã®è¦ç´ ã‚’æŒã¤æ–‡å­—åˆ—é…åˆ—ã‚’è¿”ã—ã¾ã™ã€‚
    - Index 0: $PSDefaultParameterValues['*:Encoding'] ã®å€¤
    - Index 1: $global:OutputEncoding ã®WebName
    - Index 2: [console]::OutputEncoding ã®WebName

.NOTES
    $PSDefaultParameterValues['*:Encoding'] ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã€å¯¾å¿œã™ã‚‹é…åˆ—è¦ç´ ã¯ç©ºã®æ–‡å­—åˆ—ã«ãªã‚Šã¾ã™ã€‚
#>
# ç¾åœ¨ã€è¨­å®šã—ã¦ã„ã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—
Function Get-PsCharcode {
    [System.String[]]$psCharcode = @(
        # ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã™ã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®è¦å®šå€¤
        ($PSDefaultParameterValues['*:Encoding']),
        # PowerShellã‹ã‚‰å¤–éƒ¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«æ¸¡ã™æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã®è¨­å®š
        ($global:OutputEncoding).WebName,
        # PowerShellã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã™ã‚‹æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã®è¨­å®š
        ([console]::OutputEncoding).WebName
    )

    return $psCharcode
}

<#
.SYNOPSIS
    ç¾åœ¨ã®PowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¿ã‚¤ãƒˆãƒ«ã«ã€æ–‡å­—ã‚³ãƒ¼ãƒ‰è¨­å®šã¨ç®¡ç†è€…æ¨©é™ã®æœ‰ç„¡ã‚’è¿½åŠ ã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€ç¾åœ¨ã®PowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’èª­ã¿è¾¼ã¿ã€ãã®æœ«å°¾ã«æƒ…å ±ã‚’è¿½åŠ ã—ã¦ã‚¿ã‚¤ãƒˆãƒ«ã‚’æ›´æ–°ã—ã¾ã™ã€‚
    å†…éƒ¨ã§ `Get-PsCharcode` é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦ä¸»è¦ãª3ã¤ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰è¨­å®šã‚’å–å¾—ã—ã€`Test-IsAdmin` é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦ç®¡ç†è€…æ¨©é™ã®æœ‰ç„¡ã‚’ç¢ºèªã—ã¾ã™ã€‚
    ã“ã‚Œã‚‰ã®æƒ…å ±ã‚’æ•´å½¢ã—ã€ã€Œ|ã€ã‚’åŒºåˆ‡ã‚Šæ–‡å­—ã¨ã—ã¦ç¾åœ¨ã®ã‚¿ã‚¤ãƒˆãƒ«ã«è¿½åŠ è¡¨ç¤ºã—ã¾ã™ã€‚
    é–¢æ•°ã‚’è¤‡æ•°å›å®Ÿè¡Œã—ã¦ã‚‚ã€å…ƒã®ã‚¿ã‚¤ãƒˆãƒ«éƒ¨åˆ†ãŒé‡è¤‡ã—ãªã„ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚

.EXAMPLE
    PS C:\> # å®Ÿè¡Œå‰ã®ã‚¿ã‚¤ãƒˆãƒ«: Windows PowerShell
    PS C:\> Change-WindowTitle
    # å®Ÿè¡Œå¾Œã€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¿ã‚¤ãƒˆãƒ«ãŒä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã•ã‚Œã‚‹:
    # Windows PowerShell | DefaultParameter=[] ; GlobalEncoding=[us-ascii] ; ConsoleEncoding=[shift_jis] ; #Administrator

    ã“ã®ä¾‹ã§ã¯ã€é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¿ã‚¤ãƒˆãƒ«ã«ç¾åœ¨ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰è¨­å®šã¨ç®¡ç†è€…çŠ¶æ…‹ãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚

.OUTPUTS
    ãªã—
    ã“ã®é–¢æ•°ã¯å€¤ã‚’è¿”ã•ãšã€ãƒ›ã‚¹ãƒˆUIã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚¿ã‚¤ãƒˆãƒ«ã‚’ç›´æ¥å¤‰æ›´ã—ã¾ã™ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯ã€åŒã˜ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã« `Test-IsAdmin` ãŠã‚ˆã³ `Get-PsCharcode` é–¢æ•°ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚
    - if-elseãƒ–ãƒ­ãƒƒã‚¯å†…ã®ãƒ­ã‚¸ãƒƒã‚¯ãŒåŒä¸€ã®ãŸã‚ã€ç¾åœ¨ã®å®Ÿè£…ã§ã¯ç®¡ç†è€…ãƒ»éç®¡ç†è€…ã«é–¢ã‚ã‚‰ãšæœ«å°¾ã«ã€Œ#Administratorã€ãŒä»˜ãã¾ã™ã€‚
    - PowerShell ISEã‚„Visual Studio Codeã®çµ±åˆã‚¿ãƒ¼ãƒŸãƒŠãƒ«ãªã©ã€ä¸€éƒ¨ã®ãƒ›ã‚¹ãƒˆç’°å¢ƒã§ã¯ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚¿ã‚¤ãƒˆãƒ«ã®å¤‰æ›´ãŒåæ˜ ã•ã‚Œãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
#>
# PowerShellã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¿ã‚¤ãƒˆãƒ«å¤‰æ›´
Function Change-WindowTitle {
    # åŒºåˆ‡ã‚Šæ–‡å­—ã®è¨­å®š
    [System.String]$separator1 = '|'
    [System.String]$separator2 = ';'

    # ç¾åœ¨ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å–å¾—

    [System.String]$title = $Host.UI.RawUI.WindowTitle
    [System.String]$baseTitle = $title

    # ã™ã§ã«ã“ã®Functionã§ã‚¿ã‚¤ãƒˆãƒ«å¤‰æ›´ã—ã¦ã„ã‚‹å ´åˆã€ä¸€ç•ªå·¦ã«ã‚ã‚‹å…ƒã®ã‚¿ã‚¤ãƒˆãƒ«åã®ã¿æŠ½å‡º
    [System.String[]]$titleArray = $title.Split($separator1)
    if ($titleArray.Length -ne 0) {
        $baseTitle = ($titleArray[0]).TrimEnd()
    }

    # ç¾åœ¨ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—
    [System.String[]]$psCharcode = Get-PsCharcode

    # ç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œã—ã¦ã„ã‚‹ã‹ã«ã‚ˆã‚Šè¨­å®šã™ã‚‹ã‚¿ã‚¤ãƒˆãƒ«åã‚’åˆ†å²
    [System.String]$changeTitle = $baseTitle
    if (Test-IsAdmin) {
        # PowerShellã‚’ç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œã—ã¦ã„ã‚‹å ´åˆ
        $changeTitle = "$baseTitle $separator1 " +
                       "DefaultParameter=[$($psCharcode[0])] $separator2 " +
                       "GlobalEncoding=[$($psCharcode[1])] $separator2 " +
                       "ConsoleEncoding=[$($psCharcode[2])] $separator2 " +
                       "#Administrator"
    }
    else {
        # ã—ã¦ã„ãªã„å ´åˆ
        $changeTitle = "$baseTitle $separator1 " +
                       "DefaultParameter=[$($psCharcode[0])] $separator2 " +
                       "GlobalEncoding=[$($psCharcode[1])] $separator2 " +
                       "ConsoleEncoding=[$($psCharcode[2])] $separator2 " +
                       "#Administrator"
    }
    $Host.UI.RawUI.WindowTitle = $changeTitle
}
```

#### \[PowerShell\]wingetã®çµæœã‚’å¤‰æ•°ã«ä»£å…¥ã—å‡ºåŠ›ã™ã‚‹ã¨æ–‡å­—åŒ–ã‘ãŒç™ºç”Ÿ

https://zenn.dev/haretokidoki/articles/8946231076f129

```powershell:PowerShellã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’è¨­å®š
<#
.SYNOPSIS
    PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ä¸»è¦ãªæ–‡å­—ã‚³ãƒ¼ãƒ‰è¨­å®šã‚’ã¾ã¨ã‚ã¦å¤‰æ›´ã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€æŒ‡å®šã•ã‚ŒãŸãƒ¢ãƒ¼ãƒ‰ã«å¿œã˜ã¦ã€PowerShellã®3ã¤ã®ä¸»è¦ãªæ–‡å­—ã‚³ãƒ¼ãƒ‰è¨­å®šã‚’å¤‰æ›´ã—ã¾ã™ã€‚
    å¤‰æ›´å¯¾è±¡ã¨ãªã‚‹ã®ã¯ä»¥ä¸‹ã®3ã¤ã§ã™ã€‚
    - $PSDefaultParameterValues['*:Encoding']: ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®-Encodingãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ—¢å®šå€¤ã€‚
    - $global:OutputEncoding: PowerShellã‹ã‚‰å¤–éƒ¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¸ãƒ‘ã‚¤ãƒ—/ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹éš›ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€‚
    - [console]::OutputEncoding: PowerShellã‚³ãƒ³ã‚½ãƒ¼ãƒ«è‡ªä½“ã®å‡ºåŠ›ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€‚

    'utf8', 'sjis', 'ascii' ãªã©ã®ãƒ—ãƒªã‚»ãƒƒãƒˆã‹ã‚‰é¸æŠã—ã¦è¨­å®šã§ãã¾ã™ã€‚ã¾ãŸã€è¨­å®šã‚’åˆæœŸçŠ¶æ…‹ã«æˆ»ã™ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

.PARAMETER CharCode
    è¨­å®šã™ã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®ãƒ¢ãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚æŒ‡å®šå¯èƒ½ãªå€¤ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚
    - 'utf8': å„ç¨®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’UTF-8ã«è¨­å®šã—ã¾ã™ã€‚
    - 'sjis': å„ç¨®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’Shift-JISã«è¨­å®šã—ã¾ã™ã€‚
    - 'ascii': å„ç¨®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’ASCIIã«è¨­å®šã—ã¾ã™ã€‚
    - 'rm_encoding': ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®æ—¢å®šã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¨­å®š ($PSDefaultParameterValues) ã®ã¿è§£é™¤ã—ã¾ã™ã€‚
    - 'reset_encoding': ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¨­å®šã‚’PowerShellã®åˆæœŸçŠ¶æ…‹ã«æˆ»ã—ã¾ã™ã€‚

    ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’çœç•¥ã—ãŸå ´åˆã€'reset_encoding' ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¨ã—ã¦ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

.EXAMPLE
    # ä¾‹ 1: æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’UTF-8ã«è¨­å®šã™ã‚‹
    PS C:\> Set-PsOutputEncoding -CharCode 'utf8'

    # ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰é–¢é€£è¨­å®šãŒUTF-8ã«çµ±ä¸€ã•ã‚Œã¾ã™ã€‚
    # å®Ÿè¡Œçµæœã¯ã€å‰å›ä½œæˆã—ãŸ Change-WindowTitle é–¢æ•°ãªã©ã§ç¢ºèªã§ãã¾ã™ã€‚

.EXAMPLE
    # ä¾‹ 2: æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’Shift-JISã«è¨­å®šã™ã‚‹
    PS C:\> Set-PsOutputEncoding 'sjis'

    # æ–‡å­—ã‚³ãƒ¼ãƒ‰é–¢é€£è¨­å®šãŒShift-JISã«è¨­å®šã•ã‚Œã¾ã™ã€‚
    # ãŸã ã—ã€PowerShellã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã£ã¦ä¸€éƒ¨ã®æŒ™å‹•ãŒç•°ãªã‚‹ç‚¹ã«æ³¨æ„ãŒå¿…è¦ã§ã™ï¼ˆNOTESå‚ç…§ï¼‰ã€‚

.EXAMPLE
    # ä¾‹ 3: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒ‡å®šã›ãšã«å®Ÿè¡Œã—ã€è¨­å®šã‚’åˆæœŸçŠ¶æ…‹ã«æˆ»ã™
    PS C:\> Set-PsOutputEncoding

    # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® 'reset_encoding' ãƒ¢ãƒ¼ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã€ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¨­å®šãŒ
    # ä½¿ç”¨ã—ã¦ã„ã‚‹PowerShellã®ã‚¨ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ã«å¿œã˜ãŸåˆæœŸçŠ¶æ…‹ã«æˆ»ã‚Šã¾ã™ã€‚

.OUTPUTS
    ãªã—
    ã“ã®é–¢æ•°ã¯å€¤ã‚’è¿”ã•ãšã€ç¾åœ¨ã®PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³ã®è¨­å®šã‚’ç›´æ¥å¤‰æ›´ã™ã‚‹å‰¯ä½œç”¨ã‚’æŒã¡ã¾ã™ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã«ã‚ˆã‚‹è¨­å®šå¤‰æ›´ã¯ã€ç¾åœ¨ã®PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ã®ã¿æœ‰åŠ¹ã§ã™ã€‚æ–°ã—ã„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‹ãã¨è¨­å®šã¯å…ƒã«æˆ»ã‚Šã¾ã™ã€‚
    - 'sjis' ãƒ¢ãƒ¼ãƒ‰ã«ã¤ã„ã¦: PowerShell 7 (Core) ä»¥é™ã§ã¯ã€`$PSDefaultParameterValues['*:Encoding']` ã« 'shift_jis' ã‚’ç›´æ¥è¨­å®šã§ããªã„ãŸã‚ã€'default' ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯Windows PowerShell (5.1ä»¥å‰) ã§ã¯Shift-JISã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ãŒã€Coreã§ã¯UTF-8ã¨ã—ã¦è§£é‡ˆã•ã‚Œã¾ã™ã€‚
    - 'reset_encoding' ãƒ¢ãƒ¼ãƒ‰ã¯ã€PowerShellã®ã‚¨ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ ($PSVersionTable.PSEdition ãŒ 'Core' ã‹ 'Desktop' ã‹) ã«ã‚ˆã£ã¦å¾©å…ƒã•ã‚Œã‚‹åˆæœŸå€¤ãŒç•°ãªã‚Šã¾ã™ã€‚
#>
Function Set-PsOutputEncoding {
    param (
        [System.String]$CharCode = 'reset_encoding'
    )

    switch ($CharCode) {
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’UTF8ã«è¨­å®šã™ã‚‹
        'utf8' {
            $PSDefaultParameterValues['*:Encoding'] = 'utf8'
            $global:OutputEncoding = [System.Text.Encoding]::UTF8
            [console]::OutputEncoding = [System.Text.Encoding]::UTF8
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’Shift JISï¼ˆSJISï¼‰ã«è¨­å®šã™ã‚‹
        'sjis' {
            # $PSDefaultParameterValues['*:Encoding'] = 'default'ã«ã¤ã„ã¦
            #   ã“ã®è¨­å®šã¯Coreä»¥å¤–ï¼ˆ5.1ä»¥å‰ï¼‰ã®ç’°å¢ƒã§ã®ã¿Shift JISã§è¨­å®šã•ã‚Œã‚‹ã€‚
            #   Coreç’°å¢ƒã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯ã€UTF-8ã§ã‚ã‚ŠUTF-8ã§è¨­å®šã•ã‚Œã¦ã—ã¾ã†ã€‚
            #   ã¾ãŸã€Shift JISã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚‚å­˜åœ¨ã—ãªã„ç‚ºã€Coreç’°å¢ƒã§Shift JISã®è¨­å®šã¯ä¸å¯ã¨ãªã‚‹ã€‚
            $PSDefaultParameterValues['*:Encoding'] = 'default'
            $global:OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
            [console]::OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’ASCIIã«è¨­å®šã™ã‚‹
        'ascii' {
            $PSDefaultParameterValues.Remove('*:Encoding')
            $global:OutputEncoding = [System.Text.Encoding]::ASCII
            [console]::OutputEncoding = [System.Text.Encoding]::ASCII
        }
        # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰æŒ‡å®šã‚’è§£é™¤ã™ã‚‹
        'rm_encoding' {
            $PSDefaultParameterValues.Remove('*:Encoding')
        }
        # æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰è¨­å®šã‚’åˆæœŸçŠ¶æ…‹ã«æˆ»ã™
        'reset_encoding' {
            $PSDefaultParameterValues.Remove('*:Encoding')

            if ($PSVersionTable.PSEdition -eq 'Core') {
                # Core ã®å ´åˆ
                $global:OutputEncoding = [System.Text.Encoding]::UTF8
                [console]::OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
            }
            else {
                # Core ä»¥å¤–ã®å ´åˆï¼ˆPowerShell 5.1 ä»¥å‰ï¼‰
                $global:OutputEncoding = [System.Text.Encoding]::ASCII
                [console]::OutputEncoding = [System.Text.Encoding]::GetEncoding('shift_jis')
            }
        }
    }
}
```

#### \[PowerShell\]æ¨™æº–å‡ºåŠ›ã‚’ç„¡è¦–ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã«å¤‰æ›ã™ã‚‹Function

https://zenn.dev/haretokidoki/articles/24ac3ba42d8050

```powershell:ã‚³ãƒãƒ³ãƒ‰ã‚’åŠ å·¥ã—å®Ÿè¡Œ
<#
.SYNOPSIS
    æ–‡å­—åˆ—é…åˆ—ã®å„è¦ç´ ã®å…ˆé ­ã¨æœ«å°¾ã«ã€æŒ‡å®šã•ã‚ŒãŸæ–‡å­—åˆ—ã‚’è¿½åŠ ã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€commands ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸæ–‡å­—åˆ—ã®é…åˆ—ã‚’å‡¦ç†ã—ã¾ã™ã€‚
    é…åˆ—å†…ã®å„æ–‡å­—åˆ—ã«å¯¾ã—ã¦ã€first ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸæ–‡å­—åˆ—ã‚’å…ˆé ­ã«ã€last ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸæ–‡å­—åˆ—ã‚’æœ«å°¾ã«çµåˆã—ã¾ã™ã€‚
    ã“ã®å‡¦ç†ã‚’ã™ã¹ã¦ã®è¦ç´ ã«é©ç”¨ã—ã€åŠ å·¥å¾Œã®æ–°ã—ã„æ–‡å­—åˆ—é…åˆ—ã‚’è¿”ã—ã¾ã™ã€‚
    ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®å‡ºåŠ›ã‚’æŠ‘åˆ¶ã™ã‚‹ãŸã‚ã® `[void](...)` ã‚­ãƒ£ã‚¹ãƒˆå½¢å¼ã®æ–‡å­—åˆ—ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

.PARAMETER commands
    åŠ å·¥å¯¾è±¡ã¨ãªã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚„æ–‡å­—åˆ—ã‚’æ ¼ç´ã—ãŸé…åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚
    ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER first
    å„æ–‡å­—åˆ—ã®å…ˆé ­ã«è¿½åŠ ã™ã‚‹æ–‡å­—åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚
    ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’çœç•¥ã—ãŸå ´åˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¨ã—ã¦ '[void](' ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

.PARAMETER last
    å„æ–‡å­—åˆ—ã®æœ«å°¾ã«è¿½åŠ ã™ã‚‹æ–‡å­—åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚
    ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’çœç•¥ã—ãŸå ´åˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¨ã—ã¦ ')' ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

.EXAMPLE
    # ä¾‹ 1: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å‹•ä½œã§voidã‚­ãƒ£ã‚¹ãƒˆæ–‡å­—åˆ—ã‚’ç”Ÿæˆã™ã‚‹
    PS C:\> $commandList = @('Get-Date', 'Get-Process')
    PS C:\> Add-FixedString -commands $commandList
    [void](Get-Date)
    [void](Get-Process)

    ã“ã®ä¾‹ã§ã¯ã€å„ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® first ('[void](') ã¨ last (')') ã§å›²ã¾ã‚Œã€
    voidã‚­ãƒ£ã‚¹ãƒˆå½¢å¼ã®æ–°ã—ã„æ–‡å­—åˆ—é…åˆ—ãŒç”Ÿæˆã•ã‚Œã¦è¿”ã•ã‚Œã¾ã™ã€‚

.EXAMPLE
    # ä¾‹ 2: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒ‡å®šã—ã¦ã€å‡ºåŠ›ã‚’$nullã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹æ–‡å­—åˆ—ã‚’ç”Ÿæˆã™ã‚‹
    PS C:\> $commandList = @('Get-Date', 'Get-Process')
    PS C:\> Add-FixedString -commands $commandList -first '' -last ' > $null'
    Get-Date > $null
    Get-Process > $null

    ã“ã®ä¾‹ã§ã¯ã€first ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ç©ºæ–‡å­—åˆ—ã€last ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆç”¨ã®æ–‡å­—åˆ— ' > $null' ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚
    ã“ã‚Œã«ã‚ˆã‚Šã€å„ã‚³ãƒãƒ³ãƒ‰ã®æœ«å°¾ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå‡¦ç†ãŒè¿½åŠ ã•ã‚ŒãŸæ–°ã—ã„æ–‡å­—åˆ—é…åˆ—ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

.OUTPUTS
    System.String[]
    åŠ å·¥å¾Œã®æ–‡å­—åˆ—ã‚’æ ¼ç´ã—ãŸæ–°ã—ã„é…åˆ—ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    ã“ã®é–¢æ•°ã¯æ–‡å­—åˆ—ã‚’åŠ å·¥ã™ã‚‹ã ã‘ã§ã€ã‚³ãƒãƒ³ãƒ‰è‡ªä½“ã‚’å®Ÿè¡Œã™ã‚‹æ©Ÿèƒ½ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
    ç”Ÿæˆã•ã‚ŒãŸæ–‡å­—åˆ—ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯ã€`Invoke-Expression` ãªã©ã®åˆ¥ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
#>
Function Add-FixedString {
    Param (
        # å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ï¼šã‚³ãƒãƒ³ãƒ‰ãŒè¨˜è¼‰ã•ã‚ŒãŸæ–‡å­—åˆ—é…åˆ—
        [Parameter(Mandatory=$true)]
        [System.String[]]$commands,

        # ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ï¼šå…ˆé ­ã«è¿½åŠ ã™ã‚‹æ–‡å­—
        [System.String]$first = '[void](',

        # ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ï¼šæœ«å°¾ã«è¿½åŠ ã™ã‚‹æ–‡å­—
        [System.String]$last = ')'
    )

    # çµæœã‚’æ ¼ç´ã™ã‚‹é…åˆ—ã‚’ä½œæˆ
    [System.String[]]$result = @()

    # é…åˆ—å†…ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ç¹°ã‚Šè¿”ã—å‡¦ç†ã§å¤‰æ›´
    [System.String]$modified = ''
    foreach ($command in $commands) {
        # å…ˆé ­ã¨æœ«å°¾ã«å›ºå®šå€¤ã®æ–‡å­—ã‚’è¿½åŠ 
        $modified = "$($first)$($command)$($last)"

        # çµæœã®é…åˆ—ã«è¿½åŠ 
        $result += $modified
    }

    # çµæœã®é…åˆ—ã‚’è¿”ã™
    return $result
}
```

#### â€œping -tâ€ã®ã‚ˆã†ã«PowerShellã§ã‚‚é€£ç¶šã—ã¦pingç–é€šã™ã‚‹æ–¹æ³•

https://zenn.dev/haretokidoki/articles/31ad6dfc204e38

```powershell:PowerShellã§é€£ç¶šPingç–é€šã‚’å®Ÿè¡Œ
<#
.SYNOPSIS
    æŒ‡å®šã—ãŸãƒ›ã‚¹ãƒˆã«å¯¾ã—ã¦ã€æŒ‡å®šã—ãŸé–“éš”ã§é€£ç¶šçš„ã«Pingã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã® `ping -t` ã‚³ãƒãƒ³ãƒ‰ã¨åŒæ§˜ã®æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚
    TargetHost ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸãƒ›ã‚¹ãƒˆã«å¯¾ã—ã€Test-Connection ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’1å›ãšã¤å®Ÿè¡Œã™ã‚‹å‡¦ç†ã‚’ç„¡é™ã«ç¹°ã‚Šè¿”ã—ã¾ã™ã€‚
    Pingã®å®Ÿè¡Œé–“éš”ã¯ PingInterval ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ãƒŸãƒªç§’å˜ä½ã§æŒ‡å®šã§ãã¾ã™ã€‚
    PingãŒæˆåŠŸã™ã‚‹ã¨ã€å®Ÿè¡Œæ—¥æ™‚ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒ›ã‚¹ãƒˆã€å¿œç­”æ™‚é–“ã‚’ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã®æ–‡å­—åˆ—ã¨ã—ã¦å‡ºåŠ›ã—ã¾ã™ã€‚
    PingãŒå¤±æ•—ã—ãŸå ´åˆï¼ˆä¾‹: åå‰è§£æ±ºãŒã§ããªã„ãªã©ï¼‰ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’èµ¤è‰²ã§è¡¨ç¤ºã—ã€å‡¦ç†ã¯ç¶šè¡Œã•ã‚Œã¾ã™ã€‚
    ã“ã®é–¢æ•°ã‚’åœæ­¢ã™ã‚‹ã«ã¯ã€Ctrl+C ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚

.PARAMETER TargetHost
    Pingã®å®›å…ˆã¨ãªã‚‹ãƒ›ã‚¹ãƒˆåã¾ãŸã¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚
    ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’çœç•¥ã—ãŸå ´åˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¨ã—ã¦ 'localhost' ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

.PARAMETER PingInterval
    å„Pingã®å®Ÿè¡Œé–“éš”ã‚’ãƒŸãƒªç§’å˜ä½ã§æŒ‡å®šã—ã¾ã™ã€‚
    ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’çœç•¥ã—ãŸå ´åˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¨ã—ã¦ 1000 (1ç§’) ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

.EXAMPLE
    # ä¾‹ 1: www.bing.com ã«å¯¾ã—ã¦ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆé–“éš”ã§Pingã‚’å®Ÿè¡Œã™ã‚‹
    PS C:\> Invoke-ContinuousPing www.bing.com

    2024/05/17 12:21:53.557, www.bing.com, 28 ms
    2024/05/17 12:21:54.643, www.bing.com, 21 ms
    2024/05/17 12:21:55.703, www.bing.com, 21 ms
    ... (Ctrl+C ã‚’æŠ¼ã™ã¾ã§å‡¦ç†ãŒç¶šã)

    ã“ã®ä¾‹ã§ã¯ã€ãƒ›ã‚¹ãƒˆ 'www.bing.com' ã«å¯¾ã—ã¦ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®é–“éš”ï¼ˆ1ç§’ï¼‰ã§é€£ç¶šçš„ã«Pingã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

.EXAMPLE
    # ä¾‹ 2: ç‰¹å®šã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¯¾ã—ã¦500msé–“éš”ã§Pingã‚’å®Ÿè¡Œã™ã‚‹
    PS C:\> Invoke-ContinuousPing -TargetHost 192.168.1.1 -PingInterval 500

    ã“ã®ä¾‹ã§ã¯ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ '192.168.1.1' ã«å¯¾ã—ã¦ã€500ãƒŸãƒªç§’ï¼ˆ0.5ç§’ï¼‰é–“éš”ã§é€£ç¶šçš„ã«Pingã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

.OUTPUTS
    System.String
    PingãŒæˆåŠŸã—ãŸå ´åˆã€"yyyy/MM/dd HH:mm:ss.fff, [TargetHost], [ResponseTime] ms" ã®å½¢å¼ã®æ–‡å­—åˆ—ã‚’å‡ºåŠ›ã‚¹ãƒˆãƒªãƒ¼ãƒ ã«æ›¸ãè¾¼ã¿ã¾ã™ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯ç„¡é™ãƒ«ãƒ¼ãƒ—ã§å‹•ä½œã—ã¾ã™ã€‚å‡¦ç†ã‚’åœæ­¢ã™ã‚‹ã«ã¯ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ Ctrl+C ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚
    - Pingã®å¤±æ•—ï¼ˆTest-Connectionã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆè‡ªä½“ã®ã‚¨ãƒ©ãƒ¼ï¼‰ã¯ try-catch ãƒ–ãƒ­ãƒƒã‚¯ã§æ•æ‰ã•ã‚Œã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚ŒãŸå¾Œã‚‚å‡¦ç†ã¯ç¶šè¡Œã•ã‚Œã¾ã™ã€‚
    - å¿œç­”æ™‚é–“ãŒ 0 ãƒŸãƒªç§’ã®å ´åˆ (ä¾‹: localhostã¸ã®ping)ã€å‡ºåŠ›ã¯ "0 ms" ã¨è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
#>
# Functionã®å®šç¾©
Function Invoke-ContinuousPing{
    param(
        [System.String]$TargetHost = 'localhost',
        [System.Int32]$PingInterval = 1000
    )
    # ãƒ–ãƒ¬ãƒ¼ã‚¯é€ä¿¡ã•ã‚Œã‚‹ã¾ã§ç¹°ã‚Šè¿”ã—
    while ($true) {
        try {
            # pingå®Ÿè¡Œ
            # [Microsoft.PowerShell.Commands.TestConnectionCommand+PingStatus]
            $pingResult = Test-Connection $TargetHost -Count 1 -ErrorAction Stop
            # ç”»é¢ã«çµæœè¡¨ç¤º
            [System.String]$currentDatetime = (Get-Date -Format "yyyy/MM/dd HH:mm:ss.fff")
            # ResponseTimeãŒ0ã®å ´åˆã€nullã«ãªã‚‹ãŸã‚åˆ¤å®šã™ã‚‹
            if ($null -eq $pingResult.ResponseTime) {
                # ResponseTImeãŒnullã®å ´åˆã¯ã€å›ºå®šå€¤"0 ms"
                Write-Output "$currentDatetime, $TargetHost, 0 ms"
            }
            else {
                # nullã§ã¯ãªã„å ´åˆã€å–å¾—ã—ãŸå€¤ã‚’è¨­å®š
                Write-Output "$currentDatetime, $TargetHost, $($pingResult.ResponseTime) ms"
            }
        }
        catch {
            Write-Host "ã‚¨ãƒ©ãƒ¼ï¼š$($_.Exception.Message)" -ForegroundColor Red
            # ã€Œping -tã€ã®æŒ™å‹•ã«åˆã‚ã›ã€pingç–é€šãŒå–ã‚Œãªãã¦ã‚‚å‡¦ç†ã‚’ç¶šè¡Œã™ã‚‹ã€‚
            # ã‚‚ã—ã€NGã¨ãªã£ãŸå ´åˆã«å‡¦ç†ã‚’ä¸­æ–­ã—ãŸã„å ´åˆã¯ã€ã“ã“ã§ã€Œbreakã€ã‚’å®Ÿè¡Œã€‚
            # break
        }
        # é–“éš”ã‚’ã‚ã‘ã‚‹
        Start-Sleep -Milliseconds $PingInterval
    }
}
```

#### PowerShellã§ æ–‡å­—ã‚³ãƒ¼ãƒ‰ ãŠã‚ˆã³ BOMä»˜ã ã‚’åˆ¤å®šã™ã‚‹Function

https://zenn.dev/haretokidoki/articles/962a7fc6c51b47

##### PowerShellã§ç¾åœ¨ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª

```powershell:PowerShellã§ç¾åœ¨ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ï¼ˆã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼‰ã‚’åˆ¤å®šã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€TargetFile ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ `System.IO.StreamReader` ã‚’ä½¿ã£ã¦é–‹ãã¾ã™ã€‚
    `StreamReader` ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­ã«ã‚ã‚‹ãƒã‚¤ãƒˆã‚ªãƒ¼ãƒ€ãƒ¼ãƒãƒ¼ã‚¯ï¼ˆBOMï¼‰ã‚’è‡ªå‹•çš„ã«æ¤œå‡ºã—ã€ãã‚Œã«åŸºã¥ã„ã¦æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’åˆ¤å®šã—ã¾ã™ã€‚
    åˆ¤å®šã•ã‚ŒãŸã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®è¡¨ç¤ºåï¼ˆä¾‹: "Unicode (UTF-8)"ï¼‰ãŒã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚

.PARAMETER TargetFile
    æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’åˆ¤å®šã—ãŸã„ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    # utf8.txt ã¨ã„ã†åå‰ã®BOMä»˜ãUTF-8ãƒ•ã‚¡ã‚¤ãƒ«ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã™ã‚‹
    PS C:\> Get-PsEncoding .\utf8.txt

    EncodingName: [Unicode (UTF-8)]

    ã“ã®ä¾‹ã§ã¯ã€`utf8.txt` ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒ "Unicode (UTF-8)" ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚

.OUTPUTS
    ãªã—
    ã“ã®é–¢æ•°ã¯ `Write-Host` ã‚’ä½¿ç”¨ã—ã¦ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ç›´æ¥çµæœã‚’å‡ºåŠ›ã™ã‚‹ãŸã‚ã€æˆåŠŸã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã—ã¾ã›ã‚“ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰åˆ¤å®šã¯ã€ä¸»ã«ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒã‚¤ãƒˆã‚ªãƒ¼ãƒ€ãƒ¼ãƒãƒ¼ã‚¯ï¼ˆBOMï¼‰ã«ä¾å­˜ã—ã¾ã™ã€‚
    - BOMãŒãªã„ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®å ´åˆã€`StreamReader` ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§UTF-8ã¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚‚ã†ã¨ã™ã‚‹ãŸã‚ã€å®Ÿéš›ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¨ç•°ãªã‚‹çµæœãŒè¡¨ç¤ºã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
    - ã“ã®é–¢æ•°ã¯ `Write-Host` ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€åˆ¤å®šçµæœã‚’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ä»–ã®ã‚³ãƒãƒ³ãƒ‰ã«æ¸¡ã™ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚
#>
# æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®åˆ¤å®š
Function Get-PsEncoding {
    param (
        [Parameter(Mandatory=$true)][System.String]$TargetFile
    )

    $streamReader = New-Object System.IO.StreamReader (Convert-Path $TargetFile)
    $profileEncoding = $streamReader.CurrentEncoding
    $streamReader.Close()

    Write-Host "EncodingName: [$($profileEncoding.EncodingName)]"
}
```

##### UTFã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒBOMä»˜ãã‹åˆ¤å®š

```powershell:UTFã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒBOMä»˜ãã‹åˆ¤å®š
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒå„ç¨®UTFã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®ãƒã‚¤ãƒˆã‚ªãƒ¼ãƒ€ãƒ¼ãƒãƒ¼ã‚¯ï¼ˆBOMï¼‰ã‚’æŒã¤ã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€TargetFile ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­ãƒã‚¤ãƒˆã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚
    èª­ã¿è¾¼ã‚“ã ãƒã‚¤ãƒˆã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’ã€ã‚ã‚‰ã‹ã˜ã‚å®šç¾©ã•ã‚ŒãŸUTF-7, UTF-8, UTF-16 (Big Endian/Little Endian), UTF-32 (Big Endian/Little Endian) ã®BOMã¨æ¯”è¼ƒã—ã¾ã™ã€‚
    ä¸€è‡´ã™ã‚‹BOMãŒè¦‹ã¤ã‹ã£ãŸå ´åˆã¯ãã®ç¨®é¡ã‚’ã€è¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸå ´åˆã¯BOMãŒãªã„æ—¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã—ã¾ã™ã€‚

.PARAMETER TargetFile
    BOMã®æœ‰ç„¡ã‚’åˆ¤å®šã—ãŸã„ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    PS C:\> # BOMä»˜ãã®UTF-8ãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã—ã¦å®Ÿè¡Œ
    PS C:\> Check-BOMStatus .\utf8_bom.txt

    [.\utf8_bom.txt] is UTF-8 BOM.

    ã“ã®ä¾‹ã§ã¯ã€`utf8_bom.txt` ãƒ•ã‚¡ã‚¤ãƒ«ã«UTF-8ã®BOMãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã•ã‚Œã¾ã™ã€‚

.OUTPUTS
    ãªã—
    ã“ã®é–¢æ•°ã¯ `Write-Host` ã‚’ä½¿ç”¨ã—ã¦ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ç›´æ¥çµæœã‚’å‡ºåŠ›ã™ã‚‹ãŸã‚ã€æˆåŠŸã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã—ã¾ã›ã‚“ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯UTFç³»ã®BOMã®ã¿ã‚’ãƒã‚§ãƒƒã‚¯å¯¾è±¡ã¨ã—ã¦ã„ã¾ã™ã€‚ä»–ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆShift-JISãªã©ï¼‰ã¯åˆ¤å®šã§ãã¾ã›ã‚“ã€‚
    - ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã€è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã¦å‡¦ç†ã‚’çµ‚äº†ã—ã¾ã™ã€‚
    - ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«ã¯ `Get-Content -Encoding Byte` ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€ãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­ã‹ã‚‰æœ€å¤§4ãƒã‚¤ãƒˆã‚’èª­ã¿è¾¼ã‚“ã§åˆ¤å®šã—ã¾ã™ã€‚
#>
Function Check-BOMStatus {
    param (
        [Parameter(Mandatory=$true)][System.String]$TargetFile
    )

    # ç„¡åŠ¹ãªãƒ•ã‚¡ã‚¤ãƒ«ã ã£ãŸå ´åˆ
    if (-Not (Test-Path $TargetFile)) {
        Write-Warning 'The target file does not exist.' -ForegroundColor Red
        return
    }
    
    # BOMã®ãƒã‚¤ãƒˆã‚·ãƒ¼ã‚±ãƒ³ã‚¹
    $UTF7_BOM1 = [System.Byte[]](0x2B,0x2F,0x76,0x38)
    $UTF7_BOM2 = [System.Byte[]](0x2B,0x2F,0x76,0x39)
    $UTF7_BOM3 = [System.Byte[]](0x2B,0x2F,0x76,0x2B)
    $UTF7_BOM4 = [System.Byte[]](0x2B,0x2F,0x76,0x2F)
    $UTF8_BOM = [System.Byte[]](0xEF,0xBB,0xBF)
    $UTF16BE_BOM = [System.Byte[]](0xFE,0xFF)
    $UTF16LE_BOM = [System.Byte[]](0xFF,0xFE)
    $UTF32BE_BOM = [System.Byte[]](0x00,0x00,0xFE,0xFF)
    $UTF32LE_BOM = [System.Byte[]](0xFF,0xFE,0x00,0x00)
    
    # å…ˆé ­è¡Œã‚’ãƒã‚¤ãƒˆã§èª­ã¿è¾¼ã¿å…ˆé ­ã‹ã‚‰3ãƒã‚¤ãƒˆåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
    [System.Byte[]]$first4Bytes = (Get-Content -Path $TargetFile -Encoding Byte -TotalCount 4)
    [System.Byte[]]$first3Bytes = $first4Bytes[0..2]
    [System.Byte[]]$first2Bytes = $first4Bytes[0..1]
    
    # å…ˆé ­ãƒã‚¤ãƒˆã§BOMä»˜ãã‹åˆ¤å®š
    # UTF-7
    if (($null -eq (Compare-Object $first4Bytes $UTF7_BOM1 -SyncWindow 0)) -Or
        ($null -eq (Compare-Object $first4Bytes $UTF7_BOM2 -SyncWindow 0)) -Or
        ($null -eq (Compare-Object $first4Bytes $UTF7_BOM3 -SyncWindow 0)) -Or
        ($null -eq (Compare-Object $first4Bytes $UTF7_BOM4 -SyncWindow 0))) {
        Write-Host "[$($TargetFile)] is UTF-7 BOM."
    }
    # UTF-8
    elseif ($null -eq (Compare-Object $first3Bytes $UTF8_BOM -SyncWindow 0)) {
        Write-Host "[$($TargetFile)] is UTF-8 BOM."
    }
    # UTF-16 BE
    elseif ($null -eq (Compare-Object $first2Bytes $UTF16BE_BOM -SyncWindow 0)) {
        Write-Host "[$($TargetFile)] is UTF-16 BE BOM."
    }
    # UTF-16 LE
    elseif ($null -eq (Compare-Object $first2Bytes $UTF16LE_BOM -SyncWindow 0)) {
        Write-Host "[$($TargetFile)] is UTF-16 LE BOM."
    }
    # UTF-32 BE
    elseif ($null -eq (Compare-Object $first4Bytes $UTF32BE_BOM -SyncWindow 0)) {
        Write-Host "[$($TargetFile)] is UTF-32 BE BOM."
    }
    # UTF-32 LE
    elseif ($null -eq (Compare-Object $first4Bytes $UTF32LE_BOM -SyncWindow 0)) {
        Write-Host "[$($TargetFile)] is UTF-32 LE BOM."
    }
    else {
        Write-Host "[$($TargetFile)] is not BOM." -ForegroundColor Red
    }
}
```

#### PowerShell 6.0ä»¥é™ï¼ˆCoreï¼‰ã§OSç’°å¢ƒã‚’ç¢ºèªã§ãã‚‹è‡ªå‹•å¤‰æ•°

https://zenn.dev/haretokidoki/articles/fac8e50fbe9dcd

```powershell:PowerShellå®Ÿè¡Œç’°å¢ƒã‚’ãƒã‚§ãƒƒã‚¯
# ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ enumè¨­å®š
Add-Type -TypeDefinition @"
    public enum MESSAGECODE {
        Successful = 0,
        Error_NotCore,
        Error_NotSupportedVersion,
        Error_NotWindows
    }
"@

<#
.SYNOPSIS
    ç¾åœ¨ã®PowerShellå®Ÿè¡Œç’°å¢ƒãŒã€ç‰¹å®šã®è¦ä»¶ï¼ˆWindowsä¸Šã®PowerShell 7 Coreä»¥ä¸Šï¼‰ã‚’æº€ãŸã—ã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€å¼•æ•°ã‚’å–ã‚‰ãšã«ç¾åœ¨ã®PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ç’°å¢ƒã‚’æ¤œè¨¼ã—ã¾ã™ã€‚
    å…·ä½“çš„ã«ã¯ã€ä»¥ä¸‹ã®3ã¤ã®æ¡ä»¶ã‚’é †ç•ªã«ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚
    1. PowerShellã®ã‚¨ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ãŒ 'Core' (6.0ä»¥é™) ã§ã‚ã‚‹ã“ã¨ã€‚
    2. PowerShellã®ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ 7 ä»¥ä¸Šã§ã‚ã‚‹ã“ã¨ã€‚
    3. å®Ÿè¡ŒOSãŒ Windows ã§ã‚ã‚‹ã“ã¨ã€‚

    å„ãƒã‚§ãƒƒã‚¯ã§è¦ä»¶ã‚’æº€ãŸã•ãªã„å ´åˆã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«èµ¤è‰²ã§ç†ç”±ã‚’è¡¨ç¤ºã—ã€å¯¾å¿œã™ã‚‹ã‚¨ãƒ©ãƒ¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¿”ã—ã¦å‡¦ç†ã‚’çµ‚äº†ã—ã¾ã™ã€‚
    ã™ã¹ã¦ã®ãƒã‚§ãƒƒã‚¯ã‚’é€šéã—ãŸå ´åˆã¯ã€æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã€æˆåŠŸã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¿”ã—ã¾ã™ã€‚
    æˆ»ã‚Šå€¤ã«ã¯ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å†’é ­ã§å®šç¾©ã•ã‚ŒãŸ `MESSAGECODE` ã¨ã„ã†ã‚«ã‚¹ã‚¿ãƒ enumå‹ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

.EXAMPLE
    # ä¾‹ 1: è¦ä»¶ã‚’æº€ãŸã™ç’°å¢ƒï¼ˆä¾‹: Windowsä¸Šã®PowerShell 7.3ï¼‰ã§å®Ÿè¡Œã—ãŸå ´åˆ
    PS C:\> $status = Check-PsEnv
    Coreï¼ˆ6.0ä»¥é™ï¼‰ã®ç’°å¢ƒã§ã€ã‹ã¤ 7ä»¥ä¸Š ã®ç’°å¢ƒã€Windows OS ã®ç’°å¢ƒã§ã‚ã‚‹
    PS C:\> $status
    Successful
    PS C:\> [int]$status
    0

    # ã“ã®ä¾‹ã§ã¯ã€ã™ã¹ã¦ã®æ¡ä»¶ã‚’æº€ãŸã—ã¦ã„ã‚‹ãŸã‚ã€æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã€
    # æˆ»ã‚Šå€¤ã¨ã—ã¦ [MESSAGECODE]::Successful ãŒè¿”ã•ã‚Œã¾ã™ã€‚

.EXAMPLE
    # ä¾‹ 2: è¦ä»¶ã‚’æº€ãŸã•ãªã„ç’°å¢ƒï¼ˆä¾‹: Windows PowerShell 5.1ï¼‰ã§å®Ÿè¡Œã—ãŸå ´åˆ
    PS C:\> $status = Check-PsEnv
    Coreï¼ˆ6.0ä»¥é™ï¼‰ã®ç’°å¢ƒã§ã¯ãªã„
    PS C:\> $status
    Error_NotCore
    PS C:\> [int]$status
    1

    # ã“ã®ä¾‹ã§ã¯ã€æœ€åˆã®ãƒã‚§ãƒƒã‚¯ï¼ˆCoreã‚¨ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ã‹ã©ã†ã‹ï¼‰ã§å¤±æ•—ã™ã‚‹ãŸã‚ã€
    # é–¢é€£ã™ã‚‹ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã€æˆ»ã‚Šå€¤ã¨ã—ã¦ [MESSAGECODE]::Error_NotCore ãŒè¿”ã•ã‚Œã¾ã™ã€‚

.OUTPUTS
    MESSAGECODE
    ãƒã‚§ãƒƒã‚¯çµæœã‚’ç¤ºã™ `MESSAGECODE` enum ã®å€¤ã‚’è¿”ã—ã¾ã™ã€‚
    - Successful (0)
    - Error_NotCore (1)
    - Error_NotSupportedVersion (2)
    - Error_NotWindows (3)

.NOTES
    - ã“ã®é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹å‰ã«ã€`MESSAGECODE` enum ãŒ `Add-Type` ã‚’ä½¿ã£ã¦å®šç¾©ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
    - ã“ã®é–¢æ•°ã¯ç’°å¢ƒã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã ã‘ã§ã€ä½•ã‹ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
    - `Write-Host` ã‚’ä½¿ç”¨ã—ã¦ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚
#>
#################################################################################
# å‡¦ç†åã€€ | Check-PsEnv
# æ©Ÿèƒ½ã€€ã€€ | PowerShellç’°å¢ƒãƒã‚§ãƒƒã‚¯
#--------------------------------------------------------------------------------
# æˆ»ã‚Šå€¤ã€€ | MESSAGECODEï¼ˆenumï¼‰
# å¼•æ•°ã€€ã€€ | ãªã—
#################################################################################
Function Check-PsEnv {
    [MESSAGECODE]$returncode = [MESSAGECODE]::Successful

    # ç’°å¢ƒæƒ…å ±ã‚’å–å¾—
    [System.Collections.Hashtable]$psVersion = $PSVersionTable

    # ç’°å¢ƒã®åˆ¤å®šï¼šCoreã§ã¯ãªã„å ´åˆï¼ˆ5.1ã ã¨'Desktop'ã¨ãªã‚‹ï¼‰
    if ($psVersion.PSEdition -ne 'Core') {
        $returncode = [MESSAGECODE]::Error_NotCore
        Write-Host 'Coreï¼ˆ6.0ä»¥é™ï¼‰ã®ç’°å¢ƒã§ã¯ãªã„' -ForegroundColor Red
    }
    # ç’°å¢ƒã®åˆ¤å®šï¼šãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ7ã‚ˆã‚Šå°ã•ã„å ´åˆ
    elseif ($psVersion.PSVersion.Major -lt 7) {
        $returncode = [MESSAGECODE]::Error_NotSupportedVersion
        Write-Host 'Coreï¼ˆ6.0ä»¥é™ï¼‰ã®ç’°å¢ƒã ãŒã€7ä»¥ä¸Š ã®ç’°å¢ƒã§ã¯ãªã„' -ForegroundColor Red
    }
    # ç’°å¢ƒã®åˆ¤å®šï¼šWindows OSã§ã¯ãªã„å ´åˆï¼ˆPowerShell Coreã®ã¿ä½¿ç”¨ã§ãã‚‹è‡ªå‹•å¤‰æ•°ï¼‰
    elseif (-Not($IsWindows)) {
        $returncode = [MESSAGECODE]::Error_NotWindows
        Write-Host 'Coreï¼ˆ6.0ä»¥é™ï¼‰ã®ç’°å¢ƒã§ã€ã‹ã¤ 7ä»¥ä¸Š ã®ç’°å¢ƒã ãŒã€Windows OS ã®ç’°å¢ƒã§ã¯ãªã„' -ForegroundColor Red
    }
    else {
        Write-Host 'Coreï¼ˆ6.0ä»¥é™ï¼‰ã®ç’°å¢ƒã§ã€ã‹ã¤ 7ä»¥ä¸Š ã®ç’°å¢ƒã€Windows OS ã®ç’°å¢ƒã§ã‚ã‚‹'
    }

    return $returncode
}
```

#### PowerShellã‹ã‚‰Pythonã®chardetã‚’ä½¿ã£ã¦æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’åˆ¤å®š

https://zenn.dev/haretokidoki/articles/aea5b45679d966

```powershell:æ–‡å­—åˆ—åˆ¤å®šå¯èƒ½ãªPythonã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€Œchardetã€ã‚’PowerShellã‹ã‚‰å‘¼ã³å‡ºã™
<#
.SYNOPSIS
    Pythonã® `chardet` ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’åˆ©ç”¨ã—ã¦ã€æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’æ¨å®šã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’åˆ¤å®šã™ã‚‹ãŸã‚ã«ã€å†…éƒ¨ã§Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚
    ã¾ãšã€PythonãŒå®Ÿè¡Œç’°å¢ƒã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚
    æ¬¡ã«ã€`chardet` ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã€å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’åˆ¤å®šã™ã‚‹Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆ (`chardet_runner.py`) ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«é…ä¸‹ã® 'user-defined-py' ãƒ•ã‚©ãƒ«ãƒ€ã«è‡ªå‹•çš„ã«ä½œæˆã—ã¾ã™ï¼ˆåˆå›å®Ÿè¡Œæ™‚ãªã©ï¼‰ã€‚
    ã‚‚ã— `chardet` ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã€Pythonã®pipã‚’é€šã˜ã¦è‡ªå‹•çš„ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è©¦ã¿ã¾ã™ã€‚
    æœ€çµ‚çš„ã«ã€ç”Ÿæˆã•ã‚ŒãŸPythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã€ãã®çµæœï¼ˆæ¨å®šã•ã‚ŒãŸã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¨ä¿¡é ¼åº¦ï¼‰ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã—ã¾ã™ã€‚
    ã“ã®æ–¹æ³•ã«ã‚ˆã‚Šã€BOMï¼ˆãƒã‚¤ãƒˆã‚ªãƒ¼ãƒ€ãƒ¼ãƒãƒ¼ã‚¯ï¼‰ãŒãªã„ãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚‚é«˜ã„ç²¾åº¦ã§æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’åˆ¤å®šã§ãã¾ã™ã€‚

.PARAMETER TargetFile
    æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’åˆ¤å®šã—ãŸã„ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    # BOMãªã—UTF-16ãƒ•ã‚¡ã‚¤ãƒ«ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’åˆ¤å®šã™ã‚‹
    PS C:\> Get-PyEncoding .\utf16.txt

    # å®Ÿè¡Œçµæœï¼ˆchardetãŒåˆ¤å®šã—ãŸçµæœãŒå‡ºåŠ›ã•ã‚Œã‚‹ï¼‰
    Detected encoding for [D:\path\to\your\files\utf16.txt] is ascii with 100.0% confidence.

    ã“ã®ä¾‹ã§ã¯ã€`utf16.txt` ã‚’å¯¾è±¡ã«æ–‡å­—ã‚³ãƒ¼ãƒ‰åˆ¤å®šã‚’å®Ÿè¡Œã—ã€ãã®çµæœãŒã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
    ï¼ˆæ³¨ï¼š`chardet`ã®åˆ¤å®šçµæœã¯ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã«ä¾å­˜ã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ASCIIäº’æ›ã®æ–‡å­—ã®ã¿ãŒå«ã¾ã‚Œã¦ã„ã‚‹ãŸã‚'ascii'ã¨åˆ¤å®šã•ã‚Œã¦ã„ã¾ã™ã€‚ï¼‰

.OUTPUTS
    System.String
    Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ¨™æº–å‡ºåŠ›ãŒã€ãã®ã¾ã¾PowerShellã®æˆåŠŸã‚¹ãƒˆãƒªãƒ¼ãƒ ã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚
    ãŸã ã—ã€Pythonã‚„å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã€Write-Hostã«ã‚ˆã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã•ã‚Œã‚‹ã ã‘ã§ã€æˆåŠŸã‚¹ãƒˆãƒªãƒ¼ãƒ ã¸ã®å‡ºåŠ›ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯ã€äº‹å‰ã«PythonãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã€'python' ã‚³ãƒãƒ³ãƒ‰ãŒãƒ‘ã‚¹ã«é€šã£ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
    - åˆå›å®Ÿè¡Œæ™‚ãªã© `chardet` ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå­˜åœ¨ã—ãªã„å ´åˆã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆçµŒç”±ã§ `pip install chardet` ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚ãƒ—ãƒ­ã‚­ã‚·ç’°å¢ƒä¸‹ãªã©ã§ã¯å¤±æ•—ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
    - é–¢æ•°ã¯ `$PROFILE\..\user-defined-py\chardet_runner.py` ã¨ã„ã†ãƒ‘ã‚¹ã«Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ã€‚
    - `chardet` ã«ã‚ˆã‚‹åˆ¤å®šã¯ã‚ãã¾ã§ã€Œæ¨å®šã€ã§ã‚ã‚Šã€100%ã®æ­£ç¢ºæ€§ã‚’ä¿è¨¼ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚çµæœã¨å…±ã«è¡¨ç¤ºã•ã‚Œã‚‹ä¿¡é ¼åº¦ï¼ˆconfidenceï¼‰ã‚‚å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚
#>
Function Get-PyEncoding {
    param (
        [Parameter(Mandatory=$true)][System.String]$TargetFile
    )

    # python ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
    if (-Not(Get-Command 'python' -ErrorAction SilentlyContinue)) {
        Write-Host 'Python is not install.' -ForegroundColor Red
        return
    }

    # å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    if (-Not(Test-Path $TargetFile)) {
        Write-Host "[$TargetFile] does not exist." -ForegroundColor Red
        return
    }

    # çµ¶å¯¾ãƒ‘ã‚¹ã«å¤‰æ›
    [System.String]$fullPath = (Convert-Path $TargetFile)
    
    # ãƒ‡ãƒ¼ã‚¿ç¨®é¡ã®ãƒã‚§ãƒƒã‚¯
    if (-Not(Test-Path $fullPath -PathType Leaf)) {
        Write-Host "[$fullPath] is not a file." -ForegroundColor Red
        return
    }

    # Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ã‚³ãƒ¼ãƒ‰
    [System.String[]]$pySource = 
@"
import subprocess
import sys

# chardet ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
try:
    import chardet
except ImportError:
    subprocess.check_call([sys.executable, '-m', 'pip', 'install', 'chardet', '--user'])
    import chardet

# æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’åˆ¤å®šã™ã‚‹Function
def determine_encoding(file_path):
    with open(file_path, 'rb') as file:
        raw_data = file.read()
        result = chardet.detect(raw_data)
        print(f"Detected encoding for [{file_path}] is {result['encoding']} with {result['confidence']*100}% confidence.")

# ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã®å¼•æ•°ã‚’å–å¾—
file_path = sys.argv[1]

# å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®æ–‡å­—åˆ—ã‚’åˆ¤å®š
determine_encoding(file_path)

"@ -split "`r`n"

    # Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æº–å‚™
    #   Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ ¼ç´ã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯ã€æ–°è¦ä½œæˆ
    [System.String]$pyFolderPath = "$PROFILE\..\user-defined-py"
    if (-Not(Test-Path $pyFolderPath)) {
        New-Item -Path $pyFolderPath -ItemType 'directory' -Force > $null
    }
    $pyFolderPath = (Convert-Path $pyFolderPath)
    #   ä»Šå›å®Ÿè¡Œã™ã‚‹Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒãªã„å ´åˆã¯ã€æ–°è¦ä½œæˆ
    [System.String]$pyScriptPath = "$pyFolderPath\chardet_runner.py"
    if (-Not(Test-Path $pyScriptPath)) {
        $utf8Encoding = New-Object System.Text.UTF8Encoding
        [System.IO.File]::WriteAllText($pyScriptPath, $pySource, $utf8Encoding)
    }

    # Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œ
    try {
        & python $pyScriptPath $fullPath
    }
    catch {
        Write-Warning 'Python script execution error.'
        return
    }
}
```

#### \[PowerShell\]å¤‰æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’ç°¡å˜ã«ç¢ºèªã§ãã‚‹Function

https://zenn.dev/haretokidoki/articles/1632e92c37ea98

```powershell:å¤‰æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’ç¢ºèª
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸå¤‰æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹ã¨ãƒ™ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—ï¼ˆåŸºåº•ã‚¯ãƒ©ã‚¹ï¼‰ã‚’å–å¾—ã—ã¦è¡¨ç¤ºã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€Variable ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸå¤‰æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹æƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚
    å…·ä½“çš„ã«ã¯ã€.NETã® GetType() ãƒ¡ã‚½ãƒƒãƒ‰ã‚’åˆ©ç”¨ã—ã¦ã€å¤‰æ•°ãŒæŒã¤å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿å‹ï¼ˆFullNameï¼‰ã¨ã€ãã®ãƒ‡ãƒ¼ã‚¿å‹ãŒç¶™æ‰¿ã—ã¦ã„ã‚‹åŸºåº•ã‚¯ãƒ©ã‚¹ã®å‹ï¼ˆBaseTypeï¼‰ã‚’èª¿ã¹ã¾ã™ã€‚
    å–å¾—ã—ãŸæƒ…å ±ã¯ PSCustomObject ã«æ ¼ç´ã•ã‚Œã€æœ€çµ‚çš„ã« Format-Table ã‚’é€šã˜ã¦æ•´å½¢ã•ã‚ŒãŸãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

.PARAMETER Variable
    ãƒ‡ãƒ¼ã‚¿å‹ã‚’èª¿æŸ»ã—ãŸã„å¤‰æ•°ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    PS C:\> $lists = @(
    >>     @('AAAA',1),
    >>     @('BBBB',2),
    >>     @('CCCC',3)
    >> )
    PS C:\> Get-Datatype $lists

    BaseType     DataType
    --------     --------
    System.Array System.Object[]

    ã“ã®ä¾‹ã§ã¯ã€ã‚¸ãƒ£ã‚°é…åˆ—ï¼ˆé…åˆ—ã®é…åˆ—ï¼‰ã‚’å¤‰æ•°ã«æ ¼ç´ã—ã€ãã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’èª¿ã¹ã¦ã„ã¾ã™ã€‚
    çµæœã¨ã—ã¦ã€ãƒ™ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—ãŒ `System.Array`ã€ãƒ‡ãƒ¼ã‚¿å‹ãŒ `System.Object[]` ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

.OUTPUTS
    System.Management.Automation.PSCustomObject
    ã“ã®é–¢æ•°ã¯å†…éƒ¨ã§ PSCustomObject ã‚’ç”Ÿæˆã—ã¾ã™ãŒã€Format-Table ã‚’é€šã˜ã¦ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã™ã‚‹ãŸã‚ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç›´æ¥ã¯è¿”ã—ã¾ã›ã‚“ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯ `Format-Table` ã‚’ä½¿ç”¨ã—ã¦çµæœã‚’è¡¨ç¤ºã—ã¾ã™ã€‚ãã®ãŸã‚ã€å‡ºåŠ›ã¯è¦–è¦šçš„ãªç¢ºèªã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€é–¢æ•°ã®çµæœã‚’åˆ¥ã®å¤‰æ•°ã«ä»£å…¥ã—ãŸã‚Šã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ä»–ã®ã‚³ãƒãƒ³ãƒ‰ã«æ¸¡ã—ã¦å‡¦ç†ã—ãŸã‚Šã™ã‚‹ã“ã¨ã«ã¯é©ã—ã¦ã„ã¾ã›ã‚“ã€‚
    - å˜ç´”ãªå€¤ï¼ˆä¾‹: `[int]10` ã‚„ `"hello"`ï¼‰ã‹ã‚‰è¤‡é›‘ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¾ã§ã€ã‚ã‚‰ã‚†ã‚‹å¤‰æ•°ã‚’å¼•æ•°ã¨ã—ã¦æ¸¡ã™ã“ã¨ãŒã§ãã¾ã™ã€‚
#>
Function Get-Datatype {
    param (
        [Parameter(Mandatory=$true)]$Variable
    )

    # æ–‡å­—åˆ—é…åˆ—ã‚’å®£è¨€
    [System.String[]]$rowData = @(
        $Variable.GetType().BaseType.FullName,      # å¤‰æ•°ã®ãƒ™ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—
        $Variable.GetType().FullName                # å¤‰æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹
    )
    
    # PSCustomObjectã§é …ç›®åã‚’è¨­å®š
    $typesTable = [PSCustomObject]@{
        BaseType = $rowData[0]
        DataType = $rowData[1]
    }

    # ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§è¡¨ç¤º
    $typesTable | Format-Table -Property BaseType, DataType -AutoSize -Wrap
}
```

#### PowerShellã§ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’ä¸€æ‹¬å¤‰æ›ã™ã‚‹Function

https://zenn.dev/haretokidoki/articles/cdaf8a77dfc892

##### ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’ä¸€æ‹¬å¤‰æ›

```powershell:ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’ä¸€æ‹¬å¤‰æ›
<#
.SYNOPSIS
    ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ï¼ˆCRLF, LF, CRï¼‰ã‚’è¦–è¦šçš„ãªãƒãƒ¼ã‚«ãƒ¼ã«å¤‰æ›ã—ã¦ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€TargetFile ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€ãã®ä¸­ã«å«ã¾ã‚Œã‚‹æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’è¦–è¦šçš„ã«ã‚ã‹ã‚Šã‚„ã™ã„ãƒãƒ¼ã‚«ãƒ¼ï¼ˆ<CRLF>, <LF>, <CR>ï¼‰ã«ç½®ãæ›ãˆã¦è¡¨ç¤ºã—ã¾ã™ã€‚
    ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ç›´æ¥å¤‰æ›´ã™ã‚‹ã“ã¨ãªãã€ã©ã®ã‚ˆã†ãªæ”¹è¡Œã‚³ãƒ¼ãƒ‰ãŒã©ã“ã«ä½¿ã‚ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚
    ã¾ãŸã€Returncode ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã€ã“ã®é–¢æ•°è‡ªä½“ã®å‡ºåŠ›ãŒã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã•ã‚Œã‚‹éš›ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ï¼ˆCRLFã¾ãŸã¯LFï¼‰ã‚’æŒ‡å®šã§ãã¾ã™ã€‚

.PARAMETER TargetFile
    æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’è¦–è¦šåŒ–ã—ãŸã„ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER Returncode
    ãƒãƒ¼ã‚«ãƒ¼ä»˜ãã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã™ã‚‹éš›ã«ä½¿ç”¨ã™ã‚‹æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚
    'CRLF' ã¾ãŸã¯ 'LF' ã‚’æŒ‡å®šã§ãã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯ 'CRLF' ã§ã™ã€‚

.EXAMPLE
    # utf8.txt ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã™ã‚‹
    PS D:\> Show-Returncode .\utf8.txt

     *-- Result: Show-Returncode ---------------------------------------------*
    test<CRLF>

     *----------------------------------------------------------------------------*

    ã“ã®ä¾‹ã§ã¯ã€`utf8.txt` ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®CRLFæ”¹è¡Œã‚³ãƒ¼ãƒ‰ãŒ `<CRLF>` ã¨ã„ã†ãƒãƒ¼ã‚«ãƒ¼ã«ç½®ãæ›ãˆã‚‰ã‚Œã¦è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

.OUTPUTS
    ãªã—
    ã“ã®é–¢æ•°ã¯ `Write-Host` ã‚’ä½¿ç”¨ã—ã¦ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ç›´æ¥çµæœã‚’å‡ºåŠ›ã™ã‚‹ãŸã‚ã€æˆåŠŸã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã—ã¾ã›ã‚“ã€‚
#>
# æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’å¯è¦–åŒ–ã™ã‚‹Function
Function Show-Returncode {
    param (
        [Parameter(Mandatory=$true)][System.String]$TargetFile,
        [ValidateSet('CRLF', 'LF')][System.String]$Returncode = 'CRLF'
    )

    [System.Collections.Hashtable]$ReturncodeRegex = @{
        'CR'   = "`r"
        'LF'   = "`n"
        'CRLF' = "`r`n"
    }

    [System.Collections.Hashtable]$ReturncodeMark = @{
        'CR'   = '<CR>'
        'LF'   = '<LF>'
        'CRLF' = '<CRLF>'
    }

    # ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã™ã‚‹éš›ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã€‚æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã¯å¼•æ•°ã§æŒ‡å®šã—ãŸ CRLF ã‹ LF ãŒå…¥ã‚‹ã€‚
    [System.Collections.Hashtable]$ReturncodeVisualize = @{
        'CR'   = "<CR>$($ReturncodeRegex[$Returncode])"
        'LF'   = "<LF>$($ReturncodeRegex[$Returncode])"
        'CRLF' = "<CRLF>$($ReturncodeRegex[$Returncode])"
    }

    # æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’ãƒãƒ¼ã‚¯ã«å¤‰æ›
    [System.String]$targetData = (Get-Content -Path $TargetFile -Raw)
    $targetData = $targetData -Replace $ReturncodeRegex['CRLF'], $ReturncodeMark['CRLF']
    $targetData = $targetData -Replace $ReturncodeRegex['LF'], $ReturncodeMark['LF']
    $targetData = $targetData -Replace $ReturncodeRegex['CR'], $ReturncodeMark['CR']

    # ãƒãƒ¼ã‚¯ã‹ã‚‰ãƒãƒ¼ã‚¯ï¼‹æ”¹è¡Œã‚³ãƒ¼ãƒ‰ï¼ˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºç”¨ï¼‰ã«å¤‰æ›
    $targetData = $targetData -Replace $ReturncodeMark['CRLF'], $ReturncodeVisualize['CRLF']
    $targetData = $targetData -Replace $ReturncodeMark['LF'], $ReturncodeVisualize['LF']
    $targetData = $targetData -Replace $ReturncodeMark['CR'], $ReturncodeVisualize['CR']

    Write-Host ''
    Write-Host ' *-- Result: Show-Returncode ---------------------------------------------* '
    Write-Host $targetData
    Write-Host ' *----------------------------------------------------------------------------* '
    Write-Host ''
    Write-Host ''
}
```

##### æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›ã™ã‚‹Function

```powershell
<#
.SYNOPSIS
    ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®æŒ‡å®šã•ã‚ŒãŸæ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’ã€åˆ¥ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã«ä¸€æ‹¬ã§å¤‰æ›ã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«å†…ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›ã—ã¾ã™ã€‚
    BeforeReturncode ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§å¤‰æ›å…ƒã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’ã€AfterReturncode ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§å¤‰æ›å…ˆã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚
    å¤‰æ›çµæœã¯ã€Destination ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸå ´æ‰€ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚Destination ã‚’çœç•¥ã™ã‚‹ã¨ã€å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒä¸Šæ›¸ãã•ã‚Œã¾ã™ã€‚
    ã¾ãŸã€Show ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã« $true ã‚’æŒ‡å®šã™ã‚‹ã¨ã€å¤‰æ›å‡¦ç†å¾Œã« `Show-Returncode` é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã€å¤‰æ›å¾Œã®ãƒ•ã‚¡ã‚¤ãƒ«ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã—ã¦ç¢ºèªã§ãã¾ã™ã€‚

.PARAMETER TargetFile
    æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›ã—ãŸã„å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER BeforeReturncode
    å¤‰æ›å…ƒã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚'CR', 'LF', 'CRLF' ã®ã„ãšã‚Œã‹ã‚’é¸æŠã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER AfterReturncode
    å¤‰æ›å…ˆã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚'CR', 'LF', 'CRLF' ã®ã„ãšã‚Œã‹ã‚’é¸æŠã—ã¾ã™ã€‚'NONE' ã‚’æŒ‡å®šã™ã‚‹ã¨ã€å¯¾è±¡ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã¯å‰Šé™¤ã•ã‚Œã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER Destination
    å¤‰æ›å¾Œã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜å…ˆãƒ‘ã‚¹ã‚’ä»»æ„ã§æŒ‡å®šã—ã¾ã™ã€‚
    çœç•¥ã—ãŸå ´åˆã¯ã€å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ« (TargetFile) ã«ä¸Šæ›¸ãä¿å­˜ã•ã‚Œã¾ã™ã€‚

.PARAMETER Show
    $true ã‚’æŒ‡å®šã™ã‚‹ã¨ã€å¤‰æ›å®Œäº†å¾Œã« `Show-Returncode` é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã€å¤‰æ›å¾Œã®ãƒ•ã‚¡ã‚¤ãƒ«ã®çŠ¶æ…‹ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã—ã¾ã™ã€‚

.EXAMPLE
    # utf8.txt ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’CRLFã‹ã‚‰LFã«å¤‰æ›ã—ã€'utf8_lf.txt' ã¨ã—ã¦ä¿å­˜å¾Œã€çµæœã‚’ç¢ºèªã™ã‚‹
    PS D:\> Replace-Returncode .\utf8.txt CRLF LF .\utf8_lf.txt $true

    åå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ã—ã¾ã™ã€‚
    ã€€ä¿å­˜å…ˆ: [D:\Downloads\utf8_lf.txt]

     *-- Result: Show-Returncode ---------------------------------------------*
    test<LF>

     *----------------------------------------------------------------------------*

    ã“ã®ä¾‹ã§ã¯ã€`utf8.txt` ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®CRLFã‚’LFã«å¤‰æ›ã—ã€çµæœã‚’ `utf8_lf.txt` ã«ä¿å­˜ã—ã¾ã™ã€‚
    -Show $true ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€æœ€å¾Œã« `Show-Returncode` ãŒå®Ÿè¡Œã•ã‚Œã€å¤‰æ›ãŒæ­£ã—ãè¡Œã‚ã‚ŒãŸã“ã¨ï¼ˆ`<LF>` ãƒãƒ¼ã‚«ãƒ¼ï¼‰ãŒç¢ºèªã§ãã¾ã™ã€‚

.OUTPUTS
    ãªã—
    ã“ã®é–¢æ•°ã¯ `Write-Host` ã‚„ `Write-Warning` ã‚’ä½¿ç”¨ã—ã¦ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ç›´æ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºåŠ›ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®æ›¸ãè¾¼ã¿ã‚’è¡Œã†ãŸã‚ã€æˆåŠŸã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã—ã¾ã›ã‚“ã€‚

.NOTES
    - Show ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€`Show-Returncode` é–¢æ•°ãŒåŒã˜ã‚¹ã‚³ãƒ¼ãƒ—å†…ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
    - ã“ã®é–¢æ•°ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã®ã¿ã‚’å¤‰æ›´ã—ã€æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¯å¤‰æ›´ã—ã¾ã›ã‚“ã€‚
    - å®‰å…¨ã®ãŸã‚ã€ä¸Šæ›¸ãä¿å­˜ã™ã‚‹å‰ã«ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å–ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚
#>
# æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›ã™ã‚‹Function
Function Replace-Returncode {
    param (
        # å¿…é ˆï¼šå¤‰æ›å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®š
        [Parameter(Mandatory=$true)][System.String]$TargetFile,
        # å¿…é ˆï¼šå¤‰æ›ã™ã‚‹å‰å¾Œã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®š
        [Parameter(Mandatory=$true)][ValidateSet('CR', 'LF', 'CRLF')][System.String]$BeforeReturncode,
        [Parameter(Mandatory=$true)][ValidateSet('CR', 'LF', 'CRLF', 'NONE')][System.String]$AfterReturncode,
        # ä»»æ„ï¼šå¤‰æ›å¾Œã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã§ä¿å­˜ã—ãŸã„å ´åˆã«ä¿å­˜å…ˆã‚’æŒ‡å®š
        [System.String]$Destination='',
        # ä»»æ„ï¼šå¤‰æ›å¾Œã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¯è¦–åŒ–ã—ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºã—ãŸã„å ´åˆã«æŒ‡å®š
        [System.Boolean]$Show=$false
    )

    # Beforeãƒ»AfterãŒç•°ãªã‚‹æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    if ($BeforeReturncode -eq $AfterReturncode) {
        Write-Warning 'å¼•æ•°ã§æŒ‡å®šã•ã‚ŒãŸ å¤‰æ›å‰ ã¨ å¤‰æ›å¾Œ ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ãŒåŒä¸€ã§ã™ã€‚å¼•æ•°ã‚’è¦‹ç›´ã—ã¦ãã ã•ã„ã€‚'
        return
    }

    # ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆ
    if (-Not(Test-Path $TargetFile)) {
        Write-Warning 'å¤‰æ›å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã™ã€‚'
        return
    }

    # ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒãªã„å ´åˆ
    [System.String]$beforeData = (Get-Content -Path $TargetFile -Raw)
    if ($null -eq $beforeData) {
        Write-Warning 'å¤‰æ›å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ãŒç©ºã§ã™ã€‚å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã™ã€‚'
        return
    }

    # æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã®ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
    [System.Collections.Hashtable]$ReturncodeRegex = @{
        'CR'   = "`r"
        'LF'   = "`n"
        'CRLF' = "`r`n"
        'NONE' = ''
    }

    # æŒ‡å®šã—ãŸå¤‰æ›å‰å¾Œã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’æ­£è¦è¡¨ç¾ã®è¡¨è¨˜ã«å¤‰æ›´
    [System.String]$beforeReturncodeRegex = $ReturncodeRegex[$BeforeReturncode]
    [System.String]$afterReturncodeRegex = $ReturncodeRegex[$AfterReturncode]

    # å¤‰æ›å‡¦ç†
    [System.String]$afterData = ($beforeData -Replace $beforeReturncodeRegex, $afterReturncodeRegex)
    
    # å¤‰æ›ã•ã‚Œãªã‹ã£ãŸå ´åˆ
    if ($null -eq (Compare-Object $beforeData $afterData -SyncWindow 0)) {
        Write-Warning 'å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã—ãŸãŒã€å¯¾è±¡ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ãŒãªãå¤‰æ›ã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚å‡¦ç†ã‚’çµ‚äº†ã—ã¾ã™ã€‚'
        return
    }
    # ä¿å­˜å…ˆã®æŒ‡å®šãŒãªã„å ´åˆã€ä¸Šæ›¸ãä¿å­˜
    if ($Destination -eq '') {
        $Destination = $TargetFile
        Write-Host ''
        Write-Host 'ä¸Šæ›¸ãä¿å­˜ã—ã¾ã™ã€‚'
    }
    # ä¿å­˜å…ˆãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã§ä¿å­˜ï¼ˆåå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ï¼‰
    else {
        if (Test-Path $Destination -PathType Leaf) {
            Write-Warning 'æŒ‡å®šã®ä¿å­˜å ´æ‰€ã«ã¯ã€ã™ã§ã«ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã™ã€‚å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã™ã€‚'
            return
        }
        if (-Not(Test-Path "$Destination\.." -PathType Container)) {
            Write-Warning 'ä¿å­˜å ´æ‰€ã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã™ã€‚'
            return
        }
        Write-Host ''
        Write-Host 'åå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ã—ã¾ã™ã€‚'
    }
    # ä¿å­˜
    Try {
        Set-Content -Path $Destination -Value $afterData -NoNewline
    }
    catch {
        Write-Error 'Replace-Returncodeã®ä¿å­˜å‡¦ç†ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã™ã€‚'
        return
    }
    [System.String]$savepath_full = Convert-Path $Destination
    Write-Host "ã€€ä¿å­˜å…ˆ: [$savepath_full]"
    Write-Host ''
    Write-Host ''
    
    # è¡¨ç¤º
    if ($Show) {
        Show-Returncode($Destination)
    }
}
```

#### è¤‡æ•°IDã‚’æ¤œç´¢ã‚­ãƒ¼ã«winget showã®çµæœã‚’æŠ½å‡ºã—è¡¨ç¤ºã™ã‚‹Function

https://zenn.dev/haretokidoki/articles/d2c98229b3ca95

```powershell:ã€Œwinget showã€ã®çµæœã‹ã‚‰å¯¾è±¡IDã®æƒ…å ±ã‚’æŠ½å‡º
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸè¤‡æ•°ã®Wingetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸IDã«å¯¾ã—ã¦ `winget show` ã‚’å®Ÿè¡Œã—ã€çµæœã‹ã‚‰ã‚¢ãƒ—ãƒªåã€IDã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã®ç¨®é¡ã‚’æŠ½å‡ºã—ã¦è¡¨ç¤ºã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€TargetIDs ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸWingetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸IDã®é…åˆ—ã‚’å—ã‘å–ã‚Šã€ãã‚Œãã‚Œã®IDã«å¯¾ã—ã¦ `winget show` ã‚³ãƒãƒ³ãƒ‰ã‚’é †ã«å®Ÿè¡Œã—ã¾ã™ã€‚
    ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›ã‹ã‚‰ã€ã‚¢ãƒ—ãƒªãŒè¦‹ã¤ã‹ã£ãŸã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã€è¦‹ã¤ã‹ã£ãŸå ´åˆã¯ã‚¢ãƒ—ãƒªåã€IDã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã®ç¨®é¡ã‚’æŠœãå‡ºã—ã¦ã€ä¸€è¡Œã«ã¾ã¨ã‚ã¦ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã—ã¾ã™ã€‚
    IDãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸå ´åˆã¯ã€è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã¦æ¬¡ã®IDã®å‡¦ç†ã‚’ç¶šè¡Œã—ã¾ã™ã€‚
    ã“ã®é–¢æ•°ã¯ã€`winget` ã®è©³ç´°ãªå‡ºåŠ›ã‹ã‚‰å¿…è¦ãªæƒ…å ±ã ã‘ã‚’ç°¡æ½”ã«ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã—ãŸã„å ´åˆã«ä¾¿åˆ©ã§ã™ã€‚

.PARAMETER TargetIDs
    æƒ…å ±ã‚’å–å¾—ã—ãŸã„Wingetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸IDã‚’æ ¼ç´ã—ãŸæ–‡å­—åˆ—ã®é…åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚

.EXAMPLE
    PS C:\> $searchIDs = @(
    >>     'Microsoft.Edge',
    >>     '1234567890AB', # å­˜åœ¨ã—ãªã„IDã®ä¾‹
    >>     'XPFFZHVGQWWLHB',
    >>     'Microsoft.VCLibs.Desktop.14'
    >> )
    PS C:\> Write-WingetShow $searchIDs

    Microsoft Edge [Microsoft.Edge] [msi]
    è­¦å‘Š: è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ID: [1234567890AB]
    OneNote [XPFFZHVGQWWLHB] [exe]
    Microsoft Visual C++ 2015 UWP Desktop Runtime Package [Microsoft.VCLibs.Desktop.14] [msix]

    ã“ã®ä¾‹ã§ã¯ã€4ã¤ã®IDã‚’å«ã‚€é…åˆ—ã‚’é–¢æ•°ã«æ¸¡ã—ã¾ã™ã€‚
    é–¢æ•°ã¯å„IDã«å¯¾ã—ã¦ `winget show` ã‚’å®Ÿè¡Œã—ã€è¦‹ã¤ã‹ã£ãŸã‚‚ã®ã«ã¤ã„ã¦ã¯æ•´å½¢ã•ã‚ŒãŸæƒ…å ±ã‚’ã€è¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸã‚‚ã®ã«ã¤ã„ã¦ã¯è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚

.OUTPUTS
    ãªã—
    ã“ã®é–¢æ•°ã¯ `Write-Host` ãŠã‚ˆã³ `Write-Warning` ã‚’ä½¿ç”¨ã—ã¦ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ç›´æ¥çµæœã‚’å‡ºåŠ›ã™ã‚‹ãŸã‚ã€æˆåŠŸã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã—ã¾ã›ã‚“ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯ã€`winget` ã‚³ãƒãƒ³ãƒ‰ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã€å®Ÿè¡Œå¯èƒ½ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
    - é–¢æ•°ã¯ã€`winget` ã®å‡ºåŠ›ãŒæ—¥æœ¬èªï¼ˆ"è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ "ãªã©ï¼‰ã§ã‚ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚OSã®è¡¨ç¤ºè¨€èªãŒç•°ãªã‚‹å ´åˆã€æ­£ã—ãæƒ…å ±ã‚’æŠ½å‡ºã§ããªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
    - é–¢æ•°ã®å®Ÿè¡Œæ™‚ã«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’UTF-8ã«å¤‰æ›´ã—ã¾ã™ã€‚ã“ã®è¨­å®šã¯ç¾åœ¨ã®PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ç¶­æŒã•ã‚Œã¾ã™ã€‚
#>
# Function
Function Write-WingetShow {
    param (
        [System.String[]]$TargetIDs
    )
    # æŠ½å‡ºå¯¾è±¡ã®æ–‡å­—åˆ—ã‚’æŒ‡å®š
    [System.String]$hitMessage = 'è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ '
    [System.String]$installerType = '  ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã®ç¨®é¡: '

    # æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’UTF-8ã«å¤‰æ›´
    [console]::OutputEncoding = [System.Text.Encoding]::UTF8

    # ã‚³ãƒãƒ³ãƒ‰çµæœã‹ã‚‰æŠ½å‡ºã—ã‚¢ãƒ—ãƒªåãƒ»IDãƒ»ã‚½ãƒ¼ã‚¹ã®ã¿ã‚’è¡¨ç¤º
    foreach ($id in $TargetIDs) {
        [System.String[]]$appInfo = (winget show --id $id)
        # æ¤œç´¢çµæœã‚ã‚Š
        if ($appInfo -match $hitMessage) {
            $appNameAndId = $appInfo | Select-String "$hitMessage.*" | ForEach-Object {
                $_.Matches[0].Value -replace "$hitMessage", ''
            }
            $appSource = $appInfo | Select-String "$installerType.*" | ForEach-Object {
                $_.Matches[0].Value -replace "$installerType", ''
            }
            Write-Host "$appNameAndId [$appSource]"
        }
        # æ¤œç´¢çµæœãªã—
        else {
            Write-Warning "è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ID: [$id]"
            # ä¸­æ–­ã™ã‚‹å ´åˆã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆè§£é™¤
            #return
        }
    }
}
```

#### PowerShellã§æ–‡å­—åˆ—ã®ãƒã‚¤ãƒˆæ•°ã‚’å–å¾—ã™ã‚‹æ–¹æ³•ï¼ˆæ–‡å­—åˆ—æŠ½å‡ºã™ã‚‹Functionã‚‚ç´¹ä»‹ï¼‰

https://zenn.dev/haretokidoki/articles/3df8f03faeac28

##### powershell:å¯¾è±¡æ–‡å­—åˆ—ã®ãƒã‚¤ãƒˆæ•°ï¼ˆShift JISï¼‰ã‚’å–å¾—

```powershell:å¯¾è±¡æ–‡å­—åˆ—ã®ãƒã‚¤ãƒˆæ•°ï¼ˆShift JISï¼‰ã‚’å–å¾—
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸæ–‡å­—åˆ—ã®Shift-JISã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã§ã®ãƒã‚¤ãƒˆæ•°ã‚’è¨ˆç®—ã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€TargetString ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§å—ã‘å–ã£ãŸæ–‡å­—åˆ—ã«ã¤ã„ã¦ã€[System.Text.Encoding] ã‚¯ãƒ©ã‚¹ã‚’ä½¿ç”¨ã—ã¦Shift-JISã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã§ã®ãƒã‚¤ãƒˆæ•°ã‚’è¨ˆç®—ã—ã€ãã®å€¤ã‚’è¿”ã—ã¾ã™ã€‚
    Shift-JISã§ã¯ã€ä¸€èˆ¬çš„ã«å…¨è§’æ–‡å­—ã¯2ãƒã‚¤ãƒˆã€åŠè§’æ–‡å­—ã¯1ãƒã‚¤ãƒˆã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™ã€‚

.PARAMETER TargetString
    ãƒã‚¤ãƒˆæ•°ã‚’è¨ˆç®—ã—ãŸã„æ–‡å­—åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    PS C:\> Get-SjisByteCount 'é …ç›®0001  '
    10

    ã“ã®ä¾‹ã§ã¯ã€æ–‡å­—åˆ— 'é …ç›®0001  ' ã®Shift-JISã§ã®ãƒã‚¤ãƒˆæ•°ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
    ã€Œé …ç›®ã€ï¼ˆå…¨è§’2æ–‡å­— x 2ãƒã‚¤ãƒˆï¼‰ã¨ã€Œ0001  ã€ï¼ˆåŠè§’6æ–‡å­— x 1ãƒã‚¤ãƒˆï¼‰ã§ã€åˆè¨ˆ10ãƒã‚¤ãƒˆãŒè¿”ã•ã‚Œã¾ã™ã€‚

.OUTPUTS
    System.Int32
    è¨ˆç®—ã•ã‚ŒãŸæ–‡å­—åˆ—ã®ãƒã‚¤ãƒˆæ•°ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    - ãƒã‚¤ãƒˆæ•°ã®è¨ˆç®—ã«ä½¿ç”¨ã™ã‚‹ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¯ "Shift_JIS" ã«å›ºå®šã•ã‚Œã¦ã„ã¾ã™ã€‚
#>
Function Get-SjisByteCount {
    param (
        [Parameter(Mandatory=$true)]
        [System.String]$TargetString
    )

    # æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’SJISã§è¨­å®š
    $sjisEncoding = [System.Text.Encoding]::GetEncoding("Shift_JIS")

    # æ–‡å­—åˆ—ã®ãƒã‚¤ãƒˆæ•°ã‚’è¿”ã™
    return $sjisEncoding.GetByteCount($TargetString)
}
```

##### ãƒã‚¤ãƒˆæ•°ã‚’æŒ‡å®šã—ã¦æ–‡å­—åˆ—æŠ½å‡º

```powershell:ãƒã‚¤ãƒˆæ•°ã‚’æŒ‡å®šã—ã¦æ–‡å­—åˆ—æŠ½å‡º
<#
.SYNOPSIS
    Shift-JISã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’åŸºæº–ã«ã€æŒ‡å®šã•ã‚ŒãŸãƒã‚¤ãƒˆä½ç½®ã‹ã‚‰æŒ‡å®šã•ã‚ŒãŸãƒã‚¤ãƒˆæ•°åˆ†ã®æ–‡å­—åˆ—ã‚’æŠ½å‡ºã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€ã¾ãšå¯¾è±¡ã®æ–‡å­—åˆ—ã‚’Shift-JISã®ãƒã‚¤ãƒˆé…åˆ—ã«å¤‰æ›ã—ã¾ã™ã€‚
    æ¬¡ã«ã€ByteStart ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸé–‹å§‹ä½ç½®ã‹ã‚‰ã€ByteLength ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸãƒã‚¤ãƒˆæ•°åˆ†ã‚’åˆ‡ã‚Šå‡ºã—ã€æ–°ã—ã„ãƒã‚¤ãƒˆé…åˆ—ã‚’ä½œæˆã—ã¾ã™ã€‚
    æœ€å¾Œã«ã€ã“ã®æ–°ã—ã„ãƒã‚¤ãƒˆé…åˆ—ã‚’Shift-JISã®æ–‡å­—åˆ—ã«å†å¤‰æ›ã—ã¦è¿”ã—ã¾ã™ã€‚
    å›ºå®šé•·ã®ãƒã‚¤ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†éš›ã«ä¾¿åˆ©ã§ã™ã€‚

.PARAMETER TargetString
    æŠ½å‡ºå…ƒã®æ–‡å­—åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER ByteStart
    æŠ½å‡ºã‚’é–‹å§‹ã™ã‚‹ãƒã‚¤ãƒˆä½ç½®ã‚’ã€0ã‹ã‚‰å§‹ã¾ã‚‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER ByteLength
    æŠ½å‡ºã™ã‚‹ãƒã‚¤ãƒˆæ•°ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    PS C:\> Get-SubstringByByte '1234ã‚ã‹' 4 4
    ã‚ã‹

    ã“ã®ä¾‹ã§ã¯ã€æ–‡å­—åˆ— '1234ã‚ã‹' ã‹ã‚‰ãƒã‚¤ãƒˆå˜ä½ã§éƒ¨åˆ†æ–‡å­—åˆ—ã‚’æŠ½å‡ºã—ã¾ã™ã€‚
    Shift-JISã§ã¯ã€ã€Œ1234ã€ã¯4ãƒã‚¤ãƒˆã€ã€Œã‚ã€ã¯2ãƒã‚¤ãƒˆã€ã€Œã‹ã€ã¯2ãƒã‚¤ãƒˆã§ã™ã€‚
    ByteStart 4 ã¯5ãƒã‚¤ãƒˆç›®ï¼ˆã€Œã‚ã€ã®å…ˆé ­ï¼‰ã‚’æŒ‡ã—ã€ãã“ã‹ã‚‰ ByteLength 4 ãƒã‚¤ãƒˆåˆ†ï¼ˆã€Œã‚ã€ã¨ã€Œã‹ã€ï¼‰ã‚’æŠ½å‡ºã™ã‚‹ãŸã‚ã€çµæœã¨ã—ã¦ã€Œã‚ã‹ã€ãŒè¿”ã•ã‚Œã¾ã™ã€‚

.OUTPUTS
    System.String
    æŒ‡å®šã•ã‚ŒãŸãƒã‚¤ãƒˆç¯„å›²ã‹ã‚‰æŠ½å‡ºã•ã‚ŒãŸæ–‡å­—åˆ—ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    - ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¯ "Shift_JIS" ã«å›ºå®šã•ã‚Œã¦ã„ã¾ã™ã€‚
    - ãƒã‚¤ãƒˆã®é–‹å§‹ä½ç½®ã‚„é•·ã•ãŒ2ãƒã‚¤ãƒˆæ–‡å­—ã®é€”ä¸­ã§åŒºåˆ‡ã‚‰ã‚Œã‚‹å ´åˆã€æ–‡å­—åŒ–ã‘ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€'ã‚' (2ãƒã‚¤ãƒˆ) ã®1ãƒã‚¤ãƒˆç›®ã ã‘ã‚’æŠ½å‡ºã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€æ­£ã—ãæ–‡å­—ã¨ã—ã¦å¾©å…ƒã§ãã¾ã›ã‚“ã€‚
    - æŒ‡å®šã—ãŸãƒã‚¤ãƒˆç¯„å›² (ByteStart + ByteLength) ãŒå…ƒã®æ–‡å­—åˆ—ã®åˆè¨ˆãƒã‚¤ãƒˆæ•°ã‚’è¶…ãˆã‚‹å ´åˆã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚
#>
#################################################################################
# å‡¦ç†åã€€ | Get-SubstringByByte
# æ©Ÿèƒ½ã€€ã€€ | ãƒã‚¤ãƒˆæ•°ã§æ–‡å­—åˆ—ã‚’æŠ½å‡º
#--------------------------------------------------------------------------------
# æˆ»ã‚Šå€¤ã€€ | Stringï¼ˆæŠ½å‡ºã—ãŸæ–‡å­—åˆ—ï¼‰
# å¼•æ•°ã€€ã€€ | TargetString: å¯¾è±¡æ–‡å­—åˆ—
# ã€€ã€€ã€€ã€€ | ByteStart   : æŠ½å‡ºé–‹å§‹ã™ã‚‹ãƒã‚¤ãƒˆä½ç½®
# ã€€ã€€ã€€ã€€ | ByteLength  : æŒ‡å®šãƒã‚¤ãƒˆæ•°
#################################################################################
Function Get-SubstringByByte {
    param (
        [Parameter(Mandatory=$true)][System.String]$TargetString,
        [Parameter(Mandatory=$true)][System.Int32]$ByteStart,
        [Parameter(Mandatory=$true)][System.Int32]$ByteLength
    )

    $sjisEncoding = [System.Text.Encoding]::GetEncoding("Shift_JIS")

    # æ–‡å­—åˆ—ã‚’ãƒã‚¤ãƒˆé…åˆ—ã«å¤‰æ›
    [System.Byte[]]$stringBytes = $sjisEncoding.GetBytes($TargetString)

    # æŠ½å‡ºã™ã‚‹ãƒã‚¤ãƒˆé…åˆ—ã‚’åˆæœŸåŒ–
    $substringBytes = New-Object Byte[] $ByteLength

    # æŒ‡å®šã•ã‚ŒãŸãƒã‚¤ãƒˆä½ç½®ã‹ã‚‰ãƒã‚¤ãƒˆé…åˆ—ã‚’æŠ½å‡º
    [System.Array]::Copy($stringBytes, $ByteStart, $substringBytes, 0, $ByteLength)

    # æŠ½å‡ºã—ãŸãƒã‚¤ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’æ–‡å­—åˆ—ã¨ã—ã¦è¿”ã™
    return $sjisEncoding.GetString($substringBytes)
}
```

#### \[PowerShell\]é…åˆ—ã®ç¨®é¡ï¼ˆã‚¸ãƒ£ã‚°é…åˆ— or å¤šæ¬¡å…ƒé…åˆ—ï¼‰ã‚’åˆ¤å®šã™ã‚‹Function"

2024.6.13 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/45c5af7cbf7eb8

```powershell:å¼•æ•°ã®é…åˆ—ã®ç¨®é¡ã‚’åˆ¤å®šã™ã‚‹Function
<#
.SYNOPSIS
    å¼•æ•°ã§æ¸¡ã•ã‚ŒãŸå¤‰æ•°ãŒã€å˜ä¸€é…åˆ—ã€å¤šæ®µéšé…åˆ—ï¼ˆã‚¸ãƒ£ã‚°é…åˆ—ï¼‰ã€å¤šæ¬¡å…ƒé…åˆ—ã®ã„ãšã‚Œã§ã‚ã‚‹ã‹ã‚’åˆ¤å®šã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€InputObject ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸå¤‰æ•°ãŒã©ã®ã‚ˆã†ãªç¨®é¡ã®é…åˆ—ã‹ã‚’åˆ¤å®šã—ã€çµæœã‚’æ•´æ•°ã‚³ãƒ¼ãƒ‰ã§è¿”ã—ã¾ã™ã€‚
    - å˜ä¸€é…åˆ— (ä¾‹: @(1, 2, 3))
    - å¤šæ®µéšé…åˆ—ï¼ˆã‚¸ãƒ£ã‚°é…åˆ—ï¼‰ (ä¾‹: @(@(1), @(2, 3)))
    - å¤šæ¬¡å…ƒé…åˆ— (ä¾‹: New-Object 'int[,]' 2,2)

    å…¥åŠ›ãŒé…åˆ—ã§ã¯ãªã„ã€ã¾ãŸã¯$nullã®å ´åˆã¯ã€é…åˆ—ã§ã¯ãªã„ã“ã¨ã‚’ç¤ºã™ã‚³ãƒ¼ãƒ‰ã‚’è¿”ã—ã¾ã™ã€‚
    ã“ã®é–¢æ•°ã¯ã€é…åˆ—ã®æ§‹é€ ã«å¿œã˜ã¦ç•°ãªã‚‹å‡¦ç†ã‚’è¡Œã„ãŸã„å ´åˆã«ä¾¿åˆ©ã§ã™ã€‚

.PARAMETER InputObject
    åˆ¤å®šå¯¾è±¡ã®å¤‰æ•°ã‚’æŒ‡å®šã—ã¾ã™ã€‚

.EXAMPLE
    # æ§˜ã€…ãªç¨®é¡ã®é…åˆ—ã‚’æº–å‚™
    $singleArray = @('ã‚', 'ã„', 'ã†')
    $multiLevel = @(@(1, 2), @(3, 4))
    $multiDim = New-Object 'System.String[,]' 2,2

    # ãã‚Œãã‚Œã®é…åˆ—ã«å¯¾ã—ã¦é–¢æ•°ã‚’å®Ÿè¡Œ
    PS C:\> Get-ArrayType $singleArray
    0
    PS C:\> Get-ArrayType $multiLevel
    1
    PS C:\> Get-ArrayType $multiDim
    2
    PS C:\> Get-ArrayType "This is not an array"
    -1

    ã“ã®ä¾‹ã§ã¯ã€3ã¤ã®ç•°ãªã‚‹ã‚¿ã‚¤ãƒ—ã®é…åˆ—ã¨éé…åˆ—ãƒ‡ãƒ¼ã‚¿ã‚’æº–å‚™ã—ã€ãã‚Œãã‚Œã«å¯¾ã—ã¦é–¢æ•°ã‚’å®Ÿè¡Œã—ã¦è¿”ã•ã‚Œã‚‹æ•´æ•°ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚
    0ã¯å˜ä¸€é…åˆ—ã€1ã¯å¤šæ®µéšé…åˆ—ã€2ã¯å¤šæ¬¡å…ƒé…åˆ—ã€-1ã¯éé…åˆ—ã‚’ç¤ºã—ã¾ã™ã€‚

.OUTPUTS
    System.Int32
    åˆ¤å®šçµæœã¨ã—ã¦ã€ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã®æ•´æ•°å€¤ã‚’è¿”ã—ã¾ã™ã€‚
    - -1: é…åˆ—ã§ã¯ãªã„ã€ã¾ãŸã¯$null (OtherTypes)
    -  0: å˜ä¸€é…åˆ— (SingleArray)
    -  1: å¤šæ®µéšé…åˆ—ï¼ˆã‚¸ãƒ£ã‚°é…åˆ—ï¼‰ (MultiLevel)
    -  2: å¤šæ¬¡å…ƒé…åˆ— (MultiDimensional)

.NOTES
    - PowerShellã§ä¸€èˆ¬çš„ã« `@(...)` ã‚’å…¥ã‚Œå­ã«ã—ã¦ä½œæˆã•ã‚Œã‚‹ã€Œã‚¸ãƒ£ã‚°é…åˆ—ï¼ˆå¤šæ®µéšé…åˆ—ï¼‰ã€ã¨ã€`New-Object 'Type[,]'` ãªã©ã§ä½œæˆã•ã‚Œã‚‹çœŸã®ã€Œå¤šæ¬¡å…ƒé…åˆ—ã€ã‚’åŒºåˆ¥ã—ã¾ã™ã€‚
    - å¤šæ®µéšé…åˆ—ã®åˆ¤å®šã¯ã€å¤šæ¬¡å…ƒé…åˆ—ã®åˆ¤å®šï¼ˆRankãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ç¢ºèªï¼‰ã‚ˆã‚Šã‚‚å„ªå…ˆã—ã¦è¡Œã‚ã‚Œã¾ã™ã€‚
#>
Function Get-ArrayType {
    param(
        $InputObject
    )
    
    [System.Collections.Hashtable]$arrayTypes = @{
        "OtherTypes" = -1
        "SingleArray" = 0
        "MultiLevel" = 1
        "MultiDimensional" = 2
    }

    # ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆ
    if ($null -eq $InputObject) {
        return $arrayTypes["OtherTypes"]
    }

    # ä¸€ç•ªå¤–æ ãŒé…åˆ—ã§ã¯ãªã„å ´åˆ
    if ($InputObject -isnot [System.Array]) {
        return $arrayTypes["OtherTypes"]
    }

    # ã‚¸ãƒ£ã‚°é…åˆ—ï¼ˆå¤šæ®µéšé…åˆ—ï¼‰ã‹åˆ¤å®š
    $isMultiLevel = $false
    foreach ($element in $InputObject) {
        if ($element -is [System.Array]) {
            # é…åˆ—ã®ä¸­ã‚‚é…åˆ—ã§å¤šæ®µé…åˆ—
            $isMultiLevel = $true
            break
        }
    }
    if ($isMultiLevel) {
        return $arrayTypes["MultiLevel"]
    }    
    
    # å¤šæ¬¡å…ƒé…åˆ—ã‹åˆ¤å®š
    if ($InputObject.Rank -ge 2) {
        # 2æ¬¡å…ƒä»¥ä¸Šã®å ´åˆ
        return $arrayTypes["MultiDimensional"]
    }
    else {
        # 1æ¬¡å…ƒã®å ´åˆ
        return $arrayTypes["SingleArray"]
    }
}
```

```powershell:Functionå®Ÿè¡Œ
# ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®æº–å‚™

#   å˜ä¸€ã®é…åˆ—
$singleArray = @('ã‚', 'ã„', 'ã†')

#   å¤šæ®µéšé…åˆ—
$multiLevel = @(@(1, 2, 3), @(4, 5), @(6, 7, 8, 9))

#   Stringå‹ã®1x2 å¤šæ¬¡å…ƒé…åˆ—
$stringMultiDim1x2 = New-Object 'System.String[,]' 1,2
$stringMultiDim1x2[0,0] = 'Hello'
$stringMultiDim1x2[0,1] = 'World'

#   Int32å‹ã®3x2 å¤šæ¬¡å…ƒé…åˆ—
$intMultiDim3x2 = New-Object 'System.Int32[,]' 3,2
$intMultiDim3x2[0,0] = 1
$intMultiDim3x2[0,1] = 2
$intMultiDim3x2[1,0] = 3
$intMultiDim3x2[1,1] = 4
$intMultiDim3x2[2,0] = 5
$intMultiDim3x2[2,1] = 6

#   Objectå‹ã®3x1 å¤šæ¬¡å…ƒé…åˆ—
$objectMultiDim3x1 = New-Object 'System.Object[,]' 3,1
$objectMultiDim3x1[0,0] = 'I am String.'
$objectMultiDim3x1[1,0] = 1
$objectMultiDim3x1[2,0] = 10.5

#   ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’é›†ç´„
$testData = @(
    @{ "Description" = "å˜ä¸€é…åˆ—"; "InputObject" = $singleArray },
    @{ "Description" = "å¤šæ®µéšé…åˆ—"; "InputObject" = $multiLevel },
    @{ "Description" = "Stringå‹1x2å¤šæ¬¡å…ƒé…åˆ—"; "InputObject" = $stringMultiDim1x2 },
    @{ "Description" = "Int32å‹3x2å¤šæ¬¡å…ƒé…åˆ—"; "InputObject" = $intMultiDim3x2 }
    @{ "Description" = "Objectå‹3x1å¤šæ¬¡å…ƒé…åˆ—"; "InputObject" = $objectMultiDim3x1 }
)

# Functionã‚’å®Ÿè¡Œ
foreach ($data in $testData) {
    $result = Get-ArrayType -InputObject $data["InputObject"]
    Write-Host "$($data["Description"])ã®çµæœ: $result"
}

# å®Ÿè¡Œçµæœ
å˜ä¸€é…åˆ—ã®çµæœ: 0
å¤šæ®µéšé…åˆ—ã®çµæœ: 1
Stringå‹1x2å¤šæ¬¡å…ƒé…åˆ—ã®çµæœ: 2
Int32å‹3x2å¤šæ¬¡å…ƒé…åˆ—ã®çµæœ: 2
Objectå‹3x1å¤šæ¬¡å…ƒé…åˆ—ã®çµæœ: 2
```

#### PowerShellã®ã‚ã‹ã‚Šã«ãã„æ¯”è¼ƒæ¼”ç®—å­ã‚’è¨˜å·ã§åˆ¤å®šå¯èƒ½ã«ã™ã‚‹Function

2024.6.14 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/5d6510d33198ef

```powershell:è¨˜å·ã®æ¯”è¼ƒæ¼”ç®—å­ã§æ¯”è¼ƒãŒã§ãã‚‹Funciton
<#
.SYNOPSIS
    2ã¤ã®å€¤ã‚’ã€è¨˜å·å½¢å¼ã®æ–‡å­—åˆ—ã§æŒ‡å®šã•ã‚ŒãŸæ¼”ç®—å­ã‚’ä½¿ã£ã¦æ¯”è¼ƒã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€PowerShellã®æ¨™æº–çš„ãªæ¯”è¼ƒæ¼”ç®—å­ï¼ˆ-eq, -ne, -lt ãªã©ï¼‰ã®ä»£ã‚ã‚Šã«ã€ã‚ˆã‚Šä¸€èˆ¬çš„ãªè¨˜å·ï¼ˆ==, !=, < ãªã©ï¼‰ã‚’æ–‡å­—åˆ—ã¨ã—ã¦å—ã‘å–ã£ã¦æ¯”è¼ƒå‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
    Value1 ã¨ Value2 ã®2ã¤ã®å€¤ã‚’ã€Operator ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸæ¼”ç®—å­ã§æ¯”è¼ƒã—ã€ãã®çµæœã¨ã—ã¦ãƒ–ãƒ¼ãƒ«å€¤ï¼ˆ$true ã¾ãŸã¯ $falseï¼‰ã‚’è¿”ã—ã¾ã™ã€‚
    å‹•çš„ã«æ¯”è¼ƒæ¡ä»¶ã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã«ä¾¿åˆ©ã§ã™ã€‚

.PARAMETER Value1
    æ¯”è¼ƒã®å·¦è¾ºã¨ãªã‚‹å€¤ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER Operator
    æ¯”è¼ƒã«ä½¿ç”¨ã™ã‚‹æ¼”ç®—å­ã‚’æ–‡å­—åˆ—ã§æŒ‡å®šã—ã¾ã™ã€‚
    åˆ©ç”¨å¯èƒ½ãªå€¤: '==', '!=', '<', '<=', '>', '>='
    ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER Value2
    æ¯”è¼ƒã®å³è¾ºã¨ãªã‚‹å€¤ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    # 10 ãŒ 20 ã‚ˆã‚Šå°ã•ã„ã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹
    PS C:\> if (Test-Comparison -Value1 10 -Operator '<' -Value2 20) {
    >>     Write-Host "10ã¯20ã‚ˆã‚Šå°ã•ã„ã§ã™ã€‚"
    >> }
    10ã¯20ã‚ˆã‚Šå°ã•ã„ã§ã™ã€‚

    ã“ã®ä¾‹ã§ã¯ã€`Test-Comparison` é–¢æ•°ã‚’ifæ–‡ã®æ¡ä»¶ã¨ã—ã¦ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚
    `10 < 20` ã®æ¯”è¼ƒçµæœãŒ `$true` ã§ã‚ã‚‹ãŸã‚ã€ifãƒ–ãƒ­ãƒƒã‚¯å†…ã®ã‚³ãƒ¼ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

.OUTPUTS
    System.Boolean
    æ¯”è¼ƒã®çµæœã¨ã—ã¦ã€$true ã¾ãŸã¯ $false ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    - æŒ‡å®šã•ã‚ŒãŸæ¼”ç®—å­ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„å ´åˆã€ã“ã®é–¢æ•°ã¯ä¾‹å¤–ã‚’ã‚¹ãƒ­ãƒ¼ã—ã¾ã™ã€‚
    - ã“ã®é–¢æ•°ã¯ã€æ•°å€¤ã ã‘ã§ãªãã€æ–‡å­—åˆ—ã‚„æ—¥ä»˜ãªã©ã€PowerShellã®æ¯”è¼ƒæ¼”ç®—å­ãŒå‡¦ç†ã§ãã‚‹ä»»æ„ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã‚’æ¯”è¼ƒã§ãã¾ã™ã€‚
#>
Function Test-Comparison {
    param(
        [Parameter(Mandatory=$true)][System.Object]$Value1,

        [Parameter(Mandatory=$true)]
        [System.String]$Operator,

        [Parameter(Mandatory=$true)]
        [System.Object]$Value2
    )

    switch ($Operator) {
        # é€šå¸¸ã®æ¯”è¼ƒæ¼”ç®—å­
        '=='            { return $Value1 -eq $Value2 }
        '!='            { return $Value1 -ne $Value2 }
        '<'             { return $Value1 -lt $Value2 }
        '<='            { return $Value1 -le $Value2 }
        '>'             { return $Value1 -gt $Value2 }
        '>='            { return $Value1 -ge $Value2 }
        default         { throw "Invalid operator: $Operator" }
    }
}
```

```powershell:Functionå®Ÿè¡Œ
# ä¾‹: 10 ã¨ 20 ã‚’æ¯”è¼ƒã—ã¦ã€10 ãŒ 20 ã‚ˆã‚Šå°ã•ã„ã‹ã©ã†ã‹ã‚’åˆ¤å®š
$standardValue = 10
$comparedValue = 20

# ãã®ã¾ã¾å®Ÿè¡Œ
Write-Host '--- ãã®ã¾ã¾Functionã‚’å®Ÿè¡Œã—ãŸçµæœ ---'
Test-Comparison -Value1 $standardValue -Operator '<' -Value2 $comparedValue
Write-Host ''

# ifæ–‡ã§å®Ÿè¡Œ
Write-Host '--- ifæ–‡ã§Functionã‚’å®Ÿè¡Œã—ãŸçµæœ ---'
if (Test-Comparison $standardValue '<' $comparedValue) {
    Write-Host "Trueåˆ¤å®šï¼š$standardValue ã¯ $comparedValue ã‚ˆã‚Šå°ã•ã„"
    Write-Host ''
}
else {
    Write-Host "Falseåˆ¤å®šï¼š$comparedValue ã¯ $comparedValue ã‚ˆã‚Šå°ã•ããªã„"
    Write-Host ''
}

# å®Ÿè¡Œçµæœ
--- ãã®ã¾ã¾Functionã‚’å®Ÿè¡Œã—ãŸçµæœ ---
True

--- ifæ–‡ã§Functionã‚’å®Ÿè¡Œã—ãŸçµæœ ---
Trueåˆ¤å®šï¼š10 ã¯ 20 ã‚ˆã‚Šå°ã•ã„

```

#### \[PowerShell\]æŒ‡å®šã—ãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å°å…¥æœ‰ç„¡ã‚’ç¢ºèªã™ã‚‹Function

2024.6.17 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/0a94c0f83bd428

```powershell:ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å°å…¥æœ‰ç„¡ã‚’ç¢ºèª
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸPowerShellãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€ModuleName ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸåå‰ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã€ç¾åœ¨ã®ã‚·ã‚¹ãƒ†ãƒ ã§åˆ©ç”¨å¯èƒ½ã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã¾ã™ã€‚
    å†…éƒ¨ã§ã¯ `Get-Module -ListAvailable` ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒè¦‹ã¤ã‹ã‚Œã° $true ã‚’ã€è¦‹ã¤ã‹ã‚‰ãªã‘ã‚Œã° $false ã‚’è¿”ã—ã¾ã™ã€‚
    ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œå‰ã«ç‰¹å®šã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å­˜åœ¨ã‚’å‰ææ¡ä»¶ã¨ã—ã¦ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚

.PARAMETER ModuleName
    ç¢ºèªã—ãŸã„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®åå‰ã‚’æ–‡å­—åˆ—ã§æŒ‡å®šã—ã¾ã™ã€‚

.EXAMPLE
    # 'ImportExcel'ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹
    PS C:\> $moduleName = 'ImportExcel'
    PS C:\> if (-Not(Test-ModuleInstalled $moduleName)) {
    >>     [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
    >>     # ç®¡ç†è€…æ¨©é™ãŒå¿…è¦
    >>     Install-Module -Name $moduleName -Scope CurrentUser -Force
    >>     Write-Host "$($moduleName) ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã—ãŸã€‚"
    >> } else {
    >>     Write-Host "$($moduleName) ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯æ—¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã™ã€‚"
    >> }

    ã“ã®ä¾‹ã§ã¯ã€`Test-ModuleInstalled` ã‚’ä½¿ã£ã¦ 'ImportExcel' ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚
    é–¢æ•°ãŒ `$false` ã‚’è¿”ã—ãŸå ´åˆï¼ˆæœªå°å…¥ã®å ´åˆï¼‰ã€`Install-Module` ã‚’å®Ÿè¡Œã—ã¦ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
    æ—¢ã«å°å…¥æ¸ˆã¿ã®å ´åˆã¯ã€ãã®æ—¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

.OUTPUTS
    System.Boolean
    ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ `$true` ã‚’ã€ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ `$false` ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    ã“ã®é–¢æ•°ã¯ `Get-Module -ListAvailable` ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€`$env:PSModulePath` ç’°å¢ƒå¤‰æ•°ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ãƒ‘ã‚¹å†…ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ¤œç´¢å¯¾è±¡ã¨ã—ã¾ã™ã€‚
#>
Function Test-ModuleInstalled {
    param (
        [System.String]$ModuleName
    )

    $moduleInstalled = $false

    # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æƒ…å ±ã‚’å–å¾—
    $module = (Get-Module -ListAvailable -Name $ModuleName)
    # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒå°å…¥æ¸ˆã¿ã®å ´åˆ
    if ($null -ne $module) {
        $moduleInstalled = $true
    }
    
    return $moduleInstalled
}
```

#### \[PowerShell\]ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã‚’ç¢ºèªã™ã‚‹Function

2024.6.18 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/b4f4399570000a

```powershell:ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã‚’ç¢ºèªã™ã‚‹Function
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒä»–ã®ãƒ—ãƒ­ã‚»ã‚¹ã«ã‚ˆã£ã¦ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€Path ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒç¾åœ¨ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚
    å†…éƒ¨ã§ã¯ `[System.IO.File]::Open` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã€å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿æ›¸ãã‚¢ã‚¯ã‚»ã‚¹ãƒ¢ãƒ¼ãƒ‰ã§é–‹ãã“ã¨ã‚’è©¦ã¿ã¾ã™ã€‚
    ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£å¸¸ã«é–‹ã‘ãŸå ´åˆã¯ã€ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„ã¨åˆ¤æ–­ã—ã€ã™ãã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‰ã˜ã¦ `$false` ã‚’è¿”ã—ã¾ã™ã€‚
    ãƒ•ã‚¡ã‚¤ãƒ«ãŒä»–ã®ãƒ—ãƒ­ã‚»ã‚¹ã«ã‚ˆã£ã¦ä½¿ç”¨ä¸­ã§é–‹ãã“ã¨ãŒã§ããªã‹ã£ãŸå ´åˆï¼ˆIOException ãŒç™ºç”Ÿã—ãŸå ´åˆï¼‰ã€ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ã¨åˆ¤æ–­ã—ã€`$true` ã‚’è¿”ã—ã¾ã™ã€‚
    ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†ã‚’è¡Œã†å‰ã«ã€å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ“ä½œå¯èƒ½ã‹ã©ã†ã‹ã‚’äº‹å‰ã«ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚

.PARAMETER Path
    ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã‚’ç¢ºèªã—ãŸã„ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æ–‡å­—åˆ—ã§æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    # Excelãƒ•ã‚¡ã‚¤ãƒ« 'D:\Downloads\TestBook.xlsx' ã®ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã‚’ç¢ºèªã™ã‚‹
    PS C:\> $targetPath = 'D:\Downloads\TestBook.xlsx'

    # ã‚·ãƒŠãƒªã‚ª1: Excelã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ã¦ã„ãªã„çŠ¶æ…‹ã§å®Ÿè¡Œ
    PS C:\> Test-FileLocked $targetPath
    False

    # ã‚·ãƒŠãƒªã‚ª2: Excelã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ã¦ã„ã‚‹çŠ¶æ…‹ã§å®Ÿè¡Œ
    PS C:\> Test-FileLocked $targetPath
    True

    ã“ã®ä¾‹ã§ã¯ã€åŒã˜ãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã—ã¦ã€ä»–ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆExcelï¼‰ã§é–‹ã„ã¦ã„ã‚‹å ´åˆã¨é–‹ã„ã¦ã„ãªã„å ´åˆã§é–¢æ•°ã‚’å®Ÿè¡Œã—ã¦ã„ã¾ã™ã€‚
    ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ï¼ˆé–‹ã‹ã‚Œã¦ã„ã‚‹ï¼‰å ´åˆã« `$true` ãŒè¿”ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

.OUTPUTS
    System.Boolean
    ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ `$true` ã‚’ã€ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ `$false` ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    - ã“ã®ãƒã‚§ãƒƒã‚¯ã¯é–¢æ•°ãŒå®Ÿè¡Œã•ã‚ŒãŸç¬é–“ã®çŠ¶æ…‹ã‚’åæ˜ ã™ã‚‹ã‚‚ã®ã§ã™ã€‚ãƒã‚§ãƒƒã‚¯ç›´å¾Œã«ãƒ•ã‚¡ã‚¤ãƒ«ã®çŠ¶æ…‹ãŒå¤‰ã‚ã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚Šã¾ã™ã€‚
    - å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆã€ã“ã®é–¢æ•°ã¯ `Write-Error` ã‚’ä½¿ã£ã¦ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã—ã€å®Ÿè¡Œã‚’åœæ­¢ã—ã¾ã™ã€‚
    - ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ããŸã‚ã®ååˆ†ãªã‚¢ã‚¯ã‚»ã‚¹æ¨©ãŒãªã„å ´åˆã€ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ãªãã¦ã‚‚ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ã¨èª¤ã£ã¦åˆ¤æ–­ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
#>
Function Test-FileLocked {
    param (
        [Parameter(Mandatory=$true)][System.String]$Path
    )

    if (-Not(Test-Path $Path)) {
        Write-Error 'å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚' -ErrorAction Stop
    }

    # ç›¸å¯¾ãƒ‘ã‚¹ã ã¨Openãƒ¡ã‚½ãƒƒãƒ‰ãŒæ­£å¸¸å‹•ä½œã—ãªã„ç‚ºã€çµ¶å¯¾ãƒ‘ã‚¹ã«å¤‰æ›
    $fullPath = (Resolve-Path -Path $Path).Path

    $fileLocked = $false
    try {
        # èª­ã¿å–ã‚Šå°‚ç”¨ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãå‡¦ç†ã‚’å®Ÿè¡Œ
        $fileStream = [System.IO.File]::Open($fullPath, 'Open', 'ReadWrite', 'None')
    }
    catch {
        # ãƒ•ã‚¡ã‚¤ãƒ«ãŒé–‹ã‘ãªã„å ´åˆã€ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã¨åˆ¤æ–­
        $fileLocked = $true
    }
    finally {
        if ($null -ne $fileStream) {
            $fileStream.Close()
        }
    }

    return $fileLocked
}
```

#### PowerShellã§â€œMarkdownãƒ†ãƒ¼ãƒ–ãƒ«â€ã¨â€œExcelãƒ•ã‚¡ã‚¤ãƒ«â€ã‚’ç›¸äº’å¤‰æ›ã™ã‚‹æ–¹æ³•

2025.7.15 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/35f534e04e731c

ã“ã“ã®Functionã§ã¯ã€å…ˆã«ç´¹ä»‹ã—ãŸè‡ªä½œé–¢æ•°ã€Œ`Test-FileLocked`ã€ã‚’å‘¼ã³å‡ºã—ã¦ã„ã¾ã™ã€‚

:::details è£œè¶³æƒ…å ±ï¼šå¼•æ•°ã®é…åˆ—ã®ç¨®é¡ã‚’åˆ¤å®šã™ã‚‹Function

```powershell:ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã‚’ç¢ºèªã™ã‚‹Function
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒä»–ã®ãƒ—ãƒ­ã‚»ã‚¹ã«ã‚ˆã£ã¦ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€Path ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒç¾åœ¨ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚
    å†…éƒ¨ã§ã¯ `[System.IO.File]::Open` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã€å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿æ›¸ãã‚¢ã‚¯ã‚»ã‚¹ãƒ¢ãƒ¼ãƒ‰ã§é–‹ãã“ã¨ã‚’è©¦ã¿ã¾ã™ã€‚
    ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£å¸¸ã«é–‹ã‘ãŸå ´åˆã¯ã€ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„ã¨åˆ¤æ–­ã—ã€ã™ãã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‰ã˜ã¦ `$false` ã‚’è¿”ã—ã¾ã™ã€‚
    ãƒ•ã‚¡ã‚¤ãƒ«ãŒä»–ã®ãƒ—ãƒ­ã‚»ã‚¹ã«ã‚ˆã£ã¦ä½¿ç”¨ä¸­ã§é–‹ãã“ã¨ãŒã§ããªã‹ã£ãŸå ´åˆï¼ˆIOException ãŒç™ºç”Ÿã—ãŸå ´åˆï¼‰ã€ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ã¨åˆ¤æ–­ã—ã€`$true` ã‚’è¿”ã—ã¾ã™ã€‚
    ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†ã‚’è¡Œã†å‰ã«ã€å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ“ä½œå¯èƒ½ã‹ã©ã†ã‹ã‚’äº‹å‰ã«ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚

.PARAMETER Path
    ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã‚’ç¢ºèªã—ãŸã„ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æ–‡å­—åˆ—ã§æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    # Excelãƒ•ã‚¡ã‚¤ãƒ« 'D:\Downloads\TestBook.xlsx' ã®ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã‚’ç¢ºèªã™ã‚‹
    PS C:\> $targetPath = 'D:\Downloads\TestBook.xlsx'

    # ã‚·ãƒŠãƒªã‚ª1: Excelã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ã¦ã„ãªã„çŠ¶æ…‹ã§å®Ÿè¡Œ
    PS C:\> Test-FileLocked $targetPath
    False

    # ã‚·ãƒŠãƒªã‚ª2: Excelã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ã¦ã„ã‚‹çŠ¶æ…‹ã§å®Ÿè¡Œ
    PS C:\> Test-FileLocked $targetPath
    True

    ã“ã®ä¾‹ã§ã¯ã€åŒã˜ãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã—ã¦ã€ä»–ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆExcelï¼‰ã§é–‹ã„ã¦ã„ã‚‹å ´åˆã¨é–‹ã„ã¦ã„ãªã„å ´åˆã§é–¢æ•°ã‚’å®Ÿè¡Œã—ã¦ã„ã¾ã™ã€‚
    ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ï¼ˆé–‹ã‹ã‚Œã¦ã„ã‚‹ï¼‰å ´åˆã« `$true` ãŒè¿”ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

.OUTPUTS
    System.Boolean
    ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ `$true` ã‚’ã€ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ `$false` ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    - ã“ã®ãƒã‚§ãƒƒã‚¯ã¯é–¢æ•°ãŒå®Ÿè¡Œã•ã‚ŒãŸç¬é–“ã®çŠ¶æ…‹ã‚’åæ˜ ã™ã‚‹ã‚‚ã®ã§ã™ã€‚ãƒã‚§ãƒƒã‚¯ç›´å¾Œã«ãƒ•ã‚¡ã‚¤ãƒ«ã®çŠ¶æ…‹ãŒå¤‰ã‚ã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚Šã¾ã™ã€‚
    - å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆã€ã“ã®é–¢æ•°ã¯ `Write-Error` ã‚’ä½¿ã£ã¦ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã—ã€å®Ÿè¡Œã‚’åœæ­¢ã—ã¾ã™ã€‚
    - ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ããŸã‚ã®ååˆ†ãªã‚¢ã‚¯ã‚»ã‚¹æ¨©ãŒãªã„å ´åˆã€ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ãªãã¦ã‚‚ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ã¨èª¤ã£ã¦åˆ¤æ–­ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
#>
Function Test-FileLocked {
    param (
        [Parameter(Mandatory=$true)][System.String]$Path
    )

    if (-Not(Test-Path $Path)) {
        Write-Error 'å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚' -ErrorAction Stop
    }

    # ç›¸å¯¾ãƒ‘ã‚¹ã ã¨Openãƒ¡ã‚½ãƒƒãƒ‰ãŒæ­£å¸¸å‹•ä½œã—ãªã„ç‚ºã€çµ¶å¯¾ãƒ‘ã‚¹ã«å¤‰æ›
    $fullPath = (Resolve-Path -Path $Path).Path

    $fileLocked = $false
    try {
        # èª­ã¿å–ã‚Šå°‚ç”¨ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãå‡¦ç†ã‚’å®Ÿè¡Œ
        $fileStream = [System.IO.File]::Open($fullPath, 'Open', 'ReadWrite', 'None')
    }
    catch {
        # ãƒ•ã‚¡ã‚¤ãƒ«ãŒé–‹ã‘ãªã„å ´åˆã€ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã¨åˆ¤æ–­
        $fileLocked = $true
    }
    finally {
        if ($null -ne $fileStream) {
            $fileStream.Close()
        }
    }

    return $fileLocked
}
```

:::

##### Markdown-Table ã‹ã‚‰ Excelãƒ•ã‚¡ã‚¤ãƒ« ã«å¤‰æ›ã§ãã‚‹PowerShellã®ã‚³ãƒ¼ãƒ‰

```powershell:ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å¤‰æ›ã™ã‚‹å‡¦ç†
<#
.SYNOPSIS
    Markdownãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æŠ½å‡ºã—ã€PowerShellã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é…åˆ—ã«å¤‰æ›ã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€FromMarkdownPath ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸMarkdownãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚
    æ­£è¦è¡¨ç¾ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®Markdownãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆ'|'ã§åŒºåˆ‡ã‚‰ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆï¼‰ã‚’æ¤œå‡ºã—ã€ãã®å†…å®¹ã‚’è§£æã—ã¾ã™ã€‚
    ãƒ†ãƒ¼ãƒ–ãƒ«ã®1è¡Œç›®ã‚’ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åï¼‰ã€3è¡Œç›®ä»¥é™ã‚’ãƒ‡ãƒ¼ã‚¿è¡Œï¼ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å€¤ï¼‰ã¨ã—ã¦æ‰±ã„ã€å„è¡Œã‚’1ã¤ã®PSCustomObjectã«å¤‰æ›ã—ã¾ã™ã€‚
    ã“ã®é–¢æ•°ã¯ã€`Convert-MarkdownTableToExcel` ã‹ã‚‰å†…éƒ¨çš„ã«å‘¼ã³å‡ºã•ã‚Œã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚

.PARAMETER FromMarkdownPath
    ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æŠ½å‡ºã—ãŸã„Markdownãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.OUTPUTS
    System.Management.Automation.PSCustomObject[]
    Markdownãƒ†ãƒ¼ãƒ–ãƒ«ã®å„ãƒ‡ãƒ¼ã‚¿è¡Œã‚’è¡¨ã™PSCustomObjectã®é…åˆ—ã‚’è¿”ã—ã¾ã™ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ç©ºã®é…åˆ—ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯Markdownãƒ†ãƒ¼ãƒ–ãƒ«ã®è§£æã®ã¿ã‚’è¡Œã„ã€Excelãƒ•ã‚¡ã‚¤ãƒ«ã®æ“ä½œã¯è¡Œã„ã¾ã›ã‚“ã€‚
    - ãƒ†ãƒ¼ãƒ–ãƒ«ã®2è¡Œç›®ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼ã¨ãƒ‡ãƒ¼ã‚¿ã®åŒºåˆ‡ã‚Šè¡Œ `|---|---|`ï¼‰ã¯å‡¦ç†ã§ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã™ã€‚
    - ãƒ‡ãƒ¼ã‚¿è¡Œã®åˆ—æ•°ãŒãƒ˜ãƒƒãƒ€ãƒ¼ã®åˆ—æ•°ã¨ä¸€è‡´ã—ãªã„å ´åˆã€ãã®è¡Œã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
#>
# ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å¤‰æ›ã™ã‚‹å‡¦ç†
Function Get-ExcelTable {
    param (
        [Parameter(Mandatory=$true)]
        [string]$FromMarkdownPath
    )

    # å†…å®¹ã‚’èª­ã¿å–ã‚‹
    $inputContents = (Get-Content $FromMarkdownPath -Raw)

    # è¡¨ã®é–‹å§‹ã¨çµ‚äº†ã‚’æ¤œå‡ºã™ã‚‹æ­£è¦è¡¨ç¾
    $tableRegex = '(?smi)^\|.*(?<!\\)\|.*$'
    $headerSplitRegex = '^\|?(.*?)(?<!\\)\|$'
    $rowSplitRegex = '^\|(.+?)(?<!\\)\|$'

    # è¡¨ã®å†…å®¹ã‚’æŠ½å‡ºã—ã¾ã™
    $excelTables = @()
    [regex]::Matches($inputContents, $tableRegex) | ForEach-Object {
        $tableText = $_.Value

        # ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è§£æã—ã¾ã™
        $rowCount = 0
        $rows = @()

        $tableText -split "`n" | ForEach-Object {
            if ($rowCount -eq 0) {
                $headers = [regex]::Split($_, '(?<!\\)\|')
                $headers = $headers[1..($headers.Length-2)] # æœ€åˆã¨æœ€å¾Œã®ç©ºã®è¦ç´ ã‚’å‰Šé™¤
                $rowCount += 1
            }
            elseif ($rowCount -eq 1) {
                # ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åŒºåˆ‡ã‚Šè¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—
                $rowCount += 1
            }
            else {
                $row = [regex]::Split($_, '(?<!\\)\|')
                $row = $row[1..($row.Length-2)] # æœ€åˆã¨æœ€å¾Œã®ç©ºã®è¦ç´ ã‚’å‰Šé™¤

                # ãƒ˜ãƒƒãƒ€ãƒ¼é …ç›®æ•° ã¨ ãƒ‡ãƒ¼ã‚¿é …ç›®æ•°ã‚’æ¯”è¼ƒ
                if ($row.Count -eq $headers.Count) {
                    $rows += ,$row
                }
                else {
                    # ç©ºè¡Œä»¥å¤–
                    if (-Not([System.String]::IsNullOrEmpty($_.Trim()))) {
                        Write-Host "ãƒ˜ãƒƒãƒ€ãƒ¼ã®é …ç›®æ•°ã¨åˆã‚ãªã‹ã£ãŸç‚ºã€ä¸‹è¨˜ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã—ãŸã€‚[ãƒ˜ãƒƒãƒ€ãƒ¼é …ç›®æ•°: $($headers.Count), ãƒ‡ãƒ¼ã‚¿é …ç›®æ•°: $($row.Count)]"
                        Write-Host '```:markdown'
                        Write-Host "$_"
                        Write-Host '```'
                    }
                }
            }
        }

        # å„è¡Œã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã—ã¾ã™
        $rows | ForEach-Object {
            $rowObject = New-Object psobject
            for ($i = 0; $i -lt $headers.Count; $i++) {
                $rowObject | Add-Member -MemberType NoteProperty -Name $headers[$i].Trim() -Value $_[$i].Trim()
            }
            $excelTables += ,$rowObject
        }
    }

    return $excelTables
}
```

```powershell:
<#
.SYNOPSIS
    Markdownãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€Excelãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€Markdownãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã—ã€ãã‚Œã‚’Excelãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›ã—ã¦ä¿å­˜ã™ã‚‹ä¸€é€£ã®å‡¦ç†ã‚’è‡ªå‹•åŒ–ã—ã¾ã™ã€‚
    ã¾ãšå†…éƒ¨çš„ã« `Get-ExcelTable` é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦Markdownãƒ†ãƒ¼ãƒ–ãƒ«ã‚’PowerShellã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã—ã¾ã™ã€‚
    ãã®å¾Œã€`ImportExcel` ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã® `Export-Excel` ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’Excelãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã—ã¾ã™ã€‚
    å‡ºåŠ›å…ˆã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ—¢ã«å­˜åœ¨ã™ã‚‹å ´åˆã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„ã‹ã‚’ç¢ºèªã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ä¸Šæ›¸ãä¿å­˜ã®è¨±å¯ã‚’æ±‚ã‚ã¾ã™ã€‚

.PARAMETER FromMarkdownPath
    å…¥åŠ›å…ƒã¨ãªã‚‹Markdownãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER ToExcelPath
    å‡ºåŠ›å…ˆã¨ãªã‚‹Excelãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    PS C:\> $markdownPath = 'D:\Downloads\inputMarkdownTable.md'
    PS C:\> $excelPath = 'D:\Downloads\outputExcel.xlsx'
    PS C:\> Convert-MarkdownTableToExcel $markdownPath $excelPath

    # å®Ÿè¡Œã™ã‚‹ã¨ã€inputMarkdownTable.md å†…ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãŒ outputExcel.xlsx ã¨ã—ã¦ä¿å­˜ã•ã‚Œã¾ã™ã€‚
    # outputExcel.xlsx ãŒæ—¢ã«å­˜åœ¨ã™ã‚‹å ´åˆã¯ã€"ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸Šæ›¸ãã—ã¾ã™ã‹ï¼Ÿ (Yes/No)" ã¨ã„ã†ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

.OUTPUTS
    ãªã—
    ã“ã®é–¢æ•°ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®æ›¸ãè¾¼ã¿ã¨ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã¸ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã‚’ä¸»ãªå‹•ä½œã¨ã™ã‚‹ãŸã‚ã€æˆåŠŸã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã—ã¾ã›ã‚“ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯ `ImportExcel` ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚`Export-Excel` ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆãŒåˆ©ç”¨ã§ããªã„ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚
    - ã“ã®é–¢æ•°ã¯ã€åŒã˜ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã« `Get-ExcelTable` é–¢æ•°ã¨ `Test-FileLocked` é–¢æ•°ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
    - ä¸Šæ›¸ãç¢ºèªã®éš›ã«ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ› (`Read-Host`) ãŒå¿…è¦ã«ãªã‚‹ãŸã‚ã€å®Œå…¨è‡ªå‹•åŒ–ã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã®ä½¿ç”¨ã«ã¯æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚
    - `-Show` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã‚ˆã‚Šã€å‡¦ç†å®Œäº†å¾Œã«ExcelãŒè‡ªå‹•çš„ã«èµ·å‹•ã—ã¾ã™ã€‚
#>
# Markdownå½¢å¼ã®ãƒ†ãƒ¼ãƒ–ãƒ« ã‹ã‚‰ Excelãƒ•ã‚¡ã‚¤ãƒ« ã«å¤‰æ›ã™ã‚‹Funciton
Function Convert-MarkdownTableToExcel {
    param (
        [Parameter(Mandatory=$true)]
        [System.String]$FromMarkdownPath,
        [Parameter(Mandatory=$true)]
        [System.String]$ToExcelPath

    )

    # Markdownå½¢å¼ã®ãƒ†ãƒ¼ãƒ–ãƒ« ã‚’ Excel
    $excelTables = (Get-ExcelTable -FromMarkdownPath $FromMarkdownPath)

    if ($null -eq $excelTables) {
        Write-Error 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚Šã¾ã—ãŸãŒã€ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚'
        return
    }

    if (Test-Path -Path $ToExcelPath) {
        # ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ã‹ãƒ†ã‚¹ãƒˆã—ã¾ã™
        if (Test-FileLocked -Path $ToExcelPath) {
            Write-Warning 'Excelãƒ•ã‚¡ã‚¤ãƒ«ãŒé–‹ã‹ã‚Œã¦ã„ã¾ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‰ã˜ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚'
            return
        }

        # å…¥åŠ›ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        $userInput = Read-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸Šæ›¸ãã—ã¾ã™ã‹ï¼Ÿ (Yes/No)'
        $yesPatterns = '[Yy][Ee][Ss]|[Yy]'
        $noPatterns = '[Nn][Oo]|[Nn]'
        $isYes = $false
        # è©¦è¡Œå›æ•°: 3å›
        $maxCount = 2
        for ($i = 0; $i -lt $maxCount; $i++) {
            if ($userInput -match $yesPatterns) {
                $isYes = $true
                break
            }
            else {
                Write-Host 'ä¸Šæ›¸ãä¿å­˜ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸã€‚'
                return
            }
        }
        if (-Not ($isYes)) {
            Write-Warning 'è©¦è¡Œå›æ•°ã‚’è¶…éã—ã¾ã—ãŸã€‚å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã™ã€‚'
            return
        }

        # ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€Œã¯ã„ã€ã‚’é¸æŠã—ãŸå ´åˆã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸Šæ›¸ãä¿å­˜ã—ã¾ã™
        try {
            $excelTables | Export-Excel -Path $toExcelPath -Show
            Write-Host 'ä¸Šæ›¸ãä¿å­˜ã—ã¾ã—ãŸã€‚'
        }
        catch {
            Write-Error 'ä¸Šæ›¸ãä¿å­˜ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚'
        }
    }
    else {
        # æ–°è¦ä¿å­˜
        try {
            $excelTables | Export-Excel -Path $toExcelPath -Show
            Write-Host "æ–°è¦ä¿å­˜ã—ã¾ã—ãŸã€‚"
        }
        catch {
            Write-Error 'æ–°è¦ä¿å­˜ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚'
        }
    }
}
```

```powershell:Functionå®Ÿè¡Œ
# Functionã€ŒConvert-MarkdownTableToExcelã€ã‚’å®Ÿè¡Œ
# å®Ÿè¡Œ
$markdownPath = 'D:\Downloads\inputMarkdownTable.md'
$excelPath = 'D:\Downloads\outputExcel.xlsx'
Convert-MarkdownTableToExcel $markdownPath $excelPath
```

##### Excelãƒ•ã‚¡ã‚¤ãƒ« ã‹ã‚‰ Markdown-Table ã«å¤‰æ›ã§ãã‚‹PowerShellã®ã‚³ãƒ¼ãƒ‰

```powershell:Markdownãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã®ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰PowerShellã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é…åˆ—ã«å¤‰æ›
<#
.SYNOPSIS
    Markdownãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æŠ½å‡ºã—ã€PowerShellã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é…åˆ—ã«å¤‰æ›ã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€FromMarkdownPath ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸMarkdownãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚
    æ­£è¦è¡¨ç¾ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®Markdownãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆ'|'ã§åŒºåˆ‡ã‚‰ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆï¼‰ã‚’æ¤œå‡ºã—ã€ãã®å†…å®¹ã‚’è§£æã—ã¾ã™ã€‚
    ãƒ†ãƒ¼ãƒ–ãƒ«ã®1è¡Œç›®ã‚’ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åï¼‰ã€3è¡Œç›®ä»¥é™ã‚’ãƒ‡ãƒ¼ã‚¿è¡Œï¼ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å€¤ï¼‰ã¨ã—ã¦æ‰±ã„ã€å„è¡Œã‚’1ã¤ã®PSCustomObjectã«å¤‰æ›ã—ã¾ã™ã€‚
    ã“ã®é–¢æ•°ã¯ã€`Convert-MarkdownTableToExcel` ã‹ã‚‰å†…éƒ¨çš„ã«å‘¼ã³å‡ºã•ã‚Œã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚

.PARAMETER FromMarkdownPath
    ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æŠ½å‡ºã—ãŸã„Markdownãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.OUTPUTS
    System.Management.Automation.PSCustomObject[]
    Markdownãƒ†ãƒ¼ãƒ–ãƒ«ã®å„ãƒ‡ãƒ¼ã‚¿è¡Œã‚’è¡¨ã™PSCustomObjectã®é…åˆ—ã‚’è¿”ã—ã¾ã™ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ç©ºã®é…åˆ—ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯Markdownãƒ†ãƒ¼ãƒ–ãƒ«ã®è§£æã®ã¿ã‚’è¡Œã„ã€Excelãƒ•ã‚¡ã‚¤ãƒ«ã®æ“ä½œã¯è¡Œã„ã¾ã›ã‚“ã€‚
    - ãƒ†ãƒ¼ãƒ–ãƒ«ã®2è¡Œç›®ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼ã¨ãƒ‡ãƒ¼ã‚¿ã®åŒºåˆ‡ã‚Šè¡Œ `|---|---|`ï¼‰ã¯å‡¦ç†ã§ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã™ã€‚
    - ãƒ‡ãƒ¼ã‚¿è¡Œã®åˆ—æ•°ãŒãƒ˜ãƒƒãƒ€ãƒ¼ã®åˆ—æ•°ã¨ä¸€è‡´ã—ãªã„å ´åˆã€ãã®è¡Œã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
#>
# ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å¤‰æ›ã™ã‚‹å‡¦ç†
Function Get-ExcelTable {
    param (
        [Parameter(Mandatory=$true)]
        [string]$FromMarkdownPath
    )

    # å†…å®¹ã‚’èª­ã¿å–ã‚‹
    $inputContents = (Get-Content $FromMarkdownPath -Raw)

    # è¡¨ã®é–‹å§‹ã¨çµ‚äº†ã‚’æ¤œå‡ºã™ã‚‹æ­£è¦è¡¨ç¾
    $tableRegex = '(?smi)^\|.*(?<!\\)\|.*$'
    $headerSplitRegex = '^\|?(.*?)(?<!\\)\|$'
    $rowSplitRegex = '^\|(.+?)(?<!\\)\|$'

    # è¡¨ã®å†…å®¹ã‚’æŠ½å‡ºã—ã¾ã™
    $excelTables = @()
    [regex]::Matches($inputContents, $tableRegex) | ForEach-Object {
        $tableText = $_.Value

        # ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è§£æã—ã¾ã™
        $rowCount = 0
        $rows = @()

        $tableText -split "`n" | ForEach-Object {
            if ($rowCount -eq 0) {
                $headers = [regex]::Split($_, '(?<!\\)\|')
                $headers = $headers[1..($headers.Length-2)] # æœ€åˆã¨æœ€å¾Œã®ç©ºã®è¦ç´ ã‚’å‰Šé™¤
                $rowCount += 1
            }
            elseif ($rowCount -eq 1) {
                # ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åŒºåˆ‡ã‚Šè¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—
                $rowCount += 1
            }
            else {
                $row = [regex]::Split($_, '(?<!\\)\|')
                $row = $row[1..($row.Length-2)] # æœ€åˆã¨æœ€å¾Œã®ç©ºã®è¦ç´ ã‚’å‰Šé™¤

                # ãƒ˜ãƒƒãƒ€ãƒ¼é …ç›®æ•° ã¨ ãƒ‡ãƒ¼ã‚¿é …ç›®æ•°ã‚’æ¯”è¼ƒ
                if ($row.Count -eq $headers.Count) {
                    $rows += ,$row
                }
                else {
                    # ç©ºè¡Œä»¥å¤–
                    if (-Not([System.String]::IsNullOrEmpty($_.Trim()))) {
                        Write-Host "ãƒ˜ãƒƒãƒ€ãƒ¼ã®é …ç›®æ•°ã¨åˆã‚ãªã‹ã£ãŸç‚ºã€ä¸‹è¨˜ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã—ãŸã€‚[ãƒ˜ãƒƒãƒ€ãƒ¼é …ç›®æ•°: $($headers.Count), ãƒ‡ãƒ¼ã‚¿é …ç›®æ•°: $($row.Count)]"
                        Write-Host '```:markdown'
                        Write-Host "$_"
                        Write-Host '```'
                    }
                }
            }
        }

        # å„è¡Œã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã—ã¾ã™
        $rows | ForEach-Object {
            $rowObject = New-Object psobject
            for ($i = 0; $i -lt $headers.Count; $i++) {
                $rowObject | Add-Member -MemberType NoteProperty -Name $headers[$i].Trim() -Value $_[$i].Trim()
            }
            $excelTables += ,$rowObject
        }
    }

    return $excelTables
}
```

```powershell:Excelãƒ•ã‚¡ã‚¤ãƒ« ã‹ã‚‰ Markdownå½¢å¼ã®ãƒ†ãƒ¼ãƒ–ãƒ« ã«å¤‰æ›ã™ã‚‹Function
<#
.SYNOPSIS
    Markdownãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€Excelãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€Markdownãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã—ã€ãã‚Œã‚’Excelãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›ã—ã¦ä¿å­˜ã™ã‚‹ä¸€é€£ã®å‡¦ç†ã‚’è‡ªå‹•åŒ–ã—ã¾ã™ã€‚
    ã¾ãšå†…éƒ¨çš„ã« `Get-ExcelTable` é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦Markdownãƒ†ãƒ¼ãƒ–ãƒ«ã‚’PowerShellã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã—ã¾ã™ã€‚
    ãã®å¾Œã€`ImportExcel` ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã® `Export-Excel` ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’Excelãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã—ã¾ã™ã€‚
    å‡ºåŠ›å…ˆã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ—¢ã«å­˜åœ¨ã™ã‚‹å ´åˆã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„ã‹ã‚’ç¢ºèªã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ä¸Šæ›¸ãä¿å­˜ã®è¨±å¯ã‚’æ±‚ã‚ã¾ã™ã€‚

.PARAMETER FromMarkdownPath
    å…¥åŠ›å…ƒã¨ãªã‚‹Markdownãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER ToExcelPath
    å‡ºåŠ›å…ˆã¨ãªã‚‹Excelãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    PS C:\> $markdownPath = 'D:\Downloads\inputMarkdownTable.md'
    PS C:\> $excelPath = 'D:\Downloads\outputExcel.xlsx'
    PS C:\> Convert-MarkdownTableToExcel $markdownPath $excelPath

    # å®Ÿè¡Œã™ã‚‹ã¨ã€inputMarkdownTable.md å†…ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãŒ outputExcel.xlsx ã¨ã—ã¦ä¿å­˜ã•ã‚Œã¾ã™ã€‚
    # outputExcel.xlsx ãŒæ—¢ã«å­˜åœ¨ã™ã‚‹å ´åˆã¯ã€"ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸Šæ›¸ãã—ã¾ã™ã‹ï¼Ÿ (Yes/No)" ã¨ã„ã†ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

.OUTPUTS
    ãªã—
    ã“ã®é–¢æ•°ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®æ›¸ãè¾¼ã¿ã¨ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã¸ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã‚’ä¸»ãªå‹•ä½œã¨ã™ã‚‹ãŸã‚ã€æˆåŠŸã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã—ã¾ã›ã‚“ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯ `ImportExcel` ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚`Export-Excel` ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆãŒåˆ©ç”¨ã§ããªã„ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚
    - ã“ã®é–¢æ•°ã¯ã€åŒã˜ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã« `Get-ExcelTable` é–¢æ•°ã¨ `Test-FileLocked` é–¢æ•°ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
    - ä¸Šæ›¸ãç¢ºèªã®éš›ã«ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ› (`Read-Host`) ãŒå¿…è¦ã«ãªã‚‹ãŸã‚ã€å®Œå…¨è‡ªå‹•åŒ–ã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã®ä½¿ç”¨ã«ã¯æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚
    - `-Show` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã‚ˆã‚Šã€å‡¦ç†å®Œäº†å¾Œã«ExcelãŒè‡ªå‹•çš„ã«èµ·å‹•ã—ã¾ã™ã€‚
#>
# Markdownå½¢å¼ã®ãƒ†ãƒ¼ãƒ–ãƒ« ã‹ã‚‰ Excelãƒ•ã‚¡ã‚¤ãƒ« ã«å¤‰æ›ã™ã‚‹Funciton
Function Convert-MarkdownTableToExcel {
    param (
        [Parameter(Mandatory=$true)]
        [System.String]$FromMarkdownPath,
        [Parameter(Mandatory=$true)]
        [System.String]$ToExcelPath

    )

    # Markdownå½¢å¼ã®ãƒ†ãƒ¼ãƒ–ãƒ« ã‚’ Excel
    $excelTables = (Get-ExcelTable -FromMarkdownPath $FromMarkdownPath)

    if ($null -eq $excelTables) {
        Write-Error 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚Šã¾ã—ãŸãŒã€ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚'
        return
    }

    if (Test-Path -Path $ToExcelPath) {
        # ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ã‹ãƒ†ã‚¹ãƒˆã—ã¾ã™
        if (Test-FileLocked -Path $ToExcelPath) {
            Write-Warning 'Excelãƒ•ã‚¡ã‚¤ãƒ«ãŒé–‹ã‹ã‚Œã¦ã„ã¾ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‰ã˜ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚'
            return
        }

        # å…¥åŠ›ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        $userInput = Read-Host 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸Šæ›¸ãã—ã¾ã™ã‹ï¼Ÿ (Yes/No)'
        $yesPatterns = '[Yy][Ee][Ss]|[Yy]'
        $noPatterns = '[Nn][Oo]|[Nn]'
        $isYes = $false
        # è©¦è¡Œå›æ•°: 3å›
        $maxCount = 2
        for ($i = 0; $i -lt $maxCount; $i++) {
            if ($userInput -match $yesPatterns) {
                $isYes = $true
                break
            }
            else {
                Write-Host 'ä¸Šæ›¸ãä¿å­˜ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸã€‚'
                return
            }
        }
        if (-Not ($isYes)) {
            Write-Warning 'è©¦è¡Œå›æ•°ã‚’è¶…éã—ã¾ã—ãŸã€‚å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã™ã€‚'
            return
        }

        # ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€Œã¯ã„ã€ã‚’é¸æŠã—ãŸå ´åˆã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸Šæ›¸ãä¿å­˜ã—ã¾ã™
        try {
            $excelTables | Export-Excel -Path $toExcelPath -Show
            Write-Host 'ä¸Šæ›¸ãä¿å­˜ã—ã¾ã—ãŸã€‚'
        }
        catch {
            Write-Error 'ä¸Šæ›¸ãä¿å­˜ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚'
        }
    }
    else {
        # æ–°è¦ä¿å­˜
        try {
            $excelTables | Export-Excel -Path $toExcelPath -Show
            Write-Host "æ–°è¦ä¿å­˜ã—ã¾ã—ãŸã€‚"
        }
        catch {
            Write-Error 'æ–°è¦ä¿å­˜ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚'
        }
    }
}
```

```powershell
# Functionã€ŒConvert-ExcelToMarkdownTableã€ã‚’å®Ÿè¡Œ
# å®Ÿè¡Œ
$excelPath = 'D:\Downloads\inputExcel.xlsx'
$markdownPath = 'D:\Downloads\outputMarkdownTable.md'
Convert-ExcelToMarkdownTable $excelPath $markdownPath
```

#### PowerShellã§2ã¤ã®é…åˆ—åŒå£«ã®è¦ç´ æ•°ãŒåŒã˜ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹Function

2025.7.15 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/c1aeace31dbf48

ã“ã“ã®Functionã§ã¯ã€å…ˆã«ç´¹ä»‹ã—ãŸè‡ªä½œé–¢æ•°ã€Œ`Get-ArrayType`ã€ã‚’å‘¼ã³å‡ºã—ã¦ã„ã¾ã™ã€‚

:::details è£œè¶³æƒ…å ±ï¼šå¼•æ•°ã®é…åˆ—ã®ç¨®é¡ã‚’åˆ¤å®šã™ã‚‹Function

```powershell:å¼•æ•°ã®é…åˆ—ã®ç¨®é¡ã‚’åˆ¤å®šã™ã‚‹Function
<#
.SYNOPSIS
    å¼•æ•°ã§æ¸¡ã•ã‚ŒãŸå¤‰æ•°ãŒã€å˜ä¸€é…åˆ—ã€å¤šæ®µéšé…åˆ—ï¼ˆã‚¸ãƒ£ã‚°é…åˆ—ï¼‰ã€å¤šæ¬¡å…ƒé…åˆ—ã®ã„ãšã‚Œã§ã‚ã‚‹ã‹ã‚’åˆ¤å®šã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€InputObject ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸå¤‰æ•°ãŒã©ã®ã‚ˆã†ãªç¨®é¡ã®é…åˆ—ã‹ã‚’åˆ¤å®šã—ã€çµæœã‚’æ•´æ•°ã‚³ãƒ¼ãƒ‰ã§è¿”ã—ã¾ã™ã€‚
    - å˜ä¸€é…åˆ— (ä¾‹: @(1, 2, 3))
    - å¤šæ®µéšé…åˆ—ï¼ˆã‚¸ãƒ£ã‚°é…åˆ—ï¼‰ (ä¾‹: @(@(1), @(2, 3)))
    - å¤šæ¬¡å…ƒé…åˆ— (ä¾‹: New-Object 'int[,]' 2,2)

    å…¥åŠ›ãŒé…åˆ—ã§ã¯ãªã„ã€ã¾ãŸã¯$nullã®å ´åˆã¯ã€é…åˆ—ã§ã¯ãªã„ã“ã¨ã‚’ç¤ºã™ã‚³ãƒ¼ãƒ‰ã‚’è¿”ã—ã¾ã™ã€‚
    ã“ã®é–¢æ•°ã¯ã€é…åˆ—ã®æ§‹é€ ã«å¿œã˜ã¦ç•°ãªã‚‹å‡¦ç†ã‚’è¡Œã„ãŸã„å ´åˆã«ä¾¿åˆ©ã§ã™ã€‚

.PARAMETER InputObject
    åˆ¤å®šå¯¾è±¡ã®å¤‰æ•°ã‚’æŒ‡å®šã—ã¾ã™ã€‚

.EXAMPLE
    # æ§˜ã€…ãªç¨®é¡ã®é…åˆ—ã‚’æº–å‚™
    $singleArray = @('ã‚', 'ã„', 'ã†')
    $multiLevel = @(@(1, 2), @(3, 4))
    $multiDim = New-Object 'System.String[,]' 2,2

    # ãã‚Œãã‚Œã®é…åˆ—ã«å¯¾ã—ã¦é–¢æ•°ã‚’å®Ÿè¡Œ
    PS C:\> Get-ArrayType $singleArray
    0
    PS C:\> Get-ArrayType $multiLevel
    1
    PS C:\> Get-ArrayType $multiDim
    2
    PS C:\> Get-ArrayType "This is not an array"
    -1

    ã“ã®ä¾‹ã§ã¯ã€3ã¤ã®ç•°ãªã‚‹ã‚¿ã‚¤ãƒ—ã®é…åˆ—ã¨éé…åˆ—ãƒ‡ãƒ¼ã‚¿ã‚’æº–å‚™ã—ã€ãã‚Œãã‚Œã«å¯¾ã—ã¦é–¢æ•°ã‚’å®Ÿè¡Œã—ã¦è¿”ã•ã‚Œã‚‹æ•´æ•°ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚
    0ã¯å˜ä¸€é…åˆ—ã€1ã¯å¤šæ®µéšé…åˆ—ã€2ã¯å¤šæ¬¡å…ƒé…åˆ—ã€-1ã¯éé…åˆ—ã‚’ç¤ºã—ã¾ã™ã€‚

.OUTPUTS
    System.Int32
    åˆ¤å®šçµæœã¨ã—ã¦ã€ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã®æ•´æ•°å€¤ã‚’è¿”ã—ã¾ã™ã€‚
    - -1: é…åˆ—ã§ã¯ãªã„ã€ã¾ãŸã¯$null (OtherTypes)
    -  0: å˜ä¸€é…åˆ— (SingleArray)
    -  1: å¤šæ®µéšé…åˆ—ï¼ˆã‚¸ãƒ£ã‚°é…åˆ—ï¼‰ (MultiLevel)
    -  2: å¤šæ¬¡å…ƒé…åˆ— (MultiDimensional)

.NOTES
    - PowerShellã§ä¸€èˆ¬çš„ã« `@(...)` ã‚’å…¥ã‚Œå­ã«ã—ã¦ä½œæˆã•ã‚Œã‚‹ã€Œã‚¸ãƒ£ã‚°é…åˆ—ï¼ˆå¤šæ®µéšé…åˆ—ï¼‰ã€ã¨ã€`New-Object 'Type[,]'` ãªã©ã§ä½œæˆã•ã‚Œã‚‹çœŸã®ã€Œå¤šæ¬¡å…ƒé…åˆ—ã€ã‚’åŒºåˆ¥ã—ã¾ã™ã€‚
    - å¤šæ®µéšé…åˆ—ã®åˆ¤å®šã¯ã€å¤šæ¬¡å…ƒé…åˆ—ã®åˆ¤å®šï¼ˆRankãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ç¢ºèªï¼‰ã‚ˆã‚Šã‚‚å„ªå…ˆã—ã¦è¡Œã‚ã‚Œã¾ã™ã€‚
#>
Function Get-ArrayType {
    param(
        $InputObject
    )
    
    [System.Collections.Hashtable]$arrayTypes = @{
        "OtherTypes" = -1
        "SingleArray" = 0
        "MultiLevel" = 1
        "MultiDimensional" = 2
    }

    # ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆ
    if ($null -eq $InputObject) {
        return $arrayTypes["OtherTypes"]
    }

    # ä¸€ç•ªå¤–æ ãŒé…åˆ—ã§ã¯ãªã„å ´åˆ
    if ($InputObject -isnot [System.Array]) {
        return $arrayTypes["OtherTypes"]
    }

    # ã‚¸ãƒ£ã‚°é…åˆ—ï¼ˆå¤šæ®µéšé…åˆ—ï¼‰ã‹åˆ¤å®š
    $isMultiLevel = $false
    foreach ($element in $InputObject) {
        if ($element -is [System.Array]) {
            # é…åˆ—ã®ä¸­ã‚‚é…åˆ—ã§å¤šæ®µé…åˆ—
            $isMultiLevel = $true
            break
        }
    }
    if ($isMultiLevel) {
        return $arrayTypes["MultiLevel"]
    }    
    
    # å¤šæ¬¡å…ƒé…åˆ—ã‹åˆ¤å®š
    if ($InputObject.Rank -ge 2) {
        # 2æ¬¡å…ƒä»¥ä¸Šã®å ´åˆ
        return $arrayTypes["MultiDimensional"]
    }
    else {
        # 1æ¬¡å…ƒã®å ´åˆ
        return $arrayTypes["SingleArray"]
    }
}
```

:::

##### 2ã¤ã®å¤šæ¬¡å…ƒé…åˆ—ã®è¦ç´ æ•°ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚³ãƒ¼ãƒ‰

```powershell
<#
.SYNOPSIS
    2ã¤ã®å¤šæ¬¡å…ƒé…åˆ—ã®æ§‹é€ ï¼ˆæ¬¡å…ƒæ•°ã¨å„æ¬¡å…ƒã®è¦ç´ æ•°ï¼‰ãŒåŒä¸€ã§ã‚ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€Array1 ã¨ Array2 ã§æŒ‡å®šã•ã‚ŒãŸ2ã¤ã®å¤‰æ•°ãŒã€ä¸¡æ–¹ã¨ã‚‚å¤šæ¬¡å…ƒé…åˆ—ã§ã‚ã‚Šã€ã‹ã¤ãã®æ§‹é€ ãŒå®Œå…¨ã«ä¸€è‡´ã™ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã¾ã™ã€‚
    åˆ¤å®šã¯ä»¥ä¸‹ã®ã‚¹ãƒ†ãƒƒãƒ—ã§è¡Œã‚ã‚Œã¾ã™ã€‚
    1. å†…éƒ¨ã§ `Get-ArrayType` é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã€ä¸¡æ–¹ã®å¼•æ•°ãŒå¤šæ¬¡å…ƒé…åˆ—ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚
    2. `.Rank` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æ¯”è¼ƒã—ã€ä¸¡æ–¹ã®é…åˆ—ã®æ¬¡å…ƒæ•°ãŒåŒã˜ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚
    3. `.GetLength(dimensionIndex)` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã€å„æ¬¡å…ƒã®è¦ç´ æ•°ãŒã™ã¹ã¦åŒã˜ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚
    
    ã™ã¹ã¦ã®æ¡ä»¶ã‚’æº€ãŸã™å ´åˆã«ã®ã¿ `$true` ã‚’è¿”ã—ã¾ã™ã€‚é…åˆ—ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹è¦ç´ ã®å€¤è‡ªä½“ã¯æ¯”è¼ƒã—ã¾ã›ã‚“ã€‚

.PARAMETER Array1
    æ¯”è¼ƒå…ƒã®å¤šæ¬¡å…ƒé…åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER Array2
    æ¯”è¼ƒå…ˆã®å¤šæ¬¡å…ƒé…åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    # æ¯”è¼ƒç”¨ã®å¤šæ¬¡å…ƒé…åˆ—ã‚’æº–å‚™
    $arrayA = New-Object 'int[,]' 2, 3  # 2x3 ã®é…åˆ—
    $arrayB = New-Object 'int[,]' 2, 3  # åŒã˜ã 2x3 ã®é…åˆ—
    $arrayC = New-Object 'int[,]' 3, 2  # æ§‹é€ ãŒç•°ãªã‚‹ 3x2 ã®é…åˆ—

    # ä¾‹ 1: æ§‹é€ ãŒå®Œå…¨ã«ä¸€è‡´ã™ã‚‹å ´åˆ
    PS C:\> Test-MultiDimensionalArrayEquality -Array1 $arrayA -Array2 $arrayB
    True

    # ä¾‹ 2: æ§‹é€ ãŒç•°ãªã‚‹å ´åˆï¼ˆæ¬¡å…ƒã”ã¨ã®è¦ç´ æ•°ãŒé•ã†ï¼‰
    PS C:\> Test-MultiDimensionalArrayEquality -Array1 $arrayA -Array2 $arrayC
    False

    # ä¾‹ 3: ç‰‡æ–¹ãŒå¤šæ¬¡å…ƒé…åˆ—ã§ã¯ãªã„å ´åˆ
    PS C:\> $singleArray = @(1, 2, 3)
    PS C:\> Test-MultiDimensionalArrayEquality -Array1 $arrayA -Array2 $singleArray
    è­¦å‘Š: å¼•æ•°ã®ã€ŒArray2ã€ãŒå¤šæ¬¡å…ƒé…åˆ—ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚[é…åˆ—ã®åˆ¤å®šçµæœ: 0]
    False

.OUTPUTS
    System.Boolean
    2ã¤ã®å¤šæ¬¡å…ƒé…åˆ—ã®æ§‹é€ ãŒå®Œå…¨ã«ä¸€è‡´ã™ã‚‹å ´åˆã¯ `$true` ã‚’ã€ãã†ã§ãªã„å ´åˆã¯ `$false` ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯ã€`Get-ArrayType` ã¨ã„ã†åˆ¥ã®ã‚«ã‚¹ã‚¿ãƒ é–¢æ•°ãŒåŒã˜ã‚¹ã‚³ãƒ¼ãƒ—å†…ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚
    - ã“ã®é–¢æ•°ã¯é…åˆ—ã®ã€Œæ§‹é€ ã€ã®ã¿ã‚’æ¯”è¼ƒã—ã€é…åˆ—ã«å«ã¾ã‚Œã‚‹è¦ç´ ã®å€¤ã¯ç„¡è¦–ã—ã¾ã™ã€‚
    - å¼•æ•°ã«å¤šæ¬¡å…ƒé…åˆ—ä»¥å¤–ãŒæ¸¡ã•ã‚ŒãŸå ´åˆã€è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã€`$false` ãŒè¿”ã•ã‚Œã¾ã™ã€‚
#>
# å¤šæ¬¡å…ƒé…åˆ—ã®è¦ç´ æ•°ã‚’ãƒã‚§ãƒƒã‚¯
Function Test-MultiDimensionalArrayEquality {
    param (
        [Parameter(Mandatory=$true)]$Array1,
        [Parameter(Mandatory=$true)]$Array2
    )

    # å¤šæ¬¡å…ƒé…åˆ—ã‹åˆ¤å®š
    $resultArrayType = (Get-ArrayType $Array1)
    if ($resultArrayType -ne 2) {
        Write-Warning "å¼•æ•°ã®ã€ŒArray1ã€ãŒå¤šæ¬¡å…ƒé…åˆ—ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚[é…åˆ—ã®åˆ¤å®šçµæœ: $($resultArrayType)]"
        return $false
    }
    $resultArrayType = (Get-ArrayType $Array2)
    if ($resultArrayType -ne 2) {
        Write-Warning "å¼•æ•°ã®ã€ŒArray2ã€ãŒå¤šæ¬¡å…ƒé…åˆ—ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚[é…åˆ—ã®åˆ¤å®šçµæœ: $($resultArrayType)]"
        return $false
    }

    # é…åˆ—ã®æ¬¡å…ƒæ•°ã‚’æ¯”è¼ƒ
    $dimensionArray1 = $Array1.Rank
    $dimensionArray2 = $Array2.Rank

    if ($dimensionArray1 -ne $dimensionArray2) {
        return $false
    }

    # å„æ¬¡å…ƒæ¯ã®è¦ç´ æ•°ã‚’ãƒã‚§ãƒƒã‚¯
    for ($i = 0; $i -lt $dimensionArray1; $i++) {
        if ($Array1.GetLength($i) -ne $Array2.GetLength($i)) {
            return $false
        }
    }

    # è¦ç´ æ•°ãŒä¸€è‡´
    return $true
}
```

##### 2ã¤ã®ã‚¸ãƒ£ã‚°é…åˆ—ï¼ˆå¤šæ®µé…åˆ—ï¼‰ãŒåŒã˜è¦ç´ æ•°ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚³ãƒ¼ãƒ‰

```powershell
<#
.SYNOPSIS
    2ã¤ã®ã‚¸ãƒ£ã‚°é…åˆ—ï¼ˆå¤šæ®µéšé…åˆ—ï¼‰ã®æ§‹é€ ã¨ã€å«ã¾ã‚Œã‚‹ã™ã¹ã¦ã®è¦ç´ ã®å€¤ãŒå®Œå…¨ã«ä¸€è‡´ã™ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€Array1 ã¨ Array2 ã§æŒ‡å®šã•ã‚ŒãŸ2ã¤ã®å¤‰æ•°ãŒã€ã‚¸ãƒ£ã‚°é…åˆ—ã¨ã—ã¦å®Œå…¨ã«ç­‰ã—ã„ã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã¾ã™ã€‚
    åˆ¤å®šã¯ä»¥ä¸‹ã®ã‚¹ãƒ†ãƒƒãƒ—ã§è¡Œã‚ã‚Œã¾ã™ã€‚
    1. å†…éƒ¨ã§ `Get-ArrayType` é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã€ä¸¡æ–¹ã®å¼•æ•°ãŒã‚¸ãƒ£ã‚°é…åˆ—ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚
    2. æœ€ä¸Šä½ã®é…åˆ—ã®è¦ç´ æ•°ã‚’æ¯”è¼ƒã—ã¾ã™ã€‚
    3. å„å†…éƒ¨é…åˆ—ã®è¦ç´ æ•°ã‚’æ¯”è¼ƒã—ã¾ã™ã€‚
    4. å¯¾å¿œã™ã‚‹ä½ç½®ã«ã‚ã‚‹ã™ã¹ã¦ã®è¦ç´ ã®å€¤ãã®ã‚‚ã®ã‚’æ¯”è¼ƒã—ã¾ã™ã€‚

    ã“ã‚Œã‚‰ã™ã¹ã¦ã®æ¡ä»¶ã‚’æº€ãŸã™å ´åˆã«ã®ã¿ `$true` ã‚’è¿”ã—ã¾ã™ã€‚

.PARAMETER Array1
    æ¯”è¼ƒå…ƒã®ã‚¸ãƒ£ã‚°é…åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER Array2
    æ¯”è¼ƒå…ˆã®ã‚¸ãƒ£ã‚°é…åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    # æ¯”è¼ƒç”¨ã®ã‚¸ãƒ£ã‚°é…åˆ—ã‚’æº–å‚™
    $arrayA = @(@(1, 2), @(3))
    $arrayB = @(@(1, 2), @(3)) # $arrayAã¨å®Œå…¨ã«ä¸€è‡´
    $arrayC = @(@(1, 2), @(9)) # å€¤ãŒç•°ãªã‚‹
    $arrayD = @(@(1), @(2, 3)) # æ§‹é€ ãŒç•°ãªã‚‹

    # ä¾‹ 1: æ§‹é€ ã‚‚å€¤ã‚‚å®Œå…¨ã«ä¸€è‡´ã™ã‚‹å ´åˆ
    PS C:\> Test-MultiLevelArrayEquality -Array1 $arrayA -Array2 $arrayB
    True

    # ä¾‹ 2: æ§‹é€ ã¯åŒã˜ã ãŒã€è¦ç´ ã®å€¤ãŒç•°ãªã‚‹å ´åˆ
    PS C:\> Test-MultiLevelArrayEquality -Array1 $arrayA -Array2 $arrayC
    False

    # ä¾‹ 3: æ§‹é€ ãŒç•°ãªã‚‹å ´åˆ
    PS C:\> Test-MultiLevelArrayEquality -Array1 $arrayA -Array2 $arrayD
    False

.OUTPUTS
    System.Boolean
    2ã¤ã®ã‚¸ãƒ£ã‚°é…åˆ—ã®æ§‹é€ ã¨è¦ç´ ã®å€¤ãŒå®Œå…¨ã«ä¸€è‡´ã™ã‚‹å ´åˆã¯ `$true` ã‚’ã€ãã†ã§ãªã„å ´åˆã¯ `$false` ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯ã€`Get-ArrayType` ã¨ã„ã†åˆ¥ã®ã‚«ã‚¹ã‚¿ãƒ é–¢æ•°ãŒåŒã˜ã‚¹ã‚³ãƒ¼ãƒ—å†…ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚
    - ã“ã®é–¢æ•°ã¯é…åˆ—ã®ã€Œæ§‹é€ ã€ã ã‘ã§ãªãã€å«ã¾ã‚Œã‚‹ã€Œè¦ç´ ã®å€¤ã€ã‚‚å³å¯†ã«æ¯”è¼ƒã—ã¾ã™ã€‚
    - `-Debug` ã‚¹ã‚¤ãƒƒãƒã‚’ä»˜ã‘ã¦å®Ÿè¡Œã™ã‚‹ã¨ã€æ¯”è¼ƒå‡¦ç†ã®è©³ç´°ãªãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
#>
# ã‚¸ãƒ£ã‚°é…åˆ—ã®è¦ç´ æ•°ã‚’ãƒã‚§ãƒƒã‚¯
Function Test-MultiLevelArrayEquality {
    param (
        [Parameter(Mandatory=$true)]$Array1,
        [Parameter(Mandatory=$true)]$Array2
    )

    # ãƒ£ã‚°é…åˆ—ã‹åˆ¤å®š
    $resultArrayType = (Get-ArrayType $Array1)
    if ($resultArrayType -ne 1) {
        Write-Warning "å¼•æ•°ã®ã€ŒArray1ã€ãŒã‚¸ãƒ£ã‚°é…åˆ—ï¼ˆå¤šæ¬¡å…ƒé…åˆ—ï¼‰ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚[é…åˆ—ã®åˆ¤å®šçµæœ: $($resultArrayType)]"
        return $false
    }
    $resultArrayType = (Get-ArrayType $Array2)
    if ($resultArrayType -ne 1) {
        Write-Warning "å¼•æ•°ã®ã€ŒArray2ã€ãŒã‚¸ãƒ£ã‚°é…åˆ—ï¼ˆå¤šæ¬¡å…ƒé…åˆ—ï¼‰ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚[é…åˆ—ã®åˆ¤å®šçµæœ: $($resultArrayType)]"
        return $false
    }

    # é…åˆ—ã®æ¬¡å…ƒæ•°ã‚’æ¯”è¼ƒ
    $levelArray1 = $Array1.Length
    $levelArray2 = $Array2.Length

    Write-Debug "`$levelArray1: [$($levelArray1)], `$levelArray2: [$($levelArray2)]"
    if ($levelArray1 -ne $levelArray2) {
        return $false
    }

    # å„æ¬¡å…ƒæ¯ã®è¦ç´ æ•°ã‚’ãƒã‚§ãƒƒã‚¯
    for ($i = 0; $i -lt $Array1.Length; $i++) {
        Write-Debug "`$Array1[$($i)].Length: [$($Array1[$i].Length)], `$Array2[$($i)].Length: [$($Array2[$i].Length)]"
        if ($Array1[$i].Length -ne $Array2[$i].Length) {
            return $false
        }
        for ($j = 0; $j -lt $Array1[$i].Length; $j++) {
            Write-Debug "`$Array1[$($i)][$($j)]: [$($Array1[$i][$j])], `$Array2[$($i)][$($j)]: [$($Array2[$i][$j])]"
            if ($Array1[$i][$j] -ne $Array2[$i][$j]) {
                return $false
            }
        }
    }

    # è¦ç´ æ•°ãŒä¸€è‡´
    return $true
}
```

##### å€¤ã‚‚å«ã‚ã¦é…åˆ—ã‚’ã¾ã‚‹ã¾ã‚‹æ¯”è¼ƒ

```powershell
<#
.SYNOPSIS
    2ã¤ã®é…åˆ—ãŒã€è¦ç´ ã®å†…å®¹ã¨é †åºã‚’å«ã‚ã¦å®Œå…¨ã«åŒä¸€ã§ã‚ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€`Compare-Object` ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ã€2ã¤ã®é…åˆ— (`Array1` ã¨ `Array2`) ã‚’æ¯”è¼ƒã—ã¾ã™ã€‚
    `-SyncWindow 0` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€è¦ç´ ã®é †åºã‚‚å³å¯†ã«æ¯”è¼ƒã®å¯¾è±¡ã¨ã—ã¾ã™ã€‚
    ä¸¡æ–¹ã®é…åˆ—ã«å«ã¾ã‚Œã‚‹è¦ç´ ã¨ãã®é †åºãŒå®Œå…¨ã«ä¸€è‡´ã™ã‚‹å ´åˆã«ã®ã¿ã€ã“ã®é–¢æ•°ã¯ `$true` ã‚’è¿”ã—ã¾ã™ã€‚

.PARAMETER Array1
    æ¯”è¼ƒã®åŸºæº–ã¨ãªã‚‹é…åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER Array2
    `Array1` ã¨æ¯”è¼ƒã™ã‚‹å¯¾è±¡ã®é…åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    # æ¯”è¼ƒç”¨ã®é…åˆ—ã‚’æº–å‚™
    $a = 1, 2, 3
    $b = 1, 2, 3  # $a ã¨å®Œå…¨ã«åŒä¸€
    $c = 3, 2, 1  # è¦ç´ ã¯åŒã˜ã ãŒé †åºãŒé•ã†
    $d = 1, 2, 4  # è¦ç´ ãŒé•ã†

    # ä¾‹ 1: å®Œå…¨ã«åŒä¸€ã®é…åˆ—ã‚’æ¯”è¼ƒ
    PS C:\> Test-ArrayEquality -Array1 $a -Array2 $b
    True

    # ä¾‹ 2: é †åºãŒç•°ãªã‚‹é…åˆ—ã‚’æ¯”è¼ƒ
    PS C:\> Test-ArrayEquality -Array1 $a -Array2 $c
    False

    # ä¾‹ 3: è¦ç´ ãŒç•°ãªã‚‹é…åˆ—ã‚’æ¯”è¼ƒ
    PS C:\> Test-ArrayEquality -Array1 $a -Array2 $d
    False

.OUTPUTS
    System.Boolean
    é…åˆ—ãŒå®Œå…¨ã«åŒä¸€ã§ã‚ã‚Œã° `$true` ã‚’ã€ãã†ã§ãªã‘ã‚Œã° `$false` ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯ `Compare-Object` ã® `-SyncWindow 0` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ä¾å­˜ã—ã¦ãŠã‚Šã€è¦ç´ ã®é †åºãŒé‡è¦ã¨ãªã‚Šã¾ã™ã€‚é †åºã‚’å•ã‚ãªã„æ¯”è¼ƒã‚’ã—ãŸã„å ´åˆã¯ã€ã“ã®é–¢æ•°ã¯é©ã—ã¦ã„ã¾ã›ã‚“ã€‚
    - ã“ã®é–¢æ•°ã¯1æ¬¡å…ƒé…åˆ—ã®æ¯”è¼ƒã«æœ€é©ã§ã™ã€‚å¤šæ¬¡å…ƒé…åˆ—ã‚„ã‚¸ãƒ£ã‚°é…åˆ—ã®ã‚ˆã†ãªãƒã‚¹ãƒˆã•ã‚ŒãŸé…åˆ—ã®å ´åˆã€å†…éƒ¨ã®é…åˆ—ã¯å‚ç…§ã¨ã—ã¦æ¯”è¼ƒã•ã‚Œã‚‹ãŸã‚ã€æœŸå¾…é€šã‚Šã®æ·±ã„æ¯”è¼ƒã¯è¡Œã‚ã‚Œã¾ã›ã‚“ã€‚
#>
Function Test-ArrayEquality {
    param (
        [Parameter(Mandatory=$true)][System.Array]$Array1,
        [Parameter(Mandatory=$true)][System.Array]$Array2
    )
    
    # æ¯”è¼ƒï¼ˆå·®ç•°ãŒç„¡ã„å ´åˆã€$null ã‹ ç©ºã®é…åˆ— ãŒè¿”ã‚‹ï¼‰
    $diffResult = (Compare-Object -ReferenceObject $Array1 -DifferenceObject $Array2 -SyncWindow 0)

    # æ¯”è¼ƒçµæœã‚’è©•ä¾¡
    return (($null -eq $diffResult) -or ($diffResult.Count -eq 0))
}
```

#### \[PowerShell\]å®šç¾©ã—ãŸFunctionã®ä¸­èº«ã‚’ç¢ºèªã™ã‚‹5ã¤ã®æ–¹æ³•ï¼ˆ4ã¤ã®ã‚³ãƒãƒ³ãƒ‰ã¨è‡ªä½œFunctionï¼‰

2025.7.15 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/b1a62026f2dab7

```powershell:ç¾åœ¨èª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹é–¢æ•°ã®å®šç¾©ï¼ˆã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ï¼‰ã‚’å–å¾—
<#
.SYNOPSIS
    ç¾åœ¨èª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹é–¢æ•°ã®å®šç¾©ï¼ˆã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ï¼‰ã‚’å–å¾—ã—ã€æ–‡å­—åˆ—ã¨ã—ã¦è¿”ã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€FunctionName ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸã€ç¾åœ¨ã®PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹é–¢æ•°ã®å®šç¾©ã‚’å–å¾—ã—ã¾ã™ã€‚
    å†…éƒ¨ã§ `Get-Command` ã‚’ä½¿ç”¨ã—ã¦é–¢æ•°ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã‚’å–å¾—ã—ã€ãã‚Œã‚’æ•´å½¢ã•ã‚ŒãŸæ–‡å­—åˆ—ã«å¤‰æ›ã—ã¾ã™ã€‚
    ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ã—ã¦ã€å‡ºåŠ›ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ãŸã‚Šã€çµæœã‚’Markdownã®ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯å½¢å¼ã§ãƒ©ãƒƒãƒ—ã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
    å‹•çš„ã«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç”Ÿæˆã—ãŸã‚Šã€ä»–ã®é–¢æ•°ã®å®Ÿè£…ã‚’ç¢ºèªã—ãŸã‚Šã™ã‚‹ã®ã«ä¾¿åˆ©ã§ã™ã€‚

.PARAMETER FunctionName
    å®šç¾©ã‚’å–å¾—ã—ãŸã„é–¢æ•°ã®åå‰ã‚’æ–‡å­—åˆ—ã§æŒ‡å®šã—ã¾ã™ã€‚

.PARAMETER Newline
    å‡ºåŠ›ã•ã‚Œã‚‹æ–‡å­—åˆ—å†…ã§ä½¿ç”¨ã™ã‚‹æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚
    ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ `"`r`n"` (CRLF) ã§ã™ã€‚

.PARAMETER MarkdownMode
    ã“ã®ã‚¹ã‚¤ãƒƒãƒã‚’ `$true` ã«è¨­å®šã™ã‚‹ã¨ã€è¿”ã•ã‚Œã‚‹é–¢æ•°å®šç¾©ãŒPowerShellç”¨ã®Markdownã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ (``````powershell ... ``````) ã§å›²ã¾ã‚Œã¾ã™ã€‚
    ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ `$false` ã§ã™ã€‚

.EXAMPLE
    # --- æº–å‚™ï¼šãƒ†ã‚¹ãƒˆç”¨ã®é–¢æ•°ã‚’å®šç¾© ---
    Function My-DemoFunction {
        [CmdletBinding()]
        param()
        Write-Host "This is a demo."
    }

    # ä¾‹ 1: åŸºæœ¬çš„ãªä½¿ç”¨æ–¹æ³•ã€‚é–¢æ•°ã®å®šç¾©ã‚’ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§å–å¾—ã™ã‚‹ã€‚
    PS C:\> Get-FunctionDefinition -FunctionName 'My-DemoFunction'

    # å®Ÿè¡Œçµæœï¼ˆæ–‡å­—åˆ—ã¨ã—ã¦è¿”ã•ã‚Œã‚‹ï¼‰:
    # Function My-DemoFunction {
    #     [CmdletBinding()]
    #     param()
    #     Write-Host "This is a demo."
    # }

.EXAMPLE
    # ä¾‹ 2: Markdownãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã—ã¦ã€çµæœã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹
    PS C:\> Get-FunctionDefinition -FunctionName 'My-DemoFunction' -MarkdownMode $true | Set-Clipboard

    # ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªMarkdownå½¢å¼ã®ãƒ†ã‚­ã‚¹ãƒˆãŒã‚³ãƒ”ãƒ¼ã•ã‚Œã‚‹ã€‚
    # `````powershell
    # Function My-DemoFunction {
    #     [CmdletBinding()]
    #     param()
    #     Write-Host "This is a demo."
    # }
    # `````

.EXAMPLE
    # ä¾‹ 3: å­˜åœ¨ã—ãªã„é–¢æ•°ã‚’æŒ‡å®šã—ãŸå ´åˆ
    PS C:\> Get-FunctionDefinition -FunctionName 'NonExistent-Function'
    WARNING: è©²å½“ã®FunctionãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚[æ¤œç´¢ã—ãŸFunctionå: NonExistent-Function]

.OUTPUTS
    System.String
    é–¢æ•°ã®å®šç¾©ã‚’å«ã‚€å˜ä¸€ã®æ–‡å­—åˆ—ã‚’è¿”ã—ã¾ã™ã€‚é–¢æ•°ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ã€ä½•ã‚‚è¿”ã—ã¾ã›ã‚“ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯ã€å¯¾è±¡ã®é–¢æ•°ãŒç¾åœ¨ã®PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³ã«èª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ï¼ˆå®šç¾©ã¾ãŸã¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ï¼‰å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
    - è¿”ã•ã‚Œã‚‹å®šç¾©ã¯ã€`Get-Command` ãŒä¿æŒã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã‹ã‚‰å†æ§‹ç¯‰ã•ã‚ŒãŸã‚‚ã®ã§ã‚ã‚Šã€å…ƒã®ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã¨å®Œå…¨ã«åŒä¸€ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆä¾‹: `Function`ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å‰ã®ã‚³ãƒ¡ãƒ³ãƒˆãªã©ï¼‰ã§ã‚ã‚‹ã¨ã¯é™ã‚Šã¾ã›ã‚“ã€‚
#>
Function Get-FunctionDefinition {
    param (
        [System.String]$FunctionName,
        [System.String]$Newline="`r`n",
        [System.Boolean]$MarkdownMode=$False
    )

    # FunctionãŒå­˜åœ¨ã—ãªã„å ´åˆ
    if ($null -eq (Get-Command -Name $FunctionName -ErrorAction SilentlyContinue)) {
        Write-Warning "è©²å½“ã®FunctionãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚[æ¤œç´¢ã—ãŸFunctionå: $($FunctionName)]"
        return
    }

    # å…ˆé ­ã®ç©ºè¡Œã‚’é£›ã°ã—ã¦Functionã®å®šç¾©å†…å®¹ã‚’å–å¾—
    #   ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ–ãƒ­ãƒƒã‚¯å†…ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’ã€ŒLFã€ã§è¨­å®šï¼ˆâ€» PowerShellãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã£ã¦å¤‰ã‚ã‚‹ã‹ã‚‚ï¼‰
    $scriptblockNewline = "`n"
    $plainDefinition = (((Get-Command $FunctionName).ScriptBlock.ToString() -Split $scriptblockNewline | Select-Object -Skip 1) -Join $Newline)

    $functionDefinition = ''
    if ($MarkdownMode) {
        $functionDefinition += "``````powershell$($Newline)"
        $functionDefinition += "Function $FunctionName {$($Newline)"
        $functionDefinition += $plainDefinition
        $functionDefinition += "}$($Newline)"
        $functionDefinition += "``````$($Newline)"
    }
    else {
        $functionDefinition += "Function $FunctionName {$($Newline)"
        $functionDefinition += $plainDefinition
        $functionDefinition += "}$($Newline)"
    }

    return $functionDefinition
}
```

#### \[PowerShell\]å®šæ•°ãŒå®šç¾©æ¸ˆã¿ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹Function

2025.7.15 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/00550602235495

```powershell:æŒ‡å®šã•ã‚ŒãŸåå‰ã®å¤‰æ•°ãŒã€ã™ã¹ã¦ç¾åœ¨ã®ã‚¹ã‚³ãƒ¼ãƒ—ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèª
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸåå‰ã®å¤‰æ•°ãŒã€ã™ã¹ã¦ç¾åœ¨ã®ã‚¹ã‚³ãƒ¼ãƒ—ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€Constants ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§å—ã‘å–ã£ãŸæ–‡å­—åˆ—é…åˆ—ã«å«ã¾ã‚Œã‚‹ã™ã¹ã¦ã®å¤‰æ•°åã«ã¤ã„ã¦ã€ãã®å­˜åœ¨ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚
    å†…éƒ¨ã§ã¯ `Get-Variable` ã‚’ä½¿ç”¨ã—ã€é…åˆ—å†…ã®å¤‰æ•°åãŒä¸€ã¤ã§ã‚‚æœªå®šç¾©ï¼ˆ$nullï¼‰ã§ã‚ã‚‹å ´åˆã€ç›´ã¡ã« `$false` ã‚’è¿”ã—ã¾ã™ã€‚
    ã™ã¹ã¦ã®å¤‰æ•°ãŒå®šç¾©æ¸ˆã¿ã§ã‚ã‚Œã° `$true` ã‚’è¿”ã—ã¾ã™ã€‚
    ã“ã®é–¢æ•°ã¯ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒä¾å­˜ã™ã‚‹å®šæ•°ã‚„æ§‹æˆå¤‰æ•°ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ã‚’äº‹å‰ã«æ¤œè¨¼ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚

.PARAMETER Constants
    å­˜åœ¨ã‚’ç¢ºèªã—ãŸã„å¤‰æ•°åã®ãƒªã‚¹ãƒˆã‚’ã€æ–‡å­—åˆ—ã®é…åˆ—ã¨ã—ã¦æŒ‡å®šã—ã¾ã™ã€‚

.EXAMPLE
    # ä¾‹ 1: å¿…è¦ãªå¤‰æ•°ãŒã™ã¹ã¦å®šç¾©ã•ã‚Œã¦ã„ã‚‹å ´åˆ
    PS C:\> $AppPath = 'C:\apps\myapp.exe'
    PS C:\> $LogFile = 'C:\logs\app.log'
    PS C:\> if (Test-ConstantDefined -Constants 'AppPath', 'LogFile') {
    >>     Write-Host "è¨­å®šã¯æ­£å¸¸ã§ã™ã€‚"
    >> }
    è¨­å®šã¯æ­£å¸¸ã§ã™ã€‚

.EXAMPLE
    # ä¾‹ 2: ä¸€éƒ¨ã®å¤‰æ•°ãŒå®šç¾©ã•ã‚Œã¦ã„ãªã„å ´åˆ
    PS C:\> $AppPath = 'C:\apps\myapp.exe'
    PS C:\> # $LogFile ã¯æœªå®šç¾©
    PS C:\> if (-Not (Test-ConstantDefined -Constants 'AppPath', 'LogFile')) {
    >>     Write-Warning "å¿…è¦ãªå¤‰æ•°ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼"
    >> }
    WARNING: å¿…è¦ãªå¤‰æ•°ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼

.OUTPUTS
    System.Boolean
    æŒ‡å®šã•ã‚ŒãŸã™ã¹ã¦ã®å¤‰æ•°ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ `$true` ã‚’ã€ä¸€ã¤ã§ã‚‚æœªå®šç¾©ã®å¤‰æ•°ãŒã‚ã‚Œã° `$false` ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯å¤‰æ•°ãŒå­˜åœ¨ã™ã‚‹ã‹ã©ã†ã‹ï¼ˆ`$null`ã§ãªã„ã‹ï¼‰ã®ã¿ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚å¤‰æ•°ã®å€¤ãŒç©ºæ–‡å­—åˆ— (`''`) ã‚„ `$false`ã€`0` ã§ã‚ã£ã¦ã‚‚ã€Œå®šç¾©æ¸ˆã¿ã€ã¨åˆ¤æ–­ã—ã¾ã™ã€‚
    - `Get-Variable` ã¯ç¾åœ¨ã®ã‚¹ã‚³ãƒ¼ãƒ—ã‹ã‚‰è¦ªã‚¹ã‚³ãƒ¼ãƒ—ã¸ã¨å¤‰æ•°ã‚’æ¤œç´¢ã—ã¾ã™ã€‚
#>
Function Test-ConstantDefined {
    param (
        [System.String[]]$Constants
    )
    foreach ($const in $Constants) {
        [System.String]$constValue = (Get-Variable -Name $const -ErrorAction SilentlyContinue)
        # Nullã®å ´åˆã¯æœªå®šç¾©ã¨ã—ã¦åˆ¤æ–­
        # ï¼ˆç©ºæ–‡å­—ã‚„ç©ºç™½ã®ã¿ã¯å®šæ•°ã¨ã—ã¦å®šç¾©ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ãƒã‚§ãƒƒã‚¯ã—ãªã„ï¼‰
        if ($null -eq $constValue) {
            return $false
        }
    }
    return $true
}
```

#### PowerShellã§æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹Function

2025.7.15 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/046e42e21fa77c

```powershell
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã«ã€ç©ºç™½æ–‡å­—ä»¥å¤–ã®å®Ÿè³ªçš„ãªå†…å®¹ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€Path ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€ãã®å†…å®¹ãŒç©ºã¾ãŸã¯ç©ºç™½æ–‡å­—ã®ã¿ã§æ§‹æˆã•ã‚Œã¦ã„ãªã„ã‹ã‚’åˆ¤å®šã—ã¾ã™ã€‚
    å†…éƒ¨ã§ã¯ `Get-Content` ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ã™ã¹ã¦èª­ã¿è¾¼ã¿ã€ãã®çµæœã‚’ `[System.String]::IsNullOrWhiteSpace()` ãƒ¡ã‚½ãƒƒãƒ‰ã§è©•ä¾¡ã—ã¾ã™ã€‚
    ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ•ã‚¡ã‚¤ãƒ«ãŒå®Œå…¨ã«ç©ºã§ã‚ã‚‹å ´åˆã‚„ã€ã‚¹ãƒšãƒ¼ã‚¹ã€ã‚¿ãƒ–ã€æ”¹è¡Œã®ã¿ãŒå«ã¾ã‚Œã‚‹å ´åˆã‚’ã€Œå†…å®¹ãªã—ã€ã¨ã¿ãªã—ã€`$false` ã‚’è¿”ã—ã¾ã™ã€‚
    ä½•ã‚‰ã‹ã®å°åˆ·å¯èƒ½ãªæ–‡å­—ãŒ1ã¤ã§ã‚‚å«ã¾ã‚Œã¦ã„ã‚Œã°ã€Œå†…å®¹ã‚ã‚Šã€ã¨åˆ¤æ–­ã—ã€`$true` ã‚’è¿”ã—ã¾ã™ã€‚
    ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç†å‰ã«ã€ç©ºã§ãªã„ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚

.PARAMETER Path
    å†…å®¹ã‚’ç¢ºèªã—ãŸã„ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æ–‡å­—åˆ—ã§æŒ‡å®šã—ã¾ã™ã€‚

.EXAMPLE
    # ä¾‹ 1: å†…å®¹ãŒã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«
    PS C:\> "Hello World" | Out-File .\test.txt
    PS C:\> Test-FileHasContent -Path .\test.txt
    True

    # ä¾‹ 2: ç©ºã®ãƒ•ã‚¡ã‚¤ãƒ«
    PS C:\> "" | Out-File .\empty.txt
    PS C:\> Test-FileHasContent -Path .\empty.txt
    False

    # ä¾‹ 3: ã‚¹ãƒšãƒ¼ã‚¹ã¨æ”¹è¡Œã—ã‹å«ã¾ãªã„ãƒ•ã‚¡ã‚¤ãƒ«
    PS C:\> "   `r`n `t " | Out-File .\whitespace.txt
    PS C:\> Test-FileHasContent -Path .\whitespace.txt
    False

.OUTPUTS
    System.Boolean
    ãƒ•ã‚¡ã‚¤ãƒ«ã«å®Ÿè³ªçš„ãªå†…å®¹ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã¯ `$true` ã‚’ã€ãã†ã§ãªã„ï¼ˆç©ºã€ç©ºç™½ã®ã¿ã€ã¾ãŸã¯èª­ã¿å–ã‚Šã‚¨ãƒ©ãƒ¼ï¼‰å ´åˆã¯ `$false` ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    - ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ä¸­ã«ã‚¨ãƒ©ãƒ¼ï¼ˆä¾‹: ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„ã€ã‚¢ã‚¯ã‚»ã‚¹æ¨©ãŒãªã„ï¼‰ãŒç™ºç”Ÿã—ãŸå ´åˆã€ã“ã®é–¢æ•°ã¯ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã€`$false` ã‚’è¿”ã—ã¾ã™ã€‚
    - ã“ã®é–¢æ•°ã¯ãƒ•ã‚¡ã‚¤ãƒ«å…¨ä½“ã‚’ãƒ¡ãƒ¢ãƒªã«èª­ã¿è¾¼ã‚€ãŸã‚ã€éå¸¸ã«å·¨å¤§ãªãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã—ã¦ä½¿ç”¨ã™ã‚‹éš›ã¯ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚
#>
Function Test-FileHasContent {
    param (
        [System.String]$Path
    )

    try {
        $fileContents = (Get-Content $Path)
    }
    catch {
        Write-Error 'ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã‚’èª­ã¿è¾¼ã‚€éš›ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚'
        return $false
    }

    # Null ã¾ãŸã¯ ç©ºæ–‡å­—ã€ç©ºç™½ã®ã¿ã ã£ãŸå ´åˆã¯ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãªã—ã®åˆ¤å®š
    return (-not ([System.String]::IsNullOrWhiteSpace($fileContents)))
}
```

#### \[PowerShell\]ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ãƒ„ãƒªãƒ¼å½¢å¼ã§è¡¨ç¤ºã™ã‚‹Functionï¼ˆCLIã¨GUIã®2é€šã‚Šï¼‰

2025.7.15 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/7e729f6f7761a2

##### CLIã§å‡ºåŠ›å¯èƒ½ãªFunction

```powershell
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸãƒ‘ã‚¹ã®ãƒ•ã‚©ãƒ«ãƒ€ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹é€ ã‚’ã€è¦–è¦šçš„ãªãƒ„ãƒªãƒ¼å½¢å¼ã§è¡¨ç¤ºã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã® `tree` ã‚³ãƒãƒ³ãƒ‰ã®ã‚ˆã†ã«ã€æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚©ãƒ«ãƒ€ã®æ§‹é€ ã‚’å†å¸°çš„ã«ã‚¹ã‚­ãƒ£ãƒ³ã—ã€éšå±¤çš„ãªãƒ„ãƒªãƒ¼å½¢å¼ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ç”Ÿæˆã—ã¾ã™ã€‚
    ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ•ã‚©ãƒ«ãƒ€ã¯ã€å„éšå±¤å†…ã§ãƒ•ã‚¡ã‚¤ãƒ«ãŒå…ˆã«ã€ãƒ•ã‚©ãƒ«ãƒ€ãŒå¾Œã«ã‚½ãƒ¼ãƒˆã•ã‚Œã¦è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
    ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ã—ã¦ã€ç½«ç·šã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ASCIIæ–‡å­—ã«å¤‰æ›´ã—ãŸã‚Šã€çµæœã‚’ç›´æ¥ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ãŸã‚Šã€ä½¿ç”¨ã™ã‚‹æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’é¸æŠã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

.PARAMETER Path
    ãƒ„ãƒªãƒ¼è¡¨ç¤ºã®èµ·ç‚¹ã¨ãªã‚‹ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER AsciiMode
    ã“ã®ã‚¹ã‚¤ãƒƒãƒã‚’ `$true` ã«è¨­å®šã™ã‚‹ã¨ã€ç½«ç·šæ–‡å­—ï¼ˆä¾‹: â”‚, â””ï¼‰ã®ä»£ã‚ã‚Šã« `|`, `+`, `\` ãªã©ã®ASCIIæ–‡å­—ã‚’ä½¿ç”¨ã—ã¦ãƒ„ãƒªãƒ¼ã‚’æç”»ã—ã¾ã™ã€‚
    ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã‚„ç’°å¢ƒã«ã‚ˆã‚‹æ–‡å­—åŒ–ã‘ã‚’é˜²ãã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ `$false` ã§ã™ã€‚

.PARAMETER CopyToClipboard
    ã“ã®ã‚¹ã‚¤ãƒƒãƒã‚’ `$true` ã«è¨­å®šã™ã‚‹ã¨ã€ç”Ÿæˆã•ã‚ŒãŸãƒ„ãƒªãƒ¼è¡¨ç¤ºã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã™ã‚‹ä»£ã‚ã‚Šã«ã€ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚
    ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¸ã®è²¼ã‚Šä»˜ã‘ãªã©ã«ä¾¿åˆ©ã§ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ `$false` ã§ã™ã€‚

.PARAMETER NewlineCode
    å‡ºåŠ›ãƒ†ã‚­ã‚¹ãƒˆã«ä½¿ç”¨ã™ã‚‹æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚
    - 1: CRLF (`"`r`n"`) (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)
    - 2: LF (`"`n"`)

.EXAMPLE
    # ä¾‹ 1: ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ„ãƒªãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹
    PS C:\> Write-TreeView -Path .

    # å®Ÿè¡Œçµæœï¼ˆä¾‹ï¼‰:
    # .
    # â”œâ”€â”€ã€€file1.txt
    # â”œâ”€â”€ã€€file2.log
    # â”‚
    # â””â”€â”€ã€€< subfolder >
    #     â”œâ”€â”€ã€€subfile.txt
    #     â”‚
    #     â””â”€â”€ã€€< anotherfolder >
    #         ã€€ã€€ã€€
    #
    
.EXAMPLE
    # ä¾‹ 2: ASCIIãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã—ã¦è¡¨ç¤ºã™ã‚‹
    PS C:\> Write-TreeView -Path 'C:\Program Files\PowerShell' -AsciiMode $true

    # å®Ÿè¡Œçµæœï¼ˆä¾‹ï¼‰:
    # C:\Program Files\PowerShell
    # +---- pwsh.exe
    # +---- pwsh.pdb
    # |
    # \---- < 7 >
    #      +---- pwsh.dll
    #      |
    #      \---- < Ref >
    #           \---- Microsoft.PowerShell.Commands.Management.dll
    #
    
.EXAMPLE
    # ä¾‹ 3: çµæœã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹
    PS C:\> Write-TreeView -Path . -CopyToClipboard $true
    å‡ºåŠ›çµæœã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼

    # ã“ã®å¾Œã€Ctrl+Vãªã©ã§è²¼ã‚Šä»˜ã‘ã‚‹ã¨ãƒ„ãƒªãƒ¼è¡¨ç¤ºã®ãƒ†ã‚­ã‚¹ãƒˆãŒãƒšãƒ¼ã‚¹ãƒˆã•ã‚Œã‚‹ã€‚

.OUTPUTS
    System.String
    ç”Ÿæˆã•ã‚ŒãŸãƒ„ãƒªãƒ¼è¡¨ç¤ºã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æ–‡å­—åˆ—ã¨ã—ã¦å‡ºåŠ›ã—ã¾ã™ã€‚
    `-CopyToClipboard`ãŒæŒ‡å®šã•ã‚ŒãŸå ´åˆã¯ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºåŠ›ã™ã‚‹ã ã‘ã§ã€æˆåŠŸã‚¹ãƒˆãƒªãƒ¼ãƒ ã¸ã®å‡ºåŠ›ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯å†…éƒ¨ã§å†å¸°å‡¦ç†ã‚’è¡Œã†ãŸã‚ã€éå¸¸ã«æ·±ã„éšå±¤æ§‹é€ ã‚„è†¨å¤§ãªæ•°ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒã¤ãƒ•ã‚©ãƒ«ãƒ€ã«å¯¾ã—ã¦å®Ÿè¡Œã™ã‚‹ã¨ã€æ™‚é–“ãŒã‹ã‹ã£ãŸã‚Šã€å¤šãã®ãƒ¡ãƒ¢ãƒªã‚’æ¶ˆè²»ã—ãŸã‚Šã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
    - æ—¥æœ¬èªç’°å¢ƒã§ã¯ã€ASCIIãƒ¢ãƒ¼ãƒ‰ã§ãªã„å ´åˆã® `\` ãŒå††è¨˜å·ï¼ˆÂ¥ï¼‰ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
#>
Function Write-TreeView {
    param (
        [Parameter(Mandatory=$true)][System.String]$Path,
        [System.Boolean]$AsciiMode = $False,
        [System.Boolean]$CopyToClipboard = $False,
        [ValidateSet(1, 2)][System.Int32]$NewlineCode = 1
    )

    # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯å‡¦ç†ä¸­æ–­
    if (-not (Test-Path -Path $Path)) {
        Write-Warning "æŒ‡å®šã•ã‚ŒãŸãƒ‘ã‚¹ã¯å­˜åœ¨ã—ã¾ã›ã‚“: $Path"
        return
    }
    
    # æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’è¨­å®š
    $newlineTable = @{
        1 = "`r`n"  # CRLF
        2 = "`n"    # LF
    }
    
    # å‡ºåŠ›å½¢å¼ã‚’è¨­å®š
    # * æ—¥æœ¬èªOSã§ã¯ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ï¼ˆï¼¼ï¼‰ãŒå††ãƒãƒ¼ã‚¯ï¼ˆï¿¥ï¼‰ã¨ãªã‚‹ã€‚
    $indentTable = @{}
    if ($AsciiMode) {
        $indentTable["Pattern1"] = '     '
        $indentTable["Pattern2"] = '|     '
        $indentTable["Pattern3"] = '\---- '
        $indentTable["Pattern4"] = '+---- '
    }
    else {
        $indentTable["Pattern1"] = 'ã€€ã€€ã€€'
        $indentTable["Pattern2"] = 'â”‚ã€€ã€€'
        $indentTable["Pattern3"] = 'â””â”€â”€ã€€'
        $indentTable["Pattern4"] = 'â”œâ”€â”€ã€€'
    }
    
    # å†…éƒ¨é–¢æ•°ï¼šãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®ãƒ„ãƒªãƒ¼æ§‹é€ ã‚’å–å¾—ã™ã‚‹é–¢æ•°
    Function Write-FolderTree {
        param (
            [System.String]$CurrentPath,
            [System.Collections.Hashtable]$Levels
        )

        # ãƒ•ã‚¡ã‚¤ãƒ«ãŒå…ˆé ­ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ä¸¦ã³æ›¿ãˆ
        $items = (Get-ChildItem -Path $CurrentPath | Sort-Object { -not $_.PSIsContainer }, Name)
        $count = $items.Count
        $index = 0
        
        $ouputFoldertree = ""

        foreach ($item in $items) {
            $index++
            $isLastItem = ($index -eq $count)
            $level = $Levels.Count
            $Levels[$level] = $isLastItem
            $indent = ""

            for ($i = 0; $i -lt $level; $i++) {
                $indent += if ($Levels[$i]) { "$($indentTable["Pattern1"])" } else { "$($indentTable["Pattern2"])" }
            }

            $line = if ($isLastItem) { "$($indentTable["Pattern3"])" } else { "$($indentTable["Pattern4"])" }

            if ($item.PSIsContainer) {
                # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®å ´åˆ
                $ouputFoldertree += "$($indent)$($line)< $($item.Name) >$($newlineTable[$NewlineCode])"
                $ouputFoldertree += (Write-FolderTree -CurrentPath $item.FullName -Levels $Levels)
            } else {
                # ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´åˆ
                $ouputFoldertree += "$($indent)$($line)$($item.Name)$($newlineTable[$NewlineCode])"
            }
            
            # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å†…ã§æœ€çµ‚ã‚¢ã‚¤ãƒ†ãƒ ã®å ´åˆã«æ¬¡ã®ã‚¢ã‚¤ãƒ†ãƒ ã¨é–“éš”ã‚’ç©ºã‘ã‚‹
            if ($isLastItem) {
                $ouputFoldertree += "$($indent)$($newlineTable[$NewlineCode])"
            }

            $Levels.Remove($level)
        }
        
        return $ouputFoldertree
    }

    $Levels = @{}
    $outputTreeview =  "$($Path)$($newlineTable[$NewlineCode])"
    $outputTreeview += (Write-FolderTree -CurrentPath $Path -Levels $Levels)
    
    if ($CopyToClipboard) {
        $outputTreeview | Set-Clipboard
        Write-Output "å‡ºåŠ›çµæœã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼$($newlineTable[$NewlineCode])"
    }
    else {
        Write-Output $outputTreeview
    }
}
```

##### GUIã§è¡¨ç¤ºå¯èƒ½ãªFunction

!["è‡ªä½œFunctionã€ŒOut-TreeViewã€ã®ç”»é¢"](https://storage.googleapis.com/zenn-user-upload/fbc1d8aafd00-20240808.png)
*å®Ÿéš›ã®ç”»é¢ï¼šè‡ªä½œFunctionã€ŒOut-TreeViewã€*

```powershell
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸãƒ‘ã‚¹ã®ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ã‚’ã€å¯¾è©±çš„ãªGUIãƒ„ãƒªãƒ¼ãƒ“ãƒ¥ãƒ¼ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§è¡¨ç¤ºã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€Windows Formsã‚’åˆ©ç”¨ã—ã¦ã€æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚©ãƒ«ãƒ€ã®æ§‹é€ ã‚’è¦–è¦šçš„ãªãƒ„ãƒªãƒ¼ãƒ“ãƒ¥ãƒ¼ã¨ã—ã¦è¡¨ç¤ºã™ã‚‹GUIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•ã—ã¾ã™ã€‚
    ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ„ãƒªãƒ¼ã‚’å±•é–‹ãƒ»ç¸®å°ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’ãƒŠãƒ“ã‚²ãƒ¼ãƒˆã§ãã¾ã™ã€‚
    - ãƒ•ã‚©ãƒ«ãƒ€ã¯é’ã„èƒŒæ™¯è‰²ã§ãƒã‚¤ãƒ©ã‚¤ãƒˆã•ã‚Œã¾ã™ã€‚
    - ãƒãƒ¼ãƒ‰ã‚’é¸æŠã™ã‚‹ã¨ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ã«ãã®ã‚¢ã‚¤ãƒ†ãƒ ã®æœ€çµ‚æ›´æ–°æ—¥æ™‚ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
    - ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒ¼ãƒ‰ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€é–¢é€£ä»˜ã‘ã‚‰ã‚ŒãŸãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã¾ã™ã€‚
    - ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼ã«ã‚ˆã‚‹æ“ä½œã‚‚å¯èƒ½ã§ã™:
        - Enterã‚­ãƒ¼: é¸æŠã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€ã¾ãŸã¯ãƒ•ã‚©ãƒ«ãƒ€ã‚’ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ã§é–‹ãã¾ã™ã€‚
        - Ctrl+C: é¸æŠã—ãŸã‚¢ã‚¤ãƒ†ãƒ ã®åå‰ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚
        - Ctrl+Shift+C: é¸æŠã—ãŸã‚¢ã‚¤ãƒ†ãƒ ã®ãƒ•ãƒ«ãƒ‘ã‚¹ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚

.PARAMETER Path
    ãƒ„ãƒªãƒ¼è¡¨ç¤ºã®èµ·ç‚¹ã¨ãªã‚‹ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER WindowSize
    è¡¨ç¤ºã•ã‚Œã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚µã‚¤ã‚ºã‚’ [å¹…, é«˜ã•] ã®å½¢å¼ã§ãƒ”ã‚¯ã‚»ãƒ«å˜ä½ã§æŒ‡å®šã—ã¾ã™ã€‚
    ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ @(600, 450) ã§ã™ã€‚

.PARAMETER FontSize
    ãƒ„ãƒªãƒ¼ãƒ“ãƒ¥ãƒ¼ã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆã®ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’æŒ‡å®šã—ã¾ã™ã€‚
    ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ 9.5 ã§ã™ã€‚

.EXAMPLE
    # ä¾‹ 1: ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ„ãƒªãƒ¼ãƒ“ãƒ¥ãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹
    PS C:\> Out-TreeView -Path .

    # ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ãƒ«ãƒ¼ãƒˆã¨ã—ãŸãƒ„ãƒªãƒ¼ãƒ“ãƒ¥ãƒ¼ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‹ãã¾ã™ã€‚

.EXAMPLE
    # ä¾‹ 2: C:\Windows ã®å†…å®¹ã‚’ã€å¤§ããªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã¨ãƒ•ã‚©ãƒ³ãƒˆã§è¡¨ç¤ºã™ã‚‹
    PS C:\> Out-TreeView -Path 'C:\Windows' -WindowSize @(800, 600) -FontSize 11

    # ã‚«ã‚¹ã‚¿ãƒ ã‚µã‚¤ã‚ºã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ C:\Windows ã®ãƒ„ãƒªãƒ¼ãƒ“ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

.OUTPUTS
    ãªã—
    ã“ã®é–¢æ•°ã¯GUIã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¡¨ç¤ºã—ã€ãã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‰ã˜ã‚‰ã‚Œã‚‹ã¾ã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¾ã™ã€‚PowerShellã®æˆåŠŸã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã—ã¾ã›ã‚“ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯Windows Formsãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ä¾å­˜ã—ã¦ã„ã‚‹ãŸã‚ã€Windows OSç’°å¢ƒã§ã®ã¿å‹•ä½œã—ã¾ã™ã€‚
    - éå¸¸ã«æ·±ã„éšå±¤æ§‹é€ ã‚„è†¨å¤§ãªæ•°ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒã¤ãƒ•ã‚©ãƒ«ãƒ€ã«å¯¾ã—ã¦å®Ÿè¡Œã™ã‚‹ã¨ã€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®åˆæœŸè¡¨ç¤ºã«æ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
    - ã“ã®é–¢æ•°ã¯å¯¾è©±çš„ãªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ (`ShowDialog`) ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã€å®Œå…¨ã«è‡ªå‹•åŒ–ã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã§ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‰ã˜ã‚‰ã‚Œã‚‹ã¾ã§å‡¦ç†ãŒåœæ­¢ã—ã¾ã™ã€‚
#>
Function Out-TreeView {
    param (
        [Parameter(Mandatory=$true)][System.String]$Path,
        [System.Int32[]]$WindowSize = @(600, 450),
        [System.Single]$FontSize = 9.5
    )
    Add-Type -AssemblyName System.Windows.Forms
    Add-Type -AssemblyName System.Drawing
    
    # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯å‡¦ç†ä¸­æ–­
    if (-not (Test-Path -Path $Path)) {
        Write-Warning "æŒ‡å®šã•ã‚ŒãŸãƒ‘ã‚¹ã¯å­˜åœ¨ã—ã¾ã›ã‚“: $Path"
        return
    }

    # å†…éƒ¨é–¢æ•°ï¼šãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®ãƒ„ãƒªãƒ¼æ§‹é€ ã‚’å–å¾—ã™ã‚‹é–¢æ•°
    Function Get-FolderTree {
        param (
            [System.String]$Path,
            [Windows.Forms.TreeNode]$ParentNode
        )
        $items = (Get-ChildItem -Path $Path)
        foreach ($item in $items) {
            $node = New-Object Windows.Forms.TreeNode
            $node.Text = $item.Name
            $node.Tag = $item.FullName
            if ($item.PSIsContainer) {
                $node.BackColor = [System.Drawing.Color]::DarkBlue
                $node.ForeColor = [System.Drawing.Color]::AliceBlue
                Get-FolderTree -Path $item.FullName -ParentNode $node
            } else {
                $node.ForeColor = [System.Drawing.Color]::Black
            }
            $ParentNode.Nodes.Add($node) > $null
        }
    }

    # ãƒ•ã‚©ãƒ¼ãƒ ã®ä½œæˆ
    $mainForm = New-Object Windows.Forms.Form
    $mainForm.Text = "$($Path) - $($MyInvocation.MyCommand.Name)"
    $mainForm.Size = New-Object Drawing.Size($WindowSize[0], $WindowSize[1])
    $mainForm.Icon = [System.Drawing.SystemIcons]::Information
    
    # ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ã®ä½œæˆ
    # PowerShell 7ã ã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ãŒå‹•ä½œã—ãªã„ãŸã‚å¤‰æ›´
    #$statusBar = New-Object Windows.Forms.StatusBar
    #$mainForm.Controls.Add($statusBar)
    $toolStrip = New-Object System.Windows.Forms.ToolStrip
    $statusLabel = New-Object System.Windows.Forms.ToolStripStatusLabel
    $toolStrip.Items.Add($statusLabel) | Out-Null
    $mainForm.Controls.Add($toolStrip)

    # ãƒ„ãƒªãƒ¼ãƒ“ãƒ¥ãƒ¼ã®ä½œæˆ
    $treeView = New-Object Windows.Forms.TreeView
    [System.Int32]$witdhSize = [System.Int32]$WindowSize[0] * 0.957
    [System.Int32]$heightSize = [System.Int32]$WindowSize[1] * 0.845
    $treeView.Size = New-Object Drawing.Size($witdhSize, $heightSize)
    # PowerShell 7ã ã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ãŒå‹•ä½œã—ãªã„ãŸã‚å¤‰æ›´
    #$treeView.Location = New-Object Drawing.Point(5, 5)
    $treeView.Location = New-Object Drawing.Point(5, 25)
    $treeView.Anchor = `
    [System.Windows.Forms.AnchorStyles]::Top -bor `
    [System.Windows.Forms.AnchorStyles]::Bottom -bor `
    [System.Windows.Forms.AnchorStyles]::Left -bor `
    [System.Windows.Forms.AnchorStyles]::Right
    $treeView.Font = New-Object System.Drawing.Font("Microsoft Sans Serif", $FontSize)

    # ãƒ«ãƒ¼ãƒˆãƒãƒ¼ãƒ‰ã®ä½œæˆ
    $root = New-Object Windows.Forms.TreeNode
    $root.Text = $Path
    $root.Tag = $Path
    $root.BackColor = [System.Drawing.Color]::DarkBlue
    $root.ForeColor = [System.Drawing.Color]::AliceBlue
    $treeView.Nodes.Add($root) > $null

    # ãƒ„ãƒªãƒ¼æ§‹é€ ã®å–å¾—
    Get-FolderTree -Path $root.Tag -ParentNode $root

    # ãƒãƒ¼ãƒ‰é¸æŠã‚¤ãƒ™ãƒ³ãƒˆã®è¨­å®š
    $treeView.add_AfterSelect({
        param ($sender, $e)
        $item = Get-Item -Path $e.Node.Tag
        # PowerShell 7ã ã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ãŒå‹•ä½œã—ãªã„ãŸã‚å¤‰æ›´
        #$statusBar.Text = "$($item.Name) - Last Modified: $($item.LastWriteTime)"
        $statusLabel.Text = "$($item.Name) - Last Modified: $($item.LastWriteTime)"
    })

    # ãƒãƒ¼ãƒ‰ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã®è¨­å®š
    $treeView.add_NodeMouseDoubleClick({
        param ($sender, $e)
        $item = Get-Item -Path $e.Node.Tag
        if (-not ($item.PSIsContainer)) {
            Invoke-Item -Path $item.FullName
        }
    })
    
    # ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼
    $treeView.add_KeyDown({
        param ($sender, $e)
        # Enterã‚­ãƒ¼ãŒæŠ¼ã•ã‚ŒãŸå ´åˆ
        if ($e.KeyCode -eq [System.Windows.Forms.Keys]::Enter) {
            $selectedNode = $treeView.SelectedNode
            if ($selectedNode -ne $null) {
                $item = Get-Item -Path $selectedNode.Tag
                if ($item.PSIsContainer) {
                    Start-Process explorer.exe -ArgumentList $item.FullName
                } else {
                    Invoke-Item -Path $item.FullName
                }
            }
        }
        # Ctrl + Shift + Cï¼šãƒãƒ¼ãƒ‰åã®çµ¶å¯¾ãƒ‘ã‚¹ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
        elseif ($e.Control -and $e.Shift -and $e.KeyCode -eq [System.Windows.Forms.Keys]::C) {
            $selectedNode = $treeView.SelectedNode
            if ($selectedNode -ne $null) {
                [System.Windows.Forms.Clipboard]::SetText($selectedNode.Tag)
            }
        }
        # Ctrl + Cï¼šãƒãƒ¼ãƒ‰åã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
        elseif ($e.Control -and $e.KeyCode -eq [System.Windows.Forms.Keys]::C) {
            $selectedNode = $treeView.SelectedNode
            if ($selectedNode -ne $null) {
                [System.Windows.Forms.Clipboard]::SetText($selectedNode.Text)
            }
        }
    })

    # ãƒ•ã‚©ãƒ¼ãƒ ã«ãƒ„ãƒªãƒ¼ãƒ“ãƒ¥ãƒ¼ã‚’è¿½åŠ 
    $mainForm.Controls.Add($treeView)

    # ãƒ•ã‚©ãƒ¼ãƒ ã®è¡¨ç¤º
    $mainForm.Add_Shown({$mainForm.Activate()})
    $mainForm.ShowDialog() > $null
}
```

#### \[PowerShell\]Markdownã®ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã§å„åˆ—ã®é–‹å§‹ä½ç½®ã‚’åˆã‚ã›æ•´å½¢ã™ã‚‹Function

2025.7.15 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/3ec6a82c4a095d

ã“ã“ã®Functionã§ã¯ã€å…ˆã«ç´¹ä»‹ã—ãŸã€Œ`Check-BOMStatus`ã€ã‚’å‚è€ƒã«ä½œæˆã—ãŸã€Œ`Test-UTF8Bom`ã€ã‚’å‘¼ã³å‡ºã—ã¦ã„ã¾ã™ã€‚

```powershell:
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒUTF-8 BOMï¼ˆãƒã‚¤ãƒˆã‚ªãƒ¼ãƒ€ãƒ¼ãƒãƒ¼ã‚¯ï¼‰ã‚’æŒã¤ã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€FilePath ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­3ãƒã‚¤ãƒˆã‚’èª­ã¿è¾¼ã¿ã€ãã‚ŒãŒUTF-8ã®BOMï¼ˆãƒã‚¤ãƒˆã‚·ãƒ¼ã‚±ãƒ³ã‚¹ 0xEF, 0xBB, 0xBFï¼‰ã¨ä¸€è‡´ã™ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚
    ãƒ•ã‚¡ã‚¤ãƒ«ãŒUTF-8 BOMã§å§‹ã¾ã£ã¦ã„ã‚‹å ´åˆã«ã®ã¿ $true ã‚’è¿”ã—ã¾ã™ã€‚

.PARAMETER FilePath
    åˆ¤å®šå¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    # --- æº–å‚™ï¼šBOMä»˜ãã¨BOMãªã—ã®UTF-8ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ ---
    # PS C:\> Set-Content -Path .\bom.txt -Value "BOMã‚ã‚Š" -Encoding UTF8
    # PS C:\> Set-Content -Path .\nobom.txt -Value "BOMãªã—" -Encoding UTF8NoBOM

    # BOMä»˜ããƒ•ã‚¡ã‚¤ãƒ«ã§å®Ÿè¡Œã—ãŸå ´åˆ
    PS C:\> Test-UTF8Bom -FilePath .\bom.txt
    True

    # BOMãªã—ãƒ•ã‚¡ã‚¤ãƒ«ã§å®Ÿè¡Œã—ãŸå ´åˆ
    PS C:\> Test-UTF8Bom -FilePath .\nobom.txt
    False

.OUTPUTS
    System.Boolean
    ãƒ•ã‚¡ã‚¤ãƒ«ãŒUTF-8 BOMã‚’æŒã¤å ´åˆã¯ `$true` ã‚’ã€ãã†ã§ãªã„å ´åˆã¯ `$false` ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­3ãƒã‚¤ãƒˆã®ã¿ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚„UTF-8ä»¥å¤–ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«ã¤ã„ã¦ã¯è€ƒæ…®ã—ã¾ã›ã‚“ã€‚
    - ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„ã€ã¾ãŸã¯èª­ã¿å–ã‚Šã‚¢ã‚¯ã‚»ã‚¹æ¨©ãŒãªã„å ´åˆã€ã“ã®é–¢æ•°ã¯ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã—ã¾ã™ã€‚å‘¼ã³å‡ºã—å´ã§ `Test-Path` ã‚„ `try-catch` ã‚’ä½¿ç”¨ã—ã¦å¯¾å‡¦ã™ã‚‹ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚
    - ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒ3ãƒã‚¤ãƒˆæœªæº€ã®å ´åˆã§ã‚‚ã€ã“ã®é–¢æ•°ã¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãšã«æ­£ã—ã `$false` ã‚’è¿”ã—ã¾ã™ã€‚

.LINKS
    https://zenn.dev/haretokidoki/articles/962a7fc6c51b47
#>
Function Test-UTF8Bom {
    param (
        [Parameter(Mandatory=$true)][System.String]$FilePath
    )
    
    # BOMã®ãƒã‚¤ãƒˆã‚·ãƒ¼ã‚±ãƒ³ã‚¹
    $UTF8_BOM = [System.Byte[]](0xEF, 0xBB, 0xBF)
    
    # ãƒã‚¤ãƒˆãƒ‡ãƒ¼ã‚¿ã§èª­ã¿è¾¼ã¿
    $fileBytes = [System.IO.File]::ReadAllBytes($FilePath)
    # å…ˆé ­ã‹ã‚‰3ãƒã‚¤ãƒˆåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã§BOMä»˜ãã‹åˆ¤å®š
    if ($fileBytes[0..2] -join "," -eq $UTF8_BOM -join ",") {
        return $true
    } else {
        return $false
    }
}
```

ä¸‹è¨˜ãŒãƒ¡ã‚¤ãƒ³ã®Functionã§ã™ã€‚

```powershell:Markdownãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®åˆ—å¹…ã‚’ã€å†…å®¹ã«å¿œã˜ã¦è‡ªå‹•çš„ã«æ•´å½¢
<#
.SYNOPSIS
    Markdownãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®åˆ—å¹…ã‚’ã€å†…å®¹ã«å¿œã˜ã¦è‡ªå‹•çš„ã«æ•´å½¢ã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€æŒ‡å®šã•ã‚ŒãŸMarkdownãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€å„åˆ—ã®è¡¨ç¤ºå¹…ã‚’æƒãˆã¦è¦‹ãŸç›®ã‚’æ•´ãˆã¾ã™ã€‚
    å†…éƒ¨ã§ãƒãƒ«ãƒãƒã‚¤ãƒˆæ–‡å­—ï¼ˆä¾‹: æ—¥æœ¬èªï¼‰ã‚’2æ–‡å­—åˆ†ã€ã‚·ãƒ³ã‚°ãƒ«ãƒã‚¤ãƒˆæ–‡å­—ï¼ˆä¾‹: è‹±æ•°å­—ï¼‰ã‚’1æ–‡å­—åˆ†ã¨ã—ã¦å„ã‚»ãƒ«ã®è¡¨ç¤ºå¹…ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
    ãã—ã¦ã€å„åˆ—ã§æœ€ã‚‚å¹…ã®åºƒã„ã‚»ãƒ«ã«åˆã‚ã›ã¦ã€ä»–ã®ã‚»ãƒ«ã«åŠè§’ã‚¹ãƒšãƒ¼ã‚¹ã‚’è¿½åŠ ï¼ˆãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ï¼‰ã—ã€æ•´å½¢ã•ã‚ŒãŸãƒ†ãƒ¼ãƒ–ãƒ«å…¨ä½“ã®æ–‡å­—åˆ—ã‚’è¿”ã—ã¾ã™ã€‚
    ã“ã®å‡¦ç†ã«ã‚ˆã‚Šã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚„ã‚¨ãƒ‡ã‚£ã‚¿ã§ãƒ†ãƒ¼ãƒ–ãƒ«ãŒç¶ºéº—ã«æ•´åˆ—ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

.PARAMETER FilePath
    æ•´å½¢ã—ãŸã„Markdownãƒ†ãƒ¼ãƒ–ãƒ«ãŒå«ã¾ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚

.EXAMPLE
    # --- æº–å‚™ï¼šæ•´å½¢å‰ã®Markdownãƒ•ã‚¡ã‚¤ãƒ« (table.md) ---
    # | Name | Language | Type |
    # |---|---|---|
    # | PowerShell | C# | Script |
    # | Python | C | Script |
    # | æ—¥æœ¬èª | - | å…¨è§’æ–‡å­— |

    PS C:\> $formattedTable = Format-MarkdownTableColumnWidth -FilePath .\table.md
    PS C:\> $formattedTable | Out-File -FilePath .\formatted_table.md -Encoding UTF8

    # formatted_table.md ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æ•´å½¢ã•ã‚ŒãŸãƒ†ãƒ¼ãƒ–ãƒ«ãŒä¿å­˜ã•ã‚Œã‚‹
    #
    # --- formatted_table.md ã®å†…å®¹ ---
    # | Name       | Language | Type      |
    # |------------|----------|-----------|
    # | PowerShell | C#       | Script    |
    # | Python     | C        | Script    |
    # | æ—¥æœ¬èª     | -        | å…¨è§’æ–‡å­—  |

.OUTPUTS
    System.String
    æ•´å½¢ã•ã‚ŒãŸMarkdownãƒ†ãƒ¼ãƒ–ãƒ«å…¨ä½“ã‚’å«ã‚€å˜ä¸€ã®æ–‡å­—åˆ—ã‚’è¿”ã—ã¾ã™ã€‚
    å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ãŒUTF-8 BOMã§ãªã„å ´åˆã‚„ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã¯ $null ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯ã€`Test-UTF8Bom` ã¨ã„ã†åˆ¥ã®ã‚«ã‚¹ã‚¿ãƒ é–¢æ•°ãŒåŒã˜ã‚¹ã‚³ãƒ¼ãƒ—å†…ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚
    - å‡¦ç†å¯¾è±¡ã¯UTF-8 BOMä»˜ãã®ãƒ•ã‚¡ã‚¤ãƒ«ã«é™å®šã•ã‚Œã¾ã™ã€‚BOMãŒãªã„ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´åˆã€è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œå‡¦ç†ã¯å®Ÿè¡Œã•ã‚Œã¾ã›ã‚“ã€‚
    - ãƒ•ã‚¡ã‚¤ãƒ«å…¨ä½“ã‚’ãƒ¡ãƒ¢ãƒªã«èª­ã¿è¾¼ã‚“ã§å‡¦ç†ã™ã‚‹ãŸã‚ã€éå¸¸ã«å·¨å¤§ãªãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã—ã¦ä½¿ç”¨ã™ã‚‹éš›ã¯ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚
#>
Function Format-MarkdownTableColumnWidth {
    param (
        [System.String]$FilePath
    )

    # æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®åˆ¤å®š
    if (-not (Test-UTF8Bom $FilePath)) {
        Write-Warning 'Not UTF8 BOM'
        return $null
    }

    # ãƒãƒ«ãƒãƒã‚¤ãƒˆæ–‡å­—ã‚’è€ƒæ…®ã—ã¦æ–‡å­—åˆ—ã®ãƒã‚¤ãƒˆæ•°ã‚’è¨ˆç®—ã™ã‚‹é–¢æ•°
    Function Get-DisplayWidth {
        param (
            [string]$InputString
        )
        $width = 0

        foreach ($char in $InputString.ToCharArray()) {
            if ([System.Text.Encoding]::UTF8.GetByteCount($char) -gt 1) {
                # ãƒãƒ«ãƒãƒã‚¤ãƒˆæ–‡å­—ã®å ´åˆã¯2æ–‡å­—åˆ†ã¨ã—ã¦ã‚«ã‚¦ãƒ³ãƒˆ
                $width += 2
            } else {
                # ã‚·ãƒ³ã‚°ãƒ«ãƒã‚¤ãƒˆæ–‡å­—ã®å ´åˆã¯1æ–‡å­—åˆ†ã¨ã—ã¦ã‚«ã‚¦ãƒ³ãƒˆ
                $width += 1
            }
        }

        return $width
    }


    # ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å…¥åŠ›ã‚’èª­ã¿è¾¼ã‚€
    $MarkdownTable = (Get-Content -Path $FilePath -Raw)

    # å…¥åŠ›ã‚’è¡Œã”ã¨ã«åˆ†å‰²
    $lines = $MarkdownTable -split "`n"

    # å„åˆ—ã®æœ€å¤§å¹…ã‚’è¨ˆç®—
    $maxWidths = @{}
    foreach ($line in $lines) {
        if (-not ([System.String]::IsNullOrWhiteSpace($line))) {
            $columns = $line -split '\|'
            for ($i = 1; $i -lt $columns.Length - 1; $i++) {
                $column = $columns[$i].Trim()
                $byteLength = (Get-DisplayWidth $column)
                if (-not $maxWidths.ContainsKey($i)) {
                    $maxWidths[$i] = $byteLength
                } else {
                    if ($byteLength -gt $maxWidths[$i]) {
                        $maxWidths[$i] = $byteLength
                    }
                }
            }
        }
    }

    # åˆ—ã®å¹…ã‚’æƒãˆã¦å†æ§‹ç¯‰
    $alignedTable = @()
    foreach ($line in $lines) {
        if (-not ([System.String]::IsNullOrWhiteSpace($line))) {
            $columns = $line -split '\|'
            $newLine = '|'
            for ($i = 1; $i -lt $columns.Length - 1; $i++) {
                $column = $columns[$i].Trim()
                $padding = " " * ($maxWidths[$i] - (Get-DisplayWidth $column))
                $newLine += " " + $column + $padding + ' |'
            }
            $alignedTable += $newLine
        }
    }

    return $alignedTable -join "`r`n"
}
```

#### \[PowerShell\]PSCustomObjectã§åŒã˜è¦ç´ ï¼ˆé …ç›®æ•°ãƒ»é …ç›®åï¼‰ã‹æ¯”è¼ƒã™ã‚‹Function

2025.7.15 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/0d506a78164933

ä¸‹è¨˜ã¯ã‚µãƒ–ã®Functionã§ã™ã€‚

```powershell:æŒ‡å®šã•ã‚ŒãŸé…åˆ—ã®ã™ã¹ã¦ã®è¦ç´ ãŒ [PSCustomObject] å‹ã§ã‚ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤å®š
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸé…åˆ—ã®ã™ã¹ã¦ã®è¦ç´ ãŒ [PSCustomObject] å‹ã§ã‚ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€Argument ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§å—ã‘å–ã£ãŸé…åˆ—å†…ã®å„è¦ç´ ã‚’é †ç•ªã«ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚
    ã™ã¹ã¦ã®è¦ç´ ãŒ [System.Management.Automation.PSCustomObject] å‹ã§ã‚ã‚Œã° $true ã‚’è¿”ã—ã¾ã™ã€‚
    ä¸€ã¤ã§ã‚‚ç•°ãªã‚‹å‹ã®è¦ç´ ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã€ãã®æ™‚ç‚¹ã§ãƒã‚§ãƒƒã‚¯ã‚’ä¸­æ–­ã—ã€$false ã‚’è¿”ã—ã¾ã™ã€‚
    ã“ã‚Œã¯ã€`Test-PSCustomObjectEquality` ã®ã‚ˆã†ãªã€ç‰¹å®šã®å‹ã‚’å‰æã¨ã™ã‚‹é–¢æ•°ã®ãŸã‚ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚

.PARAMETER Argument
    åˆ¤å®šå¯¾è±¡ã¨ãªã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é…åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    # ä¾‹ 1: ã™ã¹ã¦ã®è¦ç´ ãŒ PSCustomObject ã®å ´åˆ
    PS C:\> $array1 = @([pscustomobject]@{A=1}, [pscustomobject]@{B=2})
    PS C:\> Test-IsPSCustomObject -Argument $array1
    True

    # ä¾‹ 2: ä»–ã®å‹ãŒæ··åœ¨ã—ã¦ã„ã‚‹å ´åˆ
    PS C:\> $array2 = @([pscustomobject]@{A=1}, "string", 123)
    PS C:\> Test-IsPSCustomObject -Argument $array2
    False

.OUTPUTS
    System.Boolean
    ã™ã¹ã¦ã®è¦ç´ ãŒ [PSCustomObject] ã§ã‚ã‚Œã° `$true` ã‚’ã€ä¸€ã¤ã§ã‚‚ãã†ã§ãªã‘ã‚Œã° `$false` ã‚’è¿”ã—ã¾ã™ã€‚
#>
Function Test-IsPSCustomObject {
    param(
        [Parameter(Mandatory=$true)]
        [System.Object[]]$Argument
    )

    foreach ($arg in $Argument) {
        if (-not ($arg -is [System.Management.Automation.PSCustomObject])) {
            return $false
        }
    }
    return $true
}
```

ä¸‹è¨˜ãŒãƒ¡ã‚¤ãƒ³ã®Functionã¨ãªã‚Šã¾ã™ã€‚

```powershell:2ã¤ã® PSCustomObject é…åˆ—ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ§‹é€ ãŒåŒä¸€ã§ã‚ã‚‹ã‹ã‚’ç¢ºèª
<#
.SYNOPSIS
    2ã¤ã® PSCustomObject é…åˆ—ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ§‹é€ ï¼ˆé …ç›®åã¨é †åºï¼‰ãŒåŒä¸€ã§ã‚ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€2ã¤ã® PSCustomObject é…åˆ—ã®æ§‹é€ çš„ãªç­‰ä¾¡æ€§ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚
    å…·ä½“çš„ã«ã¯ã€å„é…åˆ—ã®æœ€åˆã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæŒã¤ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®åå‰ã¨é †åºã‚’æ¯”è¼ƒã—ã¾ã™ã€‚
    ä¸¡æ–¹ã®é…åˆ—ãŒç©ºã§ãªãã€ã™ã¹ã¦ã®è¦ç´ ãŒ PSCustomObject å‹ã§ã‚ã‚Šã€ã‹ã¤ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ§‹é€ ãŒå®Œå…¨ã«ä¸€è‡´ã™ã‚‹å ´åˆã«ã®ã¿ $true ã‚’è¿”ã—ã¾ã™ã€‚
    ã“ã®é–¢æ•°ã¯ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å«ã¾ã‚Œã‚‹ã€Œå€¤ã€ã‚„ã€é…åˆ—ã®ã€Œè¦ç´ æ•°ã€ã¯æ¯”è¼ƒã—ã¾ã›ã‚“ã€‚

.PARAMETER Object1
    æ¯”è¼ƒå…ƒã¨ãªã‚‹ PSCustomObject ã®é…åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER Object2
    æ¯”è¼ƒå…ˆã¨ãªã‚‹ PSCustomObject ã®é…åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.EXAMPLE
    # --- æº–å‚™ ---
    $objA = @(
        [pscustomobject]@{ Name = "Apple";  Color = "Red" },
        [pscustomobject]@{ Name = "Banana"; Color = "Yellow" }
    )
    $objB = @(
        [pscustomobject]@{ Name = "Grape"; Color = "Purple" }
    ) # æ§‹é€ ã¯åŒã˜
    $objC = @(
        [pscustomobject]@{ Color = "Red"; Name = "Apple" }
    ) # ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®é †åºãŒé•ã†

    # ä¾‹ 1: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ§‹é€ ãŒä¸€è‡´ã™ã‚‹å ´åˆ
    PS C:\> Test-PSCustomObjectEquality -Object1 $objA -Object2 $objB
    True

    # ä¾‹ 2: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®é †åºãŒç•°ãªã‚‹å ´åˆ
    PS C:\> Test-PSCustomObjectEquality -Object1 $objA -Object2 $objC
    WARNING: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒå£«ã®é …ç›®ãŒä¸€è‡´ã—ã¦ã„ã¾ã›ã‚“ã€‚
    False

.OUTPUTS
    System.Boolean
    ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ§‹é€ ãŒä¸€è‡´ã™ã‚‹å ´åˆã¯ `$true` ã‚’ã€ãã†ã§ãªã„å ´åˆã¯ `$false` ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯ `Test-IsPSCustomObject` ã¨ã„ã†åˆ¥ã®ã‚«ã‚¹ã‚¿ãƒ é–¢æ•°ãŒåŒã˜ã‚¹ã‚³ãƒ¼ãƒ—å†…ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚
    - ã“ã®é–¢æ•°ã¯ã€å„é…åˆ—ã®ã€Œæœ€åˆã®è¦ç´ ã€(`[0]`) ã®ã¿ã‚’åŸºæº–ã«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ§‹é€ ã‚’æ¯”è¼ƒã—ã¾ã™ã€‚
    - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€é…åˆ—ã®ãƒ‡ãƒ¼ã‚¿ä»¶æ•°ï¼ˆè¦ç´ æ•°ï¼‰ã¯æ¯”è¼ƒã®å¯¾è±¡å¤–ã§ã™ï¼ˆã‚³ãƒ¼ãƒ‰å†…ã§ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã•ã‚Œã¦ã„ã¾ã™ï¼‰ã€‚
#>
Function Test-PSCustomObjectEquality {
    param (
        [Parameter(Mandatory=$true)][System.Object[]]$Object1,
        [Parameter(Mandatory=$true)][System.Object[]]$Object2
    )

    # ãƒ‡ãƒ¼ã‚¿å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    if (($Object1.Count -eq 0) -or ($Object2.Count -eq 0)) {
        Write-Warning "ã„ãšã‚Œã‹å¼•æ•°ã®ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚[å¼•æ•°1ã®ä»¶æ•°: $($Object1.Count), å¼•æ•°2ã®ä»¶æ•°: $($Object2.Count)]"
        return $false
    }

    # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†…ãŒPSCustomObjectã§ã‚ã‚‹ã‹åˆ¤å®š
    if (-not (Test-IsPSCustomObject $Object1)) {
        Write-Warning 'å¼•æ•°ã®ã€ŒObject1ã€ãŒPSCustomObjectã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚'
        return $false
    }
    elseif (-not (Test-IsPSCustomObject $Object2)) {
        Write-Warning 'å¼•æ•°ã®ã€ŒObject2ã€ãŒPSCustomObjectã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚'
        return $false
    }

    # é …ç›®åã¨é …ç›®æ•°ã‚’æ¯”è¼ƒ
    $object1ColumnData = $Object1[0].psobject.properties | ForEach-Object { $_.Name }
    $object2ColumnData = $Object2[0].psobject.properties | ForEach-Object { $_.Name }
    $compareResult = (Compare-Object $object1ColumnData $object2ColumnData -SyncWindow 0)
    if (($null -ne $compareResult) -and ($compareResult.Count -ne 0)) {
        Write-Warning "ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒå£«ã®é …ç›®ãŒä¸€è‡´ã—ã¦ã„ã¾ã›ã‚“ã€‚"
        return $false
    }

    # # ãƒ‡ãƒ¼ã‚¿ä»¶æ•°ã‚’æ¯”è¼ƒï¼ˆãƒã‚§ãƒƒã‚¯ã™ã‚‹å ´åˆã¯ã€ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆè§£é™¤ï¼‰
    # if ($Object1.Count -ne $Object2.Count) {
    #     Write-Warning "ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†…ã®ãƒ‡ãƒ¼ã‚¿ä»¶æ•°ãŒä¸€è‡´ã—ã¾ã›ã‚“ã€‚[å¼•æ•°1ã®ä»¶æ•°: $($Object1.Count), å¼•æ•°2ã®ä»¶æ•°: $($Object2.Count)]"
    #     return $false
    # }

    # æ¯”è¼ƒã—ãŸçµæœ2ã¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒä¸€è‡´
    return $true
}
```

#### \[PowerShell\]UNIXã®whichã‚³ãƒãƒ³ãƒ‰ã®ã‚ˆã†ã«å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã®æ ¼ç´å…ˆã‚’ç¢ºèªã™ã‚‹æ–¹æ³•

2025.7.15 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/1ab139ed9ea72d

```powershell:æŒ‡å®šã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ã®ã‚½ãƒ¼ã‚¹ï¼ˆãƒ‘ã‚¹ã‚„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åï¼‰ã‚’å–å¾—
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ã®ã‚½ãƒ¼ã‚¹ï¼ˆãƒ‘ã‚¹ã‚„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åï¼‰ã‚’å–å¾—ã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€Linux/Unixã® `which` ã‚³ãƒãƒ³ãƒ‰ã®ã‚ˆã†ã«ã€æŒ‡å®šã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ã®ã‚½ãƒ¼ã‚¹ï¼ˆé€šå¸¸ã¯å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ•ãƒ«ãƒ‘ã‚¹ã‚„ã€ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆãŒå±ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åï¼‰ã‚’ç‰¹å®šã—ã¾ã™ã€‚
    å†…éƒ¨ã§ `Get-Command` ã‚’ä½¿ç”¨ã—ã€è¦‹ã¤ã‹ã£ãŸã‚³ãƒãƒ³ãƒ‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã® `Source` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿”ã—ã¾ã™ã€‚
    ã‚³ãƒãƒ³ãƒ‰ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ã€è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

.PARAMETER CommandName
    ã‚½ãƒ¼ã‚¹ã‚’æ¤œç´¢ã—ãŸã„ã‚³ãƒãƒ³ãƒ‰ã®åå‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚

.EXAMPLE
    # ä¾‹ 1: å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æ¤œç´¢ã™ã‚‹
    PS C:\> which -CommandName 'notepad.exe'
    C:\Windows\System32\notepad.exe

    # ä¾‹ 2: PowerShellã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆãŒå±ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ¤œç´¢ã™ã‚‹
    PS C:\> which -CommandName 'Get-ChildItem'
    Microsoft.PowerShell.Management

    # ä¾‹ 3: å­˜åœ¨ã—ãªã„ã‚³ãƒãƒ³ãƒ‰ã‚’æŒ‡å®šã—ãŸå ´åˆ
    PS C:\> which -CommandName 'nonexistent-command'
    WARNING: è©²å½“ã®ã‚³ãƒãƒ³ãƒ‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚[æŒ‡å®šã—ãŸã‚³ãƒãƒ³ãƒ‰å: nonexistent-command]

.OUTPUTS
    System.String
    ã‚³ãƒãƒ³ãƒ‰ã®ã‚½ãƒ¼ã‚¹ãƒ‘ã‚¹ã¾ãŸã¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã‚’å«ã‚€æ–‡å­—åˆ—ã‚’è¿”ã—ã¾ã™ã€‚ã‚³ãƒãƒ³ãƒ‰ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ä½•ã‚‚è¿”ã—ã¾ã›ã‚“ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯ `which` ã¨ã„ã†åå‰ã§ã™ãŒã€PowerShellã® `Get-Command` ã«åŸºã¥ã„ã¦å‹•ä½œã™ã‚‹ãŸã‚ã€ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚„é–¢æ•°ãªã©ã‚‚æ¤œç´¢å¯¾è±¡ã¨ãªã‚Šã€Unixã® `which` ã¨ã¯æŒ™å‹•ãŒç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
#>
Function which {
    param (
        [System.String]$CommandName
    )
    $commandData = (Get-Command -Name $CommandName -ErrorAction SilentlyContinue)

    if ($null -eq $commandData) {
        Write-Warning "è©²å½“ã®ã‚³ãƒãƒ³ãƒ‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚[æŒ‡å®šã—ãŸã‚³ãƒãƒ³ãƒ‰å: $($CommandName)]"
        return
    }

    return $commandData.Source
}
```

#### \[PowerShell\]ã‚³ãƒãƒ³ãƒ‰å‡ºåŠ›çµæœã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’ä¸Šã’ã¦å°‘ã—è¦‹ã‚„ã™ãã™ã‚‹Function

2025.7.15 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/0dfc7c1307e908

```powershell:æŒ‡å®šã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„æ–‡å­—åˆ—ã‚’ã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’ä»˜ã‘ã¦ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„æ–‡å­—åˆ—ã‚’ã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’ä»˜ã‘ã¦ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‹ã‚‰å—ã‘å–ã£ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„ç›´æ¥æŒ‡å®šã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã€æ•´å½¢ã•ã‚ŒãŸã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆä»˜ãã®æ–‡å­—åˆ—ã¨ã—ã¦å‡ºåŠ›ã—ã¾ã™ã€‚
    ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ `Out-String` ã‚’ä½¿ã£ã¦æ–‡å­—åˆ—ã«å¤‰æ›ã•ã‚ŒãŸå¾Œã€å„è¡Œã®å…ˆé ­ã«æŒ‡å®šã•ã‚ŒãŸãƒ¬ãƒ™ãƒ«ã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆï¼ˆ1ãƒ¬ãƒ™ãƒ«ã‚ãŸã‚ŠåŠè§’ã‚¹ãƒšãƒ¼ã‚¹4ã¤ï¼‰ãŒä»˜åŠ ã•ã‚Œã¾ã™ã€‚
    æ–‡å­—åˆ—ãŒç›´æ¥æ¸¡ã•ã‚ŒãŸå ´åˆã‚‚åŒæ§˜ã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚
    ç©ºè¡Œã‚„ç©ºç™½ã®ã¿ã®è¡Œã¯å‡ºåŠ›ã‹ã‚‰é™¤å¤–ã•ã‚Œã¾ã™ã€‚
    ã“ã®é–¢æ•°ã¯ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å‡ºåŠ›çµæœã‚’éšå±¤çš„ã«è¦‹ã‚„ã™ãè¡¨ç¤ºã—ãŸã„å ´åˆã«ä¾¿åˆ©ã§ã™ã€‚

.PARAMETER InputObject
    ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’ä»˜ã‘ã¦å‡ºåŠ›ã—ãŸã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æŒ‡å®šã—ã¾ã™ã€‚
    ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å…¥åŠ›ã‚’å—ã‘ä»˜ã‘ã¾ã™ã€‚å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã™ã€‚

.PARAMETER IndentCount
    ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã®ãƒ¬ãƒ™ãƒ«ã‚’æ•´æ•°ã§æŒ‡å®šã—ã¾ã™ã€‚1ã‚’æŒ‡å®šã™ã‚‹ã¨ã‚¹ãƒšãƒ¼ã‚¹4ã¤ã€2ã‚’æŒ‡å®šã™ã‚‹ã¨ã‚¹ãƒšãƒ¼ã‚¹8ã¤ã®ã‚ˆã†ã«ã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒæ·±ããªã‚Šã¾ã™ã€‚
    ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯ 1 ã§ã™ã€‚

.EXAMPLE
    # ä¾‹ 1: æ–‡å­—åˆ—é…åˆ—ã‚’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§æ¸¡ã—ã¦ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’ä»˜ã‘ã‚‹
    PS C:\> "Line 1", "Line 2" | Write-IndentedOutput

    # å®Ÿè¡Œçµæœ:
    #     Line 1
    #     Line 2

.EXAMPLE
    # ä¾‹ 2: Get-Process ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®çµæœã‚’ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ¬ãƒ™ãƒ«2ã§è¡¨ç¤ºã™ã‚‹
    PS C:\> Get-Process pwsh | Write-IndentedOutput -IndentCount 2

    # å®Ÿè¡Œçµæœ (pwshãƒ—ãƒ­ã‚»ã‚¹ã®æƒ…å ±ãŒã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã•ã‚Œã¦è¡¨ç¤ºã•ã‚Œã‚‹):
    #         Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName
    #         -------  ------    -----      -----     ------     --  -- -----------
    #             980      73   132180     154036      13.27  12345   1 pwsh

.EXAMPLE
    # ä¾‹ 3: Get-Date ã®çµæœã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã§è¡¨ç¤ºã™ã‚‹
    PS C:\> Get-Date | Write-IndentedOutput
    
    # å®Ÿè¡Œçµæœ:
    #     2024å¹´5æœˆ17æ—¥é‡‘æ›œæ—¥ 15:30:00

.INPUTS
    System.Object
    ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³çµŒç”±ã§ä»»æ„ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å—ã‘å–ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

.OUTPUTS
    System.String
    ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒä»˜åŠ ã•ã‚ŒãŸæ–‡å­—åˆ—ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚

.NOTES
    - ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ–‡å­—åˆ—ã«å¤‰æ›ã™ã‚‹éš›ã€å†…éƒ¨ã§ `Out-String` ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ãã®ãŸã‚ã€å‡ºåŠ›å½¢å¼ã¯ `Out-String` ã®æŒ™å‹•ã«ä¾å­˜ã—ã¾ã™ã€‚
    - å‡ºåŠ›ã‹ã‚‰ç©ºè¡Œã‚„ç©ºç™½æ–‡å­—ã®ã¿ã®è¡Œã¯å–ã‚Šé™¤ã‹ã‚Œã¾ã™ã€‚
#>
function Write-IndentedOutput {
    [CmdletBinding()]
    param (
        # ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¾ãŸã¯ç›´æ¥æ¸¡ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
        [Parameter(Mandatory = $true, ValueFromPipeline = $true)]
        [System.Object]$InputObject,
        
        # ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã«ä½¿ç”¨ã™ã‚‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ•° â€»ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯1ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆï¼ˆ1ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆ = åŠè§’ã‚¹ãƒšãƒ¼ã‚¹4ã¤åˆ†ï¼‰
        [Parameter(Mandatory = $false)]
        [System.Int32]$IndentCount = 1
    )

    begin {
        # ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆæ–‡å­—åˆ—ã‚’ä½œæˆ
        $indentString = New-Object System.String(" " , ($IndentCount * 4))
        # ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§å—ã‘å–ã£ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ ¼ç´ã™ã‚‹ãŸã‚ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ–
        $collectedObjects = @()
    }

    process {
        # å„å…¥åŠ›ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’é †ã«é…åˆ—ã«æ ¼ç´
        $collectedObjects += $InputObject
    }

    end {
        # åé›†ã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ä½•ã‚‚ã—ãªã„
        if ($collectedObjects.Count -eq 0) {
            Write-Warning "å…¥åŠ›ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚"
            return
        }

        try {
            $outputText = if ($collectedObjects -is [System.String[]]) {
                # ã™ã§ã«æ–‡å­—åˆ—ï¼ˆã¾ãŸã¯å¤šæ•°ã®æ–‡å­—åˆ—ï¼‰ã®å ´åˆã¯é€£çµã™ã‚‹
                $collectedObjects -join [Environment]::NewLine
            } else {
                # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã‚’æ–‡å­—åˆ—åŒ–ã—ã¦å‡ºåŠ›
                $collectedObjects | Out-String
            }

            # æ”¹è¡Œã”ã¨ã«æ–‡å­—åˆ—ã‚’åˆ†å‰²ã—ã€ãã‚Œãã‚Œã®è¡Œã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆæ–‡å­—åˆ—ã‚’ä»˜åŠ ã—ã¦å‡ºåŠ›
            $lines = $outputText -split [Environment]::NewLine
            foreach ($line in $lines) {
                if ($line.Trim() -ne "") {
                    Write-Output "$indentString$line"
                }
            }
        } catch {
            Write-Error "å‡ºåŠ›å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: $($_.Exception.Message)"
        }
    }
}
```

#### \[PowerShell\]ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒAdministratorsã«æ‰€å±ã—ã¦ã„ã‚‹ã‹åˆ¤å®šã™ã‚‹Function

2025.7.15 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/b5ded2924537f7

```powershell:æŒ‡å®šã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€æŒ‡å®šã•ã‚ŒãŸãƒ­ãƒ¼ã‚«ãƒ«ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã§ã‚ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèª
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€æŒ‡å®šã•ã‚ŒãŸãƒ­ãƒ¼ã‚«ãƒ«ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã§ã‚ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€targetUser ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€targetGroup ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸãƒ­ãƒ¼ã‚«ãƒ«ã‚°ãƒ«ãƒ¼ãƒ—ã«æ‰€å±ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã¾ã™ã€‚
    ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’çœç•¥ã—ãŸå ´åˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ãƒ¼ã‚«ãƒ«ã® 'Administrators' ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã§ã‚ã‚‹ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚
    å†…éƒ¨ã§ã¯ `Get-LocalGroupMember` ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã€çµæœã‚’ãƒ–ãƒ¼ãƒ«å€¤ï¼ˆ$true ã¾ãŸã¯ $falseï¼‰ã§è¿”ã—ã¾ã™ã€‚
    ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œæ¨©é™ã‚’ç¢ºèªã™ã‚‹éš›ãªã©ã«ä¾¿åˆ©ã§ã™ã€‚

.PARAMETER targetUser
    ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã‚’ç¢ºèªã—ãŸã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åå‰ã‚’æ–‡å­—åˆ—ã§æŒ‡å®šã—ã¾ã™ã€‚
    ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯ã€ç¾åœ¨ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼åã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼ˆä¾‹: 'MY-PC\MyUser'ï¼‰ã§ã™ã€‚

.PARAMETER targetGroup
    å¯¾è±¡ã¨ãªã‚‹ãƒ­ãƒ¼ã‚«ãƒ«ã‚°ãƒ«ãƒ¼ãƒ—ã®åå‰ã‚’æ–‡å­—åˆ—ã§æŒ‡å®šã—ã¾ã™ã€‚
    ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯ 'Administrators' ã§ã™ã€‚

.EXAMPLE
    # ä¾‹ 1: ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒAdministratorsã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã‹ç¢ºèªã™ã‚‹
    PS C:\> if (Test-GroupMembership) {
    >>     Write-Host "ç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œä¸­ã§ã™ã€‚"
    >> } else {
    >>     Write-Host "ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦å®Ÿè¡Œä¸­ã§ã™ã€‚"
    >> }
    ç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œä¸­ã§ã™ã€‚

.EXAMPLE
    # ä¾‹ 2: ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ 'Remote Desktop Users' ã‚°ãƒ«ãƒ¼ãƒ—ã«æ‰€å±ã—ã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹
    PS C:\> Test-GroupMembership -targetUser "MY-PC\testuser" -targetGroup "Remote Desktop Users"
    False

.OUTPUTS
    System.Boolean
    ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã§ã‚ã‚‹å ´åˆã¯ `$true` ã‚’ã€ãã†ã§ãªã„å ´åˆã¯ `$false` ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã¯ `Get-LocalGroupMember` ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã«ä¾å­˜ã—ã¦ã„ã‚‹ãŸã‚ã€Windowsç’°å¢ƒã§ã€ã‹ã¤ãƒ­ãƒ¼ã‚«ãƒ«ã‚°ãƒ«ãƒ¼ãƒ—æƒ…å ±ã‚’èª­ã¿å–ã‚‹æ¨©é™ãŒã‚ã‚‹å ´åˆã«ã®ã¿æ­£ã—ãå‹•ä½œã—ã¾ã™ã€‚
    - Active Directoryã®ã‚°ãƒ«ãƒ¼ãƒ—ã§ã¯ãªãã€ãƒ­ãƒ¼ã‚«ãƒ«ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ä¸Šã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’å¯¾è±¡ã¨ã—ã¾ã™ã€‚
#>
function Test-GroupMembership {
    param (
        # åˆæœŸå€¤ã¯ã€ç¾åœ¨ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼åã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’è¨­å®š
        [System.String]$targetUser = "$($env:COMPUTERNAME)\$($env:USERNAME)",
        # åˆæœŸå€¤ã¯ã€Administrators
        [System.String]$targetGroup = 'Administrators'
    )
    # æŒ‡å®šã®ã‚°ãƒ«ãƒ¼ãƒ—ã«æ‰€å±ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä¸€è¦§ã‚’å–å¾—
    $groupMembers = (Get-LocalGroupMember -Name $targetGroup)

    # å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæŒ‡å®šã®ã‚°ãƒ«ãƒ¼ãƒ—ã«å«ã¾ã‚Œã¦ã„ã‚‹ã‹åˆ¤å®š
    $isMember = ($groupMembers.Name -contains $targetUser)

    return $isMember
}
```

#### WindowsæŒ‡å®šãƒ‰ãƒ©ã‚¤ãƒ–å†…ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã„é †ã«ä¸Šä½ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã™ã‚‹æ–¹æ³•ï¼ˆPowerShellä½¿ç”¨ï¼‰

2025.7.15 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/6a612ab9e67f0c

```powershell:æŒ‡å®šã•ã‚ŒãŸãƒ‰ãƒ©ã‚¤ãƒ–å†…ã§ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã„é †ã«ä¸Šä½ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—
<#
.SYNOPSIS
    æŒ‡å®šã•ã‚ŒãŸãƒ‰ãƒ©ã‚¤ãƒ–å†…ã§ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã„é †ã«ä¸Šä½ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€æŒ‡å®šã•ã‚ŒãŸãƒ‰ãƒ©ã‚¤ãƒ–ãƒ¬ã‚¿ãƒ¼ã®ãƒ«ãƒ¼ãƒˆã‹ã‚‰å†å¸°çš„ã«ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºï¼ˆLengthãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼‰ã«åŸºã¥ã„ã¦é™é †ã«ä¸¦ã¹æ›¿ãˆã¾ã™ã€‚
    ãã—ã¦ã€TopCount ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸä»¶æ•°ã ã‘ä¸Šä½ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŠ½å‡ºã—ã€ãƒ©ãƒ³ã‚­ãƒ³ã‚°ç•ªå·ã€ãƒ•ãƒ«ãƒ‘ã‚¹ã€ã‚µã‚¤ã‚ºï¼ˆãƒã‚¤ãƒˆï¼‰ã€æœ€çµ‚æ›´æ–°æ—¥æ™‚ã‚’å«ã‚€ã‚«ã‚¹ã‚¿ãƒ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒªã‚¹ãƒˆã¨ã—ã¦è¿”ã—ã¾ã™ã€‚
    ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒãªã„ãŸã‚ã«ã‚¹ã‚­ãƒ£ãƒ³ã§ããªã„ãƒ•ã‚©ãƒ«ãƒ€ã¯ã€ã‚¨ãƒ©ãƒ¼ã‚’è¡¨ç¤ºã›ãšã«ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã™ã€‚

.PARAMETER DriveLetter
    æ¤œç´¢å¯¾è±¡ã¨ã™ã‚‹ãƒ‰ãƒ©ã‚¤ãƒ–ã®ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ¬ã‚¿ãƒ¼ï¼ˆä¾‹: 'C' ã‚„ 'D'ï¼‰ã‚’1æ–‡å­—ã§æŒ‡å®šã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¿…é ˆã§ã™ã€‚

.PARAMETER TopCount
    å–å¾—ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸Šä½ä»¶æ•°ã‚’æŒ‡å®šã—ã¾ã™ã€‚
    ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯ 10 ã§ã™ã€‚

.EXAMPLE
    # ä¾‹ 1: Cãƒ‰ãƒ©ã‚¤ãƒ–ã§æœ€ã‚‚å¤§ãã„ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸Šä½10ä»¶ã‚’å–å¾—ã™ã‚‹
    PS C:\> Get-LargeFiles -DriveLetter 'C'

    # å®Ÿè¡Œçµæœï¼ˆä¾‹ï¼‰:
    # Rank FullName                                Size            LastWriteTime
    # ---- --------                                ----            -------------
    #    1 C:\Windows\System32\some_large_file.dll 123456789       2023/10/27 10:00:00
    #    2 C:\Users\user\Downloads\big_archive.zip 100000000       2024/05/17 15:00:00
    #  ...

.EXAMPLE
    # ä¾‹ 2: Dãƒ‰ãƒ©ã‚¤ãƒ–ã§æœ€ã‚‚å¤§ãã„ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸Šä½20ä»¶ã‚’å–å¾—ã—ã€ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã§è¦‹ã‚„ã™ãè¡¨ç¤ºã™ã‚‹
    PS C:\> Get-LargeFiles -DriveLetter 'D' -TopCount 20 | Format-Table -AutoSize

.OUTPUTS
    System.Management.Automation.PSCustomObject[]
    ä»¥ä¸‹ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒã¤ã‚«ã‚¹ã‚¿ãƒ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é…åˆ—ã‚’è¿”ã—ã¾ã™ã€‚
    - Rank:          ã‚µã‚¤ã‚ºé †ã®ãƒ©ãƒ³ã‚­ãƒ³ã‚° (Int32)
    - FullName:      ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ•ãƒ«ãƒ‘ã‚¹ (String)
    - Size:          ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºï¼ˆãƒã‚¤ãƒˆå˜ä½ï¼‰ (Int64)
    - LastWriteTime: ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€çµ‚æ›´æ–°æ—¥æ™‚ (DateTime)

.NOTES
    - ãƒ‰ãƒ©ã‚¤ãƒ–å…¨ä½“ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹ãŸã‚ã€ç‰¹ã«å¤§å®¹é‡ã®ãƒ‰ãƒ©ã‚¤ãƒ–ã§ã¯å®Ÿè¡Œã«æ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
    - ã“ã®é–¢æ•°ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œç´¢ã®ã¿ã‚’è¡Œã„ã€ãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›´ã‚„å‰Šé™¤ã¯è¡Œã„ã¾ã›ã‚“ã€‚
    - ç®¡ç†è€…æ¨©é™ã§å®Ÿè¡Œã—ãªã„å ´åˆã€ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚©ãƒ«ãƒ€ãªã©ãŒæ¤œç´¢å¯¾è±¡ã‹ã‚‰é™¤å¤–ã•ã‚Œã€çµæœãŒä¸æ­£ç¢ºã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
#>
function Get-LargeFiles {
    [CmdletBinding()]
    param(
        # æ¤œç´¢å¯¾è±¡ã®ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ¬ã‚¿ãƒ¼ã‚’æŒ‡å®šï¼ˆä¾‹ï¼šC, D ãªã©ä¸€æ–‡å­—ï¼‰
        [Parameter(Mandatory = $true)]
        [ValidatePattern('^[A-Za-z]$')]
        [string]$DriveLetter,

        # ä¸Šä½ä½•ä½ã¾ã§æŠ½å‡ºã™ã‚‹ã‹æŒ‡å®šï¼ˆä¾‹ï¼š50ï¼‰
        [ValidateRange(1, [int]::MaxValue)]
        [int]$TopCount = 10
    )

    $path = "${DriveLetter}:\"

    try {
        # ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒªã‚¹ãƒˆã‚’å–å¾—
        $files = Get-ChildItem -Path $path -Recurse -File -ErrorAction SilentlyContinue

        if (-not $files) {
            Write-Warning "æŒ‡å®šã—ãŸãƒ‰ãƒ©ã‚¤ãƒ– ($($path)) å†…ã«ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚"
            return
        }

        # ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã„é †ã«ä¸¦ã³æ›¿ãˆã€æŒ‡å®šé †ä½åˆ†ã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’ç”Ÿæˆ
        $result = $files |
            Sort-Object -Property Length -Descending |
            Select-Object -First $TopCount |
            ForEach-Object -Begin { $i = 1 } -Process {
                [pscustomobject]@{
                    Rank          = $i++
                    FullName      = $_.FullName
                    Size          = $_.Length
                    LastWriteTime = $_.LastWriteTime
                }
            }

        return $result
        # é †ä½ãŒä¸è¦ã§ã‚ã‚Œã°ã‚³ãƒƒãƒ
        #$result = $files |
        #    Sort-Object -Property Length -Descending |
        #    Select-Object -First $TopCount -Property FullName, Length, LastWriteTime
        #
        #return $result
    }
    catch {
         Write-Error "ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ: $($_.Exception.GetType().Name) - $($_.Exception.Message)"
    }
}
```

#### wingetã‚³ãƒãƒ³ãƒ‰ã§Chromeãªã©ã®ã‚½ãƒ•ãƒˆãƒ»ã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•ï¼ˆå¯¾è©±å¼ã®PowerShellé–¢æ•°ã‚‚ç´¹ä»‹ï¼‰

2025.7.15 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/6ec7b73a25ec8f

```powershell:Winget ã§å¯¾è©±çš„ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’æ¤œç´¢ã—ã€ç‰¹å®šã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
<#
.SYNOPSIS
    Winget ã‚’ä½¿ç”¨ã—ã¦ã€å¯¾è©±çš„ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’æ¤œç´¢ã—ã€ç‰¹å®šã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

.DESCRIPTION
    ã“ã®é–¢æ•°ã¯ã€Windows Package Manager (Winget) ã®ãƒ©ãƒƒãƒ‘ãƒ¼ã¨ã—ã¦æ©Ÿèƒ½ã—ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç°¡ç•¥åŒ–ã—ã¾ã™ã€‚
    - ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸IDã‚’æŒ‡å®šã—ãªã„å ´åˆ: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ¤œç´¢ã‚¯ã‚¨ãƒªã®å…¥åŠ›ã‚’ä¿ƒã—ã€`winget search` ã®çµæœã‚’è¡¨ç¤ºã—ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒªã‚¹ãƒˆã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®IDã‚’é¸æŠã—ã¾ã™ã€‚
    - ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸IDã‚’æŒ‡å®šã—ãŸå ´åˆ: `winget show --versions` ã‚’å®Ÿè¡Œã—ã€åˆ©ç”¨å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
    - ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®šã—ãªã„å ´åˆ: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å…¥åŠ›ã‚’ä¿ƒã—ã¾ã™ã€‚æœªå…¥åŠ›ã®å ´åˆã¯ã€åˆ©ç”¨å¯èƒ½ãªæœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè‡ªå‹•çš„ã«é¸æŠã•ã‚Œã¾ã™ã€‚
    
    æœ€çµ‚çš„ã«ã€é¸æŠã•ã‚ŒãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®çµ„ã¿åˆã‚ã›ã§ `winget install` ã‚’ã‚µã‚¤ãƒ¬ãƒ³ãƒˆãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œã—ã¾ã™ã€‚

.PARAMETER PackageId
    ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®IDã‚’æ–‡å­—åˆ—ã§æŒ‡å®šã—ã¾ã™ã€‚
    ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’çœç•¥ã™ã‚‹ã¨ã€é–¢æ•°ã¯å¯¾è©±çš„ãªæ¤œç´¢ãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œã—ã¾ã™ã€‚

.PARAMETER Version
    ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ç‰¹å®šã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æ–‡å­—åˆ—ã§æŒ‡å®šã—ã¾ã™ã€‚
    ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’çœç•¥ã™ã‚‹ã¨ã€åˆ©ç”¨å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒªã‚¹ãƒˆã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé¸æŠã™ã‚‹ã‹ã€æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè‡ªå‹•çš„ã«é¸æŠã•ã‚Œã¾ã™ã€‚

.PARAMETER Source
    ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å–å¾—å…ƒã¨ãªã‚‹ã‚½ãƒ¼ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚
    ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ 'winget' ã§ã™ã€‚

.EXAMPLE
    # ä¾‹ 1: å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œã™ã‚‹
    PS C:\> Install-WingetPackage

    # å®Ÿè¡Œã™ã‚‹ã¨ã€ã¾ãšæ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®å…¥åŠ›ã‚’æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚
    # > Wingetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§æ¤œç´¢ã™ã‚‹åå‰ã‚‚ã—ãã¯IDã‚’å…¥åŠ›ã—Enterã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚ï¼ˆä¾‹: chrome)
    # chrome [Enter]
    #
    # æ¤œç´¢çµæœãŒè¡¨ç¤ºã•ã‚ŒãŸå¾Œã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹IDã®å…¥åŠ›ã‚’æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚
    # > ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã€ŒIDã€ã‚’å…¥åŠ›ã—Enterã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚ï¼ˆä¾‹: google.chromeï¼‰
    # Google.Chrome [Enter]
    #
    # åˆ©ç”¨å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚ŒãŸå¾Œã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å…¥åŠ›ã‚’æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚
    # > ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å…¥åŠ›ã—Enterã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚ï¼ˆæœªå…¥åŠ›ã®å ´åˆã¯æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’é¸æŠï¼‰
    # [Enter] (æœ€æ–°ç‰ˆã‚’é¸æŠ)
    #
    # ã“ã‚Œã«ã‚ˆã‚Šã€Google Chromeã®æœ€æ–°ç‰ˆãŒã‚µã‚¤ãƒ¬ãƒ³ãƒˆã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¾ã™ã€‚

.EXAMPLE
    # ä¾‹ 2: ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸IDã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç›´æ¥æŒ‡å®šã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹
    PS C:\> Install-WingetPackage -PackageId 'Microsoft.PowerShell' -Version '7.4.2.0'

    # ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€å¯¾è©±çš„ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãªã—ã§ã€PowerShell 7.4.2.0 ã‚’ç›´æ¥ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

.OUTPUTS
    System.Int32
    å‡¦ç†ãŒæ­£å¸¸ã«å®Œäº†ã—ãŸå ´åˆã¯ 0 ã‚’è¿”ã—ã¾ã™ã€‚
    é€”ä¸­ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€-11, -12, -13, -21, -22, -23, -24 ã®ã„ãšã‚Œã‹ã®è² ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¿”ã—ã¾ã™ã€‚

.NOTES
    - ã“ã®é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯ã€`winget` ã‚³ãƒãƒ³ãƒ‰ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã€å®Ÿè¡Œå¯èƒ½ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
    - ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ `--silent` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ä»˜ãã§å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€é€šå¸¸ã¯GUIã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚
    - ã“ã®é–¢æ•°ã¯å¯¾è©±çš„ãªå…¥åŠ› (`Read-Host`) ã‚’æ±‚ã‚ã‚‹éƒ¨åˆ†ãŒã‚ã‚‹ãŸã‚ã€å®Œå…¨è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã®ä½¿ç”¨ã«ã¯æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚
#>
Function Install-WingetPackage {
    param (
        [Parameter(Mandatory = $false)]
        [string]$PackageId, # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯¾è±¡ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ IDï¼ˆä»»æ„ï¼‰

        [Parameter(Mandatory = $false)]
        [string]$Version, # æŒ‡å®šãŒã‚ã‚Œã°ãã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

        [Parameter(Mandatory = $false)]
        [string]$Source = "winget" # æŒ‡å®šãŒã‚ã‚Œã°ã‚½ãƒ¼ã‚¹ã‚‚é¸æŠ
    )

    $statusCode = 0

    # ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’UTF-8ã«è¨­å®š
    [Console]::OutputEncoding = [System.Text.Encoding]::UTF8

    # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ ID ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„å ´åˆã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒªã‚¹ãƒˆã‚’å–å¾—
    if (-Not $PackageId) {
        Write-Host ""
        Write-Host "> åˆ©ç”¨å¯èƒ½ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒªã‚¹ãƒˆã‚’å–å¾—ä¸­..." -ForegroundColor Yellow
        Write-Host ""
        Write-Host "> Wingetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§æ¤œç´¢ã™ã‚‹åå‰ã‚‚ã—ãã¯IDã‚’å…¥åŠ›ã—Enterã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚ï¼ˆä¾‹: chrome)"
        $query = Read-Host
        $wingetListOutput = (winget search -q $query | Out-String)

        if (-Not $wingetListOutput) {
            Write-Error "wingetã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè¡Œã§ããªã„ã‹ã€æŒ‡å®šã•ã‚ŒãŸæ¡ä»¶ã§ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚"
            $statusCode = -11
            return $statusCode
        }

        # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒªã‚¹ãƒˆã‚’æ•´å½¢ã—ã¦è¡¨ç¤º
        $lines = ($wingetListOutput -split "`r?`n")
        # åå‰ã‚„IDã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãªã©ã®æƒ…å ±ãŒã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã¨åŒºåˆ‡ã‚Šç·šã®ã¿ã‚’æŠœç²‹
        $availablePackages = $lines | Where-Object { $_ -match "^\S+\s+\S+" -or $_ -match "^-{2,}" }

        if (-Not $availablePackages) {
            Write-Error "> åˆ©ç”¨å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚æ¡ä»¶ã‚’è¦‹ç›´ã—ã¦å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚"
            $statusCode = -12
            return $statusCode
        }

        Write-Host ""
        Write-Host "> å–å¾—ã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æƒ…å ±ã®ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚:" -ForegroundColor Green
        $availablePackages | ForEach-Object { Write-Host $_ }

        # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã« ID ã‚’å…¥åŠ›ã•ã›ã‚‹
        Write-Host ""
        Write-Host "> ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã€ŒIDã€ã‚’å…¥åŠ›ã—Enterã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚ï¼ˆä¾‹: google.chromeï¼‰"
        $selectedId = Read-Host
        if (-Not $selectedId) {
            Write-Error "æœªå…¥åŠ›ã§ã™ã€‚å‡¦ç†ã‚’çµ‚äº†ã—ã¾ã™ã€‚"
            $statusCode = -13
            return $statusCode
        }
    }
    else {
        $selectedId = $PackageId
    }

    # é¸æŠã•ã‚ŒãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèª
    Write-Host ""
    Write-Host "> åˆ©ç”¨å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªä¸­ï¼ˆ$selectedIdï¼‰..." -ForegroundColor Yellow
    $wingetOutput = (winget show --id $selectedId --versions | Out-String)

    if (-Not $wingetOutput) {
        Write-Error "ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ '$selectedId' ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚"
        $statusCode = -21
        return $statusCode
    }

    # ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã®ã¿ã‚’æŠ½å‡ºã—ä¸€è¦§ã‚’ä½œæˆ
    $lines = ($wingetOutput -split "`r?`n")
    $availableVersions = ($lines -replace "\s+", "" | Where-Object { $_ -ne "" -and $_ -match "^\d" } | Sort-Object)

    if (-Not $availableVersions) {
        Write-Error "ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ '$selectedId' ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚"
        $statusCode = -22
        return $statusCode
    }

    Write-Host ""
    Write-Host "> å–å¾—ã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã®ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚:" -ForegroundColor Green
    ($availableVersions | ForEach-Object { Write-Host $_ })

    if (-Not $Version) {
        # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å…¥åŠ›ã•ã›ã‚‹ï¼ˆç©ºã®å ´åˆã¯æœ€æ–°ç‰ˆã‚’ä½¿ç”¨ï¼‰
        Write-Host ""
        Write-Host "> ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å…¥åŠ›ã—Enterã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚ï¼ˆæœªå…¥åŠ›ã®å ´åˆã¯æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’é¸æŠï¼‰"
        $selectedVersion = Read-Host

        # ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒæœªæŒ‡å®šã®å ´åˆã€æœ€æ–°ç‰ˆã‚’é¸æŠ
        if (-Not $selectedVersion) {
            $selectedVersion = $availableVersions[-1]
            Write-Host ""
            Write-Host "> æœ€æ–°ç‰ˆ '$selectedVersion' ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚" -ForegroundColor Yellow
        }
    }
    else {
        $selectedVersion = $Version
    }
    
    if (-Not ($availableVersions -contains $selectedVersion)) {
        Write-Error "æŒ‡å®šã•ã‚ŒãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ '$selectedVersion' ã¯ä¸€è¦§ã«ã‚ã‚Šã¾ã›ã‚“ã€‚"
        $statusCode = -23
        return $statusCode
    }

    Write-Host ""
    Write-Host "> $selectedId ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ $selectedVersion ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’é–‹å§‹ã—ã¾ã™..." -ForegroundColor Green

    # æ¨™æº–å‡ºåŠ›ã‚’ç ´æ£„ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å‡¦ç†ã‚’å®Ÿè¡Œ
    (winget install --id $selectedId --version $selectedVersion --source $Source --silent | Out-Null)
    $wingetExitcode = $LASTEXITCODE

    if ($wingetExitcode -eq 0) {
        Write-Host "> $selectedId ãƒãƒ¼ã‚¸ãƒ§ãƒ³ $selectedVersion ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå®Œäº†ã—ã¾ã—ãŸã€‚" -ForegroundColor Green
    } else {
        Write-Error "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚winget çµ‚äº†ã‚³ãƒ¼ãƒ‰: $wingetExitcode"
        $statusCode = -24
        return $statusCode
    }

    return $statusCode
}
```

#### \[PowerShell\]2æ¬¡å…ƒã®ã‚¸ãƒ£ã‚°é…åˆ—ã¨å¤šæ¬¡å…ƒé…åˆ—ãã‚Œãã‚Œã«å¤‰æ›ã§ãã‚‹Function

2025.7.15 è¿½è¨˜

https://zenn.dev/haretokidoki/articles/5f6e20c9b8a97e

##### ã‚¸ãƒ£ã‚°é…åˆ— â†’ å¤šæ¬¡å…ƒé…åˆ— ã«å¤‰æ›ã™ã‚‹Function

```powershell
Function Convert-JaggedToMulti {
    [CmdletBinding()]
    <#
    .SYNOPSIS
        ã‚¸ãƒ£ã‚°é…åˆ—ï¼ˆé…åˆ—ã®é…åˆ—ï¼‰ã‚’2æ¬¡å…ƒã®å¤šæ¬¡å…ƒé…åˆ—ã«å¤‰æ›ã€‚
    .DESCRIPTION
        å…¥åŠ›ã•ã‚ŒãŸã‚¸ãƒ£ã‚°é…åˆ—ã‚’åˆ†æã—ã€ã™ã¹ã¦ã®è¦ç´ ã‚’æ ¼ç´ã§ãã‚‹æœ€å°ã®å¤šæ¬¡å…ƒé…åˆ—ã‚’ä½œæˆã€‚
        å„è¡Œã®è¦ç´ æ•°ãŒç•°ãªã‚Šä¸è¶³ã—ã¦ã„ã‚‹è¦ç´ ã¯ $null åŸ‹ã‚ã•ã‚Œã‚‹ã€‚
    .PARAMETER JaggedArray
        å¤‰æ›å¯¾è±¡ã®ã‚¸ãƒ£ã‚°é…åˆ—ï¼ˆé…åˆ—ãŒå†…åŒ…ã•ã‚ŒãŸé…åˆ—ï¼‰ã€‚
    .EXAMPLE
        # ãƒ†ã‚¹ãƒˆç”¨ã®ã‚¸ãƒ£ã‚°é…åˆ—ã‚’ä½œæˆ
        PS> $jagged = @(@(1, 2), @(3, 4, 5), @(6))

        # é–¢æ•°ã‚’å®Ÿè¡Œã—ã¦å¤šæ¬¡å…ƒé…åˆ—ã«å¤‰æ›
        PS> Convert-JaggedToMulti -JaggedArray $jagged
    .OUTPUTS
        [System.Object[,]]
    #>
    param(
        # å¤šæ¬¡å…ƒé…åˆ— â†’ ã‚¸ãƒ£ã‚°é…åˆ— ã§ç™ºç”Ÿã—ãŸå¥‡å¦™ãªæŒ™å‹•ã«ã‚ã‚ã›ã¦å¼•æ•°å¿…é ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼ˆæœ‰åŠ¹ã«ã—ã¦ã‚‚æ­£å¸¸å‹•ä½œå¯èƒ½ï¼‰
        #[Parameter(Mandatory = $true)] 
        [array]$JaggedArray
    )

    # å…¥åŠ›ãŒç©ºã®é…åˆ—ã®å ´åˆã¯ã€0x0ã®å¤šæ¬¡å…ƒé…åˆ—ã‚’è¿”ã™
    if ($JaggedArray.Length -eq 0) {
        $multiArray = New-Object 'object[,]' 0, 0
        return ,$multiArray
    }

    # å„è¡Œã®é…åˆ—ã®ä¸­ã§ã€æœ€å¤§ã®è¦ç´ æ•°ã‚’å–å¾—
    $maxColumnCount = ($JaggedArray | Where-Object { $_ -is [System.Array] } | Measure-Object -Property Length -Maximum).Maximum

    # å…¥åŠ›ã«é…åˆ—ãŒ1ã¤ã‚‚å«ã¾ã‚Œãªã„å ´åˆã€$maxColumnCount ãŒ $null ã«ãªã‚‹ãŸã‚ã€0ã«è¨­å®š
    if ($null -eq $maxColumnCount) {
        $maxColumnCount = 0
    }

    # å¤šæ¬¡å…ƒé…åˆ—ã‚’åˆæœŸåŒ– (ã“ã“ã§ã®å‡ºåŠ›ã¯æŠ‘åˆ¶ã—ãªã„ã€‚æœ€å¾Œã«æ˜ç¤ºçš„ã«è¿”ã™ãŸã‚)
    $multiArray = New-Object 'object[,]' $JaggedArray.Length, $maxColumnCount

    # è¦ç´ ã‚’ã‚³ãƒ”ãƒ¼
    for ($i = 0; $i -lt $JaggedArray.Length; $i++) {
        if ($JaggedArray[$i] -is [System.Array]) {
            for ($j = 0; $j -lt $JaggedArray[$i].Length; $j++) {
                $multiArray[$i, $j] = $JaggedArray[$i][$j]
                #Write-Debug "`$multiArray[$i, $j]: [$($multiArray[$i, $j])]"
            }
        }
    }
    
    return ,$multiArray
}
```

##### å¤šæ¬¡å…ƒé…åˆ— â†’ ã‚¸ãƒ£ã‚°é…åˆ— ã«å¤‰æ›ã™ã‚‹Function

```powershell
Function Convert-MultiToJagged {
    [CmdletBinding()]
    <#
    .SYNOPSIS
        2æ¬¡å…ƒã®å¤šæ¬¡å…ƒé…åˆ—ã‚’ã‚¸ãƒ£ã‚°é…åˆ—ï¼ˆé…åˆ—ã®é…åˆ—ï¼‰ã«å¤‰æ›ã—ã¾ã™ã€‚
    .DESCRIPTION
        å…¥åŠ›ã•ã‚ŒãŸ2æ¬¡å…ƒã®å¤šæ¬¡å…ƒé…åˆ—ã‚’åˆ†æã—ã€ã‚¸ãƒ£ã‚°é…åˆ—ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
        å¤šæ¬¡å…ƒé…åˆ—ã®å„è¡ŒãŒã€ã‚¸ãƒ£ã‚°é…åˆ—ã®å†…éƒ¨é…åˆ—ã«å¯¾å¿œã—ã¾ã™ã€‚
        å…ƒã®é…åˆ—ã«å«ã¾ã‚Œã‚‹ $null å€¤ã¯ã€å¤‰æ›å¾Œã®ã‚¸ãƒ£ã‚°é…åˆ—ã«ã¯å«ã¾ã‚Œã¾ã›ã‚“ã€‚
    .PARAMETER MultiArray
        å¤‰æ›å¯¾è±¡ã®2æ¬¡å…ƒå¤šæ¬¡å…ƒé…åˆ—ã€‚
    .EXAMPLE
        # ãƒ†ã‚¹ãƒˆç”¨ã®å¤šæ¬¡å…ƒé…åˆ—ã‚’ä½œæˆ
        PS> $multi = New-Object 'object[,]' 3, 3
        PS> $multi[0,0] = 1; $multi[0,1] = 2
        PS> $multi[1,0] = 3; $multi[1,1] = 4; $multi[1,2] = 5
        PS> $multi[2,0] = 6
        
        # é–¢æ•°ã‚’å®Ÿè¡Œã—ã¦ã‚¸ãƒ£ã‚°é…åˆ—ã«å¤‰æ›
        PS> $jagged = Convert-MultiToJagged -MultiArray $multi
    .OUTPUTS
        [System.Object[]]
        å„è¦ç´ ãŒé…åˆ—ã§ã‚ã‚‹ã‚¸ãƒ£ã‚°é…åˆ—ã€‚
    #>
    param(
        #å¼•æ•°å¿…é ˆã§æŒ‡å®šã—ã¦ã„ã‚‹ã¨ã€ãªãœã‹nullãŒæ¸¡ã•ã‚Œã¦ã—ã¾ã†å¥‡å¦™ãªæŒ™å‹•ãŒç™ºç”Ÿã—ãŸç‚ºã€ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ
        #[Parameter(Mandatory = $true)]
        [System.Array]$MultiArray
    )

    # å…¥åŠ›ãŒ2æ¬¡å…ƒé…åˆ—ã§ã‚ã‚‹ã“ã¨ã‚’æ¤œè¨¼
    if ($MultiArray.Rank -ne 2) {
        Write-Error "å…¥åŠ›ã¯2æ¬¡å…ƒã®å¤šæ¬¡å…ƒé…åˆ—ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚å…¥åŠ›ã•ã‚ŒãŸé…åˆ—ã®æ¬¡å…ƒæ•°: $($MultiArray.Rank)"
        return
    }

    # ã‚¸ãƒ£ã‚°é…åˆ—ã‚’æ ¼ç´ã™ã‚‹ãŸã‚ã®å¯å¤‰é•·ãƒªã‚¹ãƒˆã‚’æº–å‚™
    $jaggedArrayList = [System.Collections.ArrayList]::new()

    # è¡Œã¨åˆ—ã®æ•°ã‚’å–å¾—
    $rowCount = $MultiArray.GetLength(0)
    $colCount = $MultiArray.GetLength(1)

    # å„è¡Œã‚’ãƒ«ãƒ¼ãƒ—å‡¦ç†
    for ($i = 0; $i -lt $rowCount; $i++) {
        # å„è¡Œã®è¦ç´ ã‚’æ ¼ç´ã™ã‚‹ãŸã‚ã®å¯å¤‰é•·ãƒªã‚¹ãƒˆã‚’æº–å‚™
        $rowList = [System.Collections.ArrayList]::new()

        # å„åˆ—ã‚’ãƒ«ãƒ¼ãƒ—å‡¦ç†
        for ($j = 0; $j -lt $colCount; $j++) {
            $element = $MultiArray[$i, $j]
            
            # è¦ç´ ãŒ $null ã§ãªã„å ´åˆã®ã¿ãƒªã‚¹ãƒˆã«è¿½åŠ 
            if ($null -ne $element) {
                # Add()ãƒ¡ã‚½ãƒƒãƒ‰ã®æˆ»ã‚Šå€¤ï¼ˆè¿½åŠ ã•ã‚ŒãŸè¦ç´ ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼‰ãŒãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«å‡ºåŠ›ã•ã‚Œã‚‹ã®ã‚’é˜²ã
                [void]$rowList.Add($element)
                #Write-Debug "`$rowList: [$($rowList)]"
            }
        }

        # å®Œæˆã—ãŸè¡Œï¼ˆé…åˆ—ã«å¤‰æ›æ¸ˆã¿ï¼‰ã‚’å…¨ä½“ã®ã‚¸ãƒ£ã‚°é…åˆ—ãƒªã‚¹ãƒˆã«è¿½åŠ 
        [void]$jaggedArrayList.Add($rowList.ToArray())
        #Write-Debug "`$jaggedArrayList[$i]: [$($jaggedArrayList[$i])]"
    }

    # æœ€çµ‚çš„ãªçµæœï¼ˆArrayListã‚’é…åˆ—ã«å¤‰æ›ã—ãŸã‚‚ã®ï¼‰ã‚’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«å‡ºåŠ›
    # ã“ã‚Œã«ã‚ˆã‚Šã€å‘¼ã³å‡ºã—å…ƒã¯ã‚¸ãƒ£ã‚°é…åˆ—ã¨ã—ã¦å—ã‘å–ã‚Œã‚‹
    return ,$jaggedArrayList.ToArray()
}
```

### ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚ˆã‚ŠæŠœç²‹

#### \[PowerShell\]CDãªã©è¨˜æ†¶åª’ä½“ã«ã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®æ–‡å­—åˆ—ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ãƒ„ãƒ¼ãƒ«

https://zenn.dev/haretokidoki/articles/f1634c386ffc1d
https://github.com/akiGAMEBOY/PowerShell_CD-DetermineStringTool

##### CEãƒˆãƒ¬ã‚¤ï¼ˆãƒ¡ãƒ‡ã‚£ã‚¢ãƒˆãƒ¬ã‚¤ï¼‰ã‚’è‡ªå‹•ã§ã‚ªãƒ¼ãƒ—ãƒ³

https://github.com/akiGAMEBOY/PowerShell_CD-DetermineStringTool/blob/master/Main.ps1#L46-L74

##### CLIæ“ä½œã§Yes/Noã®å…¥åŠ›å¾…ã¡

https://github.com/akiGAMEBOY/PowerShell_CD-DetermineStringTool/blob/master/Main.ps1#L108-L160

##### CDãƒ‰ãƒ©ã‚¤ãƒ–ï¼ˆãƒ¡ãƒ‡ã‚£ã‚¢ãƒ‰ãƒ©ã‚¤ãƒ–ï¼‰ãŒèªè­˜ã•ã‚Œã¦ã„ã‚‹ã‹æ¤œè¨¼

https://github.com/akiGAMEBOY/PowerShell_CD-DetermineStringTool/blob/master/Main.ps1#L161-L228

##### ãƒ•ã‚¡ã‚¤ãƒ«åã¨æ‹¡å¼µå­ã®æ¤œè¨¼

https://github.com/akiGAMEBOY/PowerShell_CD-DetermineStringTool/blob/master/Main.ps1#L229-L263

#### \[PowerShell\]ã‚³ãƒ”ãƒ¼ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼†ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®æ–¹æ³• - Local to NAS

https://zenn.dev/haretokidoki/articles/d93f7608754bff
https://github.com/akiGAMEBOY/PowerShell_FileCopybackupTool

##### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

https://github.com/akiGAMEBOY/PowerShell_FileCopybackupTool/blob/master/source/powershell/Main.ps1#L124-L232

##### ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚³ãƒ”ãƒ¼ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

https://github.com/akiGAMEBOY/PowerShell_FileCopybackupTool/blob/master/source/powershell/Main.ps1#L233-L321

#### \[PowerShell\]â€œRPAç”»é¢æ“ä½œ:IMEè¾æ›¸ã‚’ãƒ†ã‚­ã‚¹ãƒˆå‡ºåŠ›â€ã¨â€œå˜èªç™»éŒ²æ¸ˆã¿ã‹ãƒã‚§ãƒƒã‚¯â€ã‚’è‡ªå‹•å®Ÿè¡Œã™ã‚‹æ–¹æ³•

https://zenn.dev/haretokidoki/articles/a1a89282137299
https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool

##### ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å›²ã¿ã‚’å‰Šé™¤

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L91-L128

##### åˆ©ç”¨ä¸­ã®ãƒ¢ãƒ‹ã‚¿ãƒ¼ã‚µã‚¤ã‚ºã‹ã‚‰æŒ‡å®šã®æ•°å€¤ã§é™¤ç®—ã—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚ºã‚’å–å¾—

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L177-L214

##### GUIæ“ä½œï¼ˆWindowsãƒ•ã‚©ãƒ¼ãƒ ï¼‰ã§Yes/Noã®å…¥åŠ›å¾…ã¡

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L215-L300

##### ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ¼ãƒ‰ï¼ˆenumï¼‰ã‚’æ¤œç´¢ã‚­ãƒ¼ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L66-L85

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L553-L608

##### ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ã®è¡¨ç¤º

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L609-L640

##### ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢å¯¾è±¡ã«è¤‡æ•°ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã”ã¨ã«ã‚«ã‚¦ãƒ³ãƒˆ

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L641-L710

##### ä¸Šè¨˜ã§å–å¾—ã—ãŸé…åˆ—ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã«è¡¨ç¤º

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L711-L783

##### ä¸€æ™‚çš„ã«ä¿å­˜ã™ã‚‹å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ ¼ç´ã™ã‚‹ãŸã‚ã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ

https://github.com/akiGAMEBOY/PowerShell_IMEdictionarySearchTool/blob/master/source/powershell/Main.ps1#L834-L895

#### \[PowerShell\]MySQLãƒ‡ãƒ¼ã‚¿ã‚’CSVãƒ•ã‚¡ã‚¤ãƒ«ã§å–å¾—ã™ã‚‹æ–¹æ³• - DB to CSV

https://zenn.dev/haretokidoki/articles/28a7467dedabfc
https://github.com/akiGAMEBOY/PowerShell_mysql-to-csv

##### æ–‡å­—åˆ—å½¢å¼ã®æ—¥ä»˜ï¼ˆyyyymmddï¼‰ãŒæ­£ã—ã„å€¤ã‹æ¤œè¨¼


https://github.com/akiGAMEBOY/PowerShell_mysql-to-csv/blob/master/source/Main.ps1#L39-L80

##### é–‹å§‹æ—¥ä»˜ã¨çµ‚äº†æ—¥ä»˜ãŒæ—¥ä»˜ã®æœŸé–“ã¨ã—ã¦æ­£ã—ã„ã‹æ¤œè¨¼

https://github.com/akiGAMEBOY/PowerShell_mysql-to-csv/blob/master/source/Main.ps1#L81-L100

##### MySQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®æ¥ç¶šå‡¦ç†

https://github.com/akiGAMEBOY/PowerShell_mysql-to-csv/blob/master/source/Main.ps1#L101-L133

##### MySQLã®SQLã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ

https://github.com/akiGAMEBOY/PowerShell_mysql-to-csv/blob/master/source/Main.ps1#L134-L164

#### ç”»åƒã‚’ãƒªã‚µã‚¤ã‚ºã—ã¦WebPå½¢å¼ã«å¤‰æ›ã™ã‚‹PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆ

ã¾ã è¨˜äº‹ã¨ã—ã¦å…¬é–‹ã—ã¦ã„ãªã„PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã€‚
https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool

##### æ–‡å­—åˆ—ãŒASCIIæ–‡å­—ã ã‘ã§æ§‹æˆï¼ˆè‹±æ•°å­—ã ã‘ã§ãƒãƒ«ãƒãƒã‚¤ãƒˆæ–‡å­—ãŒãªã„ï¼‰ã‹ã®æœ‰ç„¡

https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool/blob/master/source/powershell/Main.ps1#L845-L859

##### ä½¿ç”¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—

https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool/blob/master/source/powershell/Main.ps1#L860-L917

##### ä½¿ç”¨ã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼åã‚’å–å¾—

https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool/blob/master/source/powershell/Main.ps1#L1161-L1222

##### OCRï¼ˆTesseractOCRï¼‰ã§å‡ºåŠ›ã—ãŸãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢ã—ã‚«ã‚¦ãƒ³ãƒˆ

https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool/blob/master/source/powershell/Main.ps1#L918-L1018

https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool/blob/master/source/powershell/Main.ps1#L1019-L1160

##### æŒ‡å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æ‹¡å¼µå­ã‚’å¤‰æ›´

https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool/blob/master/source/powershell/Main.ps1#L1223-L1266

##### æŒ‡å®šã•ã‚ŒãŸç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã‚’WebPå½¢å¼ã«å¤‰æ›

https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool/blob/master/source/powershell/Main.ps1#L1267-L1361

##### æŒ‡å®šã•ã‚ŒãŸç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒªã‚µã‚¤ã‚ºå‡¦ç†

https://github.com/akiGAMEBOY/PowerShell_ResizeImageTool/blob/master/source/powershell/Main.ps1#L1362-L1555

#### \[PowerShell\]PDFãƒ•ã‚¡ã‚¤ãƒ«å†…ã®æ–‡å­—åˆ—ã‚’æ¤œç´¢ã—å­˜å¦ã‚’åˆ¤å®šã™ã‚‹ãƒ„ãƒ¼ãƒ«

https://zenn.dev/haretokidoki/articles/cad8b141202136
https://github.com/akiGAMEBOY/PowerShell_SearchForPdffileStrings

**æ³¨æ„äº‹é …ï¼šä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªâ€œiTextSharp 5â€ã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯ã€Œ[AGPLv3](https://github.com/itext/itextsharp/blob/develop/LICENSE.md)ã€**

https://github.com/akiGAMEBOY/PowerShell_SearchForPdffileStrings/blob/master/source/powershell/Main.ps1#L13-L15

##### æŒ‡å®šã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§PDFãƒ•ã‚¡ã‚¤ãƒ«å†…ã‚’æ¤œç´¢

https://github.com/akiGAMEBOY/PowerShell_SearchForPdffileStrings/blob/master/source/powershell/Main.ps1#L161-L207

#### \[PowerShell\]XMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´å½¢ï¼ˆåŠ å·¥ï¼‰ã™ã‚‹ãƒ„ãƒ¼ãƒ«

https://zenn.dev/haretokidoki/articles/a77765dd56f202
https://github.com/akiGAMEBOY/PowerShell_ShapingXMLfileTool

##### XMLãƒ•ã‚¡ã‚¤ãƒ«ã®å±æ€§ã‚’ä¸€æ‹¬ãƒã‚§ãƒƒã‚¯

https://github.com/akiGAMEBOY/PowerShell_ShapingXMLfileTool/blob/master/source/powershell/Main.ps1#L32-L64

https://github.com/akiGAMEBOY/PowerShell_ShapingXMLfileTool/blob/master/source/powershell/Main.ps1#L207-L234

##### XMLå±æ€§ã®ä¸¦ã³æ›¿ãˆå‡¦ç†

https://github.com/akiGAMEBOY/PowerShell_ShapingXMLfileTool/blob/master/source/powershell/Main.ps1#L235-L270

##### XMLã§ä¸è¦ãªå±æ€§ã®å‰Šé™¤

https://github.com/akiGAMEBOY/PowerShell_ShapingXMLfileTool/blob/master/source/powershell/Main.ps1#L271-L293

##### 2ã¤ã®ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¯”è¼ƒã—ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã«å‡ºåŠ›

https://github.com/akiGAMEBOY/PowerShell_ShapingXMLfileTool/blob/master/source/powershell/Main.ps1#L294-L354

##### XMLãƒ•ã‚¡ã‚¤ãƒ«å†…ã®æ–‡å­—åˆ—ç½®æ›

https://github.com/akiGAMEBOY/PowerShell_ShapingXMLfileTool/blob/master/source/powershell/Main.ps1#L355-L393

#### Windows OSã§ä¸€æ‹¬ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹PSã‚¹ã‚¯ãƒªãƒ—ãƒˆ(Win Update/MS Defender/ã‚¢ãƒ—ãƒª)

https://zenn.dev/haretokidoki/articles/a5d1a471a5699a
https://github.com/akiGAMEBOY/PowerShell_WindowsUpdateTool

##### ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®åˆ‡ã‚Šæ›¿ãˆ

https://github.com/akiGAMEBOY/PowerShell_WindowsUpdateTool/blob/master/source/powershell/Main.ps1#L432-L458

https://github.com/akiGAMEBOY/PowerShell_WindowsUpdateTool/blob/master/source/csharp/ActiveWindow.cs#L1-L136

##### å¼•æ•°ã§æŒ‡å®šã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

https://github.com/akiGAMEBOY/PowerShell_WindowsUpdateTool/blob/master/source/powershell/Main.ps1#L878-L933

## ã¾ã¨ã‚

ã‚ãŸã—è‡ªèº«ãŒæ–°è¦ã§PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã™ã‚‹éš›ã«ä¾¿åˆ©ãã†ãªã®ã§ã€ã“ã®è¨˜äº‹ã«ã¾ã¨ã‚ã¦ã¿ã¾ã—ãŸã€‚
ã“ã‚Œã‚‰Functionã‚’[ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã«ç™»éŒ²](https://zenn.dev/haretokidoki/articles/4da393f1f8d49d)ã™ã‚‹ã¨ã‚ˆã‚Šä¾¿åˆ©ã‹ã‚‚ã€‚

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
