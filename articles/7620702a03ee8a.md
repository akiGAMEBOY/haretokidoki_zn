---
title: "ã€PowerShellç‰¹æœ‰ã®è½ã¨ã—ç©´ã€‘FunctionãŒæœŸå¾…é€šã‚Šã®æˆ»ã‚Šå€¤ã§è¿”ã‚‰ãªã„äº‹è±¡"
emoji: "ğŸ›«"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

PowerShellã§ã¯ã€ŒFunctionå†…ã§ã®æ¨™æº–å‡ºåŠ›ï¼ˆ`Write-Output`ãªã©ï¼‰ãŒã€æ˜ç¤ºçš„ãªæˆ»ã‚Šå€¤ã¨ã—ã¦Functionã®å‘¼ã³å‡ºã—å…ƒã«æ¸¡ã•ã‚Œã‚‹ä»•æ§˜ï¼ˆä»¥é™ã€â€œFunctionå†…ã®æ¨™æº–å‡ºåŠ›ãŒæˆ»ã‚Šå€¤ã¨ã—ã¦å‘¼ã³å‡ºã—å…ƒã«è¿”ã•ã‚Œã‚‹ä»•æ§˜â€ã¨ã™ã‚‹ï¼‰ã€ã®å½±éŸ¿ã§ã€
æ„å›³ã—ãªã„æˆ»ã‚Šå€¤ãŒè¿”ã£ã¦ãã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

ä½•ã‚’éš ãã†ç§ã‚‚æ™‚é–“ãŒçµŒã¤ã¨ã€ã“ã®ä»•æ§˜ã®äº‹ã‚’å¿˜ã‚Œã¦ã—ã¾ã„ã€ä½•åº¦ã‹ãƒãƒã£ã¦ã—ã¾ã†ã“ã¨ã‚‚â€¦â€¦
ç§è‡ªèº«ã®å‚™å¿˜ã‚’ã‹ã­ã¦ã€ã“ã®ä»•æ§˜ã®è©³ã—ã„æƒ…å ±ã¨å¯¾å‡¦æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- ãŠã‚‚ã«PowerShellåˆå­¦è€…ãƒ»åˆç´šè€…ã®æ–¹
- ä¸‹è¨˜ã®ã‚ˆã†ãªåŸå› ä¸æ˜ãªã‚±ãƒ¼ã‚¹ã§ãŠæ‚©ã¿ã®æ–¹
    - è¤‡æ•°ã®Functionã‚’å«ã‚€PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ãŸçµæœã€ãªãœã‹ã‚¨ãƒ©ãƒ¼ã¨ãªã‚ŠåŸå› ãŒã‚ã‹ã‚‰ãªã„å ´åˆ
    - ã‚¨ãƒ©ãƒ¼ã®è¦å› ã‚’èª¿ã¹ã‚‹ã¨ã€ãªãœã‹æœŸå¾…é€šã‚Šã®ãƒ‡ãƒ¼ã‚¿å‹ã§æˆ»ã‚Šå€¤ãŒè¿”ã£ã¦ã„ãªã„å ´åˆ

## ã€ŒFunctionå†…ã®æ¨™æº–å‡ºåŠ›ãŒæˆ»ã‚Šå€¤ã¨ã—ã¦å‘¼ã³å‡ºã—å…ƒã«è¿”ã•ã‚Œã‚‹ä»•æ§˜ã€ã¨ã¯

å…·ä½“çš„ãªã‚³ãƒ¼ãƒ‰ã‚’è¦‹ãŸæ–¹ãŒæ—©ã„ã¨æ€ã†ã®ã§ä¸‹è¨˜ã«ã€Œä»•æ§˜ã§æˆ»ã‚Šå€¤ãŒæœŸå¾…é€šã‚Šã¨ãªã‚‰ãªã„ä¾‹ã€ã‚’è¨˜è¼‰ã€‚

```powershell:ä»•æ§˜ã§æˆ»ã‚Šå€¤ãŒæœŸå¾…é€šã‚Šã¨ãªã‚‰ãªã„ä¾‹
# Functionç¾¤
function New-Folder {
    param (
        [string]$FolderPath
    )
    # å‡¦ç†çµæœã®é€²æ—ã‚’å…¥ã‚Œã‚‹æ•°å€¤å‹ã®ã‚³ãƒ¼ãƒ‰
    [int]$statusCode = 0

    if (Test-Path -Path $FolderPath) {
        # ã™ã§ã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤
        try {
            Remove-Item -Path $FolderPath -Recurse -Force
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å‰Šé™¤ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -101
        }

        # å‰Šé™¤å¾Œã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ
        if ($statusCode -eq 0) {
            try {
                New-Item -ItemType Directory -Path $FolderPath
                # âŒ æˆ»ã‚Šå€¤ãŒãŠã‹ã—ããªã‚‹è¨˜è¿°
                Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å†ä½œæˆã€‚"
            }
            catch {
                Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
                $statusCode = -201
            }
        }
    }
    else {
        # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯ãã®ã¾ã¾ä½œæˆ
        try {
            New-Item -ItemType Directory -Path $FolderPath
            # âŒ æˆ»ã‚Šå€¤ãŒãŠã‹ã—ããªã‚‹è¨˜è¿°
            Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚"
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -301
        }
    }

    # âŒ æˆ»ã‚Šå€¤ãŒãŠã‹ã—ããªã‚‹è¨˜è¿°
    if ($statusCode -eq 0) {
        Write-Output "New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }
    else {
        Write-Output "New-FolderãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }

    # âŒ Intã§è¿”ã£ãŸã»ã—ã„ãŒã€æ¨™æº–å‡ºåŠ›ã®æ–‡å­—åˆ—å‹ã‚‚å…¥ã£ã¦Objectå‹ã¨ã—ã¦è¿”ã—ã¦ã—ã¾ã†ã€‚
    return $statusCode
}

# ãƒ¡ã‚¤ãƒ³å‡¦ç†
[int]$statusCode = 0

# âŒ Objectå‹ã§æˆ»ã£ãŸã“ã¨ã«ã‚ˆã‚ŠIntå‹ã«å¤‰æ›ä½¿ç”¨ã¨ã—ã¦ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚$statusCodeã¯ã€Œ0ã€ã®ã¾ã¾ã¨ãªã‚‹ã€‚
$statusCode = (New-Folder "D:\Temp")

if ($statusCode -eq 0) {
    # âŒ ä¸Šè¨˜ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã‚‚ã®ã®$statusCodeã¯ã€Œ0ã€ã®ã¾ã¾ãªã®ã§æ­£å¸¸çµ‚äº†ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºåŠ›
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

```powershell:
$DebugPreference = "Continue"
```

```powershell:
$DebugPreference = "SilentlyContinue"
```

```diff powershell:
# ãƒ¡ã‚¤ãƒ³å‡¦ç†
[int]$statusCode = 0

+Write-Debug ($statusCode.GetType().FullName)
+Write-Debug "statusCode[$($statusCode)]"
$statusCode = (New-Folder "D:\Temp")
+Write-Debug ($statusCode.GetType().FullName)
+Write-Debug "statusCode[$($statusCode)]"

if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}

# exit $statusCode
```

:::details ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ ã—ãŸã‚³ãƒ¼ãƒ‰å…¨ä½“

```powershell:
$DebugPreference = "Continue"
# $DebugPreference = "SilentlyContinue"

# Functionç¾¤
function New-Folder {
    param (
        [string]$FolderPath
    )
    # å‡¦ç†çµæœã®é€²æ—ã‚’å…¥ã‚Œã‚‹æ•°å€¤å‹ã®ã‚³ãƒ¼ãƒ‰
    [int]$statusCode = 0

    if (Test-Path -Path $FolderPath) {
        # ã™ã§ã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤
        try {
            Remove-Item -Path $FolderPath -Recurse -Force
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å‰Šé™¤ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -101
        }

        # å‰Šé™¤å¾Œã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ
        if ($statusCode -eq 0) {
            try {
                New-Item -ItemType Directory -Path $FolderPath
                # âŒ æˆ»ã‚Šå€¤ãŒãŠã‹ã—ããªã‚‹è¨˜è¿°
                Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å†ä½œæˆã€‚"
            }
            catch {
                Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
                $statusCode = -201
            }
        }
    }
    else {
        # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯ãã®ã¾ã¾ä½œæˆ
        try {
            New-Item -ItemType Directory -Path $FolderPath
            # âŒ æˆ»ã‚Šå€¤ãŒãŠã‹ã—ããªã‚‹è¨˜è¿°
            Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚"
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -301
        }
    }

    # âŒ æˆ»ã‚Šå€¤ãŒãŠã‹ã—ããªã‚‹è¨˜è¿°
    if ($statusCode -eq 0) {
        Write-Output "New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }
    else {
        Write-Output "New-FolderãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }

    return $statusCode
}

# ãƒ¡ã‚¤ãƒ³å‡¦ç†
[int]$statusCode = 0

Write-Debug ($statusCode.GetType().FullName)
Write-Debug "statusCode[$($statusCode)]"
$statusCode = (New-Folder "D:\Temp")
Write-Debug ($statusCode.GetType().FullName)
Write-Debug "statusCode[$($statusCode)]"

if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

:::

### ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å«ã‚ã¦å®Ÿè¡Œã—ã¦ã¿ã‚‹ã¨

```powershell:
DEBUG: System.Int32
DEBUG: statusCode[0]
MetadataError:
Line |
  64 |  $statusCode = (New-Folder "D:\Temp")
     |  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Cannot convert the "System.Object[]" value of type "System.Object[]" to type "System.Int32".
DEBUG: System.Int32
DEBUG: statusCode[0]
ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
PS C:\Users\XXXX>
```

### ãƒ‡ãƒãƒƒã‚°ã—ã¦ã‚³ãƒ¼ãƒ‰ä¾‹ã§ã¯ã©ã®ã‚ˆã†ãªã“ã¨ãŒèµ·ãã¦ã„ã‚‹ã‹

1. ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã€Œ0ã€ãŒä»£å…¥
2. Functionï¼ˆ`New-Folder`ï¼‰ãŒå®Ÿè¡Œ
    1. ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒä½œæˆã‚‚ã—ãã¯å†ä½œæˆ
        â†’ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã€Œ0ã€ãŒä»£å…¥
    2. æ¨™æº–å‡ºåŠ›(`Write-Output`)ã§é€²æ—ã‚„çµæœã‚’è¡¨ç¤º
        â†’ æŒ‡å®šã—ã¦ãªãã¦ã‚‚**è‡ªå‹•ã§æˆ»ã‚Šå€¤ã«æ¨™æº–å‡ºåŠ›ã®çµæœãŒè‡ªå‹•ã§å…¥ã‚‹**


## è¤‡æ•°ã®äº‹ä¾‹ã¨ãã®è§£æ±ºæ¡ˆ

### **äº‹ä¾‹1: Write-Outputã«ã‚ˆã‚‹äºˆæœŸã›ã¬æ¨™æº–å‡ºåŠ›**

**å•é¡Œ:**  
é–¢æ•°å†…ã§ `Write-Output` ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€æ„å›³ã›ãšãã®çµæœãŒæˆ»ã‚Šå€¤ã¨ã—ã¦è¿”ã•ã‚Œã¾ã™ã€‚

**ã‚³ãƒ¼ãƒ‰ä¾‹:**  

```powershell
function Get-Number {
    Write-Output "Debugging Info" # ä½™åˆ†ãªæ¨™æº–å‡ºåŠ›
    return 42
}

$result = Get-Number
Write-Host "çµæœ: $result" # "Debugging Info" ã¨ 42 ã®ä¸¡æ–¹ãŒè¿”ã•ã‚Œã‚‹
```

**å¯¾å¿œæ–¹æ³•:**  

1. **ä¸è¦ãªæ¨™æº–å‡ºåŠ›ã‚’å®Œå…¨ã«æ’é™¤ã™ã‚‹**
    æ¨™æº–å‡ºåŠ›ã‚’æŠ‘åˆ¶ã™ã‚‹å ´åˆã«ã¯æ˜ç¤ºçš„ã«ãã®å‡¦ç†ã‚’è¡Œã†ã®ã§ã¯ãªãã€ä½™è¨ˆãª `Write-Output` ã‚’å‰Šé™¤ã—ã€æ„å›³çš„ãªå‡¦ç†ã‚’è¨˜è¿°ã—ãªã„æ–¹æ³•ãŒé©åˆ‡ã§ã™ã€‚
2. **ãƒ‡ãƒãƒƒã‚°ç”¨é€”ã®å ´åˆ**
    ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ®‹ã™æ„å›³ãŒã‚ã‚‹å ´åˆã¯ã€`Write-Debug` ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å‡ºåŠ›ã‚’ç°¡å˜ã«åˆ¶å¾¡å¯èƒ½ã«ã—ã¾ã™ã€‚

**ã‚³ãƒ¼ãƒ‰ä¾‹:**  

```powershell
# ä¸è¦ãªæ¨™æº–å‡ºåŠ›ã‚’æ’é™¤
function Get-Number {
    return 42 # ãƒ‡ãƒãƒƒã‚°ç›®çš„ã§ãªã‘ã‚Œã° Write-Output ã‚’ä½¿ç”¨ã—ãªã„
}

# ãƒ‡ãƒãƒƒã‚°ç›®çš„
function Get-Number-Debug {
    Write-Debug "ç¾åœ¨ã®é–¢æ•°å‡¦ç†: 42 ã‚’è¿”ã—ã¦ã„ã¾ã™"
    return 42
}

$DebugPreference = "Continue" # ãƒ‡ãƒãƒƒã‚°ã‚’æœ‰åŠ¹åŒ–
$result = Get-Number-Debug
Write-Host "çµæœ: $result" # å¿…è¦ã«å¿œã˜ã¦ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª
```

---

### **äº‹ä¾‹2: è¤‡æ•°ã®æˆ»ã‚Šå€¤ãŒè¿”ã•ã‚Œã‚‹**

**å•é¡Œ:**  

1. **æ„å›³çš„ã«é…åˆ—ã‚’è¿”ã™**
    è¤‡æ•°ã®å€¤ã‚’è¿”ã™å¿…è¦ãŒã‚ã‚‹å ´åˆã€PowerShellã® `@()` æ¼”ç®—å­ã‚’ä½¿ç”¨ã—ã¦æ˜ç¤ºçš„ã«é…åˆ—ã¨ã—ã¦è¿”ã—ã¾ã™ã€‚
2. **å˜ä¸€å€¤ã‚’è¿”ã™å ´åˆ**
    æ„å›³çš„ã«æœ€å¾Œã« `return` ã‚’åˆ©ç”¨ã—ã€æ˜ç¤ºçš„ã«æˆ»ã‚Šå€¤ã‚’æŒ‡å®šã™ã‚‹ã€‚

**ã‚³ãƒ¼ãƒ‰ä¾‹:**  

```powershell
function Get-Data {
    Write-Output 10
    Write-Output 20
}

$result = Get-Data
Write-Host "çµæœ: $result" # "10 20" ãŒè¿”ã‚‹ï¼ˆé…åˆ—åŒ–ã•ã‚Œã‚‹ï¼‰
```

**å¯¾å¿œæ–¹æ³•:**  
é…åˆ—ã«æ ¼ç´ã—ã€æ˜ç¤ºçš„ã«åˆ¶å¾¡ã—ã¾ã™ã€‚

**ä¿®æ­£ä¾‹:**  

```powershell
function Get-MultipleValues {
    return @(10, 20) # æ˜ç¤ºçš„ã«é…åˆ—ã‚’è¿”ã™
}

function Get-SingleValue {
    return 10 # å˜ä¸€ã®å€¤ã‚’è¿”ã™
}

# å‘¼ã³å‡ºã—ä¾‹
$resultArray = Get-MultipleValues
Write-Host "é…åˆ—: $($resultArray -join ', ')"

$resultSingle = Get-SingleValue
Write-Host "å˜ä¸€å€¤: $resultSingle"
```

---

### **äº‹ä¾‹3: ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«ã‚ˆã‚‹æš—é»™çš„ãªãƒ‡ãƒ¼ã‚¿æµå‡º**

**å•é¡Œ:**  
é–¢æ•°å†…ã®æ¨™æº–å‡ºåŠ›ãŒãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’é€šã˜ã¦å¤–éƒ¨ã«å‡ºåŠ›ã•ã‚Œã€æ„å›³ã—ãªã„æˆ»ã‚Šå€¤ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

**ã‚³ãƒ¼ãƒ‰ä¾‹:**

```powershell:
function Get-String {
    "This is output"
    return "Expected Return"
}

$result = Get-String
Write-Host "çµæœ: $result" # "This is output" ãŒå„ªå…ˆã•ã‚Œã‚‹
```

**å¯¾å¿œæ–¹æ³•:**  

1. **`$Output.Clear()` ã‚’æ´»ç”¨**
    ãƒ‡ãƒ¼ã‚¿ã®æµå‡ºã‚’æŠ‘åˆ¶ã™ã‚‹ãŸã‚ã«ã€å‡¦ç†ã®é–‹å§‹æ™‚ã« `$Output.Clear()` ã‚’ç”¨ã„ã‚‹æ–¹æ³•ãŒæœ‰åŠ¹ã§ã™ã€‚
2. **é©åˆ‡ãªæˆ»ã‚Šå€¤ã®è¨­è¨ˆ**
    æˆ»ã‚Šå€¤ãŒæœ€å¾Œã«æ„å›³çš„ã«åˆ¶å¾¡ã•ã‚Œã‚‹ã¹ãã§ã‚ã‚‹ã“ã¨ã‚’å¿µé ­ã«ç½®ãã¾ã™ã€‚

**ä¿®æ­£ä¾‹:**

```powershell:
function Get-String {
    $Output.Clear() # æ¨™æº–å‡ºåŠ›ã‚’ã‚¯ãƒªã‚¢
    "This is debug info" > $null # æ¨™æº–å‡ºåŠ›ã®æŠ‘åˆ¶
    return "Expected Return"
}

$result = Get-String
Write-Host "çµæœ: $result" # æ­£ã—ã„æˆ»ã‚Šå€¤ãŒå¾—ã‚‰ã‚Œã‚‹
```

---

### **äº‹ä¾‹4: æˆ»ã‚Šå€¤ãŒç•°ãªã‚‹å‹ã«ã‚­ãƒ£ã‚¹ãƒˆã•ã‚Œã‚‹**

**å•é¡Œ:**  
æˆ»ã‚Šå€¤ã®å‹ãŒé–¢æ•°å†…ã®æ“ä½œã«ã‚ˆã£ã¦æš—é»™çš„ã«å¤‰æ›´ã•ã‚Œã¾ã™ã€‚

**ã‚³ãƒ¼ãƒ‰ä¾‹:**

```powershell
function Convert-StringToInt {
    param (
        [string]$TargetString
    )
    [int]$value = $TargetString
    Write-Host "æ–‡å­—åˆ—[$TargetString]ã‚’æ•°å€¤å‹[$value]ã«å¤‰æ›ã—ã¾ã—ãŸã€‚"
    return $value
}

$result = Convert-StringToInt -TargetString "123abc" # æ•´æ•°ã¨ã—ã¦æ‰±ã†ã«ã¯ä¸é©åˆ‡
Write-Host "çµæœ: $result" # æœŸå¾…ã—ãŸå€¤ã«ãªã‚‰ãªã„
```

**å¯¾å¿œæ–¹æ³•:**  

1. **æ˜ç¤ºçš„ãªå‹æŒ‡å®š**
    PowerShellã§ã¯å‹ã®æ˜ç¤ºãŒå¯èƒ½ãªãŸã‚ã€å¿…è¦ãªå‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚
2. **å‹å¤‰æ›ã‚¨ãƒ©ãƒ¼ã«å¯¾ã™ã‚‹ä¾‹å¤–å‡¦ç†**
    å‹å¤‰æ›ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹å ´åˆã¯ã€`Try-Catch` ã‚’ä½¿ç”¨ã—ã¦ä¾‹å¤–å‡¦ç†ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

**ä¿®æ­£ä¾‹:**  

```powershell
function Convert-StringToInt {
    param (
        [string]$TargetString
    )
    try {
        [int]$value = $TargetString    
        Write-Host "æ–‡å­—åˆ—[$TargetString]ã‚’æ•°å€¤å‹[$value]ã«å¤‰æ›ã—ã¾ã—ãŸã€‚"
    }
    catch {
        Write-Error "ConvertStringToint: å¤‰æ›æ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚[$($_.Exception.Message)"
        return $null
    }

    return $value
}

$result = Convert-StringToInt -TargetString "123abc" # æ•´æ•°ã¨ã—ã¦æ‰±ã†ã«ã¯ä¸é©åˆ‡
if ($null -ne $result) {
    Write-Host "çµæœ: $result"
}
else {
    Write-Host "å¤‰æ›æ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸãŸã‚ã€çµæœã‚’è¡¨ç¤ºã—ã¾ã›ã‚“ã€‚"
}
```

## å¯¾å¿œæ–¹æ³•

## ã¾ã¨ã‚

## é–¢é€£è¨˜äº‹
