---
title: "PowerShellç‰¹æœ‰ã®è½ã¨ã—ç©´ï¼Functionå†…ã§æ¨™æº–å‡ºåŠ›ã™ã‚‹ã¨æˆ»ã‚Šå€¤ãŒã€ŒSystem.Object[]ã€ã«ãªã£ã¦ã—ã¾ã†ä»•æ§˜ã«ã¤ã„ã¦"
emoji: "ğŸ›«"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: true
---

PowerShellã§ã¯ã€ŒFunctionå†…ã®æ¨™æº–å‡ºåŠ›ãŒæˆ»ã‚Šå€¤ã¨ã—ã¦å‘¼ã³å‡ºã—å…ƒã«æ¸¡ã•ã‚Œã‚‹ã€ã¨ã„ã†**ä»•æ§˜**ãŒã‚ã‚Šã¾ã™ã€‚

è¦ã¯ã€ **Functionå†…ã§æ¨™æº–å‡ºåŠ›ã™ã‚‹ã¨æ„å›³ã—ãªã„æˆ»ã‚Šå€¤ã«ãªã‚‹ã‚ˆ** ã€ã¨ã„ã†ã“ã¨ã€‚

ä½•ã‚’éš ãã†ç§ã‚‚æ™‚é–“ãŒçµŒã¤ã¨ã€ã“ã®ä»•æ§˜ã‚’å¿˜ã‚Œã¦ã—ã¾ã„ä½•åº¦ã‹ãƒãƒã£ã¦ã„ã¾ã™â€¦â€¦
ç§è‡ªèº«ã®å‚™å¿˜ã‚‚ã‹ã­ã¦ã€ã“ã®ä»•æ§˜ã®è©³ã—ã„æƒ…å ±ã¨å¯¾å‡¦æ–¹æ³•ã‚’ç´¹ä»‹ã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- ä¸»ã«PowerShellåˆå­¦è€…ãƒ»åˆç´šè€…ã®æ–¹
- ä¸‹è¨˜ã®ã‚ˆã†ãªã‚±ãƒ¼ã‚¹ã®åŸå› ä¸æ˜ãªã‚¨ãƒ©ãƒ¼ã§ãŠæ‚©ã¿ã®æ–¹
    - è¤‡æ•°ã®Functionã§é€£æºã™ã‚‹PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ
    - ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ç›´ã™ãŒå•é¡ŒãŒãªã„ã‚ˆã†ã«è¦‹ãˆã€ãªãœã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã‹ä¸æ˜
    - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã¿ã‚‹ã¨ã€ãªãœã‹Functionã®æˆ»ã‚Šå€¤ãŒæƒ³å®šå¤–ã®ãƒ‡ãƒ¼ã‚¿å‹ã§è¿”ã£ã¦ã„ã‚‹

## ã€ŒFunctionå†…ã§æ¨™æº–å‡ºåŠ›ã™ã‚‹ã¨æ„å›³ã—ãªã„æˆ»ã‚Šå€¤ã«ãªã‚‹ã€ã¨ã¯

è¨€è‘‰ã®é€šã‚Šãªã®ã§ã™ãŒæ–‡ç« ã ã‘ã§ã¯ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒæ´ã¿ã«ãã„ã¨æ€ã†ã®ã§ã€ãã®äº‹è±¡ã¨ãªã‚‹ã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚

### ä»•æ§˜ã§æˆ»ã‚Šå€¤ãŒæœŸå¾…å€¤ã¨ãªã‚‰ãªã„ã‚³ãƒ¼ãƒ‰

æ„å›³ã—ãªã„æˆ»ã‚Šå€¤ã«ã•ã›ã¦ã—ã¾ã£ã¦ã„ã‚‹ãƒã‚¤ãƒ³ãƒˆã«ã¯ã€ŒâŒãƒãƒ¼ã‚¯ã€ã§ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ã„ã¾ã™ã€‚

```powershell:ä»•æ§˜ã§æˆ»ã‚Šå€¤ãŒæœŸå¾…å€¤ã¨ãªã‚‰ãªã„ã‚³ãƒ¼ãƒ‰ã®ä¾‹
# Function
function New-Folder {
    param (
        [string]$FolderPath
    )
    # å‡¦ç†çµæœã®é€²æ—ã‚’å…¥ã‚Œã‚‹æ•°å€¤å‹ã®ã‚³ãƒ¼ãƒ‰
    [int]$statusCode = 0

    if (Test-Path -Path $FolderPath) {
        # ã™ã§ã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤
        try {
            Remove-Item -Path $FolderPath -Recurse -Force
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å‰Šé™¤ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -101
        }

        # å‰Šé™¤å¾Œã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ
        if ($statusCode -eq 0) {
            try {
                # âŒ New-Itemã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
                New-Item -ItemType Directory -Path $FolderPath
                # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
                Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å†ä½œæˆã€‚"
            }
            catch {
                Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
                $statusCode = -201
            }
        }
    }
    else {
        # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯ãã®ã¾ã¾ä½œæˆ
        try {
            # âŒ New-Itemã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
            New-Item -ItemType Directory -Path $FolderPath
            # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
            Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚"
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -301
        }
    }

    # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
    if ($statusCode -eq 0) {
        Write-Output "New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }
    else {
        Write-Output "New-FolderãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }

    # âŒ Intã§è¿”ã£ãŸã»ã—ã„ãŒã€æ¨™æº–å‡ºåŠ›ã®æ–‡å­—åˆ—å‹ã‚‚å…¥ã£ã¦Objectå‹ã¨ã—ã¦è¿”ã—ã¦ã—ã¾ã†ã€‚
    return $statusCode
}

# ãƒ¡ã‚¤ãƒ³å‡¦ç†
[int]$statusCode = 0

# âŒ Functionå®Ÿè¡Œã—ã¦ã„ã‚‹å ´æ‰€ã§å®Ÿè¡Œã™ã‚‹ã¨Objectå‹ã§è¿”ã£ã¦ãã¦ãã‚‹ã€‚
#     æˆ»ã‚Šå€¤ã‚’Intå‹ã®$statusCodeã«ä»£å…¥ã—ã¦ã„ã‚‹ã®ã§ãƒ‡ãƒ¼ã‚¿å‹ã®å¤‰æ›å‡¦ç†ãŒç™ºç”Ÿã€‚Objectå‹ã‹ã‚‰Intå‹ã«ã¯å¤‰æ›ä¸å¯ã¨ãªã‚‹ãŸã‚ã‚³ã‚³ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚
#     $stautsCode ã«å€¤ã‚’ä»£å…¥ã™ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ãŸã‚ã€$statusCodeã¯ã€Œ0ã€ã®ã¾ã¾ã¨ãªã‚‹ã€‚
$statusCode = (New-Folder "D:\Temp")

# âŒ ä¸Šè¨˜ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã‚‚ã®ã®$statusCodeã¯ã€Œ0ã€ã®ã¾ã¾ãªã®ã§æ­£å¸¸çµ‚äº†ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºåŠ›
if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

ã“ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ Functionï¼ˆ`New-Folder`ï¼‰ã®æˆ»ã‚Šå€¤ã¯ã€æ•°å€¤å‹ï¼ˆ`Int`ï¼‰ã§ã¯ãªã Functionå†…ã§å‡ºåŠ›ã•ã‚ŒãŸæ¨™æº–å‡ºåŠ›çµæœï¼ˆ`Write-Output` ã‚„ `New-Item`ï¼‰ã‚’å«ã‚€ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ï¼ˆ`System.Object[]`ï¼‰ãŒæˆ»ã‚Šå€¤ã«ã€‚

ã¤ãã¯å®Ÿéš›ã«ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

### â€œä»•æ§˜ã§æˆ»ã‚Šå€¤ãŒæœŸå¾…å€¤ã¨ãªã‚‰ãªã„ã‚³ãƒ¼ãƒ‰â€ã‚’å®Ÿè¡Œã—ãŸçµæœ

â€œä»•æ§˜ã§æˆ»ã‚Šå€¤ãŒæœŸå¾…å€¤ã¨ãªã‚‰ãªã„â€ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä¸‹è¨˜ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚

```powershell:ã‚¨ãƒ©ãƒ¼ï¼ˆçµæœã‚’ãã®ã¾ã¾è¨˜è¼‰ï¼‰
MetadataError:
Line |
  63 |  $statusCode = (New-Folder "D:\Temp")
     |  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Cannot convert the "System.Object[]" value of type "System.Object[]" to type "System.Int32".
ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
```

æ—¥æœ¬èªã®ç¿»è¨³ã™ã‚‹ã¨ä¸‹è¨˜ã®ã¨ãŠã‚Šã€‚

```powershell:ã‚¨ãƒ©ãƒ¼ï¼ˆçµæœã‚’æ—¥æœ¬èªã«ç¿»è¨³ï¼‰
ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ©ãƒ¼:
è¡Œ |
  63 |  $statusCode = (New-Folder "D:\Temp")
     |  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | "System.Object[]" å‹ã®å€¤ "System.Object[]" ã‚’ "System.Int32" å‹ã«å¤‰æ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚
ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
```

å‰è¿°ã—ã¦ã„ã‚‹é€šã‚Š Functionï¼ˆ`New-Folder`ï¼‰ã‚’å®Ÿè¡Œã—ãŸæˆ»ã‚Šå€¤ãŒã€System.Int32 ã§ã¯ãªã ã€Œ**System.Object[]**ã€ã§è¿”ã£ã¦ããŸã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚
ã§ã¯ã€å®Ÿéš›ã«ã©ã®ã‚ˆã†ãªæµã‚Œã§ã€Œ**System.Object[]**ã€ãŒè¿”ã£ã¦ããŸã®ã‹ãƒ‡ãƒãƒƒã‚°ã—ã¦è©³ç´°ã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

### èª¿æŸ»ã®ãŸã‚ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ ã—ãŸã‚³ãƒ¼ãƒ‰

Functionã‚’å®Ÿè¡Œã™ã‚‹å‰å¾Œã® `$statusCode` ã®ãƒ‡ãƒ¼ã‚¿å‹ã¨ä¸­èº«ã‚’ç¢ºèªã—ã¾ã™ã€‚
ç¢ºèªã™ã‚‹æ–¹æ³•ã¨ã—ã¦ã€`Write-Debug` ã‚’ä½¿ã„ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ä¸­ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºåŠ›ã™ã‚‹ã‚ˆã†ã«ä¿®æ­£ã€‚

PowerShellã§ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’ã‚ªãƒ³ã«ã™ã‚‹ã«ã¯ã€äº‹å‰ã«ä¸‹è¨˜ã‚’è¨­å®šã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```powershell:ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’ã‚ªãƒ³ã«ã™ã‚‹è¨­å®š
$DebugPreference = "Continue"
```

ã¡ãªã¿ã«ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã‹ã‚‰æŠœã‘ã‚‹å ´åˆã¯ä¸‹è¨˜ã‚’è¨­å®šã—ã¾ã™ã€‚

```powershell:ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’ã‚ªãƒ•ã«ã™ã‚‹è¨­å®šï¼ˆåˆ‡ã‚Šæˆ»ã—ç”¨ï¼‰
$DebugPreference = "SilentlyContinue"
```

ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«è¿½åŠ ã—ã¾ã™ã€‚

```diff powershell:ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
# ãƒ¡ã‚¤ãƒ³å‡¦ç†
[int]$statusCode = 0

+Write-Debug ($statusCode.GetType().FullName)
+Write-Debug "statusCode[$($statusCode)]"
$statusCode = (New-Folder "D:\Temp")
+Write-Debug ($statusCode.GetType().FullName)
+Write-Debug "statusCode[$($statusCode)]"

if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

:::details èª¿æŸ»ã®ãŸã‚ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ ã—ãŸã‚³ãƒ¼ãƒ‰ï¼ˆå…¨ä½“ï¼‰

ãƒ‡ãƒãƒƒã‚°é–¢é€£ã‚’è¿½åŠ ã—ãŸã‚³ãƒ¼ãƒ‰ã€‚
è¿½åŠ ã—ãŸç®‡æ‰€ã«ã¯ã€ŒğŸ“‘ãƒãƒ¼ã‚¯ã€ã‚’å…¥ã‚Œã¦ã„ã¾ã™ã€‚

```powershell:
# ğŸ“‘ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’ã‚ªãƒ³
$DebugPreference = "Continue"
# $DebugPreference = "SilentlyContinue"

# Functionç¾¤
function New-Folder {
    param (
        [string]$FolderPath
    )
    # å‡¦ç†çµæœã®é€²æ—ã‚’å…¥ã‚Œã‚‹æ•°å€¤å‹ã®ã‚³ãƒ¼ãƒ‰
    [int]$statusCode = 0

    if (Test-Path -Path $FolderPath) {
        # ã™ã§ã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤
        try {
            Remove-Item -Path $FolderPath -Recurse -Force
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å‰Šé™¤ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -101
        }

        # å‰Šé™¤å¾Œã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ
        if ($statusCode -eq 0) {
            try {
                # âŒ New-Itemã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
                New-Item -ItemType Directory -Path $FolderPath
                # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
                Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å†ä½œæˆã€‚"
            }
            catch {
                Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
                $statusCode = -201
            }
        }
    }
    else {
        # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯ãã®ã¾ã¾ä½œæˆ
        try {
            # âŒ New-Itemã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
            New-Item -ItemType Directory -Path $FolderPath
            # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
            Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚"
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -301
        }
    }

    # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
    if ($statusCode -eq 0) {
        Write-Output "New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }
    else {
        Write-Output "New-FolderãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }

    # âŒ Intã§è¿”ã£ãŸã»ã—ã„ãŒã€æ¨™æº–å‡ºåŠ›ã®æ–‡å­—åˆ—å‹ã‚‚å…¥ã£ã¦Objectå‹ã¨ã—ã¦è¿”ã—ã¦ã—ã¾ã†ã€‚
    return $statusCode
}

# ãƒ¡ã‚¤ãƒ³å‡¦ç†
[int]$statusCode = 0

# ğŸ“‘ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿½åŠ 
Write-Debug ($statusCode.GetType().FullName)
Write-Debug "statusCode[$($statusCode)]"
# âŒ Objectå‹ã§æˆ»ã£ãŸã“ã¨ã«ã‚ˆã‚ŠIntå‹ã«å¤‰æ›ä½¿ç”¨ã¨ã—ã¦ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚$statusCodeã¯ã€Œ0ã€ã®ã¾ã¾ã¨ãªã‚‹ã€‚
$statusCode = (New-Folder "D:\Temp")
# ğŸ“‘ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿½åŠ 
Write-Debug ($statusCode.GetType().FullName)
Write-Debug "statusCode[$($statusCode)]"

# âŒ ä¸Šè¨˜ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã‚‚ã®ã®$statusCodeã¯ã€Œ0ã€ã®ã¾ã¾ãªã®ã§æ­£å¸¸çµ‚äº†ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºåŠ›
if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

:::

#### â€œèª¿æŸ»ã®ãŸã‚ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ ã—ãŸã‚³ãƒ¼ãƒ‰â€ã‚’å®Ÿè¡Œã—ãŸçµæœ

```powershell:ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ ã—ãŸã‚³ãƒ¼ãƒ‰ã®å®Ÿè¡Œçµæœ
DEBUG: System.Int32
DEBUG: statusCode[0]
MetadataError:
Line |
  64 |  $statusCode = (New-Folder "D:\Temp")
     |  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Cannot convert the "System.Object[]" value of type "System.Object[]" to type "System.Int32".
DEBUG: System.Int32
DEBUG: statusCode[0]
ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
PS C:\Users\XXXX>
```

Functionï¼ˆ`New-Folder`ï¼‰ã‚’å®Ÿè¡Œã™ã‚‹å‰å¾Œã§ `$statusCode` ã®çµæœã‚’ç¢ºèªã™ã‚‹ã¨ã€ãƒ‡ãƒ¼ã‚¿å‹ã¯ `System.Int32` ã§ ä¸­èº«ã¯æ•°å­— `0` ã®ã¾ã¾ã§ã™ã€‚

ã¤ãã« `Cannot convert the "System.Object[]" value of type "System.Object[]" to type "System.Int32".` ã¨ã„ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¦‹ã¦ã„ãã¾ã™ã€‚
Functionï¼ˆ`New-Folder`ï¼‰ã®æˆ»ã‚Šå€¤ã¯ã€PowerShellç‰¹æœ‰ã®ä»•æ§˜ã«ã‚ˆã‚Š `System.Object[]` ã§è¿”ã‚Šã€ãã®ãƒ‡ãƒ¼ã‚¿ã‚’æ•°å€¤å‹ã® `$statusCode` ã«ä»£å…¥ã—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ãŸã‚ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚
ã“ã®ã‚¨ãƒ©ãƒ¼ã¯ã€æ„å›³ã—ãªã„ãƒ‡ãƒ¼ã‚¿å‹ã®æˆ»ã‚Šå€¤ã ã£ãŸã‹ã‚‰ç™ºç”Ÿã—ãŸã®ã§ã¯ãªãã€ãƒ‡ãƒ¼ã‚¿å‹ã®å¤‰æ›å‡¦ç†ãŒè¡Œã‚ã‚ŒãŸçµæœã€ç™ºç”Ÿã—ãŸã‚¨ãƒ©ãƒ¼ã§ã™ã€‚
ã“ã‚Œã‚‚PowerShellã®ä»•æ§˜ãªã®ã§ã™ãŒã€åˆ¥ã®ãƒ‡ãƒ¼ã‚¿å‹ã®å¤‰æ•°ã«ä»£å…¥ã™ã‚‹ã¨è‡ªå‹•ã§ã‚­ãƒ£ã‚¹ãƒˆï¼ˆå‹ã®å¤‰æ›ï¼‰ãŒç™ºç”Ÿã€‚
ãã®ã‚­ãƒ£ã‚¹ãƒˆå‡¦ç†ãŒå®Ÿè¡Œã•ã‚ŒãŸã‚‚ã®ã®ã€`System.Object[]` ã‹ã‚‰ `System.Int32` ã¯ã‚­ãƒ£ã‚¹ãƒˆï¼ˆå¤‰æ›ï¼‰ã§ããªã„ãƒ‡ãƒ¼ã‚¿å‹åŒå£«ãªã®ã§ `Cannot convert` ã‹ã‚‰å§‹ã¾ã‚‹ **ãƒ‡ãƒ¼ã‚¿å‹ã®å¤‰æ›ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸ** ã¨ã„ã†æµã‚Œã¨ãªã‚Šã¾ã™ã€‚

ã‚ã‚‰ãŸã‚ã¦ç®‡æ¡æ›¸ãã§å‡¦ç†ã®æµã‚Œã‚’èª¬æ˜ã™ã‚‹ã¨æœ¬æ¥ã€Functionï¼ˆ`New-Folder`ï¼‰ã§æœŸå¾…ã—ã¦ã„ãŸãƒ‡ãƒ¼ã‚¿å‹ã¯ã€ã€Œ`System.Int32`ã€ã€‚
ã—ã‹ã—ã€Functionå†…ã®æ¨™æº–å‡ºåŠ›ã«ã‚ˆã‚Šã€Œ`@("New-Itemã®æ¨™æº–å‡ºåŠ›çµæœ", "Write-Outputã®æ¨™æº–å‡ºåŠ›çµæœ", "$statusCodeã®æ•°å€¤")`ã€ã¨ã„ã†ã‚ˆã†ãª `System.Object[]` ã®æˆ»ã‚Šå€¤ã¨ã—ã¦è¿”ã£ã¦ãã¦ã€
ãã®æ„å›³ã—ãªã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ï¼ˆ`System.Object[]`ï¼‰ã®æˆ»ã‚Šå€¤ã‚’ç•°ãªã‚‹æ•°å€¤å‹ï¼ˆ`System.Int32`ï¼‰ã«ä»£å…¥ã•ã‚ŒãŸã¨ãã«ã‚­ãƒ£ã‚¹ãƒˆå‡¦ç†ãŒç™ºç”Ÿã—ã€ãƒ‡ãƒ¼ã‚¿å‹ã®å¤‰æ›ãŒä¸å¯èƒ½ãªãŸã‚ **ãƒ‡ãƒ¼ã‚¿å‹ã®å¤‰æ›ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ**ã¨ãªã‚Šã¾ã™ã€‚

ã§ã¯ã€å®Ÿéš›ã«æˆ»ã£ã¦ããŸ `System.Object[]` ã®ä¸­èº«ãŒäºˆæƒ³é€šã‚Šã‹è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

### æœ¬å½“ã«æˆ»ã‚Šå€¤ãŒ System.Object[] ã§æ¨™æº–å‡ºåŠ›ã‚‚å«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

å®Ÿéš›ã«Functionï¼ˆ`New-Folder`ï¼‰ã®æˆ»ã‚Šå€¤å†…ã‚’ç¢ºèªã—ã¦ã¿ã¾ã™ã€‚
ç¢ºèªã™ã‚‹ãŸã‚ã«æ–°ãŸã«ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ï¼

#### æˆ»ã‚Šå€¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã®ä¸­èº«ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚³ãƒ¼ãƒ‰

```diff powershell:æˆ»ã‚Šå€¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã®ä¸­èº«ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ 
# ãƒ¡ã‚¤ãƒ³å‡¦ç†
-[int]$statusCode = 0
+[object]$resultData = @()

-$statusCode = (New-Folder "D:\Temp")
+$resultData = (New-Folder "D:\Temp")
+$resultData | Format-List

if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

:::details æˆ»ã‚Šå€¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã®ä¸­èº«ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚³ãƒ¼ãƒ‰ï¼ˆå…¨ä½“ï¼‰

ä¸Šè¨˜ã®ã¨ãŠã‚Šã€å¤‰æ•°ï¼ˆ`$resultData`ï¼‰ã®ä¸­èº«ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã€‚
å¤‰åŒ–ç‚¹ã«ã¯ã€ŒğŸ‘€ãƒãƒ¼ã‚¯ã€ã‚’å…¥ã‚Œã¦ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ã¾ã™ã€‚

```powershell:System.Object[]ã®ä¸­èº«ç¢ºèªç”¨ã®ã‚³ãƒ¼ãƒ‰
# Functionç¾¤
function New-Folder {
    param (
        [string]$FolderPath
    )
    # å‡¦ç†çµæœã®é€²æ—ã‚’å…¥ã‚Œã‚‹æ•°å€¤å‹ã®ã‚³ãƒ¼ãƒ‰
    [int]$statusCode = 0

    if (Test-Path -Path $FolderPath) {
        # ã™ã§ã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤
        try {
            Remove-Item -Path $FolderPath -Recurse -Force
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å‰Šé™¤ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -101
        }

        # å‰Šé™¤å¾Œã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ
        if ($statusCode -eq 0) {
            try {
                New-Item -ItemType Directory -Path $FolderPath
                Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å†ä½œæˆã€‚"
            }
            catch {
                Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
                $statusCode = -201
            }
        }
    }
    else {
        # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯ãã®ã¾ã¾ä½œæˆ
        try {
            New-Item -ItemType Directory -Path $FolderPath
            Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚"
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -301
        }
    }
    
    if ($statusCode -eq 0) {
        Write-Output "New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }
    else {
        Write-Output "New-FolderãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }
    
    return $statusCode
}

# ãƒ¡ã‚¤ãƒ³å‡¦ç†
# ğŸ‘€ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã¨ã—ã¦å—ã‘å–ã‚‹ãŸã‚å¤‰æ•°ã‚’å®£è¨€
[object]$resultData = @()

# ğŸ‘€ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã¨ã—ã¦å—ã‘å–ã‚‹
$resultData = (New-Folder "D:\Temp")

# ğŸ‘€ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã®ä¸­èº«ã‚’ç¢ºèª
$resultData | Format-List

if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

:::

#### â€œæˆ»ã‚Šå€¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã®ä¸­èº«ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚³ãƒ¼ãƒ‰â€ã‚’å®Ÿè¡Œã—ãŸçµæœ

ä¸‹è¨˜ãŒå®Ÿè¡Œã—ãŸçµæœã§ã™ã€‚

```powershell:â€œæˆ»ã‚Šå€¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã®ä¸­èº«ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚³ãƒ¼ãƒ‰â€ã‚’å®Ÿè¡Œã—ãŸçµæœ


    Directory: D:\

Name           : Temp
CreationTime   : 2025/03/13 12:28:42
LastWriteTime  : 2025/03/13 12:28:42
LastAccessTime : 2025/03/13 12:28:42
Mode           : d----
LinkType       :
Target         :

New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚
New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
0
ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
PS C:\Users\XXXX>
```

å®Ÿè¡Œçµæœã®ä¸€ã¤ã²ã¨ã¤ã‚’åˆ†é¡ã—ã¦ã¿ã‚‹ã¨â€¦â€¦

ä¸‹è¨˜ã¯ã€ŒNew-Itemã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®æ¨™æº–å‡ºåŠ›ã€ã®çµæœã€‚

```powershell:New-Itemã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®æ¨™æº–å‡ºåŠ›

    Directory: D:\

Name           : Temp
CreationTime   : 2025/03/13 12:28:42
LastWriteTime  : 2025/03/13 12:28:42
LastAccessTime : 2025/03/13 12:28:42
Mode           : d----
LinkType       :
Target         :

```

ã¤ãã¯ã€ŒWrite-Outputã®æ¨™æº–å‡ºåŠ›ã€ã®çµæœã€‚

```powershell:Write-Outputã®æ¨™æº–å‡ºåŠ›
New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚
New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
```

ãã®æ¬¡ã¯ã€ŒFunctionã§returnã—ãŸæ•°å€¤å‹ã®æˆ»ã‚Šå€¤ã€ã®çµæœã€‚

```powershell:Functionã§returnã—ãŸæ•°å€¤å‹ã®æˆ»ã‚Šå€¤
0
```

ã•ã„ã”ã¯ã€Œãƒ¡ã‚¤ãƒ³å‡¦ç†å´ã€Write-Outputã®æ¨™æº–å‡ºåŠ›ã€ã®çµæœã¨ãªã‚Šã¾ã™ã€‚

```powershell:
ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
```

### å…¨ä½“ã®æµã‚Œã‚’ç®‡æ¡æ›¸ãã§èª¬æ˜

ã“ã“ã¾ã§ã®ã¾ã¨ã‚ã¨ã—ã¦ç®‡æ¡æ›¸ãã§å‡¦ç†ã®æµã‚Œã‚’è¨˜è¼‰ã—ã¾ã™ã€‚

- ãƒ¡ã‚¤ãƒ³å‡¦ç†ï¼ˆFunctionã‚’å‘¼ã³å‡ºã™å‰ï¼‰
    1. ã‚ã‚‰ã‹ã˜ã‚ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã€Œ0ã€ã‚’ã‚»ãƒƒãƒˆ
    1. Functionï¼ˆ`New-Folder`ï¼‰ã‚’å‘¼ã³å‡ºã—

- Functionå‡¦ç†
    1. ã‚ã‚‰ã‹ã˜ã‚ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã€Œ0ã€ã‚’ã‚»ãƒƒãƒˆ
    1. å¯¾è±¡ã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ
        **ã“ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§æ¨™æº–å‡ºåŠ›ã‚ã‚Š**
        `New-Item`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã«ã‚ˆã‚Šæ¨™æº–å‡ºåŠ›ã•ã‚Œã€æ˜ç¤ºçš„ã«æŒ‡å®šãŒç„¡ãã¦ã‚‚æˆ»ã‚Šå€¤ã¨ã—ã¦è¿”ã•ã‚Œã¦ã—ã¾ã†ã€‚
    1. Functionã®å‡¦ç†çµæœã‚’å‡ºåŠ›
        **ã“ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§æ¨™æº–å‡ºåŠ›ã‚ã‚Š**
        `Write-Output`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã«ã‚ˆã‚Šæ¨™æº–å‡ºåŠ›ã•ã‚Œã€æ˜ç¤ºçš„ã«æŒ‡å®šãŒç„¡ãã¦ã‚‚æˆ»ã‚Šå€¤ã¨ã—ã¦è¿”ã•ã‚Œã¦ã—ã¾ã†ã€‚
    1. ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’æˆ»ã‚Šå€¤ã«è¿”ã™
        **ã‚³ã‚³ã§æˆ»ã‚Šå€¤ãŒã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã«**
        ã“ã‚Œã¾ã§ã®å‡¦ç†ã§æ¨™æº–å‡ºåŠ›ã•ã‚ŒãŸçµæœãŒè‡ªå‹•çš„ã«æˆ»ã‚Šå€¤ã¨ã—ã¦è¿”ã•ã‚Œã‚‹ã€‚
        æˆ»ã‚Šå€¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã®ä¸­èº«ã¯ã€`@("New-Itemã®çµæœ", "Write-Outputã®çµæœ", "ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã®æ•°å€¤")` ã¨ãªã‚‹ã€‚

- ãƒ¡ã‚¤ãƒ³å‡¦ç†ï¼ˆFunctionã‚’å‘¼ã³å‡ºã—ãŸå¾Œï¼‰
    1. Functionã®çµæœã‚’ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã«ä»£å…¥
        **ã‚³ã‚³ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ**
        Functionã®æˆ»ã‚Šå€¤ãŒ **ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹** ã§ã‚ã‚Šã€**æ•°å€¤å‹** ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã«ä»£å…¥ã—ã‚ˆã†ã¨è‡ªå‹•ã§ãƒ‡ãƒ¼ã‚¿å‹ã®å¤‰æ›ã‚’è¡Œã†ã¨ã™ã‚‹ãŒã€
        **ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹** ã‹ã‚‰ **æ•°å€¤å‹** ã¸ã®å¤‰æ›ã¯ä¸å¯ã®ãŸã‚ã€å¤‰æ›ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚
        ã€€
        ãªãŠã€ã“ã®ä»£å…¥æ™‚ã®ã‚¨ãƒ©ãƒ¼ã«ã‚ˆã‚Šã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã€Œ0ã€ã®ã¾ã¾ã§æ¬¡ã¸
    1. ãƒ¡ã‚¤ãƒ³å‡¦ç†ã®çµ‚äº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        ã¡ãªã¿ã«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã€Œ0ã€ã®ã¾ã¾ãªã®ã§æ­£å¸¸çµ‚äº†ã¨ã—ã¦å®Œäº†ã™ã‚‹ã€‚

## è§£æ±ºæ–¹æ³•

è§£æ±ºæ–¹æ³•ã¯ç°¡å˜ã§ã€ŒFunctionå†…ã§ã¯ã€**æ¨™æº–å‡ºåŠ›ã—ãªã„ã‚ˆã†ã«å¤‰æ›´**ã—ã¦æƒ³å®šé€šã‚Šã®æˆ»ã‚Šå€¤ã«ã™ã‚‹ã€ã ã‘ã§ã™ã€‚

ã“ã‚Œã¾ã§é¡Œæã«ã—ãŸã‚³ãƒ¼ãƒ‰ã«å¯¾ã—ã¦ ã€Œ**æ¨™æº–å‡ºåŠ›ã—ãªã„ã‚ˆã†ã«å¤‰æ›´**ã€ã—ã¦ã¿ã¾ã™ã€‚

### æ¨™æº–å‡ºåŠ›ã—ãªã„ã‚ˆã†ã«å¤‰æ›´ã—ãŸã‚³ãƒ¼ãƒ‰

`New-Item`ãªã©ã®æ¨™æº–å‡ºåŠ›ã‚’ä¼´ã†ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ã€`ã‚³ãƒãƒ³ãƒ‰ > $null` ã‚’ä½¿ã£ã¦æ¨™æº–å‡ºåŠ›ã‚’ç ´æ£„ã—ã¾ã™ã€‚

```diff powrshell
-New-Item -ItemType Directory -Path $FolderPath
+(New-Item -ItemType Directory -Path $FolderPath > $null)
```

`Write-Output` ã§ã¯ãªã `Write-Host` ã«ã‚ˆã‚Š æ¨™æº–å‡ºåŠ› ã‹ã‚‰ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ› ã«å¤‰æ›´ã€‚
â€» ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã¨ã¯ã€ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚„ãƒ‘ã‚¤ãƒ—å‡¦ç†ãŒå¯èƒ½ãªæ¨™æº–å‡ºåŠ›ã¯ãªãç”»é¢ã®ã¿ã«å‡ºåŠ›ã™ã‚‹æ–¹å¼ã®ã“ã¨ã€‚ãã®ãŸã‚ã€Functionå†…ã§å®Ÿè¡Œã—ã¦ã‚‚æˆ»ã‚Šå€¤ã«å½±éŸ¿ã—ãªã„ã€‚

```diff powrshell
-Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å†ä½œæˆã€‚"
+Write-Host "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å†ä½œæˆã€‚"
```

:::details æ¨™æº–å‡ºåŠ›ã—ãªã„ã‚ˆã†ã«å¤‰æ›´ã—ãŸã‚³ãƒ¼ãƒ‰ï¼ˆå…¨ä½“ï¼‰

å¤‰åŒ–ç‚¹ã‚’ã€Œâœ…ãƒãƒ¼ã‚¯ã€ã§ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ã„ã¾ã™ã€‚

```powershell:æ¨™æº–å‡ºåŠ›ã—ãªã„ã‚ˆã†ã«å¤‰æ›´ã—ãŸã‚³ãƒ¼ãƒ‰
# Functionç¾¤
function New-Folder {
    param (
        [string]$FolderPath
    )
    # å‡¦ç†çµæœã®é€²æ—ã‚’å…¥ã‚Œã‚‹æ•°å€¤å‹ã®ã‚³ãƒ¼ãƒ‰
    [int]$statusCode = 0

    if (Test-Path -Path $FolderPath) {
        # ã™ã§ã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤
        try {
            Remove-Item -Path $FolderPath -Recurse -Force
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å‰Šé™¤ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -101
        }

        # å‰Šé™¤å¾Œã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ
        if ($statusCode -eq 0) {
            try {
                # âœ… New-Item å®Ÿè¡Œæ™‚ã®æ¨™æº–å‡ºåŠ›ã‚’ > $null ã§ç ´æ£„
                (New-Item -ItemType Directory -Path $FolderPath > $null)
                # âœ… Write-Output ã‹ã‚‰ Write-Host ã«ã‚ˆã‚‹å¤‰æ›´ã§ æ¨™æº–å‡ºåŠ› ã‹ã‚‰ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼ˆç”»é¢ã®ã¿ï¼‰ ã«ï¼
                Write-Host "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å†ä½œæˆã€‚"
            }
            catch {
                Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
                $statusCode = -201
            }
        }
    }
    else {
        # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯ãã®ã¾ã¾ä½œæˆ
        try {
            # âœ… New-Item å®Ÿè¡Œæ™‚ã®æ¨™æº–å‡ºåŠ›ã‚’ > $null ã§ç ´æ£„
            (New-Item -ItemType Directory -Path $FolderPath > $null)
            # âœ… Write-Output ã‹ã‚‰ Write-Host ã«ã‚ˆã‚‹å¤‰æ›´ã§ æ¨™æº–å‡ºåŠ› ã‹ã‚‰ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼ˆç”»é¢ã®ã¿ï¼‰ ã«ï¼
            Write-Host "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚"
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -301
        }
    }

    # âœ… Write-Output ã‹ã‚‰ Write-Host ã«ã‚ˆã‚‹å¤‰æ›´ã§ æ¨™æº–å‡ºåŠ› ã‹ã‚‰ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼ˆç”»é¢ã®ã¿ï¼‰ ã«ï¼
    if ($statusCode -eq 0) {
        Write-Host "New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }
    else {
        Write-Host "New-FolderãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }

    # âœ… Functionå†…ã§æ¨™æº–å‡ºåŠ›ãŒãªã„ã®ã§Intã§è¿”ã‚‹
    return $statusCode
}

# ãƒ¡ã‚¤ãƒ³å‡¦ç†
[int]$statusCode = 0

# âœ… Functionã®çµæœãŒIntã§è¿”ã‚Šã€å¤‰æ›ã™ã‚‹ã“ã¨ãªãã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã«çµæœãŒä»£å…¥
$statusCode = (New-Folder "D:\Temp")

# âœ… å®Ÿéš›ã®çµæœã§åˆ†å²ã•ã‚Œã‚‹
if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

:::

## ã¾ã¨ã‚

æœ€å¾Œã«ã‹ã¿ç •ã„ã¦ã€ã‚ã‹ã‚Šã‚„ã™ã„ã‚³ãƒ¼ãƒ‰ã‚’ä¾‹ã«ã¾ã¨ã‚ã¦ã¿ã¾ã™ã€‚

### äº‹ä¾‹ã€ŒFunctionå†…ã§æ¨™æº–å‡ºåŠ›ã™ã‚‹ã¨æ„å›³ã—ãªã„æˆ»ã‚Šå€¤ã€

Functionå†…ã§ `Write-Output` ã®ã‚ˆã†ã«æ¨™æº–å‡ºåŠ›ã‚’ä¼´ã†ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€æ„å›³ã›ãšãã®çµæœãŒæˆ»ã‚Šå€¤ã¨ã—ã¦è¿”ã•ã‚Œã‚‹ã€‚

### ã‚³ãƒ¼ãƒ‰ä¾‹

```powershell
function Get-Thirteen {
    Write-Output "Get-Thirteen å‡¦ç†é–‹å§‹"    # âŒ ã“ã®æ¨™æº–å‡ºåŠ›ã‚‚æˆ»ã‚Šå€¤ã¨ã—ã¦è¿”ã‚‹
    return 13
}

$result = Get-Thirteen
Write-Host "çµæœ: $result"                  # "Get-Number å‡¦ç†é–‹å§‹" ã¨ 13 ã®ä¸¡æ–¹ãŒè¿”ã•ã‚Œã‚‹
```

### å¯¾å¿œæ–¹æ³•ã®ä¸€è¦§

1. **æ¨™æº–å‡ºåŠ›ãŒä¸è¦ã§ã‚ã‚‹å ´åˆã€å¤‰æ›´ã¾ãŸã¯å‰Šé™¤ã™ã‚‹**
    æ¨™æº–å‡ºåŠ›ãŒå¿…é ˆã§ã¯ãªã„ã®ã§ã‚ã‚Œã°ã€`Write-Host` ãªã©ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã«å¤‰æ›´ã™ã‚‹ã€‚æœ¬å½“ã«ã„ã‚‰ãªã„å ´åˆã¯ `Write-Output` ãã®ã‚‚ã®ã‚’å‰Šé™¤ã€‚
    `New-Item` ã‚’ã¯ã˜ã‚ã¨ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®æ©Ÿèƒ½ãã®ã‚‚ã®ã¯å®Ÿè¡Œã—ãŸã„ãŒæ¨™æº–å‡ºåŠ›ã¯ä¸è¦ã¨ã„ã†å ´åˆã¯ã€ä¸‹è¨˜ã®ã‚ˆã†ã«ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®æ¨™æº–å‡ºåŠ›ã‚’ç ´æ£„ã™ã‚‹ã€‚
    - `ã‚³ãƒãƒ³ãƒ‰ > $null`    ğŸ‘ˆ Windowsä»¥å¤–ã§ã‚‚ä½¿ç”¨ã•ã‚Œã¦ã„ã¦ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚‚é€Ÿã„ã‚‰ã—ã„ã€‚
    - `ã‚³ãƒãƒ³ãƒ‰ | Out-Null` ğŸ‘ˆ PowerShellã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã§å…¨ä½“çš„ã«çµ±ä¸€æ„ŸãŒã§ã¦å¯èª­æ€§ãŒè‰¯ã„ã€‚
    - `[void](ã‚³ãƒãƒ³ãƒ‰)`    ğŸ‘ˆ å¯èª­æ€§ãŒæ‚ªãä¸€èˆ¬çš„ã«ã‚ã‹ã‚Šã«ãã„è¨˜è¿°ã®ä»•æ–¹ã€‚
    - `$null = ã‚³ãƒãƒ³ãƒ‰`    ğŸ‘ˆ åŒä¸Šã€‚

    :::details ã‚³ãƒ¼ãƒ‰ä¾‹ï¼šæ¨™æº–å‡ºåŠ›ãŒä¸è¦ã§ã‚ã‚‹å ´åˆã€å¤‰æ›´ã¾ãŸã¯å‰Šé™¤ã™ã‚‹

    ```diff powershell
    function Get-Thirteen {
    -    Write-Output "Get-Thirteen å‡¦ç†é–‹å§‹"    # âœ… ä¸è¦ãªæ¨™æº–å‡ºåŠ›ã‚’å‰Šé™¤ã™ã‚‹
        return 13
    }

    $result = Get-Thirteen
    Write-Host "çµæœ: $result"                  # æœŸå¾…å€¤ã® 13 ãŒè¿”ã•ã‚Œã‚‹
    ```

    ```diff powershell
    function Get-Thirteen {
    -    Write-Output "Get-Thirteen å‡¦ç†é–‹å§‹"
    +    Write-Host "Get-Thirteen å‡¦ç†é–‹å§‹"      # âœ… ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã«å¤‰æ›´
        return 13
    }

    $result = Get-Thirteen
    Write-Host "çµæœ: $result" -Debug            # æœŸå¾…å€¤ã® 13 ãŒè¿”ã•ã‚Œã‚‹ï¼ˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã‚ã‚Šï¼‰
    ```

    ```diff powershell
    function Get-Thirteen {
    -    Write-Output "Get-Thirteen å‡¦ç†é–‹å§‹"
    +    Write-Output "Get-Thirteen å‡¦ç†é–‹å§‹" > $null  # âœ… æ¨™æº–å‡ºåŠ›ã‚’ç ´æ£„ã™ã‚‹ï¼ˆWrite-Outputã®æ¨™æº–å‡ºåŠ›ã‚’ç ´æ£„ã™ã‚‹ã®ã¯å¤‰ãªã‚³ãƒ¼ãƒ‰ã§ã™ãŒâ€¦â€¦ï¼‰
        return 13
    }

    $result = Get-Thirteen
    Write-Host "çµæœ: $result"                  # æœŸå¾…å€¤ã® 13 ãŒè¿”ã•ã‚Œã‚‹
    ```

    :::

1. **ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å ´åˆã¯ãƒ‡ãƒãƒƒã‚°ç”¨ã¨ã—ã¦è¨­å®šã™ã‚‹**
    èª¿æŸ»ãƒ•ã‚§ãƒ¼ã‚ºã®ã‚³ãƒ¼ãƒ‰ç´¹ä»‹ã§å‰è¿°ã—ãŸã¨ãŠã‚Šã€ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ®‹ã™æ„å›³ãŒã‚ã‚‹å ´åˆã¯ `Write-Debug` ã‚’æ´»ç”¨ã€‚
    å®Ÿè¡Œæ™‚ã«ã€Œ`-Debug`ã€ã¨ã„ã†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•ã§ã‚‚ç°¡å˜ã«ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œå¯èƒ½ã§ã™ã€‚

    :::details ã‚³ãƒ¼ãƒ‰ä¾‹ï¼šãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å ´åˆã¯ãƒ‡ãƒãƒƒã‚°ç”¨ã¨ã—ã¦è¨­å®šã™ã‚‹

    ```diff powershell
    function Get-Thirteen {
    +    [CmdletBinding()]                       # âœ… Debugã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’å—ä»˜å¯èƒ½ã«
    +    param ()                                # âœ… åŒä¸Š
    -    Write-Output "Get-Thirteen å‡¦ç†é–‹å§‹"
    +    Write-Debug "Get-Thirteen å‡¦ç†é–‹å§‹"      # âœ… ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã«å¤‰æ›´
        return 13
    }

    -$result = Get-Thirteen
    +$result = (Get-Thirteen -Debug)              # âœ… ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§Functionã‚’å®Ÿè¡Œ
    Write-Host "çµæœ: $result"                   # æœŸå¾…å€¤ã® 13 ãŒè¿”ã•ã‚Œã‚‹ï¼ˆãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã‚ã‚Šï¼‰
    ```

    ```diff powershell
    function Get-Thirteen {
    -    Write-Output "Get-Thirteen å‡¦ç†é–‹å§‹"
    +    Write-Debug "Get-Thirteen å‡¦ç†é–‹å§‹"      # âœ… ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã«å¤‰æ›´
        return 13
    }

    +$DebugPreference = "Continue"               # âœ… ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã«ã™ã‚‹
    $result = Get-Thirteen
    Write-Host "çµæœ: $result"                   # æœŸå¾…å€¤ã® 13 ãŒè¿”ã•ã‚Œã‚‹ï¼ˆãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã‚ã‚Šï¼‰
    ```

    :::

1. **Functionå†…ã®çµæœã‚’ã©ã†ã—ã¦ã‚‚æ¨™æº–å‡ºåŠ›ã—ãŸã„å ´åˆã¯ã€æˆ»ã‚Šå€¤ã‚’é…åˆ—ã«å¤‰ãˆã‚ˆã†**
    ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è¨­è¨ˆã«ã‚ˆã£ã¦ã¯Functionå†…ã§å¾—ãŸæƒ…å ±ã‚’ã©ã†ã—ã¦ã‚‚æ¨™æº–å‡ºåŠ›ã—ãŸã„å ´åˆãŒã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚
    ãã®ã‚ˆã†ãªå ´åˆã¯ã€ã‚ã‚‰ã‹ã˜ã‚è¨­å®šã™ã‚‹æˆ»ã‚Šå€¤ã‚’é…åˆ—ã«ã™ã‚‹æ–¹æ³•ãŒã‚ªã‚¹ã‚¹ãƒ¡ã§ã™ã€‚
    é…åˆ—ã«ãŠã‘ã‚‹ã‚¨ãƒ©ãƒ¼åˆ¶å¾¡ã®æ–¹æ³•ã§ã™ãŒã€æœ€åˆã«é…åˆ—ã‚’åˆæœŸåŒ–ã—ã¦ãŠãé…åˆ—ã«ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Œã°æ­£å¸¸çµ‚äº†ã¨ã—ã€
    ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆï¼ˆ`@()`ãªã©ã§åˆ¤å®šï¼‰ã¯ç•°å¸¸çµ‚äº†ã™ã‚‹ã¨ã„ã†å‹•ããŒè‰¯ã„ã®ã§ã—ã‚‡ã†ã€‚

    :::details ã‚³ãƒ¼ãƒ‰ä¾‹ï¼šFunctionå†…ã®çµæœã‚’ã©ã†ã—ã¦ã‚‚æ¨™æº–å‡ºåŠ›ã—ãŸã„å ´åˆã¯ã€æˆ»ã‚Šå€¤ã‚’é…åˆ—ã«å¤‰ãˆã‚ˆã†

    ```diff powershell
    function Get-Thirteen {
    +    [object[]]$objectArray = @()
    -    Write-Output "Get-Thirteen å‡¦ç†é–‹å§‹"
        $objectArray += (Write-Output "Get-Thirteen å‡¦ç†é–‹å§‹")
        $objectArray += 13
    -    return 13
    +    return $objectArray
    }

    $result = Get-Thirteen
    Write-Host "çµæœ: $result"                  # "Get-Number å‡¦ç†é–‹å§‹" ã¨ 13 ã®ä¸¡æ–¹ãŒè¿”ã•ã‚Œã‚‹
    ```

    :::

---

ã“ã‚Œã§ã“ã®è¨˜äº‹ã¯çµ‚ã‚ã‚Šã§ã™ã€‚
ã“ã®å¤‰ãªä»•æ§˜ã€ç†ç”±ãŒã‚ã£ã¦ã®ã“ã¨ã ã¨æ€ã„ã¾ã™ãŒã€ä»®ã«ã€ŒPowerShellã§å«Œãªã“ã¨ã¯ï¼Ÿã€ã¨èã‹ã‚ŒãŸå ´åˆã¯çœŸã£å…ˆã«ã“ã®**PowerShellç‹¬è‡ªã®ä»•æ§˜**ã¨ç­”ãˆã‚‹ã§ã—ã‚‡ã†ã€‚

## å‚è€ƒæ–‡çŒ®

https://zenn.dev/haretokidoki/articles/24ac3ba42d8050

https://stackoverflow.com/questions/5260125/whats-the-better-cleaner-way-to-ignore-output-in-powershell?form=MG0AV3&form=MG0AV3

## é–¢é€£è¨˜äº‹

https://haretokidoki-blog.com/pasocon_powershell-startup/
https://zenn.dev/haretokidoki/articles/7e6924ff0cc960
https://zenn.dev/haretokidoki/articles/fb6830f9155de5
