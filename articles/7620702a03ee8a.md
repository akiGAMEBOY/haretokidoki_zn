---
title: "ã€PowerShellç‰¹æœ‰ã®è½ã¨ã—ç©´ï¼ã€‘Functionã®æˆ»ã‚Šå€¤ãŒæœŸå¾…é€šã‚Šã®çµæœã¨ãªã‚‰ãªã„äº‹è±¡ã¯ä»•æ§˜ã§ã™"
emoji: "ğŸ›«"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

PowerShellã§ã¯ã€ŒFunctionå†…ã§ã®æ¨™æº–å‡ºåŠ›ï¼ˆ`Write-Output`ãªã©ï¼‰ãŒã€æ˜ç¤ºçš„ãªæˆ»ã‚Šå€¤ã¨ã—ã¦Functionã®å‘¼ã³å‡ºã—å…ƒã«æ¸¡ã•ã‚Œã‚‹ä»•æ§˜ï¼ˆä»¥é™ã€â€œFunctionå†…ã®æ¨™æº–å‡ºåŠ›ãŒæˆ»ã‚Šå€¤ã¨ã—ã¦å‘¼ã³å‡ºã—å…ƒã«è¿”ã•ã‚Œã‚‹ä»•æ§˜â€ã¨ã™ã‚‹ï¼‰ã€ã«ã‚ˆã£ã¦ã€æ„å›³ã—ãªã„æˆ»ã‚Šå€¤ã§è¿”ã£ã¦ãã¾ã™ã€‚

ä½•ã‚’éš ãã†ç§ã‚‚æ™‚é–“ãŒçµŒã¤ã¨ã€ã“ã®ä»•æ§˜ã‚’å¿˜ã‚Œã¦ã—ã¾ã„ä½•åº¦ã‹ãƒãƒã‚‹ã“ã¨ã‚‚â€¦â€¦
ç§è‡ªèº«ã®å‚™å¿˜ã‚’ã‹ã­ã¦ã€ã“ã®ä»•æ§˜ã®è©³ã—ã„æƒ…å ±ã¨å¯¾å‡¦æ–¹æ³•ã‚’ç´¹ä»‹ã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- ãŠã‚‚ã«PowerShellåˆå­¦è€…ãƒ»åˆç´šè€…ã®æ–¹
- ä¸‹è¨˜ã®ã‚ˆã†ãªåŸå› ä¸æ˜ãªã‚±ãƒ¼ã‚¹ã§ãŠæ‚©ã¿ã®æ–¹
    - è¤‡æ•°ã®Functionã§é€£æºã™ã‚‹PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ãŸçµæœã€ãªãœã‹ã‚¨ãƒ©ãƒ¼ã¨ãªã‚ŠåŸå› ãŒã‚ã‹ã‚‰ãªã„å ´åˆ
    - ã‚¨ãƒ©ãƒ¼ã®è¦å› ã‚’èª¿ã¹ã‚‹ã¨ã€ãªãœã‹æœŸå¾…é€šã‚Šã®ãƒ‡ãƒ¼ã‚¿å‹ã§æˆ»ã‚Šå€¤ãŒè¿”ã£ã¦ã„ãªã„å ´åˆ

## ã€ŒFunctionå†…ã®æ¨™æº–å‡ºåŠ›ãŒæˆ»ã‚Šå€¤ã¨ã—ã¦å‘¼ã³å‡ºã—å…ƒã«è¿”ã•ã‚Œã‚‹ä»•æ§˜ã€ã¨ã¯

è¨€è‘‰ã®é€šã‚Šãªã®ã§ã™ãŒæ–‡ç« ã ã‘ã§ã¯ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒæ´ã¿ã«ãã„ã¨æ€ã†ã®ã§ã€ãã®äº‹è±¡ã«åˆè‡´ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ä¸‹è¨˜ã«è¨˜è¼‰ã—ã¾ã™ã€‚

### â€œä»•æ§˜ã§æˆ»ã‚Šå€¤ãŒæœŸå¾…å€¤ã¨ãªã‚‰ãªã„â€ã‚³ãƒ¼ãƒ‰

```powershell:ä»•æ§˜ã§æˆ»ã‚Šå€¤ãŒæœŸå¾…å€¤ã¨ãªã‚‰ãªã„ä¾‹
# Functionç¾¤
function New-Folder {
    param (
        [string]$FolderPath
    )
    # å‡¦ç†çµæœã®é€²æ—ã‚’å…¥ã‚Œã‚‹æ•°å€¤å‹ã®ã‚³ãƒ¼ãƒ‰
    [int]$statusCode = 0

    if (Test-Path -Path $FolderPath) {
        # ã™ã§ã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤
        try {
            Remove-Item -Path $FolderPath -Recurse -Force
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å‰Šé™¤ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -101
        }

        # å‰Šé™¤å¾Œã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ
        if ($statusCode -eq 0) {
            try {
                # âŒ New-Itemã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
                New-Item -ItemType Directory -Path $FolderPath
                # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
                Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å†ä½œæˆã€‚"
            }
            catch {
                Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
                $statusCode = -201
            }
        }
    }
    else {
        # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯ãã®ã¾ã¾ä½œæˆ
        try {
            # âŒ New-Itemã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
            New-Item -ItemType Directory -Path $FolderPath
            # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
            Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚"
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -301
        }
    }

    # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
    if ($statusCode -eq 0) {
        Write-Output "New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }
    else {
        Write-Output "New-FolderãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }

    # âŒ Intã§è¿”ã£ãŸã»ã—ã„ãŒã€æ¨™æº–å‡ºåŠ›ã®æ–‡å­—åˆ—å‹ã‚‚å…¥ã£ã¦Objectå‹ã¨ã—ã¦è¿”ã—ã¦ã—ã¾ã†ã€‚
    return $statusCode
}

# ãƒ¡ã‚¤ãƒ³å‡¦ç†
[int]$statusCode = 0

# âŒ Objectå‹ã§æˆ»ã£ãŸã“ã¨ã«ã‚ˆã‚ŠIntå‹ã«å¤‰æ›ä½¿ç”¨ã¨ã—ã¦ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚$statusCodeã¯ã€Œ0ã€ã®ã¾ã¾ã¨ãªã‚‹ã€‚
$statusCode = (New-Folder "D:\Temp")

# âŒ ä¸Šè¨˜ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã‚‚ã®ã®$statusCodeã¯ã€Œ0ã€ã®ã¾ã¾ãªã®ã§æ­£å¸¸çµ‚äº†ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºåŠ›
if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

### â€œä»•æ§˜ã§æˆ»ã‚Šå€¤ãŒæœŸå¾…å€¤ã¨ãªã‚‰ãªã„â€ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨â€¦

â€œä»•æ§˜ã§æˆ»ã‚Šå€¤ãŒæœŸå¾…å€¤ã¨ãªã‚‰ãªã„â€ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä¸‹è¨˜ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚

```powershell:ã‚¨ãƒ©ãƒ¼ï¼ˆçµæœã‚’ãã®ã¾ã¾è¨˜è¼‰ï¼‰
MetadataError:
Line |
  63 |  $statusCode = (New-Folder "D:\Temp")
     |  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Cannot convert the "System.Object[]" value of type "System.Object[]" to type "System.Int32".
ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
```

æ—¥æœ¬èªã®ç¿»è¨³ã™ã‚‹ã¨ä¸‹è¨˜ã®ã¨ãŠã‚Šã€‚

```powershell:ã‚¨ãƒ©ãƒ¼ï¼ˆçµæœã‚’æ—¥æœ¬èªã«ç¿»è¨³ï¼‰
ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ©ãƒ¼:
è¡Œ |
  63 |  $statusCode = (New-Folder "D:\Temp")
     |  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | "System.Object[]" å‹ã®å€¤ "System.Object[]" ã‚’ "System.Int32" å‹ã«å¤‰æ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚
ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
```

ã¤ã¾ã‚Šã€Functionï¼ˆ`New-Folder`ï¼‰ã‚’å®Ÿè¡Œã—ãŸæˆ»ã‚Šå€¤ãŒã€System.Int32 ã§ã¯ãªã ã€Œ**System.Object[]**ã€ã§è¿”ã£ã¦ããŸã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚
ã§ã¯ã€å®Ÿéš›ã«ã©ã®ã‚ˆã†ãªæµã‚Œã§ã€Œ**System.Object[]**ã€ãŒè¿”ã£ã¦ããŸã®ã‹ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

### ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§System.Object[]ã®æˆ»ã‚Šå€¤ã‚’èª¿æŸ»

```powershell:ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’ã‚ªãƒ³ã«ã™ã‚‹è¨­å®š
$DebugPreference = "Continue"
```

```powershell:ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’ã‚ªãƒ•ã«ã™ã‚‹è¨­å®š
$DebugPreference = "SilentlyContinue"
```

```diff powershell:ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
# ãƒ¡ã‚¤ãƒ³å‡¦ç†
[int]$statusCode = 0

+Write-Debug ($statusCode.GetType().FullName)
+Write-Debug "statusCode[$($statusCode)]"
$statusCode = (New-Folder "D:\Temp")
+Write-Debug ($statusCode.GetType().FullName)
+Write-Debug "statusCode[$($statusCode)]"

if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

:::details ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ ã—ãŸå…¨ã‚³ãƒ¼ãƒ‰

ã‚

```powershell:
# ğŸ“‘ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’ã‚ªãƒ³
$DebugPreference = "Continue"
# $DebugPreference = "SilentlyContinue"

# Functionç¾¤
function New-Folder {
    param (
        [string]$FolderPath
    )
    # å‡¦ç†çµæœã®é€²æ—ã‚’å…¥ã‚Œã‚‹æ•°å€¤å‹ã®ã‚³ãƒ¼ãƒ‰
    [int]$statusCode = 0

    if (Test-Path -Path $FolderPath) {
        # ã™ã§ã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤
        try {
            Remove-Item -Path $FolderPath -Recurse -Force
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å‰Šé™¤ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -101
        }

        # å‰Šé™¤å¾Œã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ
        if ($statusCode -eq 0) {
            try {
                # âŒ New-Itemã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
                New-Item -ItemType Directory -Path $FolderPath
                # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
                Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å†ä½œæˆã€‚"
            }
            catch {
                Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
                $statusCode = -201
            }
        }
    }
    else {
        # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯ãã®ã¾ã¾ä½œæˆ
        try {
            # âŒ New-Itemã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
            New-Item -ItemType Directory -Path $FolderPath
            # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
            Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚"
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -301
        }
    }

    # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
    if ($statusCode -eq 0) {
        Write-Output "New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }
    else {
        Write-Output "New-FolderãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }

    # âŒ Intã§è¿”ã£ãŸã»ã—ã„ãŒã€æ¨™æº–å‡ºåŠ›ã®æ–‡å­—åˆ—å‹ã‚‚å…¥ã£ã¦Objectå‹ã¨ã—ã¦è¿”ã—ã¦ã—ã¾ã†ã€‚
    return $statusCode
}

# ãƒ¡ã‚¤ãƒ³å‡¦ç†
[int]$statusCode = 0

# ğŸ“‘ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿½åŠ 
Write-Debug ($statusCode.GetType().FullName)
Write-Debug "statusCode[$($statusCode)]"
# âŒ Objectå‹ã§æˆ»ã£ãŸã“ã¨ã«ã‚ˆã‚ŠIntå‹ã«å¤‰æ›ä½¿ç”¨ã¨ã—ã¦ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚$statusCodeã¯ã€Œ0ã€ã®ã¾ã¾ã¨ãªã‚‹ã€‚
$statusCode = (New-Folder "D:\Temp")
# ğŸ“‘ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿½åŠ 
Write-Debug ($statusCode.GetType().FullName)
Write-Debug "statusCode[$($statusCode)]"

# âŒ ä¸Šè¨˜ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã‚‚ã®ã®$statusCodeã¯ã€Œ0ã€ã®ã¾ã¾ãªã®ã§æ­£å¸¸çµ‚äº†ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºåŠ›
if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```
:::

### ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å«ã‚ã¦å®Ÿè¡Œã—ã¦ã¿ã‚‹ã¨

```powershell:
DEBUG: System.Int32
DEBUG: statusCode[0]
MetadataError:
Line |
  64 |  $statusCode = (New-Folder "D:\Temp")
     |  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Cannot convert the "System.Object[]" value of type "System.Object[]" to type "System.Int32".
DEBUG: System.Int32
DEBUG: statusCode[0]
ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
PS C:\Users\XXXX>
```

```diff powershell:æœ¬å½“ã«æ¨™æº–å‡ºåŠ›ãŒè¿”ã£ã¦ã„ã‚‹ã®ã‹ç¢ºèª
# ãƒ¡ã‚¤ãƒ³å‡¦ç†
-[int]$statusCode = 0
+[object]$resultData = @()

-$statusCode = (New-Folder "D:\Temp")
+$resultData = (New-Folder "D:\Temp")
+$resultData | Format-List

if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}

# exit $statusCode
```

```powershell:æœ¬å½“ã«æ¨™æº–å‡ºåŠ›ãŒè¿”ã£ã¦ã„ã‚‹ã®ã‹ç¢ºèª
# Functionç¾¤
function New-Folder {
    param (
        [string]$FolderPath
    )
    # å‡¦ç†çµæœã®é€²æ—ã‚’å…¥ã‚Œã‚‹æ•°å€¤å‹ã®ã‚³ãƒ¼ãƒ‰
    [int]$statusCode = 0

    if (Test-Path -Path $FolderPath) {
        # ã™ã§ã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤
        try {
            Remove-Item -Path $FolderPath -Recurse -Force
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å‰Šé™¤ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -101
        }

        # å‰Šé™¤å¾Œã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ
        if ($statusCode -eq 0) {
            try {
                New-Item -ItemType Directory -Path $FolderPath | Out-Null
                Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å†ä½œæˆã€‚"
            }
            catch {
                Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
                $statusCode = -201
            }
        }
    }
    else {
        # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯ãã®ã¾ã¾ä½œæˆ
        try {
            New-Item -ItemType Directory -Path $FolderPath | Out-Null
            Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚"
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -301
        }
    }
    
    if ($statusCode -eq 0) {
        Write-Output "New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }
    else {
        Write-Output "New-FolderãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }
    
    return $statusCode
}

# ãƒ¡ã‚¤ãƒ³å‡¦ç†
[object]$resultData = @()

$resultData = (New-Folder "D:\Temp")

$resultData | Format-List

if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

### ãƒ‡ãƒãƒƒã‚°ã—ã¦ã‚³ãƒ¼ãƒ‰ä¾‹ã§ã¯ã©ã®ã‚ˆã†ãªã“ã¨ãŒèµ·ãã¦ã„ã‚‹ã‹

1. ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã€Œ0ã€ãŒä»£å…¥
2. Functionï¼ˆ`New-Folder`ï¼‰ãŒå®Ÿè¡Œ
    1. ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒä½œæˆã‚‚ã—ãã¯å†ä½œæˆ
        â†’ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚‚æ•°å€¤ï¼ˆ`Int`ï¼‰ã®ã¾ã¾
    2. æ¨™æº–å‡ºåŠ›(`Write-Output`)ã§ä½œæ¥­é€²æ—ã‚„å‡¦ç†çµæœã‚’è¡¨ç¤º
        â†’ PowerShellã®ä»•æ§˜ã§æ¨™æº–å‡ºåŠ›ã®çµæœã‚‚æˆ»ã‚Šå€¤ã«å…¥ã‚‹
    3. 

### è§£æ±ºæ–¹æ³•

```powershell:Write-Output ã‚’ Write-Information ã«
# Functionç¾¤
function New-Folder {
    param (
        [string]$FolderPath
    )
    # å‡¦ç†çµæœã®é€²æ—ã‚’å…¥ã‚Œã‚‹æ•°å€¤å‹ã®ã‚³ãƒ¼ãƒ‰
    [int]$statusCode = 0

    if (Test-Path -Path $FolderPath) {
        # ã™ã§ã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤
        try {
            Remove-Item -Path $FolderPath -Recurse -Force
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å‰Šé™¤ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -101
        }

        # å‰Šé™¤å¾Œã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ
        if ($statusCode -eq 0) {
            try {
                New-Item -ItemType Directory -Path $FolderPath
                # âœ… Write-Output ã‹ã‚‰ Write-Hostï¼ˆWrite-Verboseã§ã‚‚å¯ï¼‰
                Write-Host "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å†ä½œæˆã€‚"
            }
            catch {
                Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
                $statusCode = -201
            }
        }
    }
    else {
        # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯ãã®ã¾ã¾ä½œæˆ
        try {
            New-Item -ItemType Directory -Path $FolderPath
            # âœ… Write-Output ã‹ã‚‰ Write-Hostï¼ˆWrite-Verboseã§ã‚‚å¯ï¼‰
            Write-Host "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚"
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -301
        }
    }

    # âœ… Write-Output ã‹ã‚‰ Write-Hostï¼ˆWrite-Verboseã§ã‚‚å¯ï¼‰
    if ($statusCode -eq 0) {
        Write-Host "New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }
    else {
        Write-Host "New-FolderãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }

    # âœ… Functionå†…ã§æ¨™æº–å‡ºåŠ›ãŒãªã„ã®ã§Intã§è¿”ã‚‹
    return $statusCode
}

# ãƒ¡ã‚¤ãƒ³å‡¦ç†
[int]$statusCode = 0

# âœ… Functionã®çµæœãŒIntã§è¿”ã‚Šã€å¤‰æ›ã™ã‚‹ã“ã¨ãªãã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã«çµæœãŒä»£å…¥
$statusCode = (New-Folder "D:\Temp")

# âœ… å®Ÿéš›ã®çµæœã§åˆ†å²ã•ã‚Œã‚‹
if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

## è¤‡æ•°ã®äº‹ä¾‹ã¨ãã®è§£æ±ºæ¡ˆ

### **äº‹ä¾‹1: Write-Outputã«ã‚ˆã‚‹äºˆæœŸã›ã¬æ¨™æº–å‡ºåŠ›**

**å•é¡Œ:**  
é–¢æ•°å†…ã§ `Write-Output` ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€æ„å›³ã›ãšãã®çµæœãŒæˆ»ã‚Šå€¤ã¨ã—ã¦è¿”ã•ã‚Œã¾ã™ã€‚

**ã‚³ãƒ¼ãƒ‰ä¾‹:**  

```powershell
function Get-Number {
    Write-Output "Debugging Info" # ä½™åˆ†ãªæ¨™æº–å‡ºåŠ›
    return 42
}

$result = Get-Number
Write-Host "çµæœ: $result" # "Debugging Info" ã¨ 42 ã®ä¸¡æ–¹ãŒè¿”ã•ã‚Œã‚‹
```

**å¯¾å¿œæ–¹æ³•:**  

1. **ä¸è¦ãªæ¨™æº–å‡ºåŠ›ã‚’å®Œå…¨ã«æ’é™¤ã™ã‚‹**
    æ¨™æº–å‡ºåŠ›ã‚’æŠ‘åˆ¶ã™ã‚‹å ´åˆã«ã¯æ˜ç¤ºçš„ã«ãã®å‡¦ç†ã‚’è¡Œã†ã®ã§ã¯ãªãã€ä½™è¨ˆãª `Write-Output` ã‚’å‰Šé™¤ã—ã€æ„å›³çš„ãªå‡¦ç†ã‚’è¨˜è¿°ã—ãªã„æ–¹æ³•ãŒé©åˆ‡ã§ã™ã€‚
2. **ãƒ‡ãƒãƒƒã‚°ç”¨é€”ã®å ´åˆ**
    ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ®‹ã™æ„å›³ãŒã‚ã‚‹å ´åˆã¯ã€`Write-Debug` ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å‡ºåŠ›ã‚’ç°¡å˜ã«åˆ¶å¾¡å¯èƒ½ã«ã—ã¾ã™ã€‚

**ã‚³ãƒ¼ãƒ‰ä¾‹:**  

```powershell
# ä¸è¦ãªæ¨™æº–å‡ºåŠ›ã‚’æ’é™¤
function Get-Number {
    return 42 # ãƒ‡ãƒãƒƒã‚°ç›®çš„ã§ãªã‘ã‚Œã° Write-Output ã‚’ä½¿ç”¨ã—ãªã„
}

# ãƒ‡ãƒãƒƒã‚°ç›®çš„
function Get-Number-Debug {
    Write-Debug "ç¾åœ¨ã®é–¢æ•°å‡¦ç†: 42 ã‚’è¿”ã—ã¦ã„ã¾ã™"
    return 42
}

$DebugPreference = "Continue" # ãƒ‡ãƒãƒƒã‚°ã‚’æœ‰åŠ¹åŒ–
$result = Get-Number-Debug
Write-Host "çµæœ: $result" # å¿…è¦ã«å¿œã˜ã¦ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª
```

---

### **äº‹ä¾‹2: è¤‡æ•°ã®æˆ»ã‚Šå€¤ãŒè¿”ã•ã‚Œã‚‹**

**å•é¡Œ:**  

1. **æ„å›³çš„ã«é…åˆ—ã‚’è¿”ã™**
    è¤‡æ•°ã®å€¤ã‚’è¿”ã™å¿…è¦ãŒã‚ã‚‹å ´åˆã€PowerShellã® `@()` æ¼”ç®—å­ã‚’ä½¿ç”¨ã—ã¦æ˜ç¤ºçš„ã«é…åˆ—ã¨ã—ã¦è¿”ã—ã¾ã™ã€‚
2. **å˜ä¸€å€¤ã‚’è¿”ã™å ´åˆ**
    æ„å›³çš„ã«æœ€å¾Œã« `return` ã‚’åˆ©ç”¨ã—ã€æ˜ç¤ºçš„ã«æˆ»ã‚Šå€¤ã‚’æŒ‡å®šã™ã‚‹ã€‚

**ã‚³ãƒ¼ãƒ‰ä¾‹:**  

```powershell
function Get-Data {
    Write-Output 10
    Write-Output 20
}

$result = Get-Data
Write-Host "çµæœ: $result" # "10 20" ãŒè¿”ã‚‹ï¼ˆé…åˆ—åŒ–ã•ã‚Œã‚‹ï¼‰
```

**å¯¾å¿œæ–¹æ³•:**  
é…åˆ—ã«æ ¼ç´ã—ã€æ˜ç¤ºçš„ã«åˆ¶å¾¡ã—ã¾ã™ã€‚

**ä¿®æ­£ä¾‹:**  

```powershell
function Get-MultipleValues {
    return @(10, 20) # æ˜ç¤ºçš„ã«é…åˆ—ã‚’è¿”ã™
}

function Get-SingleValue {
    return 10 # å˜ä¸€ã®å€¤ã‚’è¿”ã™
}

# å‘¼ã³å‡ºã—ä¾‹
$resultArray = Get-MultipleValues
Write-Host "é…åˆ—: $($resultArray -join ', ')"

$resultSingle = Get-SingleValue
Write-Host "å˜ä¸€å€¤: $resultSingle"
```

---

### **äº‹ä¾‹3: ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«ã‚ˆã‚‹æš—é»™çš„ãªãƒ‡ãƒ¼ã‚¿æµå‡º**

**å•é¡Œ:**  
é–¢æ•°å†…ã®æ¨™æº–å‡ºåŠ›ãŒãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’é€šã˜ã¦å¤–éƒ¨ã«å‡ºåŠ›ã•ã‚Œã€æ„å›³ã—ãªã„æˆ»ã‚Šå€¤ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

**ã‚³ãƒ¼ãƒ‰ä¾‹:**

```powershell:
function Get-String {
    "This is output"
    return "Expected Return"
}

$result = Get-String
Write-Host "çµæœ: $result" # "This is output" ãŒå„ªå…ˆã•ã‚Œã‚‹
```

**å¯¾å¿œæ–¹æ³•:**  

1. **`$Output.Clear()` ã‚’æ´»ç”¨**
    ãƒ‡ãƒ¼ã‚¿ã®æµå‡ºã‚’æŠ‘åˆ¶ã™ã‚‹ãŸã‚ã«ã€å‡¦ç†ã®é–‹å§‹æ™‚ã« `$Output.Clear()` ã‚’ç”¨ã„ã‚‹æ–¹æ³•ãŒæœ‰åŠ¹ã§ã™ã€‚
2. **é©åˆ‡ãªæˆ»ã‚Šå€¤ã®è¨­è¨ˆ**
    æˆ»ã‚Šå€¤ãŒæœ€å¾Œã«æ„å›³çš„ã«åˆ¶å¾¡ã•ã‚Œã‚‹ã¹ãã§ã‚ã‚‹ã“ã¨ã‚’å¿µé ­ã«ç½®ãã¾ã™ã€‚

**ä¿®æ­£ä¾‹:**

```powershell:
function Get-String {
    $Output.Clear() # æ¨™æº–å‡ºåŠ›ã‚’ã‚¯ãƒªã‚¢
    "This is debug info" > $null # æ¨™æº–å‡ºåŠ›ã®æŠ‘åˆ¶
    return "Expected Return"
}

$result = Get-String
Write-Host "çµæœ: $result" # æ­£ã—ã„æˆ»ã‚Šå€¤ãŒå¾—ã‚‰ã‚Œã‚‹
```

---

### **äº‹ä¾‹4: æˆ»ã‚Šå€¤ãŒç•°ãªã‚‹å‹ã«ã‚­ãƒ£ã‚¹ãƒˆã•ã‚Œã‚‹**

**å•é¡Œ:**  
æˆ»ã‚Šå€¤ã®å‹ãŒé–¢æ•°å†…ã®æ“ä½œã«ã‚ˆã£ã¦æš—é»™çš„ã«å¤‰æ›´ã•ã‚Œã¾ã™ã€‚

**ã‚³ãƒ¼ãƒ‰ä¾‹:**

```powershell
function Convert-StringToInt {
    param (
        [string]$TargetString
    )
    [int]$value = $TargetString
    Write-Host "æ–‡å­—åˆ—[$TargetString]ã‚’æ•°å€¤å‹[$value]ã«å¤‰æ›ã—ã¾ã—ãŸã€‚"
    return $value
}

$result = Convert-StringToInt -TargetString "123abc" # æ•´æ•°ã¨ã—ã¦æ‰±ã†ã«ã¯ä¸é©åˆ‡
Write-Host "çµæœ: $result" # æœŸå¾…ã—ãŸå€¤ã«ãªã‚‰ãªã„
```

**å¯¾å¿œæ–¹æ³•:**  

1. **æ˜ç¤ºçš„ãªå‹æŒ‡å®š**
    PowerShellã§ã¯å‹ã®æ˜ç¤ºãŒå¯èƒ½ãªãŸã‚ã€å¿…è¦ãªå‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚
2. **å‹å¤‰æ›ã‚¨ãƒ©ãƒ¼ã«å¯¾ã™ã‚‹ä¾‹å¤–å‡¦ç†**
    å‹å¤‰æ›ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹å ´åˆã¯ã€`Try-Catch` ã‚’ä½¿ç”¨ã—ã¦ä¾‹å¤–å‡¦ç†ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

**ä¿®æ­£ä¾‹:**  

```powershell
function Convert-StringToInt {
    param (
        [string]$TargetString
    )
    try {
        [int]$value = $TargetString    
        Write-Host "æ–‡å­—åˆ—[$TargetString]ã‚’æ•°å€¤å‹[$value]ã«å¤‰æ›ã—ã¾ã—ãŸã€‚"
    }
    catch {
        Write-Error "ConvertStringToint: å¤‰æ›æ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚[$($_.Exception.Message)"
        return $null
    }

    return $value
}

$result = Convert-StringToInt -TargetString "123abc" # æ•´æ•°ã¨ã—ã¦æ‰±ã†ã«ã¯ä¸é©åˆ‡
if ($null -ne $result) {
    Write-Host "çµæœ: $result"
}
else {
    Write-Host "å¤‰æ›æ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸãŸã‚ã€çµæœã‚’è¡¨ç¤ºã—ã¾ã›ã‚“ã€‚"
}
```

## å¯¾å¿œæ–¹æ³•

## ã¾ã¨ã‚

PowerShellç‹¬è‡ª

## é–¢é€£è¨˜äº‹
