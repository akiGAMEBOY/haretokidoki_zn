---
title: "ã€PowerShellç‰¹æœ‰ã®è½ã¨ã—ç©´ï¼ã€‘Functionå†…ã§æ¨™æº–å‡ºåŠ›ã™ã‚‹ã¨æˆ»ã‚Šå€¤ãŒã€ŒSystem.Object[]ã€ã«ãªã£ã¦ã—ã¾ã†"
emoji: "ğŸ›«"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["powershell"]
published: false
---

PowerShellã§ã¯ã€ŒFunctionå†…ã®æ¨™æº–å‡ºåŠ›ãŒæˆ»ã‚Šå€¤ã¨ã—ã¦å‘¼ã³å‡ºã—å…ƒã«æ¸¡ã•ã‚Œã‚‹ã€ã¨ã„ã†**ä»•æ§˜**ãŒã‚ã‚Šã¾ã™ã€‚

è¦ã¯ã€ **Functionå†…ã§æ¨™æº–å‡ºåŠ›ã™ã‚‹ã¨æ„å›³ã—ãªã„æˆ»ã‚Šå€¤ã«ãªã‚‹ã‚ˆ** ã€ã¨ã„ã†ã“ã¨ã€‚

ä½•ã‚’éš ãã†ç§ã‚‚æ™‚é–“ãŒçµŒã¤ã¨ã€ã“ã®ä»•æ§˜ã‚’å¿˜ã‚Œã¦ã—ã¾ã„ä½•åº¦ã‹ãƒãƒã£ã¦ã„ã¾ã™â€¦â€¦
ç§è‡ªèº«ã®å‚™å¿˜ã‚‚ã‹ã­ã¦ã€ã“ã®ä»•æ§˜ã®è©³ã—ã„æƒ…å ±ã¨å¯¾å‡¦æ–¹æ³•ã‚’ç´¹ä»‹ã€‚

## ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

- ä¸»ã«PowerShellåˆå­¦è€…ãƒ»åˆç´šè€…ã®æ–¹
- ä¸‹è¨˜ã®ã‚ˆã†ãªã‚±ãƒ¼ã‚¹ã®åŸå› ä¸æ˜ãªã‚¨ãƒ©ãƒ¼ã§ãŠæ‚©ã¿ã®æ–¹
    - è¤‡æ•°ã®Functionã§é€£æºã™ã‚‹PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ
    - ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ç›´ã™ãŒå•é¡ŒãŒãªã„ã‚ˆã†ã«è¦‹ãˆã€ãªãœã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã‹ä¸æ˜
    - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã¿ã‚‹ã¨ã€ãªãœã‹Functionã®æˆ»ã‚Šå€¤ãŒæƒ³å®šå¤–ã®ãƒ‡ãƒ¼ã‚¿å‹ã§è¿”ã£ã¦ã„ã‚‹

## ã€ŒFunctionå†…ã§æ¨™æº–å‡ºåŠ›ã™ã‚‹ã¨æ„å›³ã—ãªã„æˆ»ã‚Šå€¤ã«ãªã‚‹ã€ã¨ã¯

è¨€è‘‰ã®é€šã‚Šãªã®ã§ã™ãŒæ–‡ç« ã ã‘ã§ã¯ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒæ´ã¿ã«ãã„ã¨æ€ã†ã®ã§ã€ãã®äº‹è±¡ã¨ãªã‚‹ã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚

### ä»•æ§˜ã§æˆ»ã‚Šå€¤ãŒæœŸå¾…å€¤ã¨ãªã‚‰ãªã„ã‚³ãƒ¼ãƒ‰

æ„å›³ã—ãªã„æˆ»ã‚Šå€¤ã«ã•ã›ã¦ã—ã¾ã£ã¦ã„ã‚‹ãƒã‚¤ãƒ³ãƒˆã«ã¯ã€ŒâŒãƒãƒ¼ã‚¯ã€ã§ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ã„ã¾ã™ã€‚

```powershell:ä»•æ§˜ã§æˆ»ã‚Šå€¤ãŒæœŸå¾…å€¤ã¨ãªã‚‰ãªã„ã‚³ãƒ¼ãƒ‰ã®ä¾‹
# Function
function New-Folder {
    param (
        [string]$FolderPath
    )
    # å‡¦ç†çµæœã®é€²æ—ã‚’å…¥ã‚Œã‚‹æ•°å€¤å‹ã®ã‚³ãƒ¼ãƒ‰
    [int]$statusCode = 0

    if (Test-Path -Path $FolderPath) {
        # ã™ã§ã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤
        try {
            Remove-Item -Path $FolderPath -Recurse -Force
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å‰Šé™¤ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -101
        }

        # å‰Šé™¤å¾Œã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ
        if ($statusCode -eq 0) {
            try {
                # âŒ New-Itemã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
                New-Item -ItemType Directory -Path $FolderPath
                # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
                Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å†ä½œæˆã€‚"
            }
            catch {
                Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
                $statusCode = -201
            }
        }
    }
    else {
        # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯ãã®ã¾ã¾ä½œæˆ
        try {
            # âŒ New-Itemã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
            New-Item -ItemType Directory -Path $FolderPath
            # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
            Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚"
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -301
        }
    }

    # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
    if ($statusCode -eq 0) {
        Write-Output "New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }
    else {
        Write-Output "New-FolderãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }

    # âŒ Intã§è¿”ã£ãŸã»ã—ã„ãŒã€æ¨™æº–å‡ºåŠ›ã®æ–‡å­—åˆ—å‹ã‚‚å…¥ã£ã¦Objectå‹ã¨ã—ã¦è¿”ã—ã¦ã—ã¾ã†ã€‚
    return $statusCode
}

# ãƒ¡ã‚¤ãƒ³å‡¦ç†
[int]$statusCode = 0

# âŒ Functionå®Ÿè¡Œã—ã¦ã„ã‚‹å ´æ‰€ã§å®Ÿè¡Œã™ã‚‹ã¨Objectå‹ã§è¿”ã£ã¦ãã¦ãã‚‹ã€‚
#     æˆ»ã‚Šå€¤ã‚’Intå‹ã®$statusCodeã«ä»£å…¥ã—ã¦ã„ã‚‹ã®ã§ãƒ‡ãƒ¼ã‚¿å‹ã®å¤‰æ›å‡¦ç†ãŒç™ºç”Ÿã€‚Objectå‹ã‹ã‚‰Intå‹ã«ã¯å¤‰æ›ä¸å¯ã¨ãªã‚‹ãŸã‚ã‚³ã‚³ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚
#     $stautsCode ã«å€¤ã‚’ä»£å…¥ã™ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ãŸã‚ã€$statusCodeã¯ã€Œ0ã€ã®ã¾ã¾ã¨ãªã‚‹ã€‚
$statusCode = (New-Folder "D:\Temp")

# âŒ ä¸Šè¨˜ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã‚‚ã®ã®$statusCodeã¯ã€Œ0ã€ã®ã¾ã¾ãªã®ã§æ­£å¸¸çµ‚äº†ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºåŠ›
if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

ã“ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ Functionï¼ˆ`New-Folder`ï¼‰ã®æˆ»ã‚Šå€¤ã¯ã€æ•°å€¤å‹ï¼ˆ`Int`ï¼‰ã§ã¯ãªã Functionå†…ã§å‡ºåŠ›ã•ã‚ŒãŸæ¨™æº–å‡ºåŠ›çµæœï¼ˆ`Write-Output` ã‚„ `New-Item`ï¼‰ã‚’å«ã‚€ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ï¼ˆ`System.Object[]`ï¼‰ãŒæˆ»ã‚Šå€¤ã«ã€‚

ã¤ãã¯å®Ÿéš›ã«ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã„ã¾ã™ã€‚

### â€œä»•æ§˜ã§æˆ»ã‚Šå€¤ãŒæœŸå¾…å€¤ã¨ãªã‚‰ãªã„ã‚³ãƒ¼ãƒ‰â€ã‚’å®Ÿè¡Œã—ãŸçµæœ

â€œä»•æ§˜ã§æˆ»ã‚Šå€¤ãŒæœŸå¾…å€¤ã¨ãªã‚‰ãªã„â€ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä¸‹è¨˜ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚

```powershell:ã‚¨ãƒ©ãƒ¼ï¼ˆçµæœã‚’ãã®ã¾ã¾è¨˜è¼‰ï¼‰
MetadataError:
Line |
  63 |  $statusCode = (New-Folder "D:\Temp")
     |  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Cannot convert the "System.Object[]" value of type "System.Object[]" to type "System.Int32".
ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
```

æ—¥æœ¬èªã®ç¿»è¨³ã™ã‚‹ã¨ä¸‹è¨˜ã®ã¨ãŠã‚Šã€‚

```powershell:ã‚¨ãƒ©ãƒ¼ï¼ˆçµæœã‚’æ—¥æœ¬èªã«ç¿»è¨³ï¼‰
ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ©ãƒ¼:
è¡Œ |
  63 |  $statusCode = (New-Folder "D:\Temp")
     |  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | "System.Object[]" å‹ã®å€¤ "System.Object[]" ã‚’ "System.Int32" å‹ã«å¤‰æ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚
ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
```

å‰è¿°ã—ã¦ã„ã‚‹é€šã‚Š Functionï¼ˆ`New-Folder`ï¼‰ã‚’å®Ÿè¡Œã—ãŸæˆ»ã‚Šå€¤ãŒã€System.Int32 ã§ã¯ãªã ã€Œ**System.Object[]**ã€ã§è¿”ã£ã¦ããŸã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚
ã§ã¯ã€å®Ÿéš›ã«ã©ã®ã‚ˆã†ãªæµã‚Œã§ã€Œ**System.Object[]**ã€ãŒè¿”ã£ã¦ããŸã®ã‹ãƒ‡ãƒãƒƒã‚°ã—ã¦è©³ç´°ã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

### èª¿æŸ»ã®ãŸã‚ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ ã—ãŸã‚³ãƒ¼ãƒ‰

Functionã‚’å®Ÿè¡Œã™ã‚‹å‰å¾Œã® `$statusCode` ã®ãƒ‡ãƒ¼ã‚¿å‹ã¨ä¸­èº«ã‚’ç¢ºèªã—ã¾ã™ã€‚
ç¢ºèªã™ã‚‹æ–¹æ³•ã¨ã—ã¦ã€`Write-Debug` ã‚’ä½¿ã„ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ä¸­ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºåŠ›ã™ã‚‹ã‚ˆã†ã«ä¿®æ­£ã€‚

PowerShellã§ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’ã‚ªãƒ³ã«ã™ã‚‹ã«ã¯ã€äº‹å‰ã«ä¸‹è¨˜ã‚’è¨­å®šã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```powershell:ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’ã‚ªãƒ³ã«ã™ã‚‹è¨­å®š
$DebugPreference = "Continue"
```

ã¡ãªã¿ã«ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã‹ã‚‰æŠœã‘ã‚‹å ´åˆã¯ä¸‹è¨˜ã‚’è¨­å®šã—ã¾ã™ã€‚

```powershell:ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’ã‚ªãƒ•ã«ã™ã‚‹è¨­å®šï¼ˆåˆ‡ã‚Šæˆ»ã—ç”¨ï¼‰
$DebugPreference = "SilentlyContinue"
```

ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«è¿½åŠ ã—ã¾ã™ã€‚

```diff powershell:ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
# ãƒ¡ã‚¤ãƒ³å‡¦ç†
[int]$statusCode = 0

+Write-Debug ($statusCode.GetType().FullName)
+Write-Debug "statusCode[$($statusCode)]"
$statusCode = (New-Folder "D:\Temp")
+Write-Debug ($statusCode.GetType().FullName)
+Write-Debug "statusCode[$($statusCode)]"

if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

:::details èª¿æŸ»ã®ãŸã‚ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ ã—ãŸã‚³ãƒ¼ãƒ‰ï¼ˆå…¨ä½“ï¼‰

ãƒ‡ãƒãƒƒã‚°é–¢é€£ã‚’è¿½åŠ ã—ãŸã‚³ãƒ¼ãƒ‰ã€‚
è¿½åŠ ã—ãŸç®‡æ‰€ã«ã¯ã€ŒğŸ“‘ãƒãƒ¼ã‚¯ã€ã‚’å…¥ã‚Œã¦ã„ã¾ã™ã€‚

```powershell:
# ğŸ“‘ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’ã‚ªãƒ³
$DebugPreference = "Continue"
# $DebugPreference = "SilentlyContinue"

# Functionç¾¤
function New-Folder {
    param (
        [string]$FolderPath
    )
    # å‡¦ç†çµæœã®é€²æ—ã‚’å…¥ã‚Œã‚‹æ•°å€¤å‹ã®ã‚³ãƒ¼ãƒ‰
    [int]$statusCode = 0

    if (Test-Path -Path $FolderPath) {
        # ã™ã§ã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤
        try {
            Remove-Item -Path $FolderPath -Recurse -Force
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å‰Šé™¤ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -101
        }

        # å‰Šé™¤å¾Œã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ
        if ($statusCode -eq 0) {
            try {
                # âŒ New-Itemã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
                New-Item -ItemType Directory -Path $FolderPath
                # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
                Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å†ä½œæˆã€‚"
            }
            catch {
                Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
                $statusCode = -201
            }
        }
    }
    else {
        # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯ãã®ã¾ã¾ä½œæˆ
        try {
            # âŒ New-Itemã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
            New-Item -ItemType Directory -Path $FolderPath
            # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
            Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚"
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -301
        }
    }

    # âŒ Write-Outputã®ã‚³ãƒãƒ³ãƒ‰çµæœãŒæˆ»ã‚Šå€¤ã«å…¥ã‚‹
    if ($statusCode -eq 0) {
        Write-Output "New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }
    else {
        Write-Output "New-FolderãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }

    # âŒ Intã§è¿”ã£ãŸã»ã—ã„ãŒã€æ¨™æº–å‡ºåŠ›ã®æ–‡å­—åˆ—å‹ã‚‚å…¥ã£ã¦Objectå‹ã¨ã—ã¦è¿”ã—ã¦ã—ã¾ã†ã€‚
    return $statusCode
}

# ãƒ¡ã‚¤ãƒ³å‡¦ç†
[int]$statusCode = 0

# ğŸ“‘ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿½åŠ 
Write-Debug ($statusCode.GetType().FullName)
Write-Debug "statusCode[$($statusCode)]"
# âŒ Objectå‹ã§æˆ»ã£ãŸã“ã¨ã«ã‚ˆã‚ŠIntå‹ã«å¤‰æ›ä½¿ç”¨ã¨ã—ã¦ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚$statusCodeã¯ã€Œ0ã€ã®ã¾ã¾ã¨ãªã‚‹ã€‚
$statusCode = (New-Folder "D:\Temp")
# ğŸ“‘ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿½åŠ 
Write-Debug ($statusCode.GetType().FullName)
Write-Debug "statusCode[$($statusCode)]"

# âŒ ä¸Šè¨˜ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã‚‚ã®ã®$statusCodeã¯ã€Œ0ã€ã®ã¾ã¾ãªã®ã§æ­£å¸¸çµ‚äº†ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºåŠ›
if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

:::

#### â€œèª¿æŸ»ã®ãŸã‚ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ ã—ãŸã‚³ãƒ¼ãƒ‰â€ã‚’å®Ÿè¡Œã—ãŸçµæœ

```powershell:ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ ã—ãŸã‚³ãƒ¼ãƒ‰ã®å®Ÿè¡Œçµæœ
DEBUG: System.Int32
DEBUG: statusCode[0]
MetadataError:
Line |
  64 |  $statusCode = (New-Folder "D:\Temp")
     |  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Cannot convert the "System.Object[]" value of type "System.Object[]" to type "System.Int32".
DEBUG: System.Int32
DEBUG: statusCode[0]
ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
PS C:\Users\XXXX>
```

Functionï¼ˆ`New-Folder`ï¼‰ã‚’å®Ÿè¡Œã™ã‚‹å‰å¾Œã§ `$statusCode` ã®çµæœã‚’ç¢ºèªã™ã‚‹ã¨ã€ãƒ‡ãƒ¼ã‚¿å‹ã¯ `System.Int32` ã§ ä¸­èº«ã¯æ•°å­— `0` ã®ã¾ã¾ã§ã™ã€‚

ã¤ãã« `Cannot convert the "System.Object[]" value of type "System.Object[]" to type "System.Int32".` ã¨ã„ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¦‹ã¦ã„ãã¾ã™ã€‚
Functionï¼ˆ`New-Folder`ï¼‰ã®æˆ»ã‚Šå€¤ã¯ã€PowerShellç‰¹æœ‰ã®ä»•æ§˜ã«ã‚ˆã‚Š `System.Object[]` ã§è¿”ã‚Šãã®ãƒ‡ãƒ¼ã‚¿ã‚’æ•°å€¤å‹ã® `$statusCode` ã«ä»£å…¥ã—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ãŸã‚ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚
ã“ã“ã§ã®ã‚¨ãƒ©ãƒ¼ã¯ã€ãƒ‡ãƒ¼ã‚¿å‹ã®å¤‰æ›ã‚’è¡ŒãŠã†ã¨ã—ã¦ç™ºç”Ÿã—ãŸã‚¨ãƒ©ãƒ¼ã¨ãªã‚Šã¾ã™ã€‚ã“ã‚Œã‚‚PowerShellã®ä»•æ§˜ãªã®ã§ã™ãŒã€åˆ¥ã®ãƒ‡ãƒ¼ã‚¿å‹ã«ä»£å…¥ã™ã‚‹ã¨è‡ªå‹•ã§ã‚­ãƒ£ã‚¹ãƒˆï¼ˆå‹ã®å¤‰æ›ï¼‰ãŒç™ºç”Ÿã—ã¾ã™ã€‚

ãã®ã‚­ãƒ£ã‚¹ãƒˆå‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã‚‚ã®ã®ã€`System.Object[]` ã‹ã‚‰ `System.Int32` ã¯ã‚­ãƒ£ã‚¹ãƒˆï¼ˆå¤‰æ›ï¼‰ã§ããªã„ãƒ‡ãƒ¼ã‚¿å‹åŒå£«ãªã®ã§ `Cannot convert` ã‹ã‚‰å§‹ã¾ã‚‹ **å¤‰æ›ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒç™ºç”Ÿã—ãŸ** ã¨ã„ã†æµã‚Œã€‚

ã‚‚ã†å°‘ã—å…·ä½“çš„ãªãƒ‡ãƒ¼ã‚¿ã®æµã‚Œã‚’èª¬æ˜ã™ã‚‹ã¨æœ¬æ¥ã€Functionï¼ˆ`New-Folder`ï¼‰ã§æœŸå¾…ã—ã¦ã„ãŸãƒ‡ãƒ¼ã‚¿å‹ã¯ã€ã€Œ`System.Int32`ã€ã€‚ã—ã‹ã—ã€Functionå†…ã®æ¨™æº–å‡ºåŠ›ã«ã‚ˆã‚Šã€Œ`@("New-Itemã®æ¨™æº–å‡ºåŠ›çµæœ", "Write-Outputã®æ¨™æº–å‡ºåŠ›çµæœ", "$statusCodeã®æ•°å€¤")`ã€ã¨ã„ã†ã‚ˆã†ãª `System.Object[]` ã®æˆ»ã‚Šå€¤ãŒè¿”ã£ã¦ããŸã¨ã„ã†ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

ã§ã¯ã€å®Ÿéš›ã«æˆ»ã£ã¦ããŸ `System.Object[]` ã®ä¸­èº«ãŒäºˆæƒ³é€šã‚Šã‹è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

### æœ¬å½“ã«æˆ»ã‚Šå€¤ãŒ System.Object[] ã§æ¨™æº–å‡ºåŠ›ã‚‚å«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

å®Ÿéš›ã«Functionï¼ˆ`New-Folder`ï¼‰ã®æˆ»ã‚Šå€¤å†…ã‚’ç¢ºèªã—ã¦ã¿ã¾ã™ã€‚
ç¢ºèªã™ã‚‹ãŸã‚ã«æ–°ãŸã«ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ï¼

#### æˆ»ã‚Šå€¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã®ä¸­èº«ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚³ãƒ¼ãƒ‰

```diff powershell:æˆ»ã‚Šå€¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã®ä¸­èº«ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ 
# ãƒ¡ã‚¤ãƒ³å‡¦ç†
-[int]$statusCode = 0
+[object]$resultData = @()

-$statusCode = (New-Folder "D:\Temp")
+$resultData = (New-Folder "D:\Temp")
+$resultData | Format-List

if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

:::details æˆ»ã‚Šå€¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã®ä¸­èº«ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚³ãƒ¼ãƒ‰ï¼ˆå…¨ä½“ï¼‰

ä¸Šè¨˜ã®ã¨ãŠã‚Šã€å¤‰æ•°ï¼ˆ`$resultData`ï¼‰ã®ä¸­èº«ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã€‚
å¤‰åŒ–ç‚¹ã«ã¯ã€ŒğŸ‘€ãƒãƒ¼ã‚¯ã€ã‚’å…¥ã‚Œã¦ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ã¾ã™ã€‚

```powershell:System.Object[]ã®ä¸­èº«ç¢ºèªç”¨ã®ã‚³ãƒ¼ãƒ‰
# Functionç¾¤
function New-Folder {
    param (
        [string]$FolderPath
    )
    # å‡¦ç†çµæœã®é€²æ—ã‚’å…¥ã‚Œã‚‹æ•°å€¤å‹ã®ã‚³ãƒ¼ãƒ‰
    [int]$statusCode = 0

    if (Test-Path -Path $FolderPath) {
        # ã™ã§ã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤
        try {
            Remove-Item -Path $FolderPath -Recurse -Force
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å‰Šé™¤ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -101
        }

        # å‰Šé™¤å¾Œã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ
        if ($statusCode -eq 0) {
            try {
                New-Item -ItemType Directory -Path $FolderPath
                Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å†ä½œæˆã€‚"
            }
            catch {
                Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
                $statusCode = -201
            }
        }
    }
    else {
        # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯ãã®ã¾ã¾ä½œæˆ
        try {
            New-Item -ItemType Directory -Path $FolderPath
            Write-Output "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚"
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -301
        }
    }
    
    if ($statusCode -eq 0) {
        Write-Output "New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }
    else {
        Write-Output "New-FolderãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }
    
    return $statusCode
}

# ãƒ¡ã‚¤ãƒ³å‡¦ç†
# ğŸ‘€ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã¨ã—ã¦å—ã‘å–ã‚‹ãŸã‚å¤‰æ•°ã‚’å®£è¨€
[object]$resultData = @()

# ğŸ‘€ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã¨ã—ã¦å—ã‘å–ã‚‹
$resultData = (New-Folder "D:\Temp")

# ğŸ‘€ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã®ä¸­èº«ã‚’ç¢ºèª
$resultData | Format-List

if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

:::

#### â€œæˆ»ã‚Šå€¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã®ä¸­èº«ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚³ãƒ¼ãƒ‰â€ã‚’å®Ÿè¡Œã—ãŸçµæœ

ä¸‹è¨˜ãŒå®Ÿè¡Œã—ãŸçµæœã§ã™ã€‚

```powershell:â€œæˆ»ã‚Šå€¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã®ä¸­èº«ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚³ãƒ¼ãƒ‰â€ã‚’å®Ÿè¡Œã—ãŸçµæœ


    Directory: D:\

Name           : Temp
CreationTime   : 2025/03/13 12:28:42
LastWriteTime  : 2025/03/13 12:28:42
LastAccessTime : 2025/03/13 12:28:42
Mode           : d----
LinkType       :
Target         :

New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚
New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
0
ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
PS C:\Users\XXXX>
```

å®Ÿè¡Œçµæœã®ä¸€ã¤ã²ã¨ã¤ã‚’åˆ†é¡ã—ã¦ã¿ã‚‹ã¨â€¦â€¦

ä¸‹è¨˜ã¯ã€ŒNew-Itemã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®æ¨™æº–å‡ºåŠ›ã€ã®çµæœã€‚

```powershell:New-Itemã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®æ¨™æº–å‡ºåŠ›

    Directory: D:\

Name           : Temp
CreationTime   : 2025/03/13 12:28:42
LastWriteTime  : 2025/03/13 12:28:42
LastAccessTime : 2025/03/13 12:28:42
Mode           : d----
LinkType       :
Target         :

```

ã¤ãã¯ã€ŒFunctionå†…ã®æ¨™æº–å‡ºåŠ›ã€ã®çµæœã€‚

```powershell:Functionå†…ã®æ¨™æº–å‡ºåŠ›
New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚
New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
```

ãã®æ¬¡ã¯ã€ŒFunctionã§returnã—ãŸæ•°å€¤å‹ã®æˆ»ã‚Šå€¤ã€ã®çµæœã€‚

```powershell:Functionã§returnã—ãŸæ•°å€¤å‹ã®æˆ»ã‚Šå€¤
0
```

ã•ã„ã”ã¯ã€Œãƒ¡ã‚¤ãƒ³å‡¦ç†å´ã®æ¨™æº–å‡ºåŠ›ã€ã®çµæœã€‚

```powershell:
ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[0]
```

### ãƒ‡ãƒãƒƒã‚°ã—ã¦ã‚³ãƒ¼ãƒ‰ä¾‹ã§ã¯ã©ã®ã‚ˆã†ãªã“ã¨ãŒèµ·ãã¦ã„ã‚‹ã‹

- ãƒ¡ã‚¤ãƒ³å‡¦ç†
    1. ã‚ã‚‰ã‹ã˜ã‚ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã€Œ0ã€ã‚’ã‚»ãƒƒãƒˆ
    1. Functionï¼ˆ`New-Folder`ï¼‰ã‚’å‘¼ã³å‡ºã—

- Functionå‡¦ç†
    1. ã‚ã‚‰ã‹ã˜ã‚ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã€Œ0ã€ã‚’ã‚»ãƒƒãƒˆ
    1. å¯¾è±¡ã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ
        **ã“ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§æ¨™æº–å‡ºåŠ›ã‚ã‚Š**
        `New-Item`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã«ã‚ˆã‚Šæ¨™æº–å‡ºåŠ›ã•ã‚Œã€æ˜ç¤ºçš„ã«æŒ‡å®šãŒç„¡ãã¦ã‚‚æˆ»ã‚Šå€¤ã¨ã—ã¦è¿”ã•ã‚Œã¦ã—ã¾ã†ã€‚
    1. Functionã§ã®å®Ÿè¡Œçµæœã‚’å‡ºåŠ›
        **ã“ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§æ¨™æº–å‡ºåŠ›ã‚ã‚Š**
        `Write-Output`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã«ã‚ˆã‚Šæ¨™æº–å‡ºåŠ›ã•ã‚Œã€æ˜ç¤ºçš„ã«æŒ‡å®šãŒç„¡ãã¦ã‚‚æˆ»ã‚Šå€¤ã¨ã—ã¦è¿”ã•ã‚Œã¦ã—ã¾ã†ã€‚


        1. Functionï¼ˆ`New-Folder`ï¼‰ãŒå®Ÿè¡Œ
    1. ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒä½œæˆã‚‚ã—ãã¯å†ä½œæˆ
        â†’ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚‚æ•°å€¤ï¼ˆ`Int`ï¼‰ã®ã¾ã¾
    2. æ¨™æº–å‡ºåŠ›(`Write-Output`)ã§ä½œæ¥­é€²æ—ã‚„å‡¦ç†çµæœã‚’è¡¨ç¤º
        â†’ PowerShellã®ä»•æ§˜ã§æ¨™æº–å‡ºåŠ›ã®çµæœã‚‚æˆ»ã‚Šå€¤ã«å…¥ã‚‹
    3. 

### è§£æ±ºæ–¹æ³•

```powershell:Write-Output ã‚’ Write-Information ã«
# Functionç¾¤
function New-Folder {
    param (
        [string]$FolderPath
    )
    # å‡¦ç†çµæœã®é€²æ—ã‚’å…¥ã‚Œã‚‹æ•°å€¤å‹ã®ã‚³ãƒ¼ãƒ‰
    [int]$statusCode = 0

    if (Test-Path -Path $FolderPath) {
        # ã™ã§ã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤
        try {
            Remove-Item -Path $FolderPath -Recurse -Force
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å‰Šé™¤ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -101
        }

        # å‰Šé™¤å¾Œã«ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆ
        if ($statusCode -eq 0) {
            try {
                # âœ… New-Item å®Ÿè¡Œæ™‚ã®æ¨™æº–å‡ºåŠ›ã‚’ Out-Null ã§ç ´æ£„
                (New-Item -ItemType Directory -Path $FolderPath | Out-Null)
                # âœ… Write-Output ã‹ã‚‰ Write-Host ã«ã‚ˆã‚‹å¤‰æ›´ã§ æ¨™æº–å‡ºåŠ› ã‹ã‚‰ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼ˆç”»é¢ã®ã¿ï¼‰ ã«ï¼
                Write-Host "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’å†ä½œæˆã€‚"
            }
            catch {
                Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
                $statusCode = -201
            }
        }
    }
    else {
        # ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒãªã„å ´åˆã¯ãã®ã¾ã¾ä½œæˆ
        try {
            # âœ… New-Item å®Ÿè¡Œæ™‚ã®æ¨™æº–å‡ºåŠ›ã‚’ Out-Null ã§ç ´æ£„
            (New-Item -ItemType Directory -Path $FolderPath | Out-Null)
            # âœ… Write-Output ã‹ã‚‰ Write-Host ã«ã‚ˆã‚‹å¤‰æ›´ã§ æ¨™æº–å‡ºåŠ› ã‹ã‚‰ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼ˆç”»é¢ã®ã¿ï¼‰ ã«ï¼
            Write-Host "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’æ–°è¦ä½œæˆã€‚"
        }
        catch {
            Write-Error "New-Folder: ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚FolderPath[$($FolderPath)]ã‚¨ãƒ©ãƒ¼[$($_.Exception.Message)]"
            $statusCode = -301
        }
    }

    # âœ… Write-Output ã‹ã‚‰ Write-Host ã«ã‚ˆã‚‹å¤‰æ›´ã§ æ¨™æº–å‡ºåŠ› ã‹ã‚‰ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼ˆç”»é¢ã®ã¿ï¼‰ ã«ï¼
    if ($statusCode -eq 0) {
        Write-Host "New-FolderãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }
    else {
        Write-Host "New-FolderãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
    }

    # âœ… Functionå†…ã§æ¨™æº–å‡ºåŠ›ãŒãªã„ã®ã§Intã§è¿”ã‚‹
    return $statusCode
}

# ãƒ¡ã‚¤ãƒ³å‡¦ç†
[int]$statusCode = 0

# âœ… Functionã®çµæœãŒIntã§è¿”ã‚Šã€å¤‰æ›ã™ã‚‹ã“ã¨ãªãã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã«çµæœãŒä»£å…¥
$statusCode = (New-Folder "D:\Temp")

# âœ… å®Ÿéš›ã®çµæœã§åˆ†å²ã•ã‚Œã‚‹
if ($statusCode -eq 0) {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ­£å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
else {
    Write-Host "ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒç•°å¸¸çµ‚äº†ã€‚statusCode[$($statusCode)]"
}
```

## è¤‡æ•°ã®äº‹ä¾‹ã¨ãã®è§£æ±ºæ¡ˆ

### **äº‹ä¾‹1: Write-Outputã«ã‚ˆã‚‹äºˆæœŸã›ã¬æ¨™æº–å‡ºåŠ›**

**å•é¡Œ:**  
é–¢æ•°å†…ã§ `Write-Output` ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€æ„å›³ã›ãšãã®çµæœãŒæˆ»ã‚Šå€¤ã¨ã—ã¦è¿”ã•ã‚Œã¾ã™ã€‚

**ã‚³ãƒ¼ãƒ‰ä¾‹:**  

```powershell
function Get-Number {
    Write-Output "Debugging Info" # ä½™åˆ†ãªæ¨™æº–å‡ºåŠ›
    return 42
}

$result = Get-Number
Write-Host "çµæœ: $result" # "Debugging Info" ã¨ 42 ã®ä¸¡æ–¹ãŒè¿”ã•ã‚Œã‚‹
```

**å¯¾å¿œæ–¹æ³•:**  

1. **ä¸è¦ãªæ¨™æº–å‡ºåŠ›ã‚’å®Œå…¨ã«æ’é™¤ã™ã‚‹**
    æ¨™æº–å‡ºåŠ›ã‚’æŠ‘åˆ¶ã™ã‚‹å ´åˆã«ã¯æ˜ç¤ºçš„ã«ãã®å‡¦ç†ã‚’è¡Œã†ã®ã§ã¯ãªãã€ä½™è¨ˆãª `Write-Output` ã‚’å‰Šé™¤ã—ã€æ„å›³çš„ãªå‡¦ç†ã‚’è¨˜è¿°ã—ãªã„æ–¹æ³•ãŒé©åˆ‡ã§ã™ã€‚
2. **ãƒ‡ãƒãƒƒã‚°ç”¨é€”ã®å ´åˆ**
    ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ®‹ã™æ„å›³ãŒã‚ã‚‹å ´åˆã¯ã€`Write-Debug` ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å‡ºåŠ›ã‚’ç°¡å˜ã«åˆ¶å¾¡å¯èƒ½ã«ã—ã¾ã™ã€‚

**ã‚³ãƒ¼ãƒ‰ä¾‹:**  

```powershell
# ä¸è¦ãªæ¨™æº–å‡ºåŠ›ã‚’æ’é™¤
function Get-Number {
    return 42 # ãƒ‡ãƒãƒƒã‚°ç›®çš„ã§ãªã‘ã‚Œã° Write-Output ã‚’ä½¿ç”¨ã—ãªã„
}

# ãƒ‡ãƒãƒƒã‚°ç›®çš„
function Get-Number-Debug {
    Write-Debug "ç¾åœ¨ã®é–¢æ•°å‡¦ç†: 42 ã‚’è¿”ã—ã¦ã„ã¾ã™"
    return 42
}

$DebugPreference = "Continue" # ãƒ‡ãƒãƒƒã‚°ã‚’æœ‰åŠ¹åŒ–
$result = Get-Number-Debug
Write-Host "çµæœ: $result" # å¿…è¦ã«å¿œã˜ã¦ãƒ‡ãƒãƒƒã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª
```

---

### **äº‹ä¾‹2: è¤‡æ•°ã®æˆ»ã‚Šå€¤ãŒè¿”ã•ã‚Œã‚‹**

**å•é¡Œ:**  

1. **æ„å›³çš„ã«é…åˆ—ã‚’è¿”ã™**
    è¤‡æ•°ã®å€¤ã‚’è¿”ã™å¿…è¦ãŒã‚ã‚‹å ´åˆã€PowerShellã® `@()` æ¼”ç®—å­ã‚’ä½¿ç”¨ã—ã¦æ˜ç¤ºçš„ã«é…åˆ—ã¨ã—ã¦è¿”ã—ã¾ã™ã€‚
2. **å˜ä¸€å€¤ã‚’è¿”ã™å ´åˆ**
    æ„å›³çš„ã«æœ€å¾Œã« `return` ã‚’åˆ©ç”¨ã—ã€æ˜ç¤ºçš„ã«æˆ»ã‚Šå€¤ã‚’æŒ‡å®šã™ã‚‹ã€‚

**ã‚³ãƒ¼ãƒ‰ä¾‹:**  

```powershell
function Get-Data {
    Write-Output 10
    Write-Output 20
}

$result = Get-Data
Write-Host "çµæœ: $result" # "10 20" ãŒè¿”ã‚‹ï¼ˆé…åˆ—åŒ–ã•ã‚Œã‚‹ï¼‰
```

**å¯¾å¿œæ–¹æ³•:**  
é…åˆ—ã«æ ¼ç´ã—ã€æ˜ç¤ºçš„ã«åˆ¶å¾¡ã—ã¾ã™ã€‚

**ä¿®æ­£ä¾‹:**  

```powershell
function Get-MultipleValues {
    return @(10, 20) # æ˜ç¤ºçš„ã«é…åˆ—ã‚’è¿”ã™
}

function Get-SingleValue {
    return 10 # å˜ä¸€ã®å€¤ã‚’è¿”ã™
}

# å‘¼ã³å‡ºã—ä¾‹
$resultArray = Get-MultipleValues
Write-Host "é…åˆ—: $($resultArray -join ', ')"

$resultSingle = Get-SingleValue
Write-Host "å˜ä¸€å€¤: $resultSingle"
```

---

### **äº‹ä¾‹3: ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«ã‚ˆã‚‹æš—é»™çš„ãªãƒ‡ãƒ¼ã‚¿æµå‡º**

**å•é¡Œ:**  
é–¢æ•°å†…ã®æ¨™æº–å‡ºåŠ›ãŒãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’é€šã˜ã¦å¤–éƒ¨ã«å‡ºåŠ›ã•ã‚Œã€æ„å›³ã—ãªã„æˆ»ã‚Šå€¤ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

**ã‚³ãƒ¼ãƒ‰ä¾‹:**

```powershell:
function Get-String {
    "This is output"
    return "Expected Return"
}

$result = Get-String
Write-Host "çµæœ: $result" # "This is output" ãŒå„ªå…ˆã•ã‚Œã‚‹
```

**å¯¾å¿œæ–¹æ³•:**  

1. **`$Output.Clear()` ã‚’æ´»ç”¨**
    ãƒ‡ãƒ¼ã‚¿ã®æµå‡ºã‚’æŠ‘åˆ¶ã™ã‚‹ãŸã‚ã«ã€å‡¦ç†ã®é–‹å§‹æ™‚ã« `$Output.Clear()` ã‚’ç”¨ã„ã‚‹æ–¹æ³•ãŒæœ‰åŠ¹ã§ã™ã€‚
2. **é©åˆ‡ãªæˆ»ã‚Šå€¤ã®è¨­è¨ˆ**
    æˆ»ã‚Šå€¤ãŒæœ€å¾Œã«æ„å›³çš„ã«åˆ¶å¾¡ã•ã‚Œã‚‹ã¹ãã§ã‚ã‚‹ã“ã¨ã‚’å¿µé ­ã«ç½®ãã¾ã™ã€‚

**ä¿®æ­£ä¾‹:**

```powershell:
function Get-String {
    $Output.Clear() # æ¨™æº–å‡ºåŠ›ã‚’ã‚¯ãƒªã‚¢
    "This is debug info" > $null # æ¨™æº–å‡ºåŠ›ã®æŠ‘åˆ¶
    return "Expected Return"
}

$result = Get-String
Write-Host "çµæœ: $result" # æ­£ã—ã„æˆ»ã‚Šå€¤ãŒå¾—ã‚‰ã‚Œã‚‹
```

---

### **äº‹ä¾‹4: æˆ»ã‚Šå€¤ãŒç•°ãªã‚‹å‹ã«ã‚­ãƒ£ã‚¹ãƒˆã•ã‚Œã‚‹**

**å•é¡Œ:**  
æˆ»ã‚Šå€¤ã®å‹ãŒé–¢æ•°å†…ã®æ“ä½œã«ã‚ˆã£ã¦æš—é»™çš„ã«å¤‰æ›´ã•ã‚Œã¾ã™ã€‚

**ã‚³ãƒ¼ãƒ‰ä¾‹:**

```powershell
function Convert-StringToInt {
    param (
        [string]$TargetString
    )
    [int]$value = $TargetString
    Write-Host "æ–‡å­—åˆ—[$TargetString]ã‚’æ•°å€¤å‹[$value]ã«å¤‰æ›ã—ã¾ã—ãŸã€‚"
    return $value
}

$result = Convert-StringToInt -TargetString "123abc" # æ•´æ•°ã¨ã—ã¦æ‰±ã†ã«ã¯ä¸é©åˆ‡
Write-Host "çµæœ: $result" # æœŸå¾…ã—ãŸå€¤ã«ãªã‚‰ãªã„
```

**å¯¾å¿œæ–¹æ³•:**  

1. **æ˜ç¤ºçš„ãªå‹æŒ‡å®š**
    PowerShellã§ã¯å‹ã®æ˜ç¤ºãŒå¯èƒ½ãªãŸã‚ã€å¿…è¦ãªå‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚
2. **å‹å¤‰æ›ã‚¨ãƒ©ãƒ¼ã«å¯¾ã™ã‚‹ä¾‹å¤–å‡¦ç†**
    å‹å¤‰æ›ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹å ´åˆã¯ã€`Try-Catch` ã‚’ä½¿ç”¨ã—ã¦ä¾‹å¤–å‡¦ç†ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

**ä¿®æ­£ä¾‹:**  

```powershell
function Convert-StringToInt {
    param (
        [string]$TargetString
    )
    try {
        [int]$value = $TargetString    
        Write-Host "æ–‡å­—åˆ—[$TargetString]ã‚’æ•°å€¤å‹[$value]ã«å¤‰æ›ã—ã¾ã—ãŸã€‚"
    }
    catch {
        Write-Error "ConvertStringToint: å¤‰æ›æ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚[$($_.Exception.Message)"
        return $null
    }

    return $value
}

$result = Convert-StringToInt -TargetString "123abc" # æ•´æ•°ã¨ã—ã¦æ‰±ã†ã«ã¯ä¸é©åˆ‡
if ($null -ne $result) {
    Write-Host "çµæœ: $result"
}
else {
    Write-Host "å¤‰æ›æ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸãŸã‚ã€çµæœã‚’è¡¨ç¤ºã—ã¾ã›ã‚“ã€‚"
}
```

## å¯¾å¿œæ–¹æ³•

## ã¾ã¨ã‚

PowerShellç‹¬è‡ª

## é–¢é€£è¨˜äº‹
