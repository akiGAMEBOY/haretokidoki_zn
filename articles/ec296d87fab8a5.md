---
title: "PowerShellでExcelファイルの指定セルに値を設定する○種類の方法"
emoji: "🤖"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["powershell", "excel"]
published: false
---
## 概要

PowerShellでExcelファイルの指定したセルに値を設定する方法を調べる。

## 対応方法

- 行番号と列番号でセルを指定する方法
- アルファベットと数値の組み合わせでセルを指定する方法
- Excelファイル内にあらかじめ設定した定数を置換する方法

PowerShellを使用してExcelファイルのセルに値を設定する方法はいくつかあります。ご指摘の方法に加えて、以下の方法も可能です。

---

1. **行番号と列番号でセルを指定する方法**:
   ```powershell
   $excel = New-Object -ComObject Excel.Application
   $workbook = $excel.Workbooks.Open("C:\path\to\your\spreadsheet.xlsx")
   $worksheet = $workbook.Sheets.Item(1)
   $worksheet.Cells.Item(行番号, 列番号).Value2 = "設定したい値"
   $workbook.Save()
   $excel.Quit()
   ```

2. **アルファベットと数値の組み合わせでセルを指定する方法**:
   ```powershell
   $excel = New-Object -ComObject Excel.Application
   $workbook = $excel.Workbooks.Open("C:\path\to\your\spreadsheet.xlsx")
   $worksheet = $workbook.Sheets.Item(1)
   $worksheet.Range("A1").Value2 = "設定したい値"
   $workbook.Save()
   $excel.Quit()
   ```

3. **Excelファイル内にあらかじめ設定した定数を置換する方法**:
   ```powershell
   $excel = New-Object -ComObject Excel.Application
   $workbook = $excel.Workbooks.Open("C:\path\to\your\spreadsheet.xlsx")
   $worksheet = $workbook.Sheets.Item(1)
   $range = $worksheet.UsedRange
   $range.Replace("既存の定数", "新しい値")
   $workbook.Save()
   $excel.Quit()
   ```

これらの方法は、Excelファイルを開き、特定のセルや範囲にアクセスし、値を設定した後、ファイルを保存してExcelアプリケーションを閉じる一連のステップを含んでいます。PowerShellスクリプトを実行する前に、適切なファイルパスとセルの指定を確認してください。また、これらのスクリプトはExcelがインストールされているWindows環境でのみ動作します。

さらに詳細な情報や例については、オンラインのリソースやドキュメントを参照することをお勧めします¹²³。これらのリソースでは、PowerShellを使用してExcelを操作するためのさまざまなテクニックやベストプラクティスが提供されています。特に、セルの操作、シートの操作、Excelオブジェクトの管理などに関する詳細な情報が見つかるでしょう。
